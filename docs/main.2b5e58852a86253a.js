(self.webpackChunkmapLibre=self.webpackChunkmapLibre||[]).push([[792],{26:(Xr,cn,dt)=>{"use strict";dt.d(cn,{$:()=>p});const p={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},44:function(Xr){Xr.exports=function(){"use strict";var cn={},dt={};function p(W,y,Ye){if(dt[W]=Ye,"index"===W){var En="var sharedModule = {}; ("+dt.shared+")(sharedModule); ("+dt.worker+")(sharedModule);",yn={};return dt.shared(yn),dt.index(cn,yn),typeof window<"u"&&cn.setWorkerUrl(window.URL.createObjectURL(new Blob([En],{type:"text/javascript"}))),cn}}return p("shared",0,function(W){function y(c,i,a,h){return new(a||(a=Promise))(function(m,w){function C(R){try{T(h.next(R))}catch(L){w(L)}}function E(R){try{T(h.throw(R))}catch(L){w(L)}}function T(R){var L;R.done?m(R.value):(L=R.value,L instanceof a?L:new a(function(z){z(L)})).then(C,E)}T((h=h.apply(c,i||[])).next())})}function Ye(c,i){this.x=c,this.y=i}function En(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var yn,vn;"function"==typeof SuppressedError&&SuppressedError,Ye.prototype={clone(){return new Ye(this.x,this.y)},add(c){return this.clone()._add(c)},sub(c){return this.clone()._sub(c)},multByPoint(c){return this.clone()._multByPoint(c)},divByPoint(c){return this.clone()._divByPoint(c)},mult(c){return this.clone()._mult(c)},div(c){return this.clone()._div(c)},rotate(c){return this.clone()._rotate(c)},rotateAround(c,i){return this.clone()._rotateAround(c,i)},matMult(c){return this.clone()._matMult(c)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(c){return this.x===c.x&&this.y===c.y},dist(c){return Math.sqrt(this.distSqr(c))},distSqr(c){const i=c.x-this.x,a=c.y-this.y;return i*i+a*a},angle(){return Math.atan2(this.y,this.x)},angleTo(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith(c){return this.angleWithSep(c.x,c.y)},angleWithSep(c,i){return Math.atan2(this.x*i-this.y*c,this.x*c+this.y*i)},_matMult(c){const i=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=i,this},_add(c){return this.x+=c.x,this.y+=c.y,this},_sub(c){return this.x-=c.x,this.y-=c.y,this},_mult(c){return this.x*=c,this.y*=c,this},_div(c){return this.x/=c,this.y/=c,this},_multByPoint(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint(c){return this.x/=c.x,this.y/=c.y,this},_unit(){return this._div(this.mag()),this},_perp(){const c=this.y;return this.y=this.x,this.x=-c,this},_rotate(c){const i=Math.cos(c),a=Math.sin(c),h=a*this.x+i*this.y;return this.x=i*this.x-a*this.y,this.y=h,this},_rotateAround(c,i){const a=Math.cos(c),h=Math.sin(c),m=i.y+h*(this.x-i.x)+a*(this.y-i.y);return this.x=i.x+a*(this.x-i.x)-h*(this.y-i.y),this.y=m,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:Ye},Ye.convert=function(c){if(c instanceof Ye)return c;if(Array.isArray(c))return new Ye(+c[0],+c[1]);if(void 0!==c.x&&void 0!==c.y)return new Ye(+c.x,+c.y);throw new Error("Expected [x, y] or {x, y} point format")};var Ce=En(function(){if(vn)return yn;function c(i,a,h,m){this.cx=3*i,this.bx=3*(h-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(m-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=a,this.p2x=h,this.p2y=m}return vn=1,yn=c,c.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,a){if(void 0===a&&(a=1e-6),i<0)return 0;if(i>1)return 1;for(var h=i,m=0;m<8;m++){var w=this.sampleCurveX(h)-i;if(Math.abs(w)<a)return h;var C=this.sampleCurveDerivativeX(h);if(Math.abs(C)<1e-6)break;h-=w/C}var E=0,T=1;for(h=i,m=0;m<20&&(w=this.sampleCurveX(h),!(Math.abs(w-i)<a));m++)i>w?E=h:T=h,h=.5*(T-E)+E;return h},solve:function(i,a){return this.sampleCurveY(this.solveCurveX(i,a))}},yn}());let Qe,_t;function Ht(){return null==Qe&&(Qe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof createImageBitmap),Qe}function Ut(){if(null==_t&&(_t=!1,Ht())){const i=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(i){for(let h=0;h<25;h++){const m=4*h;i.fillStyle=`rgb(${m},${m+1},${m+2})`,i.fillRect(h%5,Math.floor(h/5),1,1)}const a=i.getImageData(0,0,5,5).data;for(let h=0;h<100;h++)if(h%4!=3&&a[h]!==h){_t=!0;break}}}return _t||!1}var Gt=1e-6,sn=typeof Float32Array<"u"?Float32Array:Array;function Mn(){var c=new sn(9);return sn!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function _r(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function zt(){var c=new sn(3);return sn!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function Vo(c){return Math.hypot(c[0],c[1],c[2])}function Cn(c,i,a){var h=new sn(3);return h[0]=c,h[1]=i,h[2]=a,h}function Nt(c,i,a){return c[0]=i[0]+a[0],c[1]=i[1]+a[1],c[2]=i[2]+a[2],c}function Ge(c,i,a){return c[0]=i[0]*a,c[1]=i[1]*a,c[2]=i[2]*a,c}function ir(c,i,a){var h=i[0],m=i[1],w=i[2],C=a[0],E=a[1],T=a[2];return c[0]=m*T-w*E,c[1]=w*C-h*T,c[2]=h*E-m*C,c}Math.hypot||(Math.hypot=function(){for(var c=0,i=arguments.length;i--;)c+=arguments[i]*arguments[i];return Math.sqrt(c)});var Tn,gn=Vo;function cr(c,i,a){var h=i[0],m=i[1],w=i[2],C=i[3];return c[0]=a[0]*h+a[4]*m+a[8]*w+a[12]*C,c[1]=a[1]*h+a[5]*m+a[9]*w+a[13]*C,c[2]=a[2]*h+a[6]*m+a[10]*w+a[14]*C,c[3]=a[3]*h+a[7]*m+a[11]*w+a[15]*C,c}function Sr(){var c=new sn(4);return sn!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function Wn(c,i,a,h){var m=.5*Math.PI/180;i*=m,a*=m,h*=m;var w=Math.sin(i),C=Math.cos(i),E=Math.sin(a),T=Math.cos(a),R=Math.sin(h),L=Math.cos(h);return c[0]=w*T*L-C*E*R,c[1]=C*E*L+w*T*R,c[2]=C*T*R-w*E*L,c[3]=C*T*L+w*E*R,c}function Qo(){var c=new sn(2);return sn!=Float32Array&&(c[0]=0,c[1]=0),c}function Vn(c,i){var a=new sn(2);return a[0]=c,a[1]=i,a}zt(),Tn=new sn(4),sn!=Float32Array&&(Tn[0]=0,Tn[1]=0,Tn[2]=0,Tn[3]=0),zt(),Cn(1,0,0),Cn(0,1,0),Sr(),Sr(),Mn(),Qo();const an=8192;function fn(c,i,a){return i*(an/(c.tileSize*Math.pow(2,a-c.tileID.overscaledZ)))}function Un(c,i){return(c%i+i)%i}function yo(c,i,a){return c*(1-a)+i*a}function Rr(c){if(c<=0)return 0;if(c>=1)return 1;const i=c*c,a=i*c;return 4*(c<.5?a:3*(c-i)+a-.75)}function vo(c,i,a,h){const m=new Ce(c,i,a,h);return w=>m.solve(w)}const Uo=vo(.25,.1,.25,1);function Or(c,i,a){return Math.min(a,Math.max(i,c))}function ai(c,i,a){const h=a-i,m=((c-i)%h+h)%h+i;return m===i?a:m}function Qn(c,...i){for(const a of i)for(const h in a)c[h]=a[h];return c}let Lt=1;function li(c,i,a){const h={};for(const m in c)h[m]=i.call(this,c[m],m,c);return h}function oa(c,i,a){const h={};for(const m in c)i.call(this,c[m],m,c)&&(h[m]=c[m]);return h}function Nr(c){return Array.isArray(c)?c.map(Nr):"object"==typeof c&&c?li(c,Nr):c}const Jn={};function Le(c){Jn[c]||(typeof console<"u"&&console.warn(c),Jn[c]=!0)}function gt(c,i,a){return(a.y-c.y)*(i.x-c.x)>(i.y-c.y)*(a.x-c.x)}function At(c){return typeof WorkerGlobalScope<"u"&&void 0!==c&&c instanceof WorkerGlobalScope}let Vt=null;function bn(c){return typeof ImageBitmap<"u"&&c instanceof ImageBitmap}const Lr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function ao(c,i,a,h,m){return y(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const w=new VideoFrame(c,{timestamp:0});try{const C=w?.format;if(!C||!C.startsWith("BGR")&&!C.startsWith("RGB"))throw new Error(`Unrecognized format ${C}`);const E=C.startsWith("BGR"),T=new Uint8ClampedArray(h*m*4);if(yield w.copyTo(T,function(R,L,z,$,q){const Z=4*Math.max(-L,0),Q=(Math.max(0,z)-z)*$*4+Z,ne=4*$,ce=Math.max(0,L),Se=Math.max(0,z);return{rect:{x:ce,y:Se,width:Math.min(R.width,L+$)-ce,height:Math.min(R.height,z+q)-Se},layout:[{offset:Q,stride:ne}]}}(c,i,a,h,m)),E)for(let R=0;R<T.length;R+=4){const L=T[R];T[R]=T[R+2],T[R+2]=L}return T}finally{w.close()}})}let Ds,Pi;function ki(c,i,a,h){return c.addEventListener(i,a,h),{unsubscribe:()=>{c.removeEventListener(i,a,h)}}}function ci(c){return c*Math.PI/180}function qn(c){return c/Math.PI*180}const Ri={touchstart:!0,touchmove:!0,touchmoveWindow:!0,touchend:!0,touchcancel:!0},Go={dblclick:!0,click:!0,mouseover:!0,mouseout:!0,mousedown:!0,mousemove:!0,mousemoveWindow:!0,mouseup:!0,mouseupWindow:!0,contextmenu:!0,wheel:!0},Ao="AbortError";function xe(){return new Error(Ao)}const K={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function ee(c){return K.REGISTERED_PROTOCOLS[c.substring(0,c.indexOf("://"))]}const te="global-dispatcher";class de extends Error{constructor(i,a,h,m){super(`AJAXError: ${a} (${i}): ${h}`),this.status=i,this.statusText=a,this.url=h,this.body=m}}const be=()=>At(self)?self.worker&&self.worker.referrer:("blob:"===window.location.protocol?window.parent:window).location.href,we=function(c,i){if(/:\/\//.test(c.url)&&!/^https?:|^file:/.test(c.url)){const h=ee(c.url);if(h)return h(c,i);if(At(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,targetMapId:te},i)}if(!(/^file:/.test(a=c.url)||/^file:/.test(be())&&!/^\w+:/.test(a))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(h,m){return y(this,void 0,void 0,function*(){const w=new Request(h.url,{method:h.method||"GET",body:h.body,credentials:h.credentials,headers:h.headers,cache:h.cache,referrer:be(),signal:m.signal});let C,E;"json"!==h.type||w.headers.has("Accept")||w.headers.set("Accept","application/json");try{C=yield fetch(w)}catch(R){throw new de(0,R.message,h.url,new Blob)}if(!C.ok){const R=yield C.blob();throw new de(C.status,C.statusText,h.url,R)}E="arrayBuffer"===h.type||"image"===h.type?C.arrayBuffer():"json"===h.type?C.json():C.text();const T=yield E;if(m.signal.aborted)throw xe();return{data:T,cacheControl:C.headers.get("Cache-Control"),expires:C.headers.get("Expires")}})}(c,i);if(At(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:c,mustQueue:!0,targetMapId:te},i)}var a,h,m;return h=c,m=i,new Promise((w,C)=>{var E;const T=new XMLHttpRequest;T.open(h.method||"GET",h.url,!0),"arrayBuffer"!==h.type&&"image"!==h.type||(T.responseType="arraybuffer");for(const R in h.headers)T.setRequestHeader(R,h.headers[R]);"json"===h.type&&(T.responseType="text",!(null===(E=h.headers)||void 0===E)&&E.Accept||T.setRequestHeader("Accept","application/json")),T.withCredentials="include"===h.credentials,T.onerror=()=>{C(new Error(T.statusText))},T.onload=()=>{if(!m.signal.aborted)if((T.status>=200&&T.status<300||0===T.status)&&null!==T.response){let R=T.response;if("json"===h.type)try{R=JSON.parse(T.response)}catch(L){return void C(L)}w({data:R,cacheControl:T.getResponseHeader("Cache-Control"),expires:T.getResponseHeader("Expires")})}else{const R=new Blob([T.response],{type:T.getResponseHeader("Content-Type")});C(new de(T.status,T.statusText,h.url,R))}},m.signal.addEventListener("abort",()=>{T.abort(),C(xe())}),T.send(h.body)})};function Ne(c){if(!c||c.indexOf("://")<=0||0===c.indexOf("data:image/")||0===c.indexOf("blob:"))return!0;const i=new URL(c),a=window.location;return i.protocol===a.protocol&&i.host===a.host}function Ee(c,i,a){a[c]&&-1!==a[c].indexOf(i)||(a[c]=a[c]||[],a[c].push(i))}function Ve(c,i,a){if(a&&a[c]){const h=a[c].indexOf(i);-1!==h&&a[c].splice(h,1)}}class Ue{constructor(i,a={}){Qn(this,a),this.type=i}}class We extends Ue{constructor(i,a={}){super("error",Qn({error:i},a))}}class bt{on(i,a){return this._listeners=this._listeners||{},Ee(i,a,this._listeners),{unsubscribe:()=>{this.off(i,a)}}}off(i,a){return Ve(i,a,this._listeners),Ve(i,a,this._oneTimeListeners),this}once(i,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Ee(i,a,this._oneTimeListeners),this):new Promise(h=>this.once(i,h))}fire(i,a){"string"==typeof i&&(i=new Ue(i,a||{}));const h=i.type;if(this.listens(h)){i.target=this;const m=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const E of m)E.call(this,i);const w=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const E of w)Ve(h,E,this._oneTimeListeners),E.call(this,i);const C=this._eventedParent;C&&(Qn(i,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),C.fire(i))}else i instanceof We&&console.error(i.error);return this}listens(i){return this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i)}setEventedParent(i,a){return this._eventedParent=i,this._eventedParentData=a,this}}var Me={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},state:{type:"state",default:{}},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},"color-relief":{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_color-relief","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_color-relief":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_color-relief","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"numberArray",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-altitude":{type:"numberArray",default:45,minimum:0,maximum:90,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"colorArray",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"colorArray",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-method":{type:"enum",values:{standard:{},basic:{},combined:{},igor:{},multidirectional:{}},default:"standard",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},"paint_color-relief":{"color-relief-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"color-relief-color":{type:"color",transition:!1,expression:{interpolated:!0,parameters:["elevation"]},"property-type":"color-ramp"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Ft=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Jt(c,i){const a={};for(const h in c)"ref"!==h&&(a[h]=c[h]);return Ft.forEach(h=>{h in i&&(a[h]=i[h])}),a}function Et(c,i){if(Array.isArray(c)){if(!Array.isArray(i)||c.length!==i.length)return!1;for(let a=0;a<c.length;a++)if(!Et(c[a],i[a]))return!1;return!0}if("object"==typeof c&&null!==c&&null!==i){if("object"!=typeof i||Object.keys(c).length!==Object.keys(i).length)return!1;for(const a in c)if(!Et(c[a],i[a]))return!1;return!0}return c===i}function Zt(c,i){c.push(i)}function kn(c,i,a){Zt(a,{command:"addSource",args:[c,i[c]]})}function Zn(c,i,a){Zt(i,{command:"removeSource",args:[c]}),a[c]=!0}function Gn(c,i,a,h){Zn(c,a,h),kn(c,i,a)}function sr(c,i,a){let h;for(h in c[a])if(Object.prototype.hasOwnProperty.call(c[a],h)&&"data"!==h&&!Et(c[a][h],i[a][h]))return!1;for(h in i[a])if(Object.prototype.hasOwnProperty.call(i[a],h)&&"data"!==h&&!Et(c[a][h],i[a][h]))return!1;return!0}function rn(c,i,a,h,m,w){c=c||{},i=i||{};for(const C in c)Object.prototype.hasOwnProperty.call(c,C)&&(Et(c[C],i[C])||a.push({command:w,args:[h,C,i[C],m]}));for(const C in i)Object.prototype.hasOwnProperty.call(i,C)&&!Object.prototype.hasOwnProperty.call(c,C)&&(Et(c[C],i[C])||a.push({command:w,args:[h,C,i[C],m]}))}function un(c){return c.id}function yr(c,i){return c[i.id]=i,c}class Ke{constructor(i,a,h,m){this.message=(i?`${i}: `:"")+h,m&&(this.identifier=m),null!=a&&a.__line__&&(this.line=a.__line__)}}function Qr(c,...i){for(const a of i)for(const h in a)c[h]=a[h];return c}class ur extends Error{constructor(i,a){super(a),this.message=a,this.key=i}}class ia{constructor(i,a=[]){this.parent=i,this.bindings={};for(const[h,m]of a)this.bindings[h]=m}concat(i){return new ia(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const sa={kind:"null"},at={kind:"number"},Yt={kind:"string"},Kt={kind:"boolean"},Er={kind:"color"},ui={kind:"projectionDefinition"},As={kind:"object"},jt={kind:"value"},aa={kind:"collator"},Fr={kind:"formatted"},cc={kind:"padding"},di={kind:"colorArray"},Aa={kind:"numberArray"},Rn={kind:"resolvedImage"},bo={kind:"variableAnchorOffsetCollection"};function Po(c,i){return{kind:"array",itemType:c,N:i}}function In(c){if("array"===c.kind){const i=In(c.itemType);return"number"==typeof c.N?`array<${i}, ${c.N}>`:"value"===c.itemType.kind?"array":`array<${i}>`}return c.kind}const Oi=[sa,at,Yt,Kt,Er,ui,Fr,As,Po(jt),cc,Aa,di,Rn,bo];function Pa(c,i){if("error"===i.kind)return null;if("array"===c.kind){if("array"===i.kind&&(0===i.N&&"value"===i.itemType.kind||!Pa(c.itemType,i.itemType))&&("number"!=typeof c.N||c.N===i.N))return null}else{if(c.kind===i.kind)return null;if("value"===c.kind)for(const a of Oi)if(!Pa(a,i))return null}return`Expected ${In(c)} but found ${In(i)} instead.`}function xo(c,i){return i.some(a=>a.kind===c.kind)}function ko(c,i){return i.some(a=>"null"===a?null===c:"array"===a?Array.isArray(c):"object"===a?c&&!Array.isArray(c)&&"object"==typeof c:a===typeof c)}function Ps(c,i){return"array"===c.kind&&"array"===i.kind?c.itemType.kind===i.itemType.kind&&"number"==typeof c.N:c.kind===i.kind}const ru=4/29,hi=6/29,sd=3*hi*hi,uc=hi*hi*hi,ou=Math.PI/180,pl=180/Math.PI;function iu(c){return(c%=360)<0&&(c+=360),c}function la([c,i,a,h]){let m,w;const C=fi((.2225045*(c=dc(c))+.7168786*(i=dc(i))+.0606169*(a=dc(a)))/1);c===i&&i===a?m=w=C:(m=fi((.4360747*c+.3850649*i+.1430804*a)/.96422),w=fi((.0139322*c+.0971045*i+.7141733*a)/.82521));const E=116*C-16;return[E<0?0:E,500*(m-C),200*(C-w),h]}function dc(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function fi(c){return c>uc?Math.pow(c,1/3):c/sd+ru}function Jo([c,i,a,h]){let m=(c+16)/116,w=isNaN(i)?m:m+i/500,C=isNaN(a)?m:m-a/200;return m=1*gl(m),w=.96422*gl(w),C=.82521*gl(C),[er(3.1338561*w-1.6168667*m-.4906146*C),er(-.9787684*w+1.9161415*m+.033454*C),er(.0719453*w-.2289914*m+1.4052427*C),h]}function er(c){return(c=c<=.00304?12.92*c:1.055*Math.pow(c,1/2.4)-.055)<0?0:c>1?1:c}function gl(c){return c>hi?c*c*c:sd*(c-ru)}const lo=Object.hasOwn||function(c,i){return Object.prototype.hasOwnProperty.call(c,i)};function ks(c,i){return lo(c,i)?c[i]:void 0}function ts(c){return parseInt(c.padEnd(2,c),16)/255}function co(c,i){return Xt(i?c/100:c,0,1)}function Xt(c,i,a){return Math.min(Math.max(i,c),a)}function ns(c){return!c.some(Number.isNaN)}const pi={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function $o(c,i,a){return c+a*(i-c)}function Ni(c,i,a){return c.map((h,m)=>$o(h,i[m],a))}class Qt{constructor(i,a,h,m=1,w=!0){this.r=i,this.g=a,this.b=h,this.a=m,w||(this.r*=m,this.g*=m,this.b*=m,m||this.overwriteGetter("rgb",[i,a,h,m]))}static parse(i){if(i instanceof Qt)return i;if("string"!=typeof i)return;const a=function(h){if("transparent"===(h=h.toLowerCase().trim()))return[0,0,0,0];const m=ks(pi,h);if(m){const[C,E,T]=m;return[C/255,E/255,T/255,1]}if(h.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(h)){const C=h.length<6?1:2;let E=1;return[ts(h.slice(E,E+=C)),ts(h.slice(E,E+=C)),ts(h.slice(E,E+=C)),ts(h.slice(E,E+C)||"ff")]}if(h.startsWith("rgb")){const C=h.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(C){const[E,T,R,L,z,$,q,Z,Q,ne,ce,Se]=C,ge=[L||" ",q||" ",ne].join("");if("  "===ge||"  /"===ge||",,"===ge||",,,"===ge){const ye=[R,$,Q].join(""),Re="%%%"===ye?100:""===ye?255:0;if(Re){const je=[Xt(+T/Re,0,1),Xt(+z/Re,0,1),Xt(+Z/Re,0,1),ce?co(+ce,Se):1];if(ns(je))return je}}return}}const w=h.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(w){const[C,E,T,R,L,z,$,q,Z]=w,Q=[T||" ",L||" ",$].join("");if("  "===Q||"  /"===Q||",,"===Q||",,,"===Q){const ne=[+E,Xt(+R,0,100),Xt(+z,0,100),q?co(+q,Z):1];if(ns(ne))return function([ce,Se,ge,ye]){function Re(je){const Ze=(je+ce/30)%12,ut=Se*Math.min(ge,1-ge);return ge-ut*Math.max(-1,Math.min(Ze-3,9-Ze,1))}return ce=iu(ce),Se/=100,ge/=100,[Re(0),Re(8),Re(4),ye]}(ne)}}}(i);return a?new Qt(...a,!1):void 0}get rgb(){const{r:i,g:a,b:h,a:m}=this,w=m||1/0;return this.overwriteGetter("rgb",[i/w,a/w,h/w,m])}get hcl(){return this.overwriteGetter("hcl",function(i){const[a,h,m,w]=la(i),C=Math.sqrt(h*h+m*m);return[Math.round(1e4*C)?iu(Math.atan2(m,h)*pl):NaN,C,a,w]}(this.rgb))}get lab(){return this.overwriteGetter("lab",la(this.rgb))}overwriteGetter(i,a){return Object.defineProperty(this,i,{value:a}),a}toString(){const[i,a,h,m]=this.rgb;return`rgba(${[i,a,h].map(w=>Math.round(255*w)).join(",")},${m})`}static interpolate(i,a,h,m="rgb"){switch(m){case"rgb":{const[w,C,E,T]=Ni(i.rgb,a.rgb,h);return new Qt(w,C,E,T,!1)}case"hcl":{const[w,C,E,T]=i.hcl,[R,L,z,$]=a.hcl;let q,Z;if(isNaN(w)||isNaN(R))isNaN(w)?isNaN(R)?q=NaN:(q=R,1!==E&&0!==E||(Z=L)):(q=w,1!==z&&0!==z||(Z=C));else{let ge=R-w;R>w&&ge>180?ge-=360:R<w&&w-R>180&&(ge+=360),q=w+h*ge}const[Q,ne,ce,Se]=function([ge,ye,Re,je]){return ge=isNaN(ge)?0:ge*ou,Jo([Re,Math.cos(ge)*ye,Math.sin(ge)*ye,je])}([q,Z??$o(C,L,h),$o(E,z,h),$o(T,$,h)]);return new Qt(Q,ne,ce,Se,!1)}case"lab":{const[w,C,E,T]=Jo(Ni(i.lab,a.lab,h));return new Qt(w,C,E,T,!1)}}}}Qt.black=new Qt(0,0,0,1),Qt.white=new Qt(1,1,1,1),Qt.transparent=new Qt(0,0,0,0),Qt.red=new Qt(1,0,0,1);class ca{constructor(i,a,h){this.sensitivity=i?a?"variant":"case":a?"accent":"base",this.locale=h,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,a){return this.collator.compare(i,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const Ra=["bottom","center","top"];class ml{constructor(i,a,h,m,w,C){this.text=i,this.image=a,this.scale=h,this.fontStack=m,this.textColor=w,this.verticalAlign=C}}class uo{constructor(i){this.sections=i}static fromString(i){return new uo([new ml(i,null,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(i=>0!==i.text.length||i.image&&0!==i.image.name.length)}static factory(i){return i instanceof uo?i:uo.fromString(i)}toString(){return 0===this.sections.length?"":this.sections.map(i=>i.text).join("")}}class Mr{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Mr)return i;if("number"==typeof i)return new Mr([i,i,i,i]);if(Array.isArray(i)&&!(i.length<1||i.length>4)){for(const a of i)if("number"!=typeof a)return;switch(i.length){case 1:i=[i[0],i[0],i[0],i[0]];break;case 2:i=[i[0],i[1],i[0],i[1]];break;case 3:i=[i[0],i[1],i[2],i[1]]}return new Mr(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,a,h){return new Mr(Ni(i.values,a.values,h))}}class ho{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof ho)return i;if("number"==typeof i)return new ho([i]);if(Array.isArray(i)){for(const a of i)if("number"!=typeof a)return;return new ho(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,a,h){return new ho(Ni(i.values,a.values,h))}}class Tr{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Tr)return i;if("string"==typeof i){const h=Qt.parse(i);return h?new Tr([h]):void 0}if(!Array.isArray(i))return;const a=[];for(const h of i){if("string"!=typeof h)return;const m=Qt.parse(h);if(!m)return;a.push(m)}return new Tr(a)}toString(){return JSON.stringify(this.values)}static interpolate(i,a,h,m="rgb"){const w=[];if(i.values.length!=a.values.length)throw new Error(`colorArray: Arrays have mismatched length (${i.values.length} vs. ${a.values.length}), cannot interpolate.`);for(let C=0;C<i.values.length;C++)w.push(Qt.interpolate(i.values[C],a.values[C],h,m));return new Tr(w)}}class Dn extends Error{constructor(i){super(i),this.name="RuntimeError"}toJSON(){return this.message}}const ad=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class Ur{constructor(i){this.values=i.slice()}static parse(i){if(i instanceof Ur)return i;if(Array.isArray(i)&&!(i.length<1)&&i.length%2==0){for(let a=0;a<i.length;a+=2){const h=i[a],m=i[a+1];if("string"!=typeof h||!ad.has(h)||!Array.isArray(m)||2!==m.length||"number"!=typeof m[0]||"number"!=typeof m[1])return}return new Ur(i)}}toString(){return JSON.stringify(this.values)}static interpolate(i,a,h){const m=i.values,w=a.values;if(m.length!==w.length)throw new Dn(`Cannot interpolate values of different length. from: ${i.toString()}, to: ${a.toString()}`);const C=[];for(let E=0;E<m.length;E+=2){if(m[E]!==w[E])throw new Dn(`Cannot interpolate values containing mismatched anchors. from[${E}]: ${m[E]}, to[${E}]: ${w[E]}`);C.push(m[E]);const[T,R]=m[E+1],[L,z]=w[E+1];C.push([$o(T,L,h),$o(R,z,h)])}return new Ur(C)}}class Jr{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new Jr({name:i,available:!1}):null}}class Nn{constructor(i,a,h){this.from=i,this.to=a,this.transition=h}static interpolate(i,a,h){return new Nn(i,a,h)}static parse(i){return i instanceof Nn?i:Array.isArray(i)&&3===i.length&&"string"==typeof i[0]&&"string"==typeof i[1]&&"number"==typeof i[2]?new Nn(i[0],i[1],i[2]):"object"==typeof i&&"string"==typeof i.from&&"string"==typeof i.to&&"number"==typeof i.transition?new Nn(i.from,i.to,i.transition):"string"==typeof i?new Nn(i,i,1):void 0}}function Ln(c,i,a,h){return"number"==typeof c&&c>=0&&c<=255&&"number"==typeof i&&i>=0&&i<=255&&"number"==typeof a&&a>=0&&a<=255?void 0===h||"number"==typeof h&&h>=0&&h<=1?null:`Invalid rgba value [${[c,i,a,h].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof h?[c,i,a,h]:[c,i,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function rs(c){if(null===c||"string"==typeof c||"boolean"==typeof c||"number"==typeof c||c instanceof Nn||c instanceof Qt||c instanceof ca||c instanceof uo||c instanceof Mr||c instanceof ho||c instanceof Tr||c instanceof Ur||c instanceof Jr)return!0;if(Array.isArray(c)){for(const i of c)if(!rs(i))return!1;return!0}if("object"==typeof c){for(const i in c)if(!rs(c[i]))return!1;return!0}return!1}function Ot(c){if(null===c)return sa;if("string"==typeof c)return Yt;if("boolean"==typeof c)return Kt;if("number"==typeof c)return at;if(c instanceof Qt)return Er;if(c instanceof Nn)return ui;if(c instanceof ca)return aa;if(c instanceof uo)return Fr;if(c instanceof Mr)return cc;if(c instanceof ho)return Aa;if(c instanceof Tr)return di;if(c instanceof Ur)return bo;if(c instanceof Jr)return Rn;if(Array.isArray(c)){const i=c.length;let a;for(const h of c){const m=Ot(h);if(a){if(a===m)continue;a=jt;break}a=m}return Po(a||jt,i)}return As}function Wt(c){const i=typeof c;return null===c?"":"string"===i||"number"===i||"boolean"===i?String(c):c instanceof Qt||c instanceof Nn||c instanceof uo||c instanceof Mr||c instanceof ho||c instanceof Tr||c instanceof Ur||c instanceof Jr?c.toString():JSON.stringify(c)}class Ho{constructor(i,a){this.type=i,this.value=a}static parse(i,a){if(2!==i.length)return a.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!rs(i[1]))return a.error("invalid value");const h=i[1];let m=Ot(h);const w=a.expectedType;return"array"!==m.kind||0!==m.N||!w||"array"!==w.kind||"number"==typeof w.N&&0!==w.N||(m=w),new Ho(m,h)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const ln={string:Yt,number:at,boolean:Kt,object:As};class wo{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");let h,m=1;const w=i[0];if("array"===w){let E,T;if(i.length>2){const R=i[1];if("string"!=typeof R||!(R in ln)||"object"===R)return a.error('The item type argument of "array" must be one of string, number, boolean',1);E=ln[R],m++}else E=jt;if(i.length>3){if(null!==i[2]&&("number"!=typeof i[2]||i[2]<0||i[2]!==Math.floor(i[2])))return a.error('The length argument to "array" must be a positive integer literal',2);T=i[2],m++}h=Po(E,T)}else{if(!ln[w])throw new Error(`Types doesn't contain name = ${w}`);h=ln[w]}const C=[];for(;m<i.length;m++){const E=a.parse(i[m],m,jt);if(!E)return null;C.push(E)}return new wo(h,C)}evaluate(i){for(let a=0;a<this.args.length;a++){const h=this.args[a].evaluate(i);if(!Pa(this.type,Ot(h)))return h;if(a===this.args.length-1)throw new Dn(`Expected value to be of type ${In(this.type)}, but found ${In(Ot(h))} instead.`)}throw new Error}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const eo={"to-boolean":Kt,"to-color":Er,"to-number":at,"to-string":Yt};class ei{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");const h=i[0];if(!eo[h])throw new Error(`Can't parse ${h} as it is not part of the known types`);if(("to-boolean"===h||"to-string"===h)&&2!==i.length)return a.error("Expected one argument.");const m=eo[h],w=[];for(let C=1;C<i.length;C++){const E=a.parse(i[C],C,jt);if(!E)return null;w.push(E)}return new ei(m,w)}evaluate(i){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(i);case"color":{let a,h;for(const m of this.args){if(a=m.evaluate(i),h=null,a instanceof Qt)return a;if("string"==typeof a){const w=i.parseColor(a);if(w)return w}else if(Array.isArray(a)&&(h=a.length<3||a.length>4?`Invalid rgba value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Ln(a[0],a[1],a[2],a[3]),!h))return new Qt(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Dn(h||`Could not parse color from value '${"string"==typeof a?a:JSON.stringify(a)}'`)}case"padding":{let a;for(const h of this.args){a=h.evaluate(i);const m=Mr.parse(a);if(m)return m}throw new Dn(`Could not parse padding from value '${"string"==typeof a?a:JSON.stringify(a)}'`)}case"numberArray":{let a;for(const h of this.args){a=h.evaluate(i);const m=ho.parse(a);if(m)return m}throw new Dn(`Could not parse numberArray from value '${"string"==typeof a?a:JSON.stringify(a)}'`)}case"colorArray":{let a;for(const h of this.args){a=h.evaluate(i);const m=Tr.parse(a);if(m)return m}throw new Dn(`Could not parse colorArray from value '${"string"==typeof a?a:JSON.stringify(a)}'`)}case"variableAnchorOffsetCollection":{let a;for(const h of this.args){a=h.evaluate(i);const m=Ur.parse(a);if(m)return m}throw new Dn(`Could not parse variableAnchorOffsetCollection from value '${"string"==typeof a?a:JSON.stringify(a)}'`)}case"number":{let a=null;for(const h of this.args){if(a=h.evaluate(i),null===a)return 0;const m=Number(a);if(!isNaN(m))return m}throw new Dn(`Could not convert ${JSON.stringify(a)} to number.`)}case"formatted":return uo.fromString(Wt(this.args[0].evaluate(i)));case"resolvedImage":return Jr.fromString(Wt(this.args[0].evaluate(i)));case"projectionDefinition":return this.args[0].evaluate(i);default:return Wt(this.args[0].evaluate(i))}}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}const ua=["Unknown","Point","LineString","Polygon"];class Rs{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache=new Map,this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ua[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(i){let a=this._parseColorCache.get(i);return a||(a=Qt.parse(i),this._parseColorCache.set(i,a)),a}}class ti{constructor(i,a,h=[],m,w=new ia,C=[]){this.registry=i,this.path=h,this.key=h.map(E=>`[${E}]`).join(""),this.scope=w,this.errors=C,this.expectedType=m,this._isConstant=a}parse(i,a,h,m,w={}){return a?this.concat(a,h,m)._parse(i,w):this._parse(i,w)}_parse(i,a){function h(m,w,C){return"assert"===C?new wo(w,[m]):"coerce"===C?new ei(w,[m]):m}if(null!==i&&"string"!=typeof i&&"boolean"!=typeof i&&"number"!=typeof i||(i=["literal",i]),Array.isArray(i)){if(0===i.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=i[0];if("string"!=typeof m)return this.error(`Expression name must be a string, but found ${typeof m} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const w=this.registry[m];if(w){let C=w.parse(i,this);if(!C)return null;if(this.expectedType){const E=this.expectedType,T=C.type;if("string"!==E.kind&&"number"!==E.kind&&"boolean"!==E.kind&&"object"!==E.kind&&"array"!==E.kind||"value"!==T.kind){if("projectionDefinition"===E.kind&&["string","array"].includes(T.kind)||["color","formatted","resolvedImage"].includes(E.kind)&&["value","string"].includes(T.kind)||["padding","numberArray"].includes(E.kind)&&["value","number","array"].includes(T.kind)||"colorArray"===E.kind&&["value","string","array"].includes(T.kind)||"variableAnchorOffsetCollection"===E.kind&&["value","array"].includes(T.kind))C=h(C,E,a.typeAnnotation||"coerce");else if(this.checkSubtype(E,T))return null}else C=h(C,E,a.typeAnnotation||"assert")}if(!(C instanceof Ho)&&"resolvedImage"!==C.type.kind&&this._isConstant(C)){const E=new Rs;try{C=new Ho(C.type,C.evaluate(E))}catch(T){return this.error(T.message),null}}return C}return this.error(`Unknown expression "${m}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===i?"'undefined' value invalid. Use null instead.":"object"==typeof i?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,a,h){const m="number"==typeof i?this.path.concat(i):this.path,w=h?this.scope.concat(h):this.scope;return new ti(this.registry,this._isConstant,m,a||null,w,this.errors)}error(i,...a){const h=`${this.key}${a.map(m=>`[${m}]`).join("")}`;this.errors.push(new ur(h,i))}checkSubtype(i,a){const h=Pa(i,a);return h&&this.error(h),h}}class da{constructor(i,a){this.type=a.type,this.bindings=[].concat(i),this.result=a}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const a of this.bindings)i(a[1]);i(this.result)}static parse(i,a){if(i.length<4)return a.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const h=[];for(let w=1;w<i.length-1;w+=2){const C=i[w];if("string"!=typeof C)return a.error(`Expected string, but found ${typeof C} instead.`,w);if(/[^a-zA-Z0-9_]/.test(C))return a.error("Variable names must contain only alphanumeric characters or '_'.",w);const E=a.parse(i[w+1],w+1);if(!E)return null;h.push([C,E])}const m=a.parse(i[i.length-1],i.length-1,a.expectedType,h);return m?new da(h,m):null}outputDefined(){return this.result.outputDefined()}}class Oa{constructor(i,a){this.type=a.type,this.name=i,this.boundExpression=a}static parse(i,a){if(2!==i.length||"string"!=typeof i[1])return a.error("'var' expression requires exactly one string literal argument.");const h=i[1];return a.scope.has(h)?new Oa(h,a.scope.get(h)):a.error(`Unknown variable "${h}". Make sure "${h}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}}class hc{constructor(i,a,h){this.type=i,this.index=a,this.input=h}static parse(i,a){if(3!==i.length)return a.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,at),m=a.parse(i[2],2,Po(a.expectedType||jt));return h&&m?new hc(m.type.itemType,h,m):null}evaluate(i){const a=this.index.evaluate(i),h=this.input.evaluate(i);if(a<0)throw new Dn(`Array index out of bounds: ${a} < 0.`);if(a>=h.length)throw new Dn(`Array index out of bounds: ${a} > ${h.length-1}.`);if(a!==Math.floor(a))throw new Dn(`Array index must be an integer, but found ${a} instead.`);return h[a]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}}class _l{constructor(i,a){this.type=Kt,this.needle=i,this.haystack=a}static parse(i,a){if(3!==i.length)return a.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,jt),m=a.parse(i[2],2,jt);return h&&m?xo(h.type,[Kt,Yt,at,sa,jt])?new _l(h,m):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${In(h.type)} instead`):null}evaluate(i){const a=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(!h)return!1;if(!ko(a,["boolean","string","number","null"]))throw new Dn(`Expected first argument to be of type boolean, string, number or null, but found ${In(Ot(a))} instead.`);if(!ko(h,["string","array"]))throw new Dn(`Expected second argument to be of type array or string, but found ${In(Ot(h))} instead.`);return h.indexOf(a)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}}class Ro{constructor(i,a,h){this.type=at,this.needle=i,this.haystack=a,this.fromIndex=h}static parse(i,a){if(i.length<=2||i.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,jt),m=a.parse(i[2],2,jt);if(!h||!m)return null;if(!xo(h.type,[Kt,Yt,at,sa,jt]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${In(h.type)} instead`);if(4===i.length){const w=a.parse(i[3],3,at);return w?new Ro(h,m,w):null}return new Ro(h,m)}evaluate(i){const a=this.needle.evaluate(i),h=this.haystack.evaluate(i);if(!ko(a,["boolean","string","number","null"]))throw new Dn(`Expected first argument to be of type boolean, string, number or null, but found ${In(Ot(a))} instead.`);let m;if(this.fromIndex&&(m=this.fromIndex.evaluate(i)),ko(h,["string"])){const w=h.indexOf(a,m);return-1===w?-1:[...h.slice(0,w)].length}if(ko(h,["array"]))return h.indexOf(a,m);throw new Dn(`Expected second argument to be of type array or string, but found ${In(Ot(h))} instead.`)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}}class dr{constructor(i,a,h,m,w,C){this.inputType=i,this.type=a,this.input=h,this.cases=m,this.outputs=w,this.otherwise=C}static parse(i,a){if(i.length<5)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return a.error("Expected an even number of arguments.");let h,m;a.expectedType&&"value"!==a.expectedType.kind&&(m=a.expectedType);const w={},C=[];for(let R=2;R<i.length-1;R+=2){let L=i[R];const z=i[R+1];Array.isArray(L)||(L=[L]);const $=a.concat(R);if(0===L.length)return $.error("Expected at least one branch label.");for(const Z of L){if("number"!=typeof Z&&"string"!=typeof Z)return $.error("Branch labels must be numbers or strings.");if("number"==typeof Z&&Math.abs(Z)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof Z&&Math.floor(Z)!==Z)return $.error("Numeric branch labels must be integer values.");if(h){if($.checkSubtype(h,Ot(Z)))return null}else h=Ot(Z);if(void 0!==w[String(Z)])return $.error("Branch labels must be unique.");w[String(Z)]=C.length}const q=a.parse(z,R,m);if(!q)return null;m=m||q.type,C.push(q)}const E=a.parse(i[1],1,jt);if(!E)return null;const T=a.parse(i[i.length-1],i.length-1,m);return T?"value"!==E.type.kind&&a.concat(1).checkSubtype(h,E.type)?null:new dr(h,m,E,w,C,T):null}evaluate(i){const a=this.input.evaluate(i);return(Ot(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}}class gi{constructor(i,a,h){this.type=i,this.branches=a,this.otherwise=h}static parse(i,a){if(i.length<4)return a.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return a.error("Expected an odd number of arguments.");let h;a.expectedType&&"value"!==a.expectedType.kind&&(h=a.expectedType);const m=[];for(let C=1;C<i.length-1;C+=2){const E=a.parse(i[C],C,Kt);if(!E)return null;const T=a.parse(i[C+1],C+1,h);if(!T)return null;m.push([E,T]),h=h||T.type}const w=a.parse(i[i.length-1],i.length-1,h);if(!w)return null;if(!h)throw new Error("Can't infer output type");return new gi(h,m,w)}evaluate(i){for(const[a,h]of this.branches)if(a.evaluate(i))return h.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[a,h]of this.branches)i(a),i(h);i(this.otherwise)}outputDefined(){return this.branches.every(([i,a])=>a.outputDefined())&&this.otherwise.outputDefined()}}class Gr{constructor(i,a,h,m){this.type=i,this.input=a,this.beginIndex=h,this.endIndex=m}static parse(i,a){if(i.length<=2||i.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const h=a.parse(i[1],1,jt),m=a.parse(i[2],2,at);if(!h||!m)return null;if(!xo(h.type,[Po(jt),Yt,jt]))return a.error(`Expected first argument to be of type array or string, but found ${In(h.type)} instead`);if(4===i.length){const w=a.parse(i[3],3,at);return w?new Gr(h.type,h,m,w):null}return new Gr(h.type,h,m)}evaluate(i){const a=this.input.evaluate(i),h=this.beginIndex.evaluate(i);let m;if(this.endIndex&&(m=this.endIndex.evaluate(i)),ko(a,["string"]))return[...a].slice(h,m).join("");if(ko(a,["array"]))return a.slice(h,m);throw new Dn(`Expected first argument to be of type array or string, but found ${In(Ot(a))} instead.`)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}}function os(c,i){const a=c.length-1;let h,m,w=0,C=a,E=0;for(;w<=C;)if(E=Math.floor((w+C)/2),h=c[E],m=c[E+1],h<=i){if(E===a||i<m)return E;w=E+1}else{if(!(h>i))throw new Dn("Input is not a number.");C=E-1}return 0}class ar{constructor(i,a,h){this.type=i,this.input=a,this.labels=[],this.outputs=[];for(const[m,w]of h)this.labels.push(m),this.outputs.push(w)}static parse(i,a){if(i.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return a.error("Expected an even number of arguments.");const h=a.parse(i[1],1,at);if(!h)return null;const m=[];let w=null;a.expectedType&&"value"!==a.expectedType.kind&&(w=a.expectedType);for(let C=1;C<i.length;C+=2){const E=1===C?-1/0:i[C],T=i[C+1],R=C,L=C+1;if("number"!=typeof E)return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(m.length&&m[m.length-1][0]>=E)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',R);const z=a.parse(T,L,w);if(!z)return null;w=w||z.type,m.push([E,z])}return new ar(w,h,m)}evaluate(i){const a=this.labels,h=this.outputs;if(1===a.length)return h[0].evaluate(i);const m=this.input.evaluate(i);if(m<=a[0])return h[0].evaluate(i);const w=a.length;return m>=a[w-1]?h[w-1].evaluate(i):h[os(a,m)].evaluate(i)}eachChild(i){i(this.input);for(const a of this.outputs)i(a)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}var $r,Os,Li=function Na(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}(function(){if(Os)return $r;function c(i,a,h,m){this.cx=3*i,this.bx=3*(h-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(m-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=a,this.p2x=h,this.p2y=m}return Os=1,$r=c,c.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,a){if(void 0===a&&(a=1e-6),i<0)return 0;if(i>1)return 1;for(var h=i,m=0;m<8;m++){var w=this.sampleCurveX(h)-i;if(Math.abs(w)<a)return h;var C=this.sampleCurveDerivativeX(h);if(Math.abs(C)<1e-6)break;h-=w/C}var E=0,T=1;for(h=i,m=0;m<20&&(w=this.sampleCurveX(h),!(Math.abs(w-i)<a));m++)i>w?E=h:T=h,h=.5*(T-E)+E;return h},solve:function(i,a){return this.sampleCurveY(this.solveCurveX(i,a))}},$r}());class vr{constructor(i,a,h,m,w){this.type=i,this.operator=a,this.interpolation=h,this.input=m,this.labels=[],this.outputs=[];for(const[C,E]of w)this.labels.push(C),this.outputs.push(E)}static interpolationFactor(i,a,h,m){let w=0;if("exponential"===i.name)w=Hr(a,i.base,h,m);else if("linear"===i.name)w=Hr(a,1,h,m);else if("cubic-bezier"===i.name){const C=i.controlPoints;w=new Li(C[0],C[1],C[2],C[3]).solve(Hr(a,1,h,m))}return w}static parse(i,a){let[h,m,w,...C]=i;if(!Array.isArray(m)||0===m.length)return a.error("Expected an interpolation type expression.",1);if("linear"===m[0])m={name:"linear"};else if("exponential"===m[0]){const R=m[1];if("number"!=typeof R)return a.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:R}}else{if("cubic-bezier"!==m[0])return a.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const R=m.slice(1);if(4!==R.length||R.some(L=>"number"!=typeof L||L<0||L>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:R}}}if(i.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(w=a.parse(w,2,at),!w)return null;const E=[];let T=null;"interpolate-hcl"!==h&&"interpolate-lab"!==h||a.expectedType==di?a.expectedType&&"value"!==a.expectedType.kind&&(T=a.expectedType):T=Er;for(let R=0;R<C.length;R+=2){const L=C[R],z=C[R+1],$=R+3,q=R+4;if("number"!=typeof L)return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(E.length&&E[E.length-1][0]>=L)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const Z=a.parse(z,q,T);if(!Z)return null;T=T||Z.type,E.push([L,Z])}return Ps(T,at)||Ps(T,ui)||Ps(T,Er)||Ps(T,cc)||Ps(T,Aa)||Ps(T,di)||Ps(T,bo)||Ps(T,Po(at))?new vr(T,h,m,w,E):a.error(`Type ${In(T)} is not interpolatable.`)}evaluate(i){const a=this.labels,h=this.outputs;if(1===a.length)return h[0].evaluate(i);const m=this.input.evaluate(i);if(m<=a[0])return h[0].evaluate(i);const w=a.length;if(m>=a[w-1])return h[w-1].evaluate(i);const C=os(a,m),E=vr.interpolationFactor(this.interpolation,m,a[C],a[C+1]),T=h[C].evaluate(i),R=h[C+1].evaluate(i);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return $o(T,R,E);case"color":return Qt.interpolate(T,R,E);case"padding":return Mr.interpolate(T,R,E);case"colorArray":return Tr.interpolate(T,R,E);case"numberArray":return ho.interpolate(T,R,E);case"variableAnchorOffsetCollection":return Ur.interpolate(T,R,E);case"array":return Ni(T,R,E);case"projectionDefinition":return Nn.interpolate(T,R,E)}case"interpolate-hcl":switch(this.type.kind){case"color":return Qt.interpolate(T,R,E,"hcl");case"colorArray":return Tr.interpolate(T,R,E,"hcl")}case"interpolate-lab":switch(this.type.kind){case"color":return Qt.interpolate(T,R,E,"lab");case"colorArray":return Tr.interpolate(T,R,E,"lab")}}}eachChild(i){i(this.input);for(const a of this.outputs)i(a)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}}function Hr(c,i,a,h){const m=h-a,w=c-a;return 0===m?0:1===i?w/m:(Math.pow(i,w)-1)/(Math.pow(i,m)-1)}const Wo={color:Qt.interpolate,number:$o,padding:Mr.interpolate,numberArray:ho.interpolate,colorArray:Tr.interpolate,variableAnchorOffsetCollection:Ur.interpolate,array:Ni};class La{constructor(i,a){this.type=i,this.args=a}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");let h=null;const m=a.expectedType;m&&"value"!==m.kind&&(h=m);const w=[];for(const E of i.slice(1)){const T=a.parse(E,1+w.length,h,void 0,{typeAnnotation:"omit"});if(!T)return null;h=h||T.type,w.push(T)}if(!h)throw new Error("No output type");const C=m&&w.some(E=>Pa(m,E.type));return new La(C?jt:h,w)}evaluate(i){let a,h=null,m=0;for(const w of this.args)if(m++,h=w.evaluate(i),h&&h instanceof Jr&&!h.available&&(a||(a=h.name),h=null,m===this.args.length&&(h=a)),null!==h)break;return h}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}}function ha(c,i){return"=="===c||"!="===c?"boolean"===i.kind||"string"===i.kind||"number"===i.kind||"null"===i.kind||"value"===i.kind:"string"===i.kind||"number"===i.kind||"value"===i.kind}function Fa(c,i,a,h){return 0===h.compare(i,a)}function to(c,i,a){const h="=="!==c&&"!="!==c;return class BD{constructor(w,C,E){this.type=Kt,this.lhs=w,this.rhs=C,this.collator=E,this.hasUntypedArgument="value"===w.type.kind||"value"===C.type.kind}static parse(w,C){if(3!==w.length&&4!==w.length)return C.error("Expected two or three arguments.");const E=w[0];let T=C.parse(w[1],1,jt);if(!T)return null;if(!ha(E,T.type))return C.concat(1).error(`"${E}" comparisons are not supported for type '${In(T.type)}'.`);let R=C.parse(w[2],2,jt);if(!R)return null;if(!ha(E,R.type))return C.concat(2).error(`"${E}" comparisons are not supported for type '${In(R.type)}'.`);if(T.type.kind!==R.type.kind&&"value"!==T.type.kind&&"value"!==R.type.kind)return C.error(`Cannot compare types '${In(T.type)}' and '${In(R.type)}'.`);h&&("value"===T.type.kind&&"value"!==R.type.kind?T=new wo(R.type,[T]):"value"!==T.type.kind&&"value"===R.type.kind&&(R=new wo(T.type,[R])));let L=null;if(4===w.length){if("string"!==T.type.kind&&"string"!==R.type.kind&&"value"!==T.type.kind&&"value"!==R.type.kind)return C.error("Cannot use collator to compare non-string types.");if(L=C.parse(w[3],3,aa),!L)return null}return new BD(T,R,L)}evaluate(w){const C=this.lhs.evaluate(w),E=this.rhs.evaluate(w);if(h&&this.hasUntypedArgument){const T=Ot(C),R=Ot(E);if(T.kind!==R.kind||"string"!==T.kind&&"number"!==T.kind)throw new Dn(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${T.kind}, ${R.kind}) instead.`)}if(this.collator&&!h&&this.hasUntypedArgument){const T=Ot(C),R=Ot(E);if("string"!==T.kind||"string"!==R.kind)return i(w,C,E)}return this.collator?a(w,C,E,this.collator.evaluate(w)):i(w,C,E)}eachChild(w){w(this.lhs),w(this.rhs),this.collator&&w(this.collator)}outputDefined(){return!0}}}const fc=to("==",function(c,i,a){return i===a},Fa),pc=to("!=",function(c,i,a){return i!==a},function(c,i,a,h){return!Fa(0,i,a,h)}),su=to("<",function(c,i,a){return i<a},function(c,i,a,h){return h.compare(i,a)<0}),gc=to(">",function(c,i,a){return i>a},function(c,i,a,h){return h.compare(i,a)>0}),cd=to("<=",function(c,i,a){return i<=a},function(c,i,a,h){return h.compare(i,a)<=0}),ud=to(">=",function(c,i,a){return i>=a},function(c,i,a,h){return h.compare(i,a)>=0});class is{constructor(i,a,h){this.type=aa,this.locale=h,this.caseSensitive=i,this.diacriticSensitive=a}static parse(i,a){if(2!==i.length)return a.error("Expected one argument.");const h=i[1];if("object"!=typeof h||Array.isArray(h))return a.error("Collator options argument must be an object.");const m=a.parse(void 0!==h["case-sensitive"]&&h["case-sensitive"],1,Kt);if(!m)return null;const w=a.parse(void 0!==h["diacritic-sensitive"]&&h["diacritic-sensitive"],1,Kt);if(!w)return null;let C=null;return h.locale&&(C=a.parse(h.locale,1,Yt),!C)?null:new is(m,w,C)}evaluate(i){return new ca(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}}class Ba{constructor(i,a,h,m,w){this.type=Yt,this.number=i,this.locale=a,this.currency=h,this.minFractionDigits=m,this.maxFractionDigits=w}static parse(i,a){if(3!==i.length)return a.error("Expected two arguments.");const h=a.parse(i[1],1,at);if(!h)return null;const m=i[2];if("object"!=typeof m||Array.isArray(m))return a.error("NumberFormat options argument must be an object.");let w=null;if(m.locale&&(w=a.parse(m.locale,1,Yt),!w))return null;let C=null;if(m.currency&&(C=a.parse(m.currency,1,Yt),!C))return null;let E=null;if(m["min-fraction-digits"]&&(E=a.parse(m["min-fraction-digits"],1,at),!E))return null;let T=null;return m["max-fraction-digits"]&&(T=a.parse(m["max-fraction-digits"],1,at),!T)?null:new Ba(h,w,C,E,T)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}}class Ns{constructor(i){this.type=Fr,this.sections=i}static parse(i,a){if(i.length<2)return a.error("Expected at least one argument.");const h=i[1];if(!Array.isArray(h)&&"object"==typeof h)return a.error("First argument must be an image or text section.");const m=[];let w=!1;for(let C=1;C<=i.length-1;++C){const E=i[C];if(w&&"object"==typeof E&&!Array.isArray(E)){w=!1;let T=null;if(E["font-scale"]&&(T=a.parse(E["font-scale"],1,at),!T))return null;let R=null;if(E["text-font"]&&(R=a.parse(E["text-font"],1,Po(Yt)),!R))return null;let L=null;if(E["text-color"]&&(L=a.parse(E["text-color"],1,Er),!L))return null;let z=null;if(E["vertical-align"]){if("string"==typeof E["vertical-align"]&&!Ra.includes(E["vertical-align"]))return a.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${E["vertical-align"]}' instead.`);if(z=a.parse(E["vertical-align"],1,Yt),!z)return null}const $=m[m.length-1];$.scale=T,$.font=R,$.textColor=L,$.verticalAlign=z}else{const T=a.parse(i[C],1,jt);if(!T)return null;const R=T.type.kind;if("string"!==R&&"value"!==R&&"null"!==R&&"resolvedImage"!==R)return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");w=!0,m.push({content:T,scale:null,font:null,textColor:null,verticalAlign:null})}}return new Ns(m)}evaluate(i){return new uo(this.sections.map(a=>{const h=a.content.evaluate(i);return Ot(h)===Rn?new ml("",h,null,null,null,a.verticalAlign?a.verticalAlign.evaluate(i):null):new ml(Wt(h),null,a.scale?a.scale.evaluate(i):null,a.font?a.font.evaluate(i).join(","):null,a.textColor?a.textColor.evaluate(i):null,a.verticalAlign?a.verticalAlign.evaluate(i):null)}))}eachChild(i){for(const a of this.sections)i(a.content),a.scale&&i(a.scale),a.font&&i(a.font),a.textColor&&i(a.textColor),a.verticalAlign&&i(a.verticalAlign)}outputDefined(){return!1}}class yl{constructor(i){this.type=Rn,this.input=i}static parse(i,a){if(2!==i.length)return a.error("Expected two arguments.");const h=a.parse(i[1],1,Yt);return h?new yl(h):a.error("No image name provided.")}evaluate(i){const a=this.input.evaluate(i),h=Jr.fromString(a);return h&&i.availableImages&&(h.available=i.availableImages.indexOf(a)>-1),h}eachChild(i){i(this.input)}outputDefined(){return!1}}class vl{constructor(i){this.type=at,this.input=i}static parse(i,a){if(2!==i.length)return a.error(`Expected 1 argument, but found ${i.length-1} instead.`);const h=a.parse(i[1],1);return h?"array"!==h.type.kind&&"string"!==h.type.kind&&"value"!==h.type.kind?a.error(`Expected argument of type string or array, but found ${In(h.type)} instead.`):new vl(h):null}evaluate(i){const a=this.input.evaluate(i);if("string"==typeof a)return[...a].length;if(Array.isArray(a))return a.length;throw new Dn(`Expected value to be of type string or array, but found ${In(Ot(a))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}}const mi=8192;function Ah(c,i){const a=(180+c[0])/360,h=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,m=Math.pow(2,i.z);return[Math.round(a*m*mi),Math.round(h*m*mi)]}function Fi(c,i){const a=Math.pow(2,i.z);return[(m=(c[0]/mi+i.x)/a,360*m-180),(h=(c[1]/mi+i.y)/a,360/Math.PI*Math.atan(Math.exp((180-360*h)*Math.PI/180))-90)];var h,m}function bl(c,i){c[0]=Math.min(c[0],i[0]),c[1]=Math.min(c[1],i[1]),c[2]=Math.max(c[2],i[0]),c[3]=Math.max(c[3],i[1])}function xl(c,i){return!(c[0]<=i[0]||c[2]>=i[2]||c[1]<=i[1]||c[3]>=i[3])}function dd(c,i,a){const h=c[0]-i[0],m=c[1]-i[1],w=c[0]-a[0],C=c[1]-a[1];return h*C-w*m==0&&h*w<=0&&m*C<=0}function mc(c,i,a,h){return(m=[h[0]-a[0],h[1]-a[1]])[0]*(w=[i[0]-c[0],i[1]-c[1]])[1]-m[1]*w[0]!=0&&!(!lu(c,i,a,h)||!lu(a,h,c,i));var m,w}function _c(c,i,a){for(const h of a)for(let m=0;m<h.length-1;++m)if(mc(c,i,h[m],h[m+1]))return!0;return!1}function Bi(c,i,a=!1){let h=!1;for(const E of i)for(let T=0;T<E.length-1;T++){if(dd(c,E[T],E[T+1]))return a;(w=E[T])[1]>(m=c)[1]!=(C=E[T+1])[1]>m[1]&&m[0]<(C[0]-w[0])*(m[1]-w[1])/(C[1]-w[1])+w[0]&&(h=!h)}var m,w,C;return h}function hd(c,i){for(const a of i)if(Bi(c,a))return!0;return!1}function au(c,i){for(const a of c)if(!Bi(a,i))return!1;for(let a=0;a<c.length-1;++a)if(_c(c[a],c[a+1],i))return!1;return!0}function Ph(c,i){for(const a of i)if(au(c,a))return!0;return!1}function lu(c,i,a,h){const m=h[0]-a[0],w=h[1]-a[1],C=(c[0]-a[0])*w-m*(c[1]-a[1]),E=(i[0]-a[0])*w-m*(i[1]-a[1]);return C>0&&E<0||C<0&&E>0}function wl(c,i,a){const h=[];for(let m=0;m<c.length;m++){const w=[];for(let C=0;C<c[m].length;C++){const E=Ah(c[m][C],a);bl(i,E),w.push(E)}h.push(w)}return h}function Cl(c,i,a){const h=[];for(let m=0;m<c.length;m++){const w=wl(c[m],i,a);h.push(w)}return h}function Oo(c,i,a,h){if(c[0]<a[0]||c[0]>a[2]){const m=.5*h;let w=c[0]-a[0]>m?-h:a[0]-c[0]>m?h:0;0===w&&(w=c[0]-a[2]>m?-h:a[2]-c[0]>m?h:0),c[0]+=w}bl(i,c)}function za(c,i,a,h){const m=Math.pow(2,h.z)*mi,w=[h.x*mi,h.y*mi],C=[];for(const E of c)for(const T of E){const R=[T.x+w[0],T.y+w[1]];Oo(R,i,a,m),C.push(R)}return C}function fd(c,i,a,h){const m=Math.pow(2,h.z)*mi,w=[h.x*mi,h.y*mi],C=[];for(const T of c){const R=[];for(const L of T){const z=[L.x+w[0],L.y+w[1]];bl(i,z),R.push(z)}C.push(R)}if(i[2]-i[0]<=m/2){(E=i)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const T of C)for(const R of T)Oo(R,i,a,m)}var E;return C}class Ls{constructor(i,a){this.type=Kt,this.geojson=i,this.geometries=a}static parse(i,a){if(2!==i.length)return a.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(rs(i[1])){const h=i[1];if("FeatureCollection"===h.type){const m=[];for(const w of h.features){const{type:C,coordinates:E}=w.geometry;"Polygon"===C&&m.push(E),"MultiPolygon"===C&&m.push(...E)}if(m.length)return new Ls(h,{type:"MultiPolygon",coordinates:m})}else if("Feature"===h.type){const m=h.geometry.type;if("Polygon"===m||"MultiPolygon"===m)return new Ls(h,h.geometry)}else if("Polygon"===h.type||"MultiPolygon"===h.type)return new Ls(h,h)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(null!=i.geometry()&&null!=i.canonicalID()){if("Point"===i.geometryType())return function(a,h){const m=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],C=a.canonicalID();if("Polygon"===h.type){const E=wl(h.coordinates,w,C),T=za(a.geometry(),m,w,C);if(!xl(m,w))return!1;for(const R of T)if(!Bi(R,E))return!1}if("MultiPolygon"===h.type){const E=Cl(h.coordinates,w,C),T=za(a.geometry(),m,w,C);if(!xl(m,w))return!1;for(const R of T)if(!hd(R,E))return!1}return!0}(i,this.geometries);if("LineString"===i.geometryType())return function(a,h){const m=[1/0,1/0,-1/0,-1/0],w=[1/0,1/0,-1/0,-1/0],C=a.canonicalID();if("Polygon"===h.type){const E=wl(h.coordinates,w,C),T=fd(a.geometry(),m,w,C);if(!xl(m,w))return!1;for(const R of T)if(!au(R,E))return!1}if("MultiPolygon"===h.type){const E=Cl(h.coordinates,w,C),T=fd(a.geometry(),m,w,C);if(!xl(m,w))return!1;for(const R of T)if(!Ph(R,E))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Fs=class{constructor(c=[],i=(a,h)=>a<h?-1:a>h?1:0){if(this.data=c,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(c){this.data.push(c),this._up(this.length++)}pop(){if(0===this.length)return;const c=this.data[0],i=this.data.pop();return--this.length>0&&(this.data[0]=i,this._down(0)),c}peek(){return this.data[0]}_up(c){const{data:i,compare:a}=this,h=i[c];for(;c>0;){const m=c-1>>1,w=i[m];if(a(h,w)>=0)break;i[c]=w,c=m}i[c]=h}_down(c){const{data:i,compare:a}=this,h=this.length>>1,m=i[c];for(;c<h;){let w=1+(c<<1);const C=w+1;if(C<this.length&&a(i[C],i[w])<0&&(w=C),a(i[w],m)>=0)break;i[c]=i[w],c=w}i[c]=m}};function pd(c,i,a=0,h=c.length-1,m=kh){for(;h>a;){if(h-a>600){const T=h-a+1,R=i-a+1,L=Math.log(T),z=.5*Math.exp(2*L/3),$=.5*Math.sqrt(L*z*(T-z)/T)*(R-T/2<0?-1:1);pd(c,i,Math.max(a,Math.floor(i-R*z/T+$)),Math.min(h,Math.floor(i+(T-R)*z/T+$)),m)}const w=c[i];let C=a,E=h;for(yc(c,a,i),m(c[h],w)>0&&yc(c,a,h);C<E;){for(yc(c,C,E),C++,E--;m(c[C],w)<0;)C++;for(;m(c[E],w)>0;)E--}0===m(c[a],w)?yc(c,a,E):(E++,yc(c,E,h)),E<=i&&(a=E+1),i<=E&&(h=E-1)}}function yc(c,i,a){const h=c[i];c[i]=c[a],c[a]=h}function kh(c,i){return c<i?-1:c>i?1:0}function fa(c,i){if(c.length<=1)return[c];const a=[];let h,m;for(const w of c){const C=Vf(w);0!==C&&(w.area=Math.abs(C),void 0===m&&(m=C<0),m===C<0?(h&&a.push(h),h=[w]):h.push(w))}if(h&&a.push(h),i>1)for(let w=0;w<a.length;w++)a[w].length<=i||(pd(a[w],i,1,a[w].length-1,gd),a[w]=a[w].slice(0,i));return a}function gd(c,i){return i.area-c.area}function Vf(c){let i=0;for(let a,h,m=0,w=c.length,C=w-1;m<w;C=m++)a=c[m],h=c[C],i+=(h.x-a.x)*(a.y+h.y);return i}const cu=1/298.257223563,Bs=cu*(2-cu),vc=Math.PI/180;class Sl{constructor(i){const a=6378.137*vc*1e3,h=Math.cos(i*vc),m=1/(1-Bs*(1-h*h)),w=Math.sqrt(m);this.kx=a*w*h,this.ky=a*w*m*(1-Bs)}distance(i,a){const h=this.wrap(i[0]-a[0])*this.kx,m=(i[1]-a[1])*this.ky;return Math.sqrt(h*h+m*m)}pointOnLine(i,a){let h,m,w,C,E=1/0;for(let T=0;T<i.length-1;T++){let R=i[T][0],L=i[T][1],z=this.wrap(i[T+1][0]-R)*this.kx,$=(i[T+1][1]-L)*this.ky,q=0;0===z&&0===$||(q=(this.wrap(a[0]-R)*this.kx*z+(a[1]-L)*this.ky*$)/(z*z+$*$),q>1?(R=i[T+1][0],L=i[T+1][1]):q>0&&(R+=z/this.kx*q,L+=$/this.ky*q)),z=this.wrap(a[0]-R)*this.kx,$=(a[1]-L)*this.ky;const Z=z*z+$*$;Z<E&&(E=Z,h=R,m=L,w=T,C=q)}return{point:[h,m],index:w,t:Math.max(0,Math.min(1,C))}}wrap(i){for(;i<-180;)i+=360;for(;i>180;)i-=360;return i}}function bc(c,i){return i[0]-c[0]}function ja(c){return c[1]-c[0]+1}function zi(c,i){return c[1]>=c[0]&&c[1]<i}function xn(c,i){if(c[0]>c[1])return[null,null];const a=ja(c);if(i){if(2===a)return[c,null];const m=Math.floor(a/2);return[[c[0],c[0]+m],[c[0]+m,c[1]]]}if(1===a)return[c,null];const h=Math.floor(a/2)-1;return[[c[0],c[0]+h],[c[0]+h+1,c[1]]]}function uu(c,i){if(!zi(i,c.length))return[1/0,1/0,-1/0,-1/0];const a=[1/0,1/0,-1/0,-1/0];for(let h=i[0];h<=i[1];++h)bl(a,c[h]);return a}function El(c){const i=[1/0,1/0,-1/0,-1/0];for(const a of c)for(const h of a)bl(i,h);return i}function du(c){return c[0]!==-1/0&&c[1]!==-1/0&&c[2]!==1/0&&c[3]!==1/0}function zs(c,i,a){if(!du(c)||!du(i))return NaN;let h=0,m=0;return c[2]<i[0]&&(h=i[0]-c[2]),c[0]>i[2]&&(h=c[0]-i[2]),c[1]>i[3]&&(m=c[1]-i[3]),c[3]<i[1]&&(m=i[1]-c[3]),a.distance([0,0],[h,m])}function pa(c,i,a){const h=a.pointOnLine(i,c);return a.distance(c,h.point)}function Va(c,i,a,h,m){const w=Math.min(pa(c,[a,h],m),pa(i,[a,h],m)),C=Math.min(pa(a,[c,i],m),pa(h,[c,i],m));return Math.min(w,C)}function hu(c,i,a,h,m){if(!zi(i,c.length)||!zi(h,a.length))return 1/0;let w=1/0;for(let C=i[0];C<i[1];++C){const E=c[C],T=c[C+1];for(let R=h[0];R<h[1];++R){const L=a[R],z=a[R+1];if(mc(E,T,L,z))return 0;w=Math.min(w,Va(E,T,L,z,m))}}return w}function Rh(c,i,a,h,m){if(!zi(i,c.length)||!zi(h,a.length))return NaN;let w=1/0;for(let C=i[0];C<=i[1];++C)for(let E=h[0];E<=h[1];++E)if(w=Math.min(w,m.distance(c[C],a[E])),0===w)return w;return w}function md(c,i,a){if(Bi(c,i,!0))return 0;let h=1/0;for(const m of i){const w=m[0],C=m[m.length-1];if(w!==C&&(h=Math.min(h,pa(c,[C,w],a)),0===h))return h;const E=a.pointOnLine(m,c);if(h=Math.min(h,a.distance(c,E.point)),0===h)return h}return h}function _d(c,i,a,h){if(!zi(i,c.length))return NaN;for(let w=i[0];w<=i[1];++w)if(Bi(c[w],a,!0))return 0;let m=1/0;for(let w=i[0];w<i[1];++w){const C=c[w],E=c[w+1];for(const T of a)for(let R=0,L=T.length,z=L-1;R<L;z=R++){const $=T[z],q=T[R];if(mc(C,E,$,q))return 0;m=Math.min(m,Va(C,E,$,q,h))}}return m}function fu(c,i){for(const a of c)for(const h of a)if(Bi(h,i,!0))return!0;return!1}function pu(c,i,a,h=1/0){const m=El(c),w=El(i);if(h!==1/0&&zs(m,w,a)>=h)return h;if(xl(m,w)){if(fu(c,i))return 0}else if(fu(i,c))return 0;let C=1/0;for(const E of c)for(let T=0,R=E.length,L=R-1;T<R;L=T++){const z=E[L],$=E[T];for(const q of i)for(let Z=0,Q=q.length,ne=Q-1;Z<Q;ne=Z++){const ce=q[ne],Se=q[Z];if(mc(z,$,ce,Se))return 0;C=Math.min(C,Va(z,$,ce,Se,a))}}return C}function xc(c,i,a,h,m,w){if(!w)return;const C=zs(uu(h,w),m,a);C<i&&c.push([C,w,[0,0]])}function Ml(c,i,a,h,m,w,C){if(!w||!C)return;const E=zs(uu(h,w),uu(m,C),a);E<i&&c.push([E,w,C])}function wc(c,i,a,h,m=1/0){let w=Math.min(h.distance(c[0],a[0][0]),m);if(0===w)return w;const C=new Fs([[0,[0,c.length-1],[0,0]]],bc),E=El(a);for(;C.length>0;){const T=C.pop();if(T[0]>=w)continue;const R=T[1],L=i?50:100;if(ja(R)<=L){if(!zi(R,c.length))return NaN;if(i){const z=_d(c,R,a,h);if(isNaN(z)||0===z)return z;w=Math.min(w,z)}else for(let z=R[0];z<=R[1];++z){const $=md(c[z],a,h);if(w=Math.min(w,$),0===w)return 0}}else{const z=xn(R,i);xc(C,w,h,c,E,z[0]),xc(C,w,h,c,E,z[1])}}return w}function Cc(c,i,a,h,m,w=1/0){let C=Math.min(w,m.distance(c[0],a[0]));if(0===C)return C;const E=new Fs([[0,[0,c.length-1],[0,a.length-1]]],bc);for(;E.length>0;){const T=E.pop();if(T[0]>=C)continue;const R=T[1],L=T[2],z=i?50:100,$=h?50:100;if(ja(R)<=z&&ja(L)<=$){if(!zi(R,c.length)&&zi(L,a.length))return NaN;let q;if(i&&h)q=hu(c,R,a,L,m),C=Math.min(C,q);else if(i&&!h){const Z=c.slice(R[0],R[1]+1);for(let Q=L[0];Q<=L[1];++Q)if(q=pa(a[Q],Z,m),C=Math.min(C,q),0===C)return C}else if(!i&&h){const Z=a.slice(L[0],L[1]+1);for(let Q=R[0];Q<=R[1];++Q)if(q=pa(c[Q],Z,m),C=Math.min(C,q),0===C)return C}else q=Rh(c,R,a,L,m),C=Math.min(C,q)}else{const q=xn(R,i),Z=xn(L,h);Ml(E,C,m,c,a,q[0],Z[0]),Ml(E,C,m,c,a,q[0],Z[1]),Ml(E,C,m,c,a,q[1],Z[0]),Ml(E,C,m,c,a,q[1],Z[1])}}return C}function yd(c){return"MultiPolygon"===c.type?c.coordinates.map(i=>({type:"Polygon",coordinates:i})):"MultiLineString"===c.type?c.coordinates.map(i=>({type:"LineString",coordinates:i})):"MultiPoint"===c.type?c.coordinates.map(i=>({type:"Point",coordinates:i})):[c]}class ga{constructor(i,a){this.type=at,this.geojson=i,this.geometries=a}static parse(i,a){if(2!==i.length)return a.error(`'distance' expression requires exactly one argument, but found ${i.length-1} instead.`);if(rs(i[1])){const h=i[1];if("FeatureCollection"===h.type)return new ga(h,h.features.map(m=>yd(m.geometry)).flat());if("Feature"===h.type)return new ga(h,yd(h.geometry));if("type"in h&&"coordinates"in h)return new ga(h,yd(h))}return a.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(null!=i.geometry()&&null!=i.canonicalID()){if("Point"===i.geometryType())return function(a,h){const m=a.geometry(),w=m.flat().map(T=>Fi([T.x,T.y],a.canonical));if(0===m.length)return NaN;const C=new Sl(w[0][1]);let E=1/0;for(const T of h){switch(T.type){case"Point":E=Math.min(E,Cc(w,!1,[T.coordinates],!1,C,E));break;case"LineString":E=Math.min(E,Cc(w,!1,T.coordinates,!0,C,E));break;case"Polygon":E=Math.min(E,wc(w,!1,T.coordinates,C,E))}if(0===E)return E}return E}(i,this.geometries);if("LineString"===i.geometryType())return function(a,h){const m=a.geometry(),w=m.flat().map(T=>Fi([T.x,T.y],a.canonical));if(0===m.length)return NaN;const C=new Sl(w[0][1]);let E=1/0;for(const T of h){switch(T.type){case"Point":E=Math.min(E,Cc(w,!0,[T.coordinates],!1,C,E));break;case"LineString":E=Math.min(E,Cc(w,!0,T.coordinates,!0,C,E));break;case"Polygon":E=Math.min(E,wc(w,!0,T.coordinates,C,E))}if(0===E)return E}return E}(i,this.geometries);if("Polygon"===i.geometryType())return function(a,h){const m=a.geometry();if(0===m.length||0===m[0].length)return NaN;const w=fa(m,0).map(T=>T.map(R=>R.map(L=>Fi([L.x,L.y],a.canonical)))),C=new Sl(w[0][0][0][1]);let E=1/0;for(const T of h)for(const R of w){switch(T.type){case"Point":E=Math.min(E,wc([T.coordinates],!1,R,C,E));break;case"LineString":E=Math.min(E,wc(T.coordinates,!0,R,C,E));break;case"Polygon":E=Math.min(E,pu(R,T.coordinates,C,E))}if(0===E)return E}return E}(i,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}class Tl{constructor(i){this.type=jt,this.key=i}static parse(i,a){if(2!==i.length)return a.error(`Expected 1 argument, but found ${i.length-1} instead.`);const h=i[1];return null==h?a.error("Global state property must be defined."):"string"!=typeof h?a.error(`Global state property must be string, but found ${typeof i[1]} instead.`):new Tl(h)}evaluate(i){var a;const h=null===(a=i.globals)||void 0===a?void 0:a.globalState;return h&&0!==Object.keys(h).length?ks(h,this.key):null}eachChild(){}outputDefined(){return!1}}const Ua={"==":fc,"!=":pc,">":gc,"<":su,">=":ud,"<=":cd,array:wo,at:hc,boolean:wo,case:gi,coalesce:La,collator:is,format:Ns,image:yl,in:_l,"index-of":Ro,interpolate:vr,"interpolate-hcl":vr,"interpolate-lab":vr,length:vl,let:da,literal:Ho,match:dr,number:wo,"number-format":Ba,object:wo,slice:Gr,step:ar,string:wo,"to-boolean":ei,"to-color":ei,"to-number":ei,"to-string":ei,var:Oa,within:Ls,distance:ga,"global-state":Tl};class _i{constructor(i,a,h,m){this.name=i,this.type=a,this._evaluate=h,this.args=m}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}static parse(i,a){const h=i[0],m=_i.definitions[h];if(!m)return a.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0);const w=Array.isArray(m)?m[0]:m.type,C=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,E=C.filter(([R])=>!Array.isArray(R)||R.length===i.length-1);let T=null;for(const[R,L]of E){T=new ti(a.registry,ma,a.path,null,a.scope);const z=[];let $=!1;for(let q=1;q<i.length;q++){const Z=i[q],Q=Array.isArray(R)?R[q-1]:R.type,ne=T.parse(Z,1+z.length,Q);if(!ne){$=!0;break}z.push(ne)}if(!$)if(Array.isArray(R)&&R.length!==z.length)T.error(`Expected ${R.length} arguments, but found ${z.length} instead.`);else{for(let q=0;q<z.length;q++){const Z=Array.isArray(R)?R[q]:R.type,Q=z[q];T.concat(q+1).checkSubtype(Z,Q.type)}if(0===T.errors.length)return new _i(h,w,L,z)}}if(1===E.length)a.errors.push(...T.errors);else{const R=(E.length?E:C).map(([z])=>{return $=z,Array.isArray($)?`(${$.map(In).join(", ")})`:`(${In($.type)}...)`;var $}).join(" | "),L=[];for(let z=1;z<i.length;z++){const $=a.parse(i[z],1+L.length);if(!$)return null;L.push(In($.type))}a.error(`Expected arguments of type ${R}, but found (${L.join(", ")}) instead.`)}return null}static register(i,a){_i.definitions=a;for(const h in a)i[h]=_i}}function Il(c,[i,a,h,m]){i=i.evaluate(c),a=a.evaluate(c),h=h.evaluate(c);const w=m?m.evaluate(c):1,C=Ln(i,a,h,w);if(C)throw new Dn(C);return new Qt(i/255,a/255,h/255,w,!1)}function Ga(c,i){return c in i}function Dl(c,i){const a=i[c];return void 0===a?null:a}function ni(c){return{type:c}}function ma(c){if(c instanceof Oa)return ma(c.boundExpression);if(c instanceof _i&&"error"===c.name||c instanceof is||c instanceof Ls||c instanceof ga||c instanceof Tl)return!1;const i=c instanceof ei||c instanceof wo;let a=!0;return c.eachChild(h=>{a=i?a&&ma(h):a&&h instanceof Ho}),!!a&&_a(c)&&ya(c,["zoom","heatmap-density","elevation","line-progress","accumulated","is-supported-script"])}function _a(c){if(c instanceof _i&&("get"===c.name&&1===c.args.length||"feature-state"===c.name||"has"===c.name&&1===c.args.length||"properties"===c.name||"geometry-type"===c.name||"id"===c.name||/^filter-/.test(c.name))||c instanceof Ls||c instanceof ga)return!1;let i=!0;return c.eachChild(a=>{i&&!_a(a)&&(i=!1)}),i}function yi(c){if(c instanceof _i&&"feature-state"===c.name)return!1;let i=!0;return c.eachChild(a=>{i&&!yi(a)&&(i=!1)}),i}function ya(c,i){if(c instanceof _i&&i.indexOf(c.name)>=0)return!1;let a=!0;return c.eachChild(h=>{a&&!ya(h,i)&&(a=!1)}),a}function Sc(c){return{result:"success",value:c}}function ss(c){return{result:"error",value:c}}function ji(c){return"data-driven"===c["property-type"]||"cross-faded-data-driven"===c["property-type"]}function gu(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Al(c){return!!c.expression&&c.expression.interpolated}function en(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":null===c?"null":typeof c}function Pl(c){return"object"==typeof c&&null!==c&&!Array.isArray(c)&&Ot(c)===As}function Uf(c){return c}function qt(c,i){const a=c.stops&&"object"==typeof c.stops[0][0],h=a||!(a||void 0!==c.property),m=c.type||(Al(i)?"exponential":"interval"),w=function(L){switch(L.type){case"color":return Qt.parse;case"padding":return Mr.parse;case"numberArray":return ho.parse;case"colorArray":return Tr.parse;default:return null}}(i);if(w&&((c=Qr({},c)).stops&&(c.stops=c.stops.map(L=>[L[0],w(L[1])])),c.default=w(c.default?c.default:i.default)),c.colorSpace&&"rgb"!==(C=c.colorSpace)&&"hcl"!==C&&"lab"!==C)throw new Error(`Unknown color space: "${c.colorSpace}"`);var C;const E=function(L){switch(L){case"exponential":return Oh;case"interval":return vd;case"categorical":return Ec;case"identity":return mu;default:throw new Error(`Unknown function type "${L}"`)}}(m);let T,R;if("categorical"===m){T=Object.create(null);for(const L of c.stops)T[L[0]]=L[1];R=typeof c.stops[0][0]}if(a){const L={},z=[];for(let Z=0;Z<c.stops.length;Z++){const Q=c.stops[Z],ne=Q[0].zoom;void 0===L[ne]&&(L[ne]={zoom:ne,type:c.type,property:c.property,default:c.default,stops:[]},z.push(ne)),L[ne].stops.push([Q[0].value,Q[1]])}const $=[];for(const Z of z)$.push([L[Z].zoom,qt(L[Z],i)]);const q={name:"linear"};return{kind:"composite",interpolationType:q,interpolationFactor:vr.interpolationFactor.bind(void 0,q),zoomStops:$.map(Z=>Z[0]),evaluate:({zoom:Z},Q)=>Oh({stops:$,base:c.base},i,Z).evaluate(Z,Q)}}if(h){const L="exponential"===m?{name:"exponential",base:void 0!==c.base?c.base:1}:null;return{kind:"camera",interpolationType:L,interpolationFactor:vr.interpolationFactor.bind(void 0,L),zoomStops:c.stops.map(z=>z[0]),evaluate:({zoom:z})=>E(c,i,z,T,R)}}return{kind:"source",evaluate(L,z){const $=z&&z.properties?z.properties[c.property]:void 0;return void 0===$?Vi(c.default,i.default):E(c,i,$,T,R)}}}function Vi(c,i,a){return void 0!==c?c:void 0!==i?i:void 0!==a?a:void 0}function Ec(c,i,a,h,m){return Vi(typeof a===m?h[a]:void 0,c.default,i.default)}function vd(c,i,a){if("number"!==en(a))return Vi(c.default,i.default);const h=c.stops.length;if(1===h||a<=c.stops[0][0])return c.stops[0][1];if(a>=c.stops[h-1][0])return c.stops[h-1][1];const m=os(c.stops.map(w=>w[0]),a);return c.stops[m][1]}function Oh(c,i,a){const h=void 0!==c.base?c.base:1;if("number"!==en(a))return Vi(c.default,i.default);const m=c.stops.length;if(1===m||a<=c.stops[0][0])return c.stops[0][1];if(a>=c.stops[m-1][0])return c.stops[m-1][1];const w=os(c.stops.map(L=>L[0]),a),C=function(L,z,$,q){const Z=q-$,Q=L-$;return 0===Z?0:1===z?Q/Z:(Math.pow(z,Q)-1)/(Math.pow(z,Z)-1)}(a,h,c.stops[w][0],c.stops[w+1][0]),E=c.stops[w][1],T=c.stops[w+1][1],R=Wo[i.type]||Uf;return"function"==typeof E.evaluate?{evaluate(...L){const z=E.evaluate.apply(void 0,L),$=T.evaluate.apply(void 0,L);if(void 0!==z&&void 0!==$)return R(z,$,C,c.colorSpace)}}:R(E,T,C,c.colorSpace)}function mu(c,i,a){switch(i.type){case"color":a=Qt.parse(a);break;case"formatted":a=uo.fromString(a.toString());break;case"resolvedImage":a=Jr.fromString(a.toString());break;case"padding":a=Mr.parse(a);break;case"colorArray":a=Tr.parse(a);break;case"numberArray":a=ho.parse(a);break;default:en(a)===i.type||"enum"===i.type&&i.values[a]||(a=void 0)}return Vi(a,c.default,i.default)}_i.register(Ua,{error:[{kind:"error"},[Yt],(c,[i])=>{throw new Dn(i.evaluate(c))}],typeof:[Yt,[jt],(c,[i])=>In(Ot(i.evaluate(c)))],"to-rgba":[Po(at,4),[Er],(c,[i])=>{const[a,h,m,w]=i.evaluate(c).rgb;return[255*a,255*h,255*m,w]}],rgb:[Er,[at,at,at],Il],rgba:[Er,[at,at,at,at],Il],has:{type:Kt,overloads:[[[Yt],(c,[i])=>Ga(i.evaluate(c),c.properties())],[[Yt,As],(c,[i,a])=>Ga(i.evaluate(c),a.evaluate(c))]]},get:{type:jt,overloads:[[[Yt],(c,[i])=>Dl(i.evaluate(c),c.properties())],[[Yt,As],(c,[i,a])=>Dl(i.evaluate(c),a.evaluate(c))]]},"feature-state":[jt,[Yt],(c,[i])=>Dl(i.evaluate(c),c.featureState||{})],properties:[As,[],c=>c.properties()],"geometry-type":[Yt,[],c=>c.geometryType()],id:[jt,[],c=>c.id()],zoom:[at,[],c=>c.globals.zoom],"heatmap-density":[at,[],c=>c.globals.heatmapDensity||0],elevation:[at,[],c=>c.globals.elevation||0],"line-progress":[at,[],c=>c.globals.lineProgress||0],accumulated:[jt,[],c=>void 0===c.globals.accumulated?null:c.globals.accumulated],"+":[at,ni(at),(c,i)=>{let a=0;for(const h of i)a+=h.evaluate(c);return a}],"*":[at,ni(at),(c,i)=>{let a=1;for(const h of i)a*=h.evaluate(c);return a}],"-":{type:at,overloads:[[[at,at],(c,[i,a])=>i.evaluate(c)-a.evaluate(c)],[[at],(c,[i])=>-i.evaluate(c)]]},"/":[at,[at,at],(c,[i,a])=>i.evaluate(c)/a.evaluate(c)],"%":[at,[at,at],(c,[i,a])=>i.evaluate(c)%a.evaluate(c)],ln2:[at,[],()=>Math.LN2],pi:[at,[],()=>Math.PI],e:[at,[],()=>Math.E],"^":[at,[at,at],(c,[i,a])=>Math.pow(i.evaluate(c),a.evaluate(c))],sqrt:[at,[at],(c,[i])=>Math.sqrt(i.evaluate(c))],log10:[at,[at],(c,[i])=>Math.log(i.evaluate(c))/Math.LN10],ln:[at,[at],(c,[i])=>Math.log(i.evaluate(c))],log2:[at,[at],(c,[i])=>Math.log(i.evaluate(c))/Math.LN2],sin:[at,[at],(c,[i])=>Math.sin(i.evaluate(c))],cos:[at,[at],(c,[i])=>Math.cos(i.evaluate(c))],tan:[at,[at],(c,[i])=>Math.tan(i.evaluate(c))],asin:[at,[at],(c,[i])=>Math.asin(i.evaluate(c))],acos:[at,[at],(c,[i])=>Math.acos(i.evaluate(c))],atan:[at,[at],(c,[i])=>Math.atan(i.evaluate(c))],min:[at,ni(at),(c,i)=>Math.min(...i.map(a=>a.evaluate(c)))],max:[at,ni(at),(c,i)=>Math.max(...i.map(a=>a.evaluate(c)))],abs:[at,[at],(c,[i])=>Math.abs(i.evaluate(c))],round:[at,[at],(c,[i])=>{const a=i.evaluate(c);return a<0?-Math.round(-a):Math.round(a)}],floor:[at,[at],(c,[i])=>Math.floor(i.evaluate(c))],ceil:[at,[at],(c,[i])=>Math.ceil(i.evaluate(c))],"filter-==":[Kt,[Yt,jt],(c,[i,a])=>c.properties()[i.value]===a.value],"filter-id-==":[Kt,[jt],(c,[i])=>c.id()===i.value],"filter-type-==":[Kt,[Yt],(c,[i])=>c.geometryType()===i.value],"filter-<":[Kt,[Yt,jt],(c,[i,a])=>{const h=c.properties()[i.value],m=a.value;return typeof h==typeof m&&h<m}],"filter-id-<":[Kt,[jt],(c,[i])=>{const a=c.id(),h=i.value;return typeof a==typeof h&&a<h}],"filter->":[Kt,[Yt,jt],(c,[i,a])=>{const h=c.properties()[i.value],m=a.value;return typeof h==typeof m&&h>m}],"filter-id->":[Kt,[jt],(c,[i])=>{const a=c.id(),h=i.value;return typeof a==typeof h&&a>h}],"filter-<=":[Kt,[Yt,jt],(c,[i,a])=>{const h=c.properties()[i.value],m=a.value;return typeof h==typeof m&&h<=m}],"filter-id-<=":[Kt,[jt],(c,[i])=>{const a=c.id(),h=i.value;return typeof a==typeof h&&a<=h}],"filter->=":[Kt,[Yt,jt],(c,[i,a])=>{const h=c.properties()[i.value],m=a.value;return typeof h==typeof m&&h>=m}],"filter-id->=":[Kt,[jt],(c,[i])=>{const a=c.id(),h=i.value;return typeof a==typeof h&&a>=h}],"filter-has":[Kt,[jt],(c,[i])=>i.value in c.properties()],"filter-has-id":[Kt,[],c=>null!==c.id()&&void 0!==c.id()],"filter-type-in":[Kt,[Po(Yt)],(c,[i])=>i.value.indexOf(c.geometryType())>=0],"filter-id-in":[Kt,[Po(jt)],(c,[i])=>i.value.indexOf(c.id())>=0],"filter-in-small":[Kt,[Yt,Po(jt)],(c,[i,a])=>a.value.indexOf(c.properties()[i.value])>=0],"filter-in-large":[Kt,[Yt,Po(jt)],(c,[i,a])=>function(h,m,w,C){for(;w<=C;){const E=w+C>>1;if(m[E]===h)return!0;m[E]>h?C=E-1:w=E+1}return!1}(c.properties()[i.value],a.value,0,a.value.length-1)],all:{type:Kt,overloads:[[[Kt,Kt],(c,[i,a])=>i.evaluate(c)&&a.evaluate(c)],[ni(Kt),(c,i)=>{for(const a of i)if(!a.evaluate(c))return!1;return!0}]]},any:{type:Kt,overloads:[[[Kt,Kt],(c,[i,a])=>i.evaluate(c)||a.evaluate(c)],[ni(Kt),(c,i)=>{for(const a of i)if(a.evaluate(c))return!0;return!1}]]},"!":[Kt,[Kt],(c,[i])=>!i.evaluate(c)],"is-supported-script":[Kt,[Yt],(c,[i])=>{const a=c.globals&&c.globals.isSupportedScript;return!a||a(i.evaluate(c))}],upcase:[Yt,[Yt],(c,[i])=>i.evaluate(c).toUpperCase()],downcase:[Yt,[Yt],(c,[i])=>i.evaluate(c).toLowerCase()],concat:[Yt,ni(jt),(c,i)=>i.map(a=>Wt(a.evaluate(c))).join("")],"resolved-locale":[Yt,[aa],(c,[i])=>i.evaluate(c).resolvedLocale()]});class bd{constructor(i,a){this.expression=i,this._warningHistory={},this._evaluator=new Rs,this._defaultValue=a?function(h){if("color"===h.type&&Pl(h.default))return new Qt(0,0,0,0);switch(h.type){case"color":return Qt.parse(h.default)||null;case"padding":return Mr.parse(h.default)||null;case"numberArray":return ho.parse(h.default)||null;case"colorArray":return Tr.parse(h.default)||null;case"variableAnchorOffsetCollection":return Ur.parse(h.default)||null;case"projectionDefinition":return Nn.parse(h.default)||null;default:return void 0===h.default?null:h.default}}(a):null,this._enumValues=a&&"enum"===a.type?a.values:null}evaluateWithoutErrorHandling(i,a,h,m,w,C){return this._evaluator.globals=i,this._evaluator.feature=a,this._evaluator.featureState=h,this._evaluator.canonical=m,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=C,this.expression.evaluate(this._evaluator)}evaluate(i,a,h,m,w,C){this._evaluator.globals=i,this._evaluator.feature=a||null,this._evaluator.featureState=h||null,this._evaluator.canonical=m,this._evaluator.availableImages=w||null,this._evaluator.formattedSection=C||null;try{const E=this.expression.evaluate(this._evaluator);if(null==E||"number"==typeof E&&E!=E)return this._defaultValue;if(this._enumValues&&!(E in this._enumValues))throw new Dn(`Expected value to be one of ${Object.keys(this._enumValues).map(T=>JSON.stringify(T)).join(", ")}, but found ${JSON.stringify(E)} instead.`);return E}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console<"u"&&console.warn(E.message)),this._defaultValue}}}function kl(c){return Array.isArray(c)&&c.length>0&&"string"==typeof c[0]&&c[0]in Ua}function $a(c,i){const a=new ti(Ua,ma,[],i?function(m){const w={color:Er,string:Yt,number:at,enum:Yt,boolean:Kt,formatted:Fr,padding:cc,numberArray:Aa,colorArray:di,projectionDefinition:ui,resolvedImage:Rn,variableAnchorOffsetCollection:bo};return"array"===m.type?Po(w[m.value]||jt,m.length):w[m.type]}(i):void 0),h=a.parse(c,void 0,void 0,void 0,i&&"string"===i.type?{typeAnnotation:"coerce"}:void 0);return h?Sc(new bd(h,i)):ss(a.errors)}class Rl{constructor(i,a){this.kind=i,this._styleExpression=a,this.isStateDependent="constant"!==i&&!yi(a.expression),this.globalStateRefs=va(a.expression)}evaluateWithoutErrorHandling(i,a,h,m,w,C){return this._styleExpression.evaluateWithoutErrorHandling(i,a,h,m,w,C)}evaluate(i,a,h,m,w,C){return this._styleExpression.evaluate(i,a,h,m,w,C)}}class xd{constructor(i,a,h,m){this.kind=i,this.zoomStops=h,this._styleExpression=a,this.isStateDependent="camera"!==i&&!yi(a.expression),this.globalStateRefs=va(a.expression),this.interpolationType=m}evaluateWithoutErrorHandling(i,a,h,m,w,C){return this._styleExpression.evaluateWithoutErrorHandling(i,a,h,m,w,C)}evaluate(i,a,h,m,w,C){return this._styleExpression.evaluate(i,a,h,m,w,C)}interpolationFactor(i,a,h){return this.interpolationType?vr.interpolationFactor(this.interpolationType,i,a,h):0}}function js(c,i){const a=$a(c,i);if("error"===a.result)return a;const h=a.value.expression,m=_a(h);if(!m&&!ji(i))return ss([new ur("","data expressions not supported")]);const w=ya(h,["zoom"]);if(!w&&!gu(i))return ss([new ur("","zoom expressions not supported")]);const C=Vs(h);return C||w?C instanceof ur?ss([C]):C instanceof vr&&!Al(i)?ss([new ur("",'"interpolate" expressions cannot be used with this property')]):Sc(C?new xd(m?"camera":"composite",a.value,C.labels,C instanceof vr?C.interpolation:void 0):new Rl(m?"constant":"source",a.value)):ss([new ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Mc{constructor(i,a){this._parameters=i,this._specification=a,Qr(this,qt(this._parameters,this._specification))}static deserialize(i){return new Mc(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function Vs(c){let i=null;if(c instanceof da)i=Vs(c.result);else if(c instanceof La){for(const a of c.args)if(i=Vs(a),i)break}else(c instanceof ar||c instanceof vr)&&c.input instanceof _i&&"zoom"===c.input.name&&(i=c);return i instanceof ur||c.eachChild(a=>{const h=Vs(a);h instanceof ur?i=h:!i&&h?i=new ur("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&h&&i!==h&&(i=new ur("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}function va(c,i=new Set){return c instanceof Tl&&i.add(c.key),c.eachChild(a=>{va(a,i)}),i}function Tc(c){if(!0===c||!1===c)return!0;if(!Array.isArray(c)||0===c.length)return!1;switch(c[0]){case"has":return c.length>=2&&"$id"!==c[1]&&"$type"!==c[1];case"in":return c.length>=3&&("string"!=typeof c[1]||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==c.length||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const i of c.slice(1))if(!Tc(i)&&"boolean"!=typeof i)return!1;return!0;default:return!0}}const Ic={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Ui(c){if(null==c)return{filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set};Tc(c)||(c=xa(c));const i=$a(c,Ic);if("error"===i.result)throw new Error(i.value.map(a=>`${a.key}: ${a.message}`).join(", "));return{filter:(a,h,m)=>i.value.evaluate(a,h,{},m),needGeometry:ba(c),getGlobalStateRefs:()=>va(i.value.expression)}}function Dc(c,i){return c<i?-1:c>i?1:0}function ba(c){if(!Array.isArray(c))return!1;if("within"===c[0]||"distance"===c[0])return!0;for(let i=1;i<c.length;i++)if(ba(c[i]))return!0;return!1}function xa(c){if(!c)return!0;const i=c[0];return c.length<=1?"any"!==i:"=="===i?Ac(c[1],c[2],"=="):"!="===i?Ol(Ac(c[1],c[2],"==")):"<"===i||">"===i||"<="===i||">="===i?Ac(c[1],c[2],i):"any"===i?(a=c.slice(1),["any"].concat(a.map(xa))):"all"===i?["all"].concat(c.slice(1).map(xa)):"none"===i?["all"].concat(c.slice(1).map(xa).map(Ol)):"in"===i?wd(c[1],c.slice(2)):"!in"===i?Ol(wd(c[1],c.slice(2))):"has"===i?Nh(c[1]):"!has"!==i||Ol(Nh(c[1]));var a}function Ac(c,i,a){switch(c){case"$type":return[`filter-type-${a}`,i];case"$id":return[`filter-id-${a}`,i];default:return[`filter-${a}`,c,i]}}function wd(c,i){if(0===i.length)return!1;switch(c){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(a=>typeof a!=typeof i[0])?["filter-in-large",c,["literal",i.sort(Dc)]]:["filter-in-small",c,["literal",i]]}}function Nh(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Ol(c){return["!",c]}function _u(c){const i=typeof c;if("number"===i||"boolean"===i||"string"===i||null==c)return JSON.stringify(c);if(Array.isArray(c)){let m="[";for(const w of c)m+=`${_u(w)},`;return`${m}]`}const a=Object.keys(c).sort();let h="{";for(let m=0;m<a.length;m++)h+=`${JSON.stringify(a[m])}:${_u(c[a[m]])},`;return`${h}}`}function Lh(c){let i="";for(const a of Ft)i+=`/${_u(c[a])}`;return i}function yu(c){const i=c.value;return i?[new Ke(c.key,i,"constants have been deprecated as of v8")]:[]}function Fn(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function vi(c){if(Array.isArray(c))return c.map(vi);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const i={};for(const a in c)i[a]=vi(c[a]);return i}return Fn(c)}function No(c){const i=c.key,a=c.value,h=c.valueSpec||{},m=c.objectElementValidators||{},w=c.style,C=c.styleSpec,E=c.validateSpec;let T=[];const R=en(a);if("object"!==R)return[new Ke(i,a,`object expected, ${R} found`)];for(const L in a){const z=L.split(".")[0],$=ks(h,z)||h["*"];let q;if(ks(m,z))q=m[z];else if(ks(h,z))q=E;else if(m["*"])q=m["*"];else{if(!h["*"]){T.push(new Ke(i,a[L],`unknown property "${L}"`));continue}q=E}T=T.concat(q({key:(i&&`${i}.`)+L,value:a[L],valueSpec:$,style:w,styleSpec:C,object:a,objectKey:L,validateSpec:E},a))}for(const L in h)m[L]||h[L].required&&void 0===h[L].default&&void 0===a[L]&&T.push(new Ke(i,a,`missing required property "${L}"`));return T}function Pc(c){const i=c.value,a=c.valueSpec,h=c.style,m=c.styleSpec,w=c.key,C=c.arrayElementValidator||c.validateSpec;if("array"!==en(i))return[new Ke(w,i,`array expected, ${en(i)} found`)];if(a.length&&i.length!==a.length)return[new Ke(w,i,`array length ${a.length} expected, length ${i.length} found`)];if(a["min-length"]&&i.length<a["min-length"])return[new Ke(w,i,`array length at least ${a["min-length"]} expected, length ${i.length} found`)];let E={type:a.value,values:a.values};m.$version<7&&(E.function=a.function),"object"===en(a.value)&&(E=a.value);let T=[];for(let R=0;R<i.length;R++)T=T.concat(C({array:i,arrayIndex:R,value:i[R],valueSpec:E,validateSpec:c.validateSpec,style:h,styleSpec:m,key:`${w}[${R}]`}));return T}function kc(c){const i=c.key,a=c.value,h=c.valueSpec;let m=en(a);return"number"===m&&a!=a&&(m="NaN"),"number"!==m?[new Ke(i,a,`number expected, ${m} found`)]:"minimum"in h&&a<h.minimum?[new Ke(i,a,`${a} is less than the minimum value ${h.minimum}`)]:"maximum"in h&&a>h.maximum?[new Ke(i,a,`${a} is greater than the maximum value ${h.maximum}`)]:[]}function Fh(c){const i=c.valueSpec,a=Fn(c.value.type);let h,m,w,C={};const E="categorical"!==a&&void 0===c.value.property,T=!E,R="array"===en(c.value.stops)&&"array"===en(c.value.stops[0])&&"object"===en(c.value.stops[0][0]),L=No({key:c.key,value:c.value,valueSpec:c.styleSpec.function,validateSpec:c.validateSpec,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(q){if("identity"===a)return[new Ke(q.key,q.value,'identity function may not have a "stops" property')];let Z=[];const Q=q.value;return Z=Z.concat(Pc({key:q.key,value:Q,valueSpec:q.valueSpec,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:z})),"array"===en(Q)&&0===Q.length&&Z.push(new Ke(q.key,Q,"array must have at least one stop")),Z},default:function(q){return q.validateSpec({key:q.key,value:q.value,valueSpec:i,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec})}}});return"identity"===a&&E&&L.push(new Ke(c.key,c.value,'missing required property "property"')),"identity"===a||c.value.stops||L.push(new Ke(c.key,c.value,'missing required property "stops"')),"exponential"===a&&c.valueSpec.expression&&!Al(c.valueSpec)&&L.push(new Ke(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(T&&!ji(c.valueSpec)?L.push(new Ke(c.key,c.value,"property functions not supported")):E&&!gu(c.valueSpec)&&L.push(new Ke(c.key,c.value,"zoom functions not supported"))),"categorical"!==a&&!R||void 0!==c.value.property||L.push(new Ke(c.key,c.value,'"property" property is required')),L;function z(q){let Z=[];const Q=q.value,ne=q.key;if("array"!==en(Q))return[new Ke(ne,Q,`array expected, ${en(Q)} found`)];if(2!==Q.length)return[new Ke(ne,Q,`array length 2 expected, length ${Q.length} found`)];if(R){if("object"!==en(Q[0]))return[new Ke(ne,Q,`object expected, ${en(Q[0])} found`)];if(void 0===Q[0].zoom)return[new Ke(ne,Q,"object stop key must have zoom")];if(void 0===Q[0].value)return[new Ke(ne,Q,"object stop key must have value")];if(w&&w>Fn(Q[0].zoom))return[new Ke(ne,Q[0].zoom,"stop zoom values must appear in ascending order")];Fn(Q[0].zoom)!==w&&(w=Fn(Q[0].zoom),m=void 0,C={}),Z=Z.concat(No({key:`${ne}[0]`,value:Q[0],valueSpec:{zoom:{}},validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:kc,value:$}}))}else Z=Z.concat($({key:`${ne}[0]`,value:Q[0],validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec},Q));return kl(vi(Q[1]))?Z.concat([new Ke(`${ne}[1]`,Q[1],"expressions are not allowed in function stops.")]):Z.concat(q.validateSpec({key:`${ne}[1]`,value:Q[1],valueSpec:i,validateSpec:q.validateSpec,style:q.style,styleSpec:q.styleSpec}))}function $(q,Z){const Q=en(q.value),ne=Fn(q.value),ce=null!==q.value?q.value:Z;if(h){if(Q!==h)return[new Ke(q.key,ce,`${Q} stop domain type must match previous stop domain type ${h}`)]}else h=Q;if("number"!==Q&&"string"!==Q&&"boolean"!==Q)return[new Ke(q.key,ce,"stop domain value must be a number, string, or boolean")];if("number"!==Q&&"categorical"!==a){let Se=`number expected, ${Q} found`;return ji(i)&&void 0===a&&(Se+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ke(q.key,ce,Se)]}return"categorical"!==a||"number"!==Q||isFinite(ne)&&Math.floor(ne)===ne?"categorical"!==a&&"number"===Q&&void 0!==m&&ne<m?[new Ke(q.key,ce,"stop domain values must appear in ascending order")]:(m=ne,"categorical"===a&&ne in C?[new Ke(q.key,ce,"stop domain values must be unique")]:(C[ne]=!0,[])):[new Ke(q.key,ce,`integer expected, found ${ne}`)]}}function Ha(c){const i=("property"===c.expressionContext?js:$a)(vi(c.value),c.valueSpec);if("error"===i.result)return i.value.map(h=>new Ke(`${c.key}${h.key}`,c.value,h.message));const a=i.value.expression||i.value._styleExpression.expression;if("property"===c.expressionContext&&"text-font"===c.propertyKey&&!a.outputDefined())return[new Ke(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===c.expressionContext&&"layout"===c.propertyType&&!yi(a))return[new Ke(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===c.expressionContext&&!yi(a))return[new Ke(c.key,c.value,'"feature-state" data expressions are not supported with filters.')];if(c.expressionContext&&0===c.expressionContext.indexOf("cluster")){if(!ya(a,["zoom","feature-state"]))return[new Ke(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===c.expressionContext&&!_a(a))return[new Ke(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Us(c){const i=c.key,a=c.value,h=en(a);return"string"!==h?[new Ke(i,a,`color expected, ${h} found`)]:Qt.parse(String(a))?[]:[new Ke(i,a,`color expected, "${a}" found`)]}function as(c){const i=c.key,a=c.value,h=c.valueSpec,m=[];return Array.isArray(h.values)?-1===h.values.indexOf(Fn(a))&&m.push(new Ke(i,a,`expected one of [${h.values.join(", ")}], ${JSON.stringify(a)} found`)):-1===Object.keys(h.values).indexOf(Fn(a))&&m.push(new Ke(i,a,`expected one of [${Object.keys(h.values).join(", ")}], ${JSON.stringify(a)} found`)),m}function Wa(c){return Tc(vi(c.value))?Ha(Qr({},c,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Rc(c)}function Rc(c){const i=c.value,a=c.key;if("array"!==en(i))return[new Ke(a,i,`array expected, ${en(i)} found`)];const h=c.styleSpec;let m,w=[];if(i.length<1)return[new Ke(a,i,"filter array must have at least 1 element")];switch(w=w.concat(as({key:`${a}[0]`,value:i[0],valueSpec:h.filter_operator,style:c.style,styleSpec:c.styleSpec})),Fn(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&"$type"===Fn(i[1])&&w.push(new Ke(a,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":3!==i.length&&w.push(new Ke(a,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(m=en(i[1]),"string"!==m&&w.push(new Ke(`${a}[1]`,i[1],`string expected, ${m} found`)));for(let C=2;C<i.length;C++)m=en(i[C]),"$type"===Fn(i[1])?w=w.concat(as({key:`${a}[${C}]`,value:i[C],valueSpec:h.geometry_type,style:c.style,styleSpec:c.styleSpec})):"string"!==m&&"number"!==m&&"boolean"!==m&&w.push(new Ke(`${a}[${C}]`,i[C],`string, number, or boolean expected, ${m} found`));break;case"any":case"all":case"none":for(let C=1;C<i.length;C++)w=w.concat(Rc({key:`${a}[${C}]`,value:i[C],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":m=en(i[1]),2!==i.length?w.push(new Ke(a,i,`filter array for "${i[0]}" operator must have 2 elements`)):"string"!==m&&w.push(new Ke(`${a}[1]`,i[1],`string expected, ${m} found`))}return w}function Oc(c,i){const a=c.key,h=c.validateSpec,m=c.style,w=c.styleSpec,C=c.value,E=c.objectKey,T=w[`${i}_${c.layerType}`];if(!T)return[];const R=E.match(/^(.*)-transition$/);if("paint"===i&&R&&T[R[1]]&&T[R[1]].transition)return h({key:a,value:C,valueSpec:w.transition,style:m,styleSpec:w});const L=c.valueSpec||T[E];if(!L)return[new Ke(a,C,`unknown property "${E}"`)];let z;if("string"===en(C)&&ji(L)&&!L.tokens&&(z=/^{([^}]+)}$/.exec(C)))return[new Ke(a,C,`"${E}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(z[1])} }\`.`)];const $=[];return"symbol"===c.layerType&&("text-field"===E&&m&&!m.glyphs&&$.push(new Ke(a,C,'use of "text-field" requires a style "glyphs" property')),"text-font"===E&&Pl(vi(C))&&"identity"===Fn(C.type)&&$.push(new Ke(a,C,'"text-font" does not support identity functions'))),$.concat(h({key:c.key,value:C,valueSpec:L,style:m,styleSpec:w,expressionContext:"property",propertyType:i,propertyKey:E}))}function Bh(c){return Oc(c,"paint")}function zh(c){return Oc(c,"layout")}function vu(c){let i=[];const a=c.value,h=c.key,m=c.style,w=c.styleSpec;if("object"!==en(a))return[new Ke(h,a,`object expected, ${en(a)} found`)];a.type||a.ref||i.push(new Ke(h,a,'either "type" or "ref" is required'));let C=Fn(a.type);const E=Fn(a.ref);if(a.id){const T=Fn(a.id);for(let R=0;R<c.arrayIndex;R++){const L=m.layers[R];Fn(L.id)===T&&i.push(new Ke(h,a.id,`duplicate layer id "${a.id}", previously used at line ${L.id.__line__}`))}}if("ref"in a){let T;["type","source","source-layer","filter","layout"].forEach(R=>{R in a&&i.push(new Ke(h,a[R],`"${R}" is prohibited for ref layers`))}),m.layers.forEach(R=>{Fn(R.id)===E&&(T=R)}),T?T.ref?i.push(new Ke(h,a.ref,"ref cannot reference another ref layer")):C=Fn(T.type):i.push(new Ke(h,a.ref,`ref layer "${E}" not found`))}else if("background"!==C)if(a.source){const T=m.sources&&m.sources[a.source],R=T&&Fn(T.type);T?"vector"===R&&"raster"===C?i.push(new Ke(h,a.source,`layer "${a.id}" requires a raster source`)):"raster-dem"!==R&&"hillshade"===C||"raster-dem"!==R&&"color-relief"===C?i.push(new Ke(h,a.source,`layer "${a.id}" requires a raster-dem source`)):"raster"===R&&"raster"!==C?i.push(new Ke(h,a.source,`layer "${a.id}" requires a vector source`)):"vector"!==R||a["source-layer"]?"raster-dem"===R&&"hillshade"!==C&&"color-relief"!==C?i.push(new Ke(h,a.source,"raster-dem source can only be used with layer type 'hillshade' or 'color-relief'.")):"line"!==C||!a.paint||!a.paint["line-gradient"]||"geojson"===R&&T.lineMetrics||i.push(new Ke(h,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new Ke(h,a,`layer "${a.id}" must specify a "source-layer"`)):i.push(new Ke(h,a.source,`source "${a.source}" not found`))}else i.push(new Ke(h,a,'missing required property "source"'));return i=i.concat(No({key:h,value:a,valueSpec:w.layer,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,objectElementValidators:{"*":()=>[],type:()=>c.validateSpec({key:`${h}.type`,value:a.type,valueSpec:w.layer.type,style:c.style,styleSpec:c.styleSpec,validateSpec:c.validateSpec,object:a,objectKey:"type"}),filter:Wa,layout:T=>No({layer:a,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":R=>zh(Qr({layerType:C},R))}}),paint:T=>No({layer:a,key:T.key,value:T.value,style:T.style,styleSpec:T.styleSpec,validateSpec:T.validateSpec,objectElementValidators:{"*":R=>Bh(Qr({layerType:C},R))}})}})),i}function bi(c){const i=c.value,a=c.key,h=en(i);return"string"!==h?[new Ke(a,i,`string expected, ${h} found`)]:[]}const wa={promoteId:function({key:c,value:i}){if("string"===en(i))return bi({key:c,value:i});{const a=[];for(const h in i)a.push(...bi({key:`${c}.${h}`,value:i[h]}));return a}}};function fo(c){const i=c.value,a=c.key,h=c.styleSpec,m=c.style,w=c.validateSpec;if(!i.type)return[new Ke(a,i,'"type" is required')];const C=Fn(i.type);let E;switch(C){case"vector":case"raster":return E=No({key:a,value:i,valueSpec:h[`source_${C.replace("-","_")}`],style:c.style,styleSpec:h,objectElementValidators:wa,validateSpec:w}),E;case"raster-dem":return E=function(T){var R;const L=null!==(R=T.sourceName)&&void 0!==R?R:"",z=T.value,$=T.styleSpec,q=$.source_raster_dem,Z=T.style;let Q=[];const ne=en(z);if(void 0===z)return Q;if("object"!==ne)return Q.push(new Ke("source_raster_dem",z,`object expected, ${ne} found`)),Q;const ce="custom"===Fn(z.encoding),Se=["redFactor","greenFactor","blueFactor","baseShift"],ge=T.value.encoding?`"${T.value.encoding}"`:"Default";for(const ye in z)!ce&&Se.includes(ye)?Q.push(new Ke(ye,z[ye],`In "${L}": "${ye}" is only valid when "encoding" is set to "custom". ${ge} encoding found`)):q[ye]?Q=Q.concat(T.validateSpec({key:ye,value:z[ye],valueSpec:q[ye],validateSpec:T.validateSpec,style:Z,styleSpec:$})):Q.push(new Ke(ye,z[ye],`unknown property "${ye}"`));return Q}({sourceName:a,value:i,style:c.style,styleSpec:h,validateSpec:w}),E;case"geojson":if(E=No({key:a,value:i,valueSpec:h.source_geojson,style:m,styleSpec:h,validateSpec:w,objectElementValidators:wa}),i.cluster)for(const T in i.clusterProperties){const[R,L]=i.clusterProperties[T],z="string"==typeof R?[R,["accumulated"],["get",T]]:R;E.push(...Ha({key:`${a}.${T}.map`,value:L,expressionContext:"cluster-map"})),E.push(...Ha({key:`${a}.${T}.reduce`,value:z,expressionContext:"cluster-reduce"}))}return E;case"video":return No({key:a,value:i,valueSpec:h.source_video,style:m,validateSpec:w,styleSpec:h});case"image":return No({key:a,value:i,valueSpec:h.source_image,style:m,validateSpec:w,styleSpec:h});case"canvas":return[new Ke(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return as({key:`${a}.type`,value:i.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function Gs(c){const i=c.value,a=c.styleSpec,h=a.light,m=c.style;let w=[];const C=en(i);if(void 0===i)return w;if("object"!==C)return w=w.concat([new Ke("light",i,`object expected, ${C} found`)]),w;for(const E in i){const T=E.match(/^(.*)-transition$/);w=w.concat(T&&h[T[1]]&&h[T[1]].transition?c.validateSpec({key:E,value:i[E],valueSpec:a.transition,validateSpec:c.validateSpec,style:m,styleSpec:a}):h[E]?c.validateSpec({key:E,value:i[E],valueSpec:h[E],validateSpec:c.validateSpec,style:m,styleSpec:a}):[new Ke(E,i[E],`unknown property "${E}"`)])}return w}function Ca(c){const i=c.value,a=c.styleSpec,h=a.sky,m=c.style,w=en(i);if(void 0===i)return[];if("object"!==w)return[new Ke("sky",i,`object expected, ${w} found`)];let C=[];for(const E in i)C=C.concat(h[E]?c.validateSpec({key:E,value:i[E],valueSpec:h[E],style:m,styleSpec:a}):[new Ke(E,i[E],`unknown property "${E}"`)]);return C}function qa(c){const i=c.value,a=c.styleSpec,h=a.terrain,m=c.style;let w=[];const C=en(i);if(void 0===i)return w;if("object"!==C)return w=w.concat([new Ke("terrain",i,`object expected, ${C} found`)]),w;for(const E in i)w=w.concat(h[E]?c.validateSpec({key:E,value:i[E],valueSpec:h[E],validateSpec:c.validateSpec,style:m,styleSpec:a}):[new Ke(E,i[E],`unknown property "${E}"`)]);return w}function Cd(c){let i=[];const a=c.value,h=c.key;if(Array.isArray(a)){const m=[],w=[];for(const C in a)a[C].id&&m.includes(a[C].id)&&i.push(new Ke(h,a,`all the sprites' ids must be unique, but ${a[C].id} is duplicated`)),m.push(a[C].id),a[C].url&&w.includes(a[C].url)&&i.push(new Ke(h,a,`all the sprites' URLs must be unique, but ${a[C].url} is duplicated`)),w.push(a[C].url),i=i.concat(No({key:`${h}[${C}]`,value:a[C],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:c.validateSpec}));return i}return bi({key:h,value:a})}function Nl(c){return(i=c.value)&&i.constructor===Object?[]:[new Ke(c.key,c.value,`object expected, ${en(c.value)} found`)];var i}const bu={"*":()=>[],array:Pc,boolean:function(c){const i=c.value,a=c.key,h=en(i);return"boolean"!==h?[new Ke(a,i,`boolean expected, ${h} found`)]:[]},number:kc,color:Us,constants:yu,enum:as,filter:Wa,function:Fh,layer:vu,object:No,source:fo,light:Gs,sky:Ca,terrain:qa,projection:function(c){const i=c.value,a=c.styleSpec,h=a.projection,m=c.style,w=en(i);if(void 0===i)return[];if("object"!==w)return[new Ke("projection",i,`object expected, ${w} found`)];let C=[];for(const E in i)C=C.concat(h[E]?c.validateSpec({key:E,value:i[E],valueSpec:h[E],style:m,styleSpec:a}):[new Ke(E,i[E],`unknown property "${E}"`)]);return C},projectionDefinition:function(c){const i=c.key;let a=c.value;a=a instanceof String?a.valueOf():a;const h=en(a);return"array"!==h||(m=a,Array.isArray(m)&&3===m.length&&"string"==typeof m[0]&&"string"==typeof m[1]&&"number"==typeof m[2])||function(m){return!!["interpolate","step","literal"].includes(m[0])}(a)?["array","string"].includes(h)?[]:[new Ke(i,a,`projection expected, invalid type "${h}" found`)]:[new Ke(i,a,`projection expected, invalid array ${JSON.stringify(a)} found`)];var m},string:bi,formatted:function(c){return 0===bi(c).length?[]:Ha(c)},resolvedImage:function(c){return 0===bi(c).length?[]:Ha(c)},padding:function(c){const i=c.key,a=c.value;if("array"===en(a)){if(a.length<1||a.length>4)return[new Ke(i,a,`padding requires 1 to 4 values; ${a.length} values found`)];const h={type:"number"};let m=[];for(let w=0;w<a.length;w++)m=m.concat(c.validateSpec({key:`${i}[${w}]`,value:a[w],validateSpec:c.validateSpec,valueSpec:h}));return m}return kc({key:i,value:a,valueSpec:{}})},numberArray:function(c){const i=c.key,a=c.value;if("array"===en(a)){const h={type:"number"};if(a.length<1)return[new Ke(i,a,"array length at least 1 expected, length 0 found")];let m=[];for(let w=0;w<a.length;w++)m=m.concat(c.validateSpec({key:`${i}[${w}]`,value:a[w],validateSpec:c.validateSpec,valueSpec:h}));return m}return kc({key:i,value:a,valueSpec:{}})},colorArray:function(c){const i=c.key,a=c.value;if("array"===en(a)){if(a.length<1)return[new Ke(i,a,"array length at least 1 expected, length 0 found")];let h=[];for(let m=0;m<a.length;m++)h=h.concat(Us({key:`${i}[${m}]`,value:a[m]}));return h}return Us({key:i,value:a})},variableAnchorOffsetCollection:function(c){const i=c.key,a=c.value,h=en(a),m=c.styleSpec;if("array"!==h||a.length<1||a.length%2!=0)return[new Ke(i,a,"variableAnchorOffsetCollection requires a non-empty array of even length")];let w=[];for(let C=0;C<a.length;C+=2)w=w.concat(as({key:`${i}[${C}]`,value:a[C],valueSpec:m.layout_symbol["text-anchor"]})),w=w.concat(Pc({key:`${i}[${C+1}]`,value:a[C+1],valueSpec:{length:2,value:"number"},validateSpec:c.validateSpec,style:c.style,styleSpec:m}));return w},sprite:Cd,state:Nl};function Za(c){const i=c.value,a=c.valueSpec,h=c.styleSpec;return c.validateSpec=Za,a.expression&&Pl(Fn(i))?Fh(c):a.expression&&kl(vi(i))?Ha(c):a.type&&bu[a.type]?bu[a.type](c):No(Qr({},c,{valueSpec:a.type?h[a.type]:a}))}function jh(c){const i=c.value,a=c.key,h=bi(c);return h.length||(-1===i.indexOf("{fontstack}")&&h.push(new Ke(a,i,'"glyphs" url must include a "{fontstack}" token')),-1===i.indexOf("{range}")&&h.push(new Ke(a,i,'"glyphs" url must include a "{range}" token'))),h}function Co(c,i=Me){let a=[];return a=a.concat(Za({key:"",value:c,valueSpec:i.$root,styleSpec:i,style:c,validateSpec:Za,objectElementValidators:{glyphs:jh,"*":()=>[]}})),c.constants&&(a=a.concat(yu({key:"constants",value:c.constants}))),Ll(a)}function xi(c){return function(i){return c({...i,validateSpec:Za})}}function Ll(c){return[].concat(c).sort((i,a)=>i.line-a.line)}function wi(c){return function(...i){return Ll(c.apply(this,i))}}Co.source=wi(xi(fo)),Co.sprite=wi(xi(Cd)),Co.glyphs=wi(xi(jh)),Co.light=wi(xi(Gs)),Co.sky=wi(xi(Ca)),Co.terrain=wi(xi(qa)),Co.state=wi(xi(Nl)),Co.layer=wi(xi(vu)),Co.filter=wi(xi(Wa)),Co.paintProperty=wi(xi(Bh)),Co.layoutProperty=wi(xi(zh));const Ya=Co,Vh=Ya.light,$s=Ya.sky,Uh=Ya.paintProperty,Gf=Ya.layoutProperty;function ls(c,i){let a=!1;if(i&&i.length)for(const h of i)c.fire(new We(new Error(h.message))),a=!0;return a}class Ka{constructor(i,a,h){const m=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;const C=new Int32Array(this.arrayBuffer);i=C[0],this.d=(a=C[1])+2*(h=C[2]);for(let T=0;T<this.d*this.d;T++){const R=C[3+T],L=C[3+T+1];m.push(R===L?null:C.subarray(R,L))}const E=C[3+m.length+1];this.keys=C.subarray(C[3+m.length],E),this.bboxes=C.subarray(E),this.insert=this._insertReadonly}else{this.d=a+2*h;for(let C=0;C<this.d*this.d;C++)m.push([]);this.keys=[],this.bboxes=[]}this.n=a,this.extent=i,this.padding=h,this.scale=a/i,this.uid=0;const w=h/a*i;this.min=-w,this.max=i+w}insert(i,a,h,m,w){this._forEachCell(a,h,m,w,this._insertCell,this.uid++,void 0,void 0),this.keys.push(i),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(m),this.bboxes.push(w)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(i,a,h,m,w,C){this.cells[w].push(C)}query(i,a,h,m,w){const C=this.min,E=this.max;if(i<=C&&a<=C&&E<=h&&E<=m&&!w)return Array.prototype.slice.call(this.keys);{const T=[];return this._forEachCell(i,a,h,m,this._queryCell,T,{},w),T}}_queryCell(i,a,h,m,w,C,E,T){const R=this.cells[w];if(null!==R){const L=this.keys,z=this.bboxes;for(let $=0;$<R.length;$++){const q=R[$];if(void 0===E[q]){const Z=4*q;(T?T(z[Z+0],z[Z+1],z[Z+2],z[Z+3]):i<=z[Z+2]&&a<=z[Z+3]&&h>=z[Z+0]&&m>=z[Z+1])?(E[q]=!0,C.push(L[q])):E[q]=!1}}}}_forEachCell(i,a,h,m,w,C,E,T){const R=this._convertToCellCoord(i),L=this._convertToCellCoord(a),z=this._convertToCellCoord(h),$=this._convertToCellCoord(m);for(let q=R;q<=z;q++)for(let Z=L;Z<=$;Z++){const Q=this.d*Z+q;if((!T||T(this._convertFromCellCoord(q),this._convertFromCellCoord(Z),this._convertFromCellCoord(q+1),this._convertFromCellCoord(Z+1)))&&w.call(this,i,a,h,m,Q,C,E,T))return}}_convertFromCellCoord(i){return(i-this.padding)/this.scale}_convertToCellCoord(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const i=this.cells,a=3+this.cells.length+1+1;let h=0;for(let C=0;C<this.cells.length;C++)h+=this.cells[C].length;const m=new Int32Array(a+h+this.keys.length+this.bboxes.length);m[0]=this.extent,m[1]=this.n,m[2]=this.padding;let w=a;for(let C=0;C<i.length;C++){const E=i[C];m[3+C]=w,m.set(E,w),w+=E.length}return m[3+i.length]=w,m.set(this.keys,w),w+=this.keys.length,m[3+i.length+1]=w,m.set(this.bboxes,w),w+=this.bboxes.length,m.buffer}static serialize(i,a){const h=i.toArrayBuffer();return a&&a.push(h),{buffer:h}}static deserialize(i){return new Ka(i.buffer)}}const Gi={};function ht(c,i,a={}){if(Gi[c])throw new Error(`${c} is already registered.`);Object.defineProperty(i,"_classRegistryKey",{value:c,writeable:!1}),Gi[c]={klass:i,omit:a.omit||[],shallow:a.shallow||[]}}ht("Object",Object),ht("Set",Set),ht("TransferableGridIndex",Ka),ht("Color",Qt),ht("Error",Error),ht("AJAXError",de),ht("ResolvedImage",Jr),ht("StylePropertyFunction",Mc),ht("StyleExpression",bd,{omit:["_evaluator"]}),ht("ZoomDependentExpression",xd),ht("ZoomConstantExpression",Rl),ht("CompoundExpression",_i,{omit:["_evaluate"]});for(const c in Ua)Ua[c]._classRegistryKey||ht(`Expression_${c}`,Ua[c]);function Xa(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&"ArrayBuffer"===c.constructor.name)}function Hs(c){return c.$name||c.constructor._classRegistryKey}function ri(c){return!function(i){if(null===i||"object"!=typeof i)return!1;const a=Hs(i);return!(!a||"Object"===a)}(c)&&(null==c||"boolean"==typeof c||"number"==typeof c||"string"==typeof c||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||c instanceof Blob||c instanceof Error||Xa(c)||bn(c)||ArrayBuffer.isView(c)||c instanceof ImageData)}function Ci(c,i){if(ri(c))return(Xa(c)||bn(c))&&i&&i.push(c),ArrayBuffer.isView(c)&&i&&i.push(c.buffer),c instanceof ImageData&&i&&i.push(c.data.buffer),c;if(Array.isArray(c)){const w=[];for(const C of c)w.push(Ci(C,i));return w}if("object"!=typeof c)throw new Error("can't serialize object of type "+typeof c);const a=Hs(c);if(!a)throw new Error(`can't serialize object of unregistered class ${c.constructor.name}`);if(!Gi[a])throw new Error(`${a} is not registered.`);const{klass:h}=Gi[a],m=h.serialize?h.serialize(c,i):{};if(h.serialize){if(i&&m===i[i.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const w in c){if(!c.hasOwnProperty(w)||Gi[a].omit.indexOf(w)>=0)continue;const C=c[w];m[w]=Gi[a].shallow.indexOf(w)>=0?C:Ci(C,i)}c instanceof Error&&(m.message=c.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==a&&(m.$name=a),m}function cs(c){if(ri(c))return c;if(Array.isArray(c))return c.map(cs);if("object"!=typeof c)throw new Error("can't deserialize object of type "+typeof c);const i=Hs(c)||"Object";if(!Gi[i])throw new Error(`can't deserialize unregistered class ${i}`);const{klass:a}=Gi[i];if(!a)throw new Error(`can't deserialize unregistered class ${i}`);if(a.deserialize)return a.deserialize(c);const h=Object.create(a.prototype);for(const m of Object.keys(c)){if("$name"===m)continue;const w=c[m];h[m]=Gi[i].shallow.indexOf(m)>=0?w:cs(w)}return h}class us{constructor(){this.first=!0}update(i,a){const h=Math.floor(i);return this.first?(this.first=!1,this.lastIntegerZoom=h,this.lastIntegerZoomTime=0,this.lastZoom=i,this.lastFloorZoom=h,!0):(this.lastFloorZoom>h?(this.lastIntegerZoom=h+1,this.lastIntegerZoomTime=a):this.lastFloorZoom<h&&(this.lastIntegerZoom=h,this.lastIntegerZoomTime=a),i!==this.lastZoom&&(this.lastZoom=i,this.lastFloorZoom=h,!0))}}const on={"Latin-1 Supplement":c=>c>=128&&c<=255,"Hangul Jamo":c=>c>=4352&&c<=4607,Khmer:c=>c>=6016&&c<=6143,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Kanbun:c=>c>=12688&&c<=12703,"CJK Strokes":c=>c>=12736&&c<=12783,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Hangul Syllables":c=>c>=44032&&c<=55215,"Private Use Area":c=>c>=57344&&c<=63743,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function ds(c){for(const i of c)if(Cu(i.charCodeAt(0)))return!0;return!1}function xu(c){for(const i of c)if(!Nc(i.charCodeAt(0)))return!1;return!0}function Fl(c){const i=c.map(a=>{try{return new RegExp(`\\p{sc=${a}}`,"u").source}catch{return null}}).filter(a=>a);return new RegExp(i.join("|"),"u")}const Sd=Fl(["Arab","Dupl","Mong","Ougr","Syrc"]);function Nc(c){return!Sd.test(String.fromCodePoint(c))}const wu=Fl(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function Cu(c){return!(746!==c&&747!==c&&(c<4352||!(on["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||on["CJK Compatibility"](c)||on["CJK Strokes"](c)||!(!on["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||12336===c)||on["Enclosed CJK Letters and Months"](c)||on["Ideographic Description Characters"](c)||on.Kanbun(c)||on.Katakana(c)&&12540!==c||!(!on["Halfwidth and Fullwidth Forms"](c)||65288===c||65289===c||65293===c||c>=65306&&c<=65310||65339===c||65341===c||65343===c||c>=65371&&c<=65503||65507===c||c>=65512&&c<=65519)||!(!on["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||on["Vertical Forms"](c)||on["Yijing Hexagram Symbols"](c)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(c))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(c))||wu.test(String.fromCodePoint(c)))))}function Su(c){return!(Cu(c)||(i=c,on["Latin-1 Supplement"](i)&&(167===i||169===i||174===i||177===i||188===i||189===i||190===i||215===i||247===i)||on["General Punctuation"](i)&&(8214===i||8224===i||8225===i||8240===i||8241===i||8251===i||8252===i||8258===i||8263===i||8264===i||8265===i||8273===i)||on["Letterlike Symbols"](i)||on["Number Forms"](i)||on["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||9003===i||i>=9085&&i<=9114||i>=9150&&i<=9165||9167===i||i>=9169&&i<=9179||i>=9186&&i<=9215)||on["Control Pictures"](i)&&9251!==i||on["Optical Character Recognition"](i)||on["Enclosed Alphanumerics"](i)||on["Geometric Shapes"](i)||on["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||on["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||on["CJK Symbols and Punctuation"](i)||on.Katakana(i)||on["Private Use Area"](i)||on["CJK Compatibility Forms"](i)||on["Small Form Variants"](i)||on["Halfwidth and Fullwidth Forms"](i)||8734===i||8756===i||8757===i||i>=9984&&i<=10087||i>=10102&&i<=10131||65532===i||65533===i));var i}const Ed=Fl(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Lc(c){return Ed.test(String.fromCodePoint(c))}function Md(c,i){return!(!i&&Lc(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||on.Khmer(c))}function hs(c){for(const i of c)if(Lc(i.charCodeAt(0)))return!0;return!1}const So=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(c){this.pluginStatus=c.pluginStatus,this.pluginURL=c.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(c){if(So.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=c.applyArabicShaping,this.processBidirectionalText=c.processBidirectionalText,this.processStyledBidirectionalText=c.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return null!=this.applyArabicShaping&&null!=this.processBidirectionalText&&null!=this.processStyledBidirectionalText}getRTLTextPluginStatus(){return this.pluginStatus}syncState(c,i){return y(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if("loading"!==c.pluginStatus)return this.setState(c),c;const a=c.pluginURL,h=new Promise(w=>{this.loadScriptResolve=w});i(a);const m=new Promise(w=>setTimeout(()=>w(),this.TIMEOUT));if(yield Promise.race([h,m]),this.isParsed()){const w={pluginStatus:"loaded",pluginURL:a};return this.setState(w),w}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${a}`)})}};class Yn{constructor(i,a){this.zoom=i,a?(this.now=a.now||0,this.fadeDuration=a.fadeDuration||0,this.zoomHistory=a.zoomHistory||new us,this.transition=a.transition||{},this.globalState=a.globalState||{}):(this.now=0,this.fadeDuration=0,this.zoomHistory=new us,this.transition={},this.globalState={})}isSupportedScript(i){return function(a,h){for(const m of a)if(!Md(m.charCodeAt(0),h))return!1;return!0}(i,"loaded"===So.getRTLTextPluginStatus())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const i=this.zoom,a=i-Math.floor(i),h=this.crossFadingFactor();return i>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:a+(1-a)*h}:{fromScale:.5,toScale:1,t:1-(1-h)*a}}}class Bl{constructor(i,a){this.property=i,this.value=a,this.expression=function(h,m){if(Pl(h))return new Mc(h,m);if(kl(h)){const w=js(h,m);if("error"===w.result)throw new Error(w.value.map(C=>`${C.key}: ${C.message}`).join(", "));return w.value}{let w=h;return"color"===m.type&&"string"==typeof h?w=Qt.parse(h):"padding"!==m.type||"number"!=typeof h&&!Array.isArray(h)?"numberArray"!==m.type||"number"!=typeof h&&!Array.isArray(h)?"colorArray"!==m.type||"string"!=typeof h&&!Array.isArray(h)?"variableAnchorOffsetCollection"===m.type&&Array.isArray(h)?w=Ur.parse(h):"projectionDefinition"===m.type&&"string"==typeof h&&(w=Nn.parse(h)):w=Tr.parse(h):w=ho.parse(h):w=Mr.parse(h),{globalStateRefs:new Set,kind:"constant",evaluate:()=>w}}}(void 0===a?i.specification.default:a,i.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}getGlobalStateRefs(){return this.expression.globalStateRefs||new Set}possiblyEvaluate(i,a,h){return this.property.possiblyEvaluate(this,i,a,h)}}class Eu{constructor(i){this.property=i,this.value=new Bl(i,void 0)}transitioned(i,a){return new Mu(this.property,this.value,a,Qn({},i.transition,this.transition),i.now)}untransitioned(){return new Mu(this.property,this.value,null,{},0)}}class Gh{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return Nr(this._values[i].value.value)}setValue(i,a){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Eu(this._values[i].property)),this._values[i].value=new Bl(this._values[i].property,null===a?void 0:Nr(a))}getTransition(i){return Nr(this._values[i].transition)}setTransition(i,a){Object.prototype.hasOwnProperty.call(this._values,i)||(this._values[i]=new Eu(this._values[i].property)),this._values[i].transition=Nr(a)||void 0}serialize(){const i={};for(const a of Object.keys(this._values)){const h=this.getValue(a);void 0!==h&&(i[a]=h);const m=this.getTransition(a);void 0!==m&&(i[`${a}-transition`]=m)}return i}transitioned(i,a){const h=new Td(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].transitioned(i,a._values[m]);return h}untransitioned(){const i=new Td(this._properties);for(const a of Object.keys(this._values))i._values[a]=this._values[a].untransitioned();return i}}class Mu{constructor(i,a,h,m,w){this.property=i,this.value=a,this.begin=w+m.delay||0,this.end=this.begin+m.duration||0,i.specification.transition&&(m.delay||m.duration)&&(this.prior=h)}possiblyEvaluate(i,a,h){const m=i.now||0,w=this.value.possiblyEvaluate(i,a,h),C=this.prior;if(C){if(m>this.end)return this.prior=null,w;if(this.value.isDataDriven())return this.prior=null,w;if(m<this.begin)return C.possiblyEvaluate(i,a,h);{const E=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(C.possiblyEvaluate(i,a,h),w,Rr(E))}}return w}}class Td{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,a,h){const m=new Fc(this._properties);for(const w of Object.keys(this._values))m._values[w]=this._values[w].possiblyEvaluate(i,a,h);return m}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class Tu{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}hasValue(i){return void 0!==this._values[i].value}getValue(i){return Nr(this._values[i].value)}setValue(i,a){this._values[i]=new Bl(this._values[i].property,null===a?void 0:Nr(a))}serialize(){const i={};for(const a of Object.keys(this._values)){const h=this.getValue(a);void 0!==h&&(i[a]=h)}return i}possiblyEvaluate(i,a,h){const m=new Fc(this._properties);for(const w of Object.keys(this._values))m._values[w]=this._values[w].possiblyEvaluate(i,a,h);return m}}class $i{constructor(i,a,h){this.property=i,this.value=a,this.parameters=h}isConstant(){return"constant"===this.value.kind}constantOr(i){return"constant"===this.value.kind?this.value.value:i}evaluate(i,a,h,m){return this.property.evaluate(this.value,this.parameters,i,a,h,m)}}class Fc{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class k{constructor(i){this.specification=i}possiblyEvaluate(i,a){if(i.isDataDriven())throw new Error("Value should not be data driven");return i.expression.evaluate(a)}interpolate(i,a,h){const m=Wo[this.specification.type];return m?m(i,a,h):i}}class G{constructor(i,a){this.specification=i,this.overrides=a}possiblyEvaluate(i,a,h,m){return new $i(this,"constant"===i.expression.kind||"camera"===i.expression.kind?{kind:"constant",value:i.expression.evaluate(a,null,{},h,m)}:i.expression,a)}interpolate(i,a,h){if("constant"!==i.value.kind||"constant"!==a.value.kind)return i;if(void 0===i.value.value||void 0===a.value.value)return new $i(this,{kind:"constant",value:void 0},i.parameters);const m=Wo[this.specification.type];if(m){const w=m(i.value.value,a.value.value,h);return new $i(this,{kind:"constant",value:w},i.parameters)}return i}evaluate(i,a,h,m,w,C){return"constant"===i.kind?i.value:i.evaluate(a,h,m,w,C)}}class ae extends G{possiblyEvaluate(i,a,h,m){if(void 0===i.value)return new $i(this,{kind:"constant",value:void 0},a);if("constant"===i.expression.kind){const w=i.expression.evaluate(a,null,{},h,m),C="resolvedImage"===i.property.specification.type&&"string"!=typeof w?w.name:w,E=this._calculate(C,C,C,a);return new $i(this,{kind:"constant",value:E},a)}if("camera"===i.expression.kind){const w=this._calculate(i.expression.evaluate({zoom:a.zoom-1}),i.expression.evaluate({zoom:a.zoom}),i.expression.evaluate({zoom:a.zoom+1}),a);return new $i(this,{kind:"constant",value:w},a)}return new $i(this,i.expression,a)}evaluate(i,a,h,m,w,C){if("source"===i.kind){const E=i.evaluate(a,h,m,w,C);return this._calculate(E,E,E,a)}return"composite"===i.kind?this._calculate(i.evaluate({zoom:Math.floor(a.zoom)-1},h,m),i.evaluate({zoom:Math.floor(a.zoom)},h,m),i.evaluate({zoom:Math.floor(a.zoom)+1},h,m),a):i.value}_calculate(i,a,h,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:i,to:a}:{from:h,to:a}}interpolate(i){return i}}class Ae{constructor(i){this.specification=i}possiblyEvaluate(i,a,h,m){if(void 0!==i.value){if("constant"===i.expression.kind){const w=i.expression.evaluate(a,null,{},h,m);return this._calculate(w,w,w,a)}return this._calculate(i.expression.evaluate(new Yn(Math.floor(a.zoom-1),a)),i.expression.evaluate(new Yn(Math.floor(a.zoom),a)),i.expression.evaluate(new Yn(Math.floor(a.zoom+1),a)),a)}}_calculate(i,a,h,m){return m.zoom>m.zoomHistory.lastIntegerZoom?{from:i,to:a}:{from:h,to:a}}interpolate(i){return i}}class He{constructor(i){this.specification=i}possiblyEvaluate(i,a,h,m){return!!i.expression.evaluate(a,null,{},h,m)}interpolate(){return!1}}class ft{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const a in i){const h=i[a];h.specification.overridable&&this.overridableProperties.push(a);const m=this.defaultPropertyValues[a]=new Bl(h,void 0),w=this.defaultTransitionablePropertyValues[a]=new Eu(h);this.defaultTransitioningPropertyValues[a]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=m.possiblyEvaluate({})}}}ht("DataDrivenProperty",G),ht("DataConstantProperty",k),ht("CrossFadedDataDrivenProperty",ae),ht("CrossFadedProperty",Ae),ht("ColorRampProperty",He);const An="-transition";class Kn extends bt{constructor(i,a){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1,getGlobalStateRefs:()=>new Set},"custom"!==i.type&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,"background"!==i.type&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter,this._featureFilter=Ui(i.filter)),a.layout&&(this._unevaluatedLayout=new Tu(a.layout)),a.paint)){this._transitionablePaint=new Gh(a.paint);for(const h in i.paint)this.setPaintProperty(h,i.paint[h],{validate:!1});for(const h in i.layout)this.setLayoutProperty(h,i.layout[h],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Fc(a.paint)}}setFilter(i){this.filter=i,this._featureFilter=Ui(i)}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(i){return"visibility"===i?this.visibility:this._unevaluatedLayout.getValue(i)}getLayoutAffectingGlobalStateRefs(){const i=new Set;if(this._unevaluatedLayout)for(const a in this._unevaluatedLayout._values){const h=this._unevaluatedLayout._values[a];for(const m of h.getGlobalStateRefs())i.add(m)}for(const a of this._featureFilter.getGlobalStateRefs())i.add(a);return i}setLayoutProperty(i,a,h={}){null!=a&&this._validate(Gf,`layers.${this.id}.layout.${i}`,i,a,h)||("visibility"!==i?this._unevaluatedLayout.setValue(i,a):this.visibility=a)}getPaintProperty(i){return i.endsWith(An)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,a,h={}){if(null!=a&&this._validate(Uh,`layers.${this.id}.paint.${i}`,i,a,h))return!1;if(i.endsWith(An))return this._transitionablePaint.setTransition(i.slice(0,-11),a||void 0),!1;{const m=this._transitionablePaint._values[i],w="cross-faded-data-driven"===m.property.specification["property-type"],C=m.value.isDataDriven(),E=m.value;this._transitionablePaint.setValue(i,a),this._handleSpecialPaintPropertyUpdate(i);const T=this._transitionablePaint._values[i].value;return T.isDataDriven()||C||w||this._handleOverridablePaintPropertyUpdate(i,E,T)}}_handleSpecialPaintPropertyUpdate(i){}_handleOverridablePaintPropertyUpdate(i,a,h){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||"none"===this.visibility}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,a){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,a)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),oa(i,(a,h)=>!(void 0===a||"layout"===h&&!Object.keys(a).length||"paint"===h&&!Object.keys(a).length))}_validate(i,a,h,m,w={}){return(!w||!1!==w.validate)&&ls(this,i.call(Ya,{key:a,layerType:this.type,objectKey:h,value:m,styleSpec:Me,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const a=this.paint.get(i);if(a instanceof $i&&ji(a.property.specification)&&("source"===a.value.kind||"composite"===a.value.kind)&&a.value.isStateDependent)return!0}return!1}}const Ir={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Xn{constructor(i,a){this._structArray=i,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class wn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,a){return i._trim(),a&&(i.isTransferred=!0,a.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const a=Object.create(this.prototype);return a.arrayBuffer=i.arrayBuffer,a.length=i.length,a.capacity=i.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function hr(c,i=1){let a=0,h=0;return{members:c.map(m=>{const w=Ir[m.type].BYTES_PER_ELEMENT,C=a=Bc(a,Math.max(i,w)),E=m.components||1;return h=Math.max(h,w),a+=w*E,{name:m.name,type:m.type,components:E,offset:C}}),size:Bc(a,Math.max(h,i)),alignment:i}}function Bc(c,i){return Math.ceil(c/i)*i}class Iu extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a){const h=this.length;return this.resize(h+1),this.emplace(h,i,a)}emplace(i,a,h){const m=2*i;return this.int16[m+0]=a,this.int16[m+1]=h,i}}Iu.prototype.bytesPerElement=4,ht("StructArrayLayout2i4",Iu);class Du extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,a,h)}emplace(i,a,h,m){const w=3*i;return this.int16[w+0]=a,this.int16[w+1]=h,this.int16[w+2]=m,i}}Du.prototype.bytesPerElement=6,ht("StructArrayLayout3i6",Du);class Id extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,m){const w=this.length;return this.resize(w+1),this.emplace(w,i,a,h,m)}emplace(i,a,h,m,w){const C=4*i;return this.int16[C+0]=a,this.int16[C+1]=h,this.int16[C+2]=m,this.int16[C+3]=w,i}}Id.prototype.bytesPerElement=8,ht("StructArrayLayout4i8",Id);class zc extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,w,C){const E=this.length;return this.resize(E+1),this.emplace(E,i,a,h,m,w,C)}emplace(i,a,h,m,w,C,E){const T=6*i;return this.int16[T+0]=a,this.int16[T+1]=h,this.int16[T+2]=m,this.int16[T+3]=w,this.int16[T+4]=C,this.int16[T+5]=E,i}}zc.prototype.bytesPerElement=12,ht("StructArrayLayout2i4i12",zc);class zl extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,w,C){const E=this.length;return this.resize(E+1),this.emplace(E,i,a,h,m,w,C)}emplace(i,a,h,m,w,C,E){const T=4*i,R=8*i;return this.int16[T+0]=a,this.int16[T+1]=h,this.uint8[R+4]=m,this.uint8[R+5]=w,this.uint8[R+6]=C,this.uint8[R+7]=E,i}}zl.prototype.bytesPerElement=8,ht("StructArrayLayout2i4ub8",zl);class Au extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a){const h=this.length;return this.resize(h+1),this.emplace(h,i,a)}emplace(i,a,h){const m=2*i;return this.float32[m+0]=a,this.float32[m+1]=h,i}}Au.prototype.bytesPerElement=8,ht("StructArrayLayout2f8",Au);class Dd extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,w,C,E,T,R,L){const z=this.length;return this.resize(z+1),this.emplace(z,i,a,h,m,w,C,E,T,R,L)}emplace(i,a,h,m,w,C,E,T,R,L,z){const $=10*i;return this.uint16[$+0]=a,this.uint16[$+1]=h,this.uint16[$+2]=m,this.uint16[$+3]=w,this.uint16[$+4]=C,this.uint16[$+5]=E,this.uint16[$+6]=T,this.uint16[$+7]=R,this.uint16[$+8]=L,this.uint16[$+9]=z,i}}Dd.prototype.bytesPerElement=20,ht("StructArrayLayout10ui20",Dd);class jl extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,w,C,E,T,R,L,z,$){const q=this.length;return this.resize(q+1),this.emplace(q,i,a,h,m,w,C,E,T,R,L,z,$)}emplace(i,a,h,m,w,C,E,T,R,L,z,$,q){const Z=12*i;return this.int16[Z+0]=a,this.int16[Z+1]=h,this.int16[Z+2]=m,this.int16[Z+3]=w,this.uint16[Z+4]=C,this.uint16[Z+5]=E,this.uint16[Z+6]=T,this.uint16[Z+7]=R,this.int16[Z+8]=L,this.int16[Z+9]=z,this.int16[Z+10]=$,this.int16[Z+11]=q,i}}jl.prototype.bytesPerElement=24,ht("StructArrayLayout4i4ui4i24",jl);class Ad extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,a,h)}emplace(i,a,h,m){const w=3*i;return this.float32[w+0]=a,this.float32[w+1]=h,this.float32[w+2]=m,i}}Ad.prototype.bytesPerElement=12,ht("StructArrayLayout3f12",Ad);class Pd extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.uint32[1*i+0]=a,i}}Pd.prototype.bytesPerElement=4,ht("StructArrayLayout1ul4",Pd);class kd extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,w,C,E,T,R){const L=this.length;return this.resize(L+1),this.emplace(L,i,a,h,m,w,C,E,T,R)}emplace(i,a,h,m,w,C,E,T,R,L){const z=10*i,$=5*i;return this.int16[z+0]=a,this.int16[z+1]=h,this.int16[z+2]=m,this.int16[z+3]=w,this.int16[z+4]=C,this.int16[z+5]=E,this.uint32[$+3]=T,this.uint16[z+8]=R,this.uint16[z+9]=L,i}}kd.prototype.bytesPerElement=20,ht("StructArrayLayout6i1ul2ui20",kd);class $h extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,w,C){const E=this.length;return this.resize(E+1),this.emplace(E,i,a,h,m,w,C)}emplace(i,a,h,m,w,C,E){const T=6*i;return this.int16[T+0]=a,this.int16[T+1]=h,this.int16[T+2]=m,this.int16[T+3]=w,this.int16[T+4]=C,this.int16[T+5]=E,i}}$h.prototype.bytesPerElement=12,ht("StructArrayLayout2i2i2i12",$h);class b extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,w){const C=this.length;return this.resize(C+1),this.emplace(C,i,a,h,m,w)}emplace(i,a,h,m,w,C){const E=4*i,T=8*i;return this.float32[E+0]=a,this.float32[E+1]=h,this.float32[E+2]=m,this.int16[T+6]=w,this.int16[T+7]=C,i}}b.prototype.bytesPerElement=16,ht("StructArrayLayout2f1f2i16",b);class o extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,a,h,m,w,C){const E=this.length;return this.resize(E+1),this.emplace(E,i,a,h,m,w,C)}emplace(i,a,h,m,w,C,E){const T=16*i,R=4*i,L=8*i;return this.uint8[T+0]=a,this.uint8[T+1]=h,this.float32[R+1]=m,this.float32[R+2]=w,this.int16[L+6]=C,this.int16[L+7]=E,i}}o.prototype.bytesPerElement=16,ht("StructArrayLayout2ub2f2i16",o);class u extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,a,h)}emplace(i,a,h,m){const w=3*i;return this.uint16[w+0]=a,this.uint16[w+1]=h,this.uint16[w+2]=m,i}}u.prototype.bytesPerElement=6,ht("StructArrayLayout3ui6",u);class f extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,m,w,C,E,T,R,L,z,$,q,Z,Q,ne,ce){const Se=this.length;return this.resize(Se+1),this.emplace(Se,i,a,h,m,w,C,E,T,R,L,z,$,q,Z,Q,ne,ce)}emplace(i,a,h,m,w,C,E,T,R,L,z,$,q,Z,Q,ne,ce,Se){const ge=24*i,ye=12*i,Re=48*i;return this.int16[ge+0]=a,this.int16[ge+1]=h,this.uint16[ge+2]=m,this.uint16[ge+3]=w,this.uint32[ye+2]=C,this.uint32[ye+3]=E,this.uint32[ye+4]=T,this.uint16[ge+10]=R,this.uint16[ge+11]=L,this.uint16[ge+12]=z,this.float32[ye+7]=$,this.float32[ye+8]=q,this.uint8[Re+36]=Z,this.uint8[Re+37]=Q,this.uint8[Re+38]=ne,this.uint32[ye+10]=ce,this.int16[ge+22]=Se,i}}f.prototype.bytesPerElement=48,ht("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",f);class _ extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,m,w,C,E,T,R,L,z,$,q,Z,Q,ne,ce,Se,ge,ye,Re,je,Ze,ut,et,st,Dt,Xe){const rt=this.length;return this.resize(rt+1),this.emplace(rt,i,a,h,m,w,C,E,T,R,L,z,$,q,Z,Q,ne,ce,Se,ge,ye,Re,je,Ze,ut,et,st,Dt,Xe)}emplace(i,a,h,m,w,C,E,T,R,L,z,$,q,Z,Q,ne,ce,Se,ge,ye,Re,je,Ze,ut,et,st,Dt,Xe,rt){const ze=32*i,Pt=16*i;return this.int16[ze+0]=a,this.int16[ze+1]=h,this.int16[ze+2]=m,this.int16[ze+3]=w,this.int16[ze+4]=C,this.int16[ze+5]=E,this.int16[ze+6]=T,this.int16[ze+7]=R,this.uint16[ze+8]=L,this.uint16[ze+9]=z,this.uint16[ze+10]=$,this.uint16[ze+11]=q,this.uint16[ze+12]=Z,this.uint16[ze+13]=Q,this.uint16[ze+14]=ne,this.uint16[ze+15]=ce,this.uint16[ze+16]=Se,this.uint16[ze+17]=ge,this.uint16[ze+18]=ye,this.uint16[ze+19]=Re,this.uint16[ze+20]=je,this.uint16[ze+21]=Ze,this.uint16[ze+22]=ut,this.uint32[Pt+12]=et,this.float32[Pt+13]=st,this.float32[Pt+14]=Dt,this.uint16[ze+30]=Xe,this.uint16[ze+31]=rt,i}}_.prototype.bytesPerElement=64,ht("StructArrayLayout8i15ui1ul2f2ui64",_);class x extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.float32[1*i+0]=a,i}}x.prototype.bytesPerElement=4,ht("StructArrayLayout1f4",x);class S extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,a,h)}emplace(i,a,h,m){const w=3*i;return this.uint16[6*i+0]=a,this.float32[w+1]=h,this.float32[w+2]=m,i}}S.prototype.bytesPerElement=12,ht("StructArrayLayout1ui2f12",S);class I extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,i,a,h)}emplace(i,a,h,m){const w=4*i;return this.uint32[2*i+0]=a,this.uint16[w+2]=h,this.uint16[w+3]=m,i}}I.prototype.bytesPerElement=8,ht("StructArrayLayout1ul2ui8",I);class D extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,a){const h=this.length;return this.resize(h+1),this.emplace(h,i,a)}emplace(i,a,h){const m=2*i;return this.uint16[m+0]=a,this.uint16[m+1]=h,i}}D.prototype.bytesPerElement=4,ht("StructArrayLayout2ui4",D);class N extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const a=this.length;return this.resize(a+1),this.emplace(a,i)}emplace(i,a){return this.uint16[1*i+0]=a,i}}N.prototype.bytesPerElement=2,ht("StructArrayLayout1ui2",N);class F extends wn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,a,h,m){const w=this.length;return this.resize(w+1),this.emplace(w,i,a,h,m)}emplace(i,a,h,m,w){const C=4*i;return this.float32[C+0]=a,this.float32[C+1]=h,this.float32[C+2]=m,this.float32[C+3]=w,i}}F.prototype.bytesPerElement=16,ht("StructArrayLayout4f16",F);class U extends Xn{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new Ye(this.anchorPointX,this.anchorPointY)}}U.prototype.size=20;class V extends kd{get(i){return new U(this,i)}}ht("CollisionBoxArray",V);class H extends Xn{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(i){this._structArray.uint8[this._pos1+37]=i}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(i){this._structArray.uint8[this._pos1+38]=i}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(i){this._structArray.uint32[this._pos4+10]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}H.prototype.size=48;class Y extends f{get(i){return new H(this,i)}}ht("PlacedSymbolArray",Y);class oe extends Xn{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(i){this._structArray.uint32[this._pos4+12]=i}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}oe.prototype.size=64;class re extends _{get(i){return new oe(this,i)}}ht("SymbolInstanceArray",re);class ie extends x{getoffsetX(i){return this.float32[1*i+0]}}ht("GlyphOffsetArray",ie);class ue extends Du{getx(i){return this.int16[3*i+0]}gety(i){return this.int16[3*i+1]}gettileUnitDistanceFromAnchor(i){return this.int16[3*i+2]}}ht("SymbolLineVertexArray",ue);class pe extends Xn{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}pe.prototype.size=12;class he extends S{get(i){return new pe(this,i)}}ht("TextAnchorOffsetArray",he);class me extends Xn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}me.prototype.size=8;class ve extends I{get(i){return new me(this,i)}}ht("FeatureIndexArray",ve);class fe extends Iu{}class Te extends Iu{}class Be extends Iu{}class ke extends zc{}class Oe extends zl{}class Fe extends Au{}class Je extends Dd{}class tt extends jl{}class qe extends Ad{}class Mt extends Pd{}class nn extends $h{}class Sn extends o{}class $n extends u{}class Bn extends D{}const br=hr([{name:"a_pos",components:2,type:"Int16"}],4),{members:Dr}=br;class tn{constructor(i=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=i}prepareSegment(i,a,h,m){const w=this.segments[this.segments.length-1];return i>tn.MAX_VERTEX_ARRAY_LENGTH&&Le(`Max vertices per segment is ${tn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${tn.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!w||w.vertexLength+i>tn.MAX_VERTEX_ARRAY_LENGTH||w.sortKey!==m?this.createNewSegment(a,h,m):w}createNewSegment(i,a,h){const m={vertexOffset:i.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0,vaos:{}};return void 0!==h&&(m.sortKey=h),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(m),m}getOrCreateLatestSegment(i,a,h){return this.prepareSegment(0,i,a,h)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const i of this.segments)for(const a in i.vaos)i.vaos[a].destroy()}static simpleSegment(i,a,h,m){return new tn([{vertexOffset:i,primitiveOffset:a,vertexLength:h,primitiveLength:m,vaos:{},sortKey:0}])}}function zn(c,i){return 256*(c=Or(Math.floor(c),0,255))+Or(Math.floor(i),0,255)}tn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ht("SegmentVector",tn);const xr=hr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ar,no,Lo,Hi={exports:{}},Qa={exports:{}},Ja={exports:{}},fs=En(function(){if(Lo)return Hi.exports;Lo=1;var c=(Ar||(Ar=1,Qa.exports=function(a,h){var m,w,C,E,T,R,L,z;for(w=a.length-(m=3&a.length),C=h,T=3432918353,R=461845907,z=0;z<w;)L=255&a.charCodeAt(z)|(255&a.charCodeAt(++z))<<8|(255&a.charCodeAt(++z))<<16|(255&a.charCodeAt(++z))<<24,++z,C=27492+(65535&(E=5*(65535&(C=(C^=L=(65535&(L=(L=(65535&L)*T+(((L>>>16)*T&65535)<<16)&4294967295)<<15|L>>>17))*R+(((L>>>16)*R&65535)<<16)&4294967295)<<13|C>>>19))+((5*(C>>>16)&65535)<<16)&4294967295))+((58964+(E>>>16)&65535)<<16);switch(L=0,m){case 3:L^=(255&a.charCodeAt(z+2))<<16;case 2:L^=(255&a.charCodeAt(z+1))<<8;case 1:C^=L=(65535&(L=(L=(65535&(L^=255&a.charCodeAt(z)))*T+(((L>>>16)*T&65535)<<16)&4294967295)<<15|L>>>17))*R+(((L>>>16)*R&65535)<<16)&4294967295}return C^=a.length,C=2246822507*(65535&(C^=C>>>16))+((2246822507*(C>>>16)&65535)<<16)&4294967295,C=3266489909*(65535&(C^=C>>>13))+((3266489909*(C>>>16)&65535)<<16)&4294967295,(C^=C>>>16)>>>0}),Qa.exports),i=(no||(no=1,Ja.exports=function(a,h){for(var m,w=a.length,C=h^w,E=0;w>=4;)m=1540483477*(65535&(m=255&a.charCodeAt(E)|(255&a.charCodeAt(++E))<<8|(255&a.charCodeAt(++E))<<16|(255&a.charCodeAt(++E))<<24))+((1540483477*(m>>>16)&65535)<<16),C=1540483477*(65535&C)+((1540483477*(C>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),w-=4,++E;switch(w){case 3:C^=(255&a.charCodeAt(E+2))<<16;case 2:C^=(255&a.charCodeAt(E+1))<<8;case 1:C=1540483477*(65535&(C^=255&a.charCodeAt(E)))+((1540483477*(C>>>16)&65535)<<16)}return C=1540483477*(65535&(C^=C>>>13))+((1540483477*(C>>>16)&65535)<<16),(C^=C>>>15)>>>0}),Ja.exports);return Hi.exports=c,Hi.exports.murmur3=c,Hi.exports.murmur2=i,Hi.exports}());class Fo{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,a,h,m){this.ids.push(el(i)),this.positions.push(a,h,m)}getPositions(i){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const a=el(i);let h=0,m=this.ids.length-1;for(;h<m;){const C=h+m>>1;this.ids[C]>=a?m=C:h=C+1}const w=[];for(;this.ids[h]===a;)w.push({index:this.positions[3*h],start:this.positions[3*h+1],end:this.positions[3*h+2]}),h++;return w}static serialize(i,a){const h=new Float64Array(i.ids),m=new Uint32Array(i.positions);return Si(h,m,0,h.length-1),a&&a.push(h.buffer,m.buffer),{ids:h,positions:m}}static deserialize(i){const a=new Fo;return a.ids=i.ids,a.positions=i.positions,a.indexed=!0,a}}function el(c){const i=+c;return!isNaN(i)&&i<=Number.MAX_SAFE_INTEGER?i:fs(String(c))}function Si(c,i,a,h){for(;a<h;){const m=c[a+h>>1];let w=a-1,C=h+1;for(;;){do{w++}while(c[w]<m);do{C--}while(c[C]>m);if(w>=C)break;ps(c,w,C),ps(i,3*w,3*C),ps(i,3*w+1,3*C+1),ps(i,3*w+2,3*C+2)}C-a<h-C?(Si(c,i,a,C),a=C+1):(Si(c,i,C+1,h),h=C)}}function ps(c,i,a){const h=c[i];c[i]=c[a],c[a]=h}ht("FeaturePositionMap",Fo);class oi{constructor(i,a){this.gl=i.gl,this.location=a}}class Ul extends oi{constructor(i,a){super(i,a),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class Br extends oi{constructor(i,a){super(i,a),this.current=[0,0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))}}class Wr extends oi{constructor(i,a){super(i,a),this.current=Qt.transparent}set(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))}}const gs=new Float32Array(16);function qr(c){return[zn(255*c.r,255*c.g),zn(255*c.b,255*c.a)]}class jc{constructor(i,a,h){this.value=i,this.uniformNames=a.map(m=>`u_${m}`),this.type=h}setUniform(i,a,h){i.set(h.constantOr(this.value))}getBinding(i,a,h){return"color"===this.type?new Wr(i,a):new Ul(i,a)}}class Vc{constructor(i,a){this.uniformNames=a.map(h=>`u_${h}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(i,a){this.pixelRatioFrom=a.pixelRatio,this.pixelRatioTo=i.pixelRatio,this.patternFrom=a.tlbr,this.patternTo=i.tlbr}setUniform(i,a,h,m){const w="u_pattern_to"===m?this.patternTo:"u_pattern_from"===m?this.patternFrom:"u_pixel_ratio_to"===m?this.pixelRatioTo:"u_pixel_ratio_from"===m?this.pixelRatioFrom:null;w&&i.set(w)}getBinding(i,a,h){return"u_pattern"===h.substr(0,9)?new Br(i,a):new Ul(i,a)}}class ms{constructor(i,a,h,m){this.expression=i,this.type=h,this.maxValue=0,this.paintVertexAttributes=a.map(w=>({name:`a_${w}`,type:"Float32",components:"color"===h?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(i,a,h,m,w){const C=this.paintVertexArray.length,E=this.expression.evaluate(new Yn(0),a,{},m,[],w);this.paintVertexArray.resize(i),this._setPaintValue(C,i,E)}updatePaintArray(i,a,h,m){const w=this.expression.evaluate({zoom:0},h,m);this._setPaintValue(i,a,w)}_setPaintValue(i,a,h){if("color"===this.type){const m=qr(h);for(let w=i;w<a;w++)this.paintVertexArray.emplace(w,m[0],m[1])}else{for(let m=i;m<a;m++)this.paintVertexArray.emplace(m,h);this.maxValue=Math.max(this.maxValue,Math.abs(h))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class _s{constructor(i,a,h,m,w,C){this.expression=i,this.uniformNames=a.map(E=>`u_${E}_t`),this.type=h,this.useIntegerZoom=m,this.zoom=w,this.maxValue=0,this.paintVertexAttributes=a.map(E=>({name:`a_${E}`,type:"Float32",components:"color"===h?4:2,offset:0})),this.paintVertexArray=new C}populatePaintArray(i,a,h,m,w){const C=this.expression.evaluate(new Yn(this.zoom),a,{},m,[],w),E=this.expression.evaluate(new Yn(this.zoom+1),a,{},m,[],w),T=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(T,i,C,E)}updatePaintArray(i,a,h,m){const w=this.expression.evaluate({zoom:this.zoom},h,m),C=this.expression.evaluate({zoom:this.zoom+1},h,m);this._setPaintValue(i,a,w,C)}_setPaintValue(i,a,h,m){if("color"===this.type){const w=qr(h),C=qr(m);for(let E=i;E<a;E++)this.paintVertexArray.emplace(E,w[0],w[1],C[0],C[1])}else{for(let w=i;w<a;w++)this.paintVertexArray.emplace(w,h,m);this.maxValue=Math.max(this.maxValue,Math.abs(h),Math.abs(m))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,a){const h=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,m=Or(this.expression.interpolationFactor(h,this.zoom,this.zoom+1),0,1);i.set(m)}getBinding(i,a,h){return new Ul(i,a)}}class tl{constructor(i,a,h,m,w,C){this.expression=i,this.type=a,this.useIntegerZoom=h,this.zoom=m,this.layerId=C,this.zoomInPaintVertexArray=new w,this.zoomOutPaintVertexArray=new w}populatePaintArray(i,a,h){const m=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(i),this.zoomOutPaintVertexArray.resize(i),this._setPaintValues(m,i,a.patterns&&a.patterns[this.layerId],h)}updatePaintArray(i,a,h,m,w){this._setPaintValues(i,a,h.patterns&&h.patterns[this.layerId],w)}_setPaintValues(i,a,h,m){if(!m||!h)return;const{min:w,mid:C,max:E}=h,T=m[w],R=m[C],L=m[E];if(T&&R&&L)for(let z=i;z<a;z++)this.zoomInPaintVertexArray.emplace(z,R.tl[0],R.tl[1],R.br[0],R.br[1],T.tl[0],T.tl[1],T.br[0],T.br[1],R.pixelRatio,T.pixelRatio),this.zoomOutPaintVertexArray.emplace(z,R.tl[0],R.tl[1],R.br[0],R.br[1],L.tl[0],L.tl[1],L.br[0],L.br[1],R.pixelRatio,L.pixelRatio)}upload(i){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=i.createVertexBuffer(this.zoomInPaintVertexArray,xr.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=i.createVertexBuffer(this.zoomOutPaintVertexArray,xr.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Wi{constructor(i,a,h){this.binders={},this._buffers=[];const m=[];for(const w in i.paint._values){if(!h(w))continue;const C=i.paint.get(w);if(!(C instanceof $i&&ji(C.property.specification)))continue;const E=Hh(w,i.type),T=C.value,R=C.property.specification.type,L=C.property.useIntegerZoom,z=C.property.specification["property-type"],$="cross-faded"===z||"cross-faded-data-driven"===z;if("constant"===T.kind)this.binders[w]=$?new Vc(T.value,E):new jc(T.value,E,R),m.push(`/u_${w}`);else if("source"===T.kind||$){const q=Wh(w,R,"source");this.binders[w]=$?new tl(T,R,L,a,q,i.id):new ms(T,E,R,q),m.push(`/a_${w}`)}else{const q=Wh(w,R,"composite");this.binders[w]=new _s(T,E,R,L,a,q),m.push(`/z_${w}`)}}this.cacheKey=m.sort().join("")}getMaxValue(i){const a=this.binders[i];return a instanceof ms||a instanceof _s?a.maxValue:0}populatePaintArrays(i,a,h,m,w){for(const C in this.binders){const E=this.binders[C];(E instanceof ms||E instanceof _s||E instanceof tl)&&E.populatePaintArray(i,a,h,m,w)}}setConstantPatternPositions(i,a){for(const h in this.binders){const m=this.binders[h];m instanceof Vc&&m.setConstantPatternPositions(i,a)}}updatePaintArrays(i,a,h,m,w){let C=!1;for(const E in i){const T=a.getPositions(E);for(const R of T){const L=h.feature(R.index);for(const z in this.binders){const $=this.binders[z];if(($ instanceof ms||$ instanceof _s||$ instanceof tl)&&!0===$.expression.isStateDependent){const q=m.paint.get(z);$.expression=q.value,$.updatePaintArray(R.start,R.end,L,i[E],w),C=!0}}}}return C}defines(){const i=[];for(const a in this.binders){const h=this.binders[a];(h instanceof jc||h instanceof Vc)&&i.push(...h.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return i}getBinderAttributes(){const i=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof ms||h instanceof _s)for(let m=0;m<h.paintVertexAttributes.length;m++)i.push(h.paintVertexAttributes[m].name);else if(h instanceof tl)for(let m=0;m<xr.members.length;m++)i.push(xr.members[m].name)}return i}getBinderUniforms(){const i=[];for(const a in this.binders){const h=this.binders[a];if(h instanceof jc||h instanceof Vc||h instanceof _s)for(const m of h.uniformNames)i.push(m)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i,a){const h=[];for(const m in this.binders){const w=this.binders[m];if(w instanceof jc||w instanceof Vc||w instanceof _s)for(const C of w.uniformNames)if(a[C]){const E=w.getBinding(i,a[C],C);h.push({name:C,property:m,binding:E})}}return h}setUniforms(i,a,h,m){for(const{name:w,property:C,binding:E}of a)this.binders[C].setUniform(E,m,h.get(C),w)}updatePaintBuffers(i){this._buffers=[];for(const a in this.binders){const h=this.binders[a];if(i&&h instanceof tl){const m=2===i.fromScale?h.zoomInPaintVertexBuffer:h.zoomOutPaintVertexBuffer;m&&this._buffers.push(m)}else(h instanceof ms||h instanceof _s)&&h.paintVertexBuffer&&this._buffers.push(h.paintVertexBuffer)}}upload(i){for(const a in this.binders){const h=this.binders[a];(h instanceof ms||h instanceof _s||h instanceof tl)&&h.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const a=this.binders[i];(a instanceof ms||a instanceof _s||a instanceof tl)&&a.destroy()}}}class Ei{constructor(i,a,h=()=>!0){this.programConfigurations={};for(const m of i)this.programConfigurations[m.id]=new Wi(m,a,h);this.needsUpload=!1,this._featureMap=new Fo,this._bufferOffset=0}populatePaintArrays(i,a,h,m,w,C){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(i,a,m,w,C);void 0!==a.id&&this._featureMap.add(a.id,h,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,a,h,m){for(const w of h)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(i,this._featureMap,a,w,m)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}function Hh(c,i){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[c]||[c.replace(`${i}-`,"").replace(/-/g,"_")]}function Wh(c,i,a){const m={"line-pattern":{source:Je,composite:Je},"fill-pattern":{source:Je,composite:Je},"fill-extrusion-pattern":{source:Je,composite:Je}}[c];return m&&m[a]||{color:{source:Au,composite:F},number:{source:x,composite:Au}}[i][a]}ht("ConstantBinder",jc),ht("CrossFadedConstantBinder",Vc),ht("SourceExpressionBinder",ms),ht("CrossFadedCompositeBinder",tl),ht("CompositeExpressionBinder",_s),ht("ProgramConfiguration",Wi,{omit:["_buffers"]}),ht("ProgramConfigurationSet",Ei);const Rd=Math.pow(2,14)-1,Od=-Rd-1;function nl(c){const i=an/c.extent,a=c.loadGeometry();for(let h=0;h<a.length;h++){const m=a[h];for(let w=0;w<m.length;w++){const C=m[w],E=Math.round(C.x*i),T=Math.round(C.y*i);C.x=Or(E,Od,Rd),C.y=Or(T,Od,Rd),(E<C.x||E>C.x+1||T<C.y||T>C.y+1)&&Le("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return a}function Ws(c,i){return{type:c.type,id:c.id,properties:c.properties,geometry:i?nl(c):[]}}function Mv(c,i,a,h,m){c.emplaceBack(8*i-32768+h,8*a-32768+m)}class Ig{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new Te,this.indexArray=new $n,this.segments=new tn,this.programConfigurations=new Ei(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(i,a,h){const m=this.layers[0],w=[];let C=null,E=!1,T="heatmap"===m.type;if("circle"===m.type){const L=m;C=L.layout.get("circle-sort-key"),E=!C.isConstant(),T=T||"map"===L.paint.get("circle-pitch-alignment")}const R=T?a.subdivisionGranularity.circle:1;for(const{feature:L,id:z,index:$,sourceLayerIndex:q}of i){const Z=this.layers[0]._featureFilter.needGeometry,Q=Ws(L,Z);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom,{globalState:this.globalState}),Q,h))continue;const ne=E?C.evaluate(Q,{},h):void 0,ce={id:z,properties:L.properties,type:L.type,sourceLayerIndex:q,index:$,geometry:Z?Q.geometry:nl(L),patterns:{},sortKey:ne};w.push(ce)}E&&w.sort((L,z)=>L.sortKey-z.sortKey);for(const L of w){const{geometry:z,index:$,sourceLayerIndex:q}=L,Z=i[$].feature;this.addFeature(L,z,$,h,R),a.featureIndex.insert(Z,z,$,q,this.index)}}update(i,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Dr),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,a,h,m,w=1){let C;switch(w){case 1:C=[0,7];break;case 3:C=[0,2,5,7];break;case 5:C=[0,1,3,4,6,7];break;case 7:C=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${w}; valid values are 1, 3, 5, 7.`)}const E=C.length;for(const T of a)for(const R of T){const L=R.x,z=R.y;if(L<0||L>=an||z<0||z>=an)continue;const $=this.segments.prepareSegment(E*E,this.layoutVertexArray,this.indexArray,i.sortKey),q=$.vertexLength;for(let Z=0;Z<E;Z++)for(let Q=0;Q<E;Q++)Mv(this.layoutVertexArray,L,z,C[Q],C[Z]);for(let Z=0;Z<E-1;Z++)for(let Q=0;Q<E-1;Q++){const ne=q+Z*E+Q,ce=q+(Z+1)*E+Q;this.indexArray.emplaceBack(ne,ce+1,ne+1),this.indexArray.emplaceBack(ne,ce,ce+1)}$.vertexLength+=E*E,$.primitiveLength+=(E-1)*(E-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,{},m)}}function Hn(c,i){for(let a=0;a<c.length;a++)if(ku(i,c[a]))return!0;for(let a=0;a<i.length;a++)if(ku(c,i[a]))return!0;return!!Nd(c,i)}function Dg(c,i,a){return!!ku(c,i)||!!$f(i,c,a)}function Ag(c,i){if(1===c.length)return Ld(i,c[0]);for(let a=0;a<i.length;a++){const h=i[a];for(let m=0;m<h.length;m++)if(ku(c,h[m]))return!0}for(let a=0;a<c.length;a++)if(Ld(i,c[a]))return!0;for(let a=0;a<i.length;a++)if(Nd(c,i[a]))return!0;return!1}function Pg(c,i,a){if(c.length>1){if(Nd(c,i))return!0;for(let h=0;h<i.length;h++)if($f(i[h],c,a))return!0}for(let h=0;h<c.length;h++)if($f(c[h],i,a))return!0;return!1}function Nd(c,i){if(0===c.length||0===i.length)return!1;for(let a=0;a<c.length-1;a++){const h=c[a],m=c[a+1];for(let w=0;w<i.length-1;w++)if(Pu(h,m,i[w],i[w+1]))return!0}return!1}function Pu(c,i,a,h){return gt(c,a,h)!==gt(i,a,h)&&gt(c,i,a)!==gt(c,i,h)}function $f(c,i,a){const h=a*a;if(1===i.length)return c.distSqr(i[0])<h;for(let m=1;m<i.length;m++)if(kg(c,i[m-1],i[m])<h)return!0;return!1}function kg(c,i,a){const h=i.distSqr(a);if(0===h)return c.distSqr(i);const m=((c.x-i.x)*(a.x-i.x)+(c.y-i.y)*(a.y-i.y))/h;return c.distSqr(m<0?i:m>1?a:a.sub(i)._mult(m)._add(i))}function Ld(c,i){let a,h,m,w=!1;for(let C=0;C<c.length;C++){a=c[C];for(let E=0,T=a.length-1;E<a.length;T=E++)h=a[E],m=a[T],h.y>i.y!=m.y>i.y&&i.x<(m.x-h.x)*(i.y-h.y)/(m.y-h.y)+h.x&&(w=!w)}return w}function ku(c,i){let a=!1;for(let h=0,m=c.length-1;h<c.length;m=h++){const w=c[h],C=c[m];w.y>i.y!=C.y>i.y&&i.x<(C.x-w.x)*(i.y-w.y)/(C.y-w.y)+w.x&&(a=!a)}return a}function Tv(c,i,a){const h=a[0],m=a[2];if(c.x<h.x&&i.x<h.x||c.x>m.x&&i.x>m.x||c.y<h.y&&i.y<h.y||c.y>m.y&&i.y>m.y)return!1;const w=gt(c,i,a[0]);return w!==gt(c,i,a[1])||w!==gt(c,i,a[2])||w!==gt(c,i,a[3])}function qh(c,i,a){const h=i.paint.get(c).value;return"constant"===h.kind?h.value:a.programConfigurations.get(i.id).getMaxValue(c)}function Zh(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function Fd(c,i,a,h,m){if(!i[0]&&!i[1])return c;const w=Ye.convert(i)._mult(m);"viewport"===a&&w._rotate(-h);const C=[];for(let E=0;E<c.length;E++)C.push(c[E].sub(w));return C}let N0,Rg;ht("CircleBucket",Ig,{omit:["layers"]});var Hf={get paint(){return Rg=Rg||new ft({"circle-radius":new G(Me.paint_circle["circle-radius"]),"circle-color":new G(Me.paint_circle["circle-color"]),"circle-blur":new G(Me.paint_circle["circle-blur"]),"circle-opacity":new G(Me.paint_circle["circle-opacity"]),"circle-translate":new k(Me.paint_circle["circle-translate"]),"circle-translate-anchor":new k(Me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new k(Me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new k(Me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new G(Me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new G(Me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new G(Me.paint_circle["circle-stroke-opacity"])})},get layout(){return N0=N0||new ft({"circle-sort-key":new G(Me.layout_circle["circle-sort-key"])})}};class Iv extends Kn{constructor(i){super(i,Hf)}createBucket(i){return new Ig(i)}queryRadius(i){const a=i;return qh("circle-radius",this,a)+qh("circle-stroke-width",this,a)+Zh(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:i,feature:a,featureState:h,geometry:m,transform:w,pixelsToTileUnits:C,unwrappedTileID:E,getElevation:T}){const R=Fd(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-w.bearingInRadians,C),L=this.paint.get("circle-radius").evaluate(a,h)+this.paint.get("circle-stroke-width").evaluate(a,h),z="map"===this.paint.get("circle-pitch-alignment"),$=z?R:(Q=w,ne=E,ce=T,R.map(Se=>Wf(Se,Q,ne,ce))),q=z?L*C:L;var Q,ne,ce;for(const Z of m)for(const Q of Z){const ne=z?Q:Wf(Q,w,E,T);let ce=q;const Se=w.projectTileCoordinates(Q.x,Q.y,E,T).signedDistanceFromCamera;if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?ce*=Se/w.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(ce*=w.cameraToCenterDistance/Se),Dg($,ne,ce))return!0}return!1}}function Wf(c,i,a,h){const m=i.projectTileCoordinates(c.x,c.y,a,h).point;return new Ye((.5*m.x+.5)*i.width,(.5*-m.y+.5)*i.height)}class Bd extends Ig{}let qf;ht("HeatmapBucket",Bd,{omit:["layers"]});var qi={get paint(){return qf=qf||new ft({"heatmap-radius":new G(Me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new G(Me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new k(Me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new He(Me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new k(Me.paint_heatmap["heatmap-opacity"])})}};function Zf(c,{width:i,height:a},h,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==i*a*h)throw new RangeError(`mismatched image size. expected: ${m.length} but got: ${i*a*h}`)}else m=new Uint8Array(i*a*h);return c.width=i,c.height=a,c.data=m,c}function Yh(c,{width:i,height:a},h){if(i===c.width&&a===c.height)return;const m=Zf({},{width:i,height:a},h);Ru(c,m,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,i),height:Math.min(c.height,a)},h),c.width=i,c.height=a,c.data=m.data}function Ru(c,i,a,h,m,w){if(0===m.width||0===m.height)return i;if(m.width>c.width||m.height>c.height||a.x>c.width-m.width||a.y>c.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>i.width||m.height>i.height||h.x>i.width-m.width||h.y>i.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const C=c.data,E=i.data;if(C===E)throw new Error("srcData equals dstData, so image is already copied");for(let T=0;T<m.height;T++){const R=((a.y+T)*c.width+a.x)*w,L=((h.y+T)*i.width+h.x)*w;for(let z=0;z<m.width*w;z++)E[L+z]=C[R+z]}return i}class qs{constructor(i,a){Zf(this,i,1,a)}resize(i){Yh(this,i,1)}clone(){return new qs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,a,h,m,w){Ru(i,a,h,m,w,1)}}class qo{constructor(i,a){Zf(this,i,4,a)}resize(i){Yh(this,i,4)}replace(i,a){a?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new qo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,a,h,m,w){Ru(i,a,h,m,w,4)}setPixel(i,a,h){const m=4*(i*this.width+a);this.data[m+0]=Math.round(255*h.r/h.a),this.data[m+1]=Math.round(255*h.g/h.a),this.data[m+2]=Math.round(255*h.b/h.a),this.data[m+3]=Math.round(255*h.a)}}function Yf(c){const i={},a=c.resolution||256,h=c.clips?c.clips.length:1,m=c.image||new qo({width:a,height:h});if(Math.log(a)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${a}`);const w=(C,E,T)=>{i[c.evaluationKey]=T;const R=c.expression.evaluate(i);m.setPixel(C/4/a,E/4,R)};if(c.clips)for(let C=0,E=0;C<h;++C,E+=4*a)for(let T=0,R=0;T<a;T++,R+=4){const L=T/(a-1),{start:z,end:$}=c.clips[C];w(E,R,z*(1-L)+$*L)}else for(let C=0,E=0;C<a;C++,E+=4)w(0,E,C/(a-1));return m}ht("AlphaImage",qs),ht("RGBAImage",qo);const Og="big-fb";class zd extends Kn{createBucket(i){return new Bd(i)}constructor(i){super(i,qi),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){"heatmap-color"===i&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Yf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Og)&&this.heatmapFbos.delete(Og)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}}let Ng;var Dv={get paint(){return Ng=Ng||new ft({"hillshade-illumination-direction":new k(Me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-altitude":new k(Me.paint_hillshade["hillshade-illumination-altitude"]),"hillshade-illumination-anchor":new k(Me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new k(Me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new k(Me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new k(Me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new k(Me.paint_hillshade["hillshade-accent-color"]),"hillshade-method":new k(Me.paint_hillshade["hillshade-method"])})}};class L0 extends Kn{constructor(i){super(i,Dv),this.recalculate({zoom:0,zoomHistory:{}},void 0)}getIlluminationProperties(){let i=this.paint.get("hillshade-illumination-direction").values,a=this.paint.get("hillshade-illumination-altitude").values,h=this.paint.get("hillshade-highlight-color").values,m=this.paint.get("hillshade-shadow-color").values;const w=Math.max(i.length,a.length,h.length,m.length);i=i.concat(Array(w-i.length).fill(i.at(-1))),a=a.concat(Array(w-a.length).fill(a.at(-1))),h=h.concat(Array(w-h.length).fill(h.at(-1))),m=m.concat(Array(w-m.length).fill(m.at(-1)));const C=a.map(ci);return{directionRadians:i.map(ci),altitudeRadians:C,shadowColor:m,highlightColor:h}}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}}let F0;var Lg={get paint(){return F0=F0||new ft({"color-relief-opacity":new k(Me["paint_color-relief"]["color-relief-opacity"]),"color-relief-color":new He(Me["paint_color-relief"]["color-relief-color"])})}};class Ou{constructor(i,a,h,m){this.context=i,this.format=h,this.texture=i.gl.createTexture(),this.update(a,m)}update(i,a,h){const{width:m,height:w}=i,C=!(this.size&&this.size[0]===m&&this.size[1]===w||h),{context:E}=this,{gl:T}=E;if(this.useMipmap=!(!a||!a.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!a||!1!==a.premultiply)),C)this.size=[m,w],i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||bn(i)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,i):T.texImage2D(T.TEXTURE_2D,0,this.format,m,w,0,this.format,T.UNSIGNED_BYTE,i.data);else{const{x:R,y:L}=h||{x:0,y:0};i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||bn(i)?T.texSubImage2D(T.TEXTURE_2D,0,R,L,T.RGBA,T.UNSIGNED_BYTE,i):T.texSubImage2D(T.TEXTURE_2D,0,R,L,m,w,T.RGBA,T.UNSIGNED_BYTE,i.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D),E.pixelStoreUnpackFlipY.setDefault(),E.pixelStoreUnpack.setDefault(),E.pixelStoreUnpackPremultiplyAlpha.setDefault()}bind(i,a,h){const{context:m}=this,{gl:w}=m;w.bindTexture(w.TEXTURE_2D,this.texture),h!==w.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(h=w.LINEAR),i!==this.filter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,i),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,h||i),this.filter=i),a!==this.wrap&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,a),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class Kf{constructor(i,a,h,m=1,w=1,C=1,E=0){if(this.uid=i,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(h&&!["mapbox","terrarium","custom"].includes(h))return void Le(`"${h}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=a.height;const T=this.dim=a.height-2;switch(this.data=new Uint32Array(a.data.buffer),h){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=m,this.greenFactor=w,this.blueFactor=C,this.baseShift=E;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let R=0;R<T;R++)this.data[this._idx(-1,R)]=this.data[this._idx(0,R)],this.data[this._idx(T,R)]=this.data[this._idx(T-1,R)],this.data[this._idx(R,-1)]=this.data[this._idx(R,0)],this.data[this._idx(R,T)]=this.data[this._idx(R,T-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(T,-1)]=this.data[this._idx(T-1,0)],this.data[this._idx(-1,T)]=this.data[this._idx(0,T-1)],this.data[this._idx(T,T)]=this.data[this._idx(T-1,T-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let R=0;R<T;R++)for(let L=0;L<T;L++){const z=this.get(R,L);z>this.max&&(this.max=z),z<this.min&&(this.min=z)}}get(i,a){const h=new Uint8Array(this.data.buffer),m=4*this._idx(i,a);return this.unpack(h[m],h[m+1],h[m+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(i,a){if(i<-1||i>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(i+1)}unpack(i,a,h){return i*this.redFactor+a*this.greenFactor+h*this.blueFactor-this.baseShift}pack(i){return B0(i,this.getUnpackVector())}getPixels(){return new qo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(i,a,h){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let m=a*this.dim,w=a*this.dim+this.dim,C=h*this.dim,E=h*this.dim+this.dim;switch(a){case-1:m=w-1;break;case 1:w=m+1}switch(h){case-1:C=E-1;break;case 1:E=C+1}const T=-a*this.dim,R=-h*this.dim;for(let L=C;L<E;L++)for(let z=m;z<w;z++)this.data[this._idx(z,L)]=i.data[this._idx(z+T,L+R)]}}function B0(c,i){const a=i[0],h=i[1],m=i[2],w=i[3],C=Math.min(a,h,m),E=Math.round((c+w)/C);return{r:Math.floor(E*C/a)%256,g:Math.floor(E*C/h)%256,b:Math.floor(E*C/m)%256}}ht("DEMData",Kf);class Av extends Kn{constructor(i){super(i,Lg)}_createColorRamp(i){const a={elevationStops:[],colorStops:[]},h=this._transitionablePaint._values["color-relief-color"].value.expression;if(h instanceof Rl&&h._styleExpression.expression instanceof vr){this.colorRampExpression=h;const C=h._styleExpression.expression;a.elevationStops=C.labels,a.colorStops=[];for(const E of a.elevationStops)a.colorStops.push(C.evaluate({globals:{elevation:E}}))}if(a.elevationStops.length<1&&(a.elevationStops=[0],a.colorStops=[Qt.transparent]),a.elevationStops.length<2&&(a.elevationStops.push(a.elevationStops[0]+1),a.colorStops.push(a.colorStops[0])),a.elevationStops.length<=i)return a;const m={elevationStops:[],colorStops:[]},w=(a.elevationStops.length-1)/(i-1);for(let C=0;C<a.elevationStops.length-.5;C+=w)m.elevationStops.push(a.elevationStops[Math.round(C)]),m.colorStops.push(a.colorStops[Math.round(C)]);return Le(`Too many colors in specification of ${this.id} color-relief layer, may not render properly.`),m}_colorRampChanged(){return this.colorRampExpression!=this._transitionablePaint._values["color-relief-color"].value.expression}getColorRampTextures(i,a,h){if(this.colorRampTextures&&!this._colorRampChanged())return this.colorRampTextures;const m=this._createColorRamp(a),w=new qo({width:m.colorStops.length,height:1}),C=new qo({width:m.colorStops.length,height:1});for(let E=0;E<m.elevationStops.length;E++){const T=B0(m.elevationStops[E],h);C.setPixel(0,E,new Qt(T.r/255,T.g/255,T.b/255,1)),w.setPixel(0,E,m.colorStops[E])}return this.colorRampTextures={elevationTexture:new Ou(i,C,i.gl.RGBA),colorTexture:new Ou(i,w,i.gl.RGBA)},this.colorRampTextures}hasOffscreenPass(){return"none"!==this.visibility&&!!this.colorRampTextures}}const Fg=hr([{name:"a_pos",components:2,type:"Int16"}],4),{members:z0}=Fg;function Xf(c,i,a){const h=a.patternDependencies;let m=!1;for(const w of i){const C=w.paint.get(`${c}-pattern`);C.isConstant()||(m=!0);const E=C.constantOr(null);E&&(m=!0,h[E.to]=!0,h[E.from]=!0)}return m}function Qf(c,i,a,h,m){const w=m.patternDependencies;for(const C of i){const E=C.paint.get(`${c}-pattern`).value;if("constant"!==E.kind){let T=E.evaluate({zoom:h-1},a,{},m.availableImages),R=E.evaluate({zoom:h},a,{},m.availableImages),L=E.evaluate({zoom:h+1},a,{},m.availableImages);T=T&&T.name?T.name:T,R=R&&R.name?R.name:R,L=L&&L.name?L.name:L,w[T]=!0,w[R]=!0,w[L]=!0,a.patterns[C.id]={min:T,mid:R,max:L}}}return a}function Bg(c,i,a,h,m){let w;if(m===function(C,E,T,R){let L=0;for(let z=E,$=T-R;z<T;z+=R)L+=(C[$]-C[z])*(C[z+1]+C[$+1]),$=z;return L}(c,i,a,h)>0)for(let C=i;C<a;C+=h)w=op(C/h|0,c[C],c[C+1],w);else for(let C=a-h;C>=i;C-=h)w=op(C/h|0,c[C],c[C+1],w);return w&&Ud(w,w.next)&&(Lu(w),w=w.next),w}function Gl(c,i){if(!c)return c;i||(i=c);let a,h=c;do{if(a=!1,h.steiner||!Ud(h,h.next)&&0!==tr(h.prev,h,h.next))h=h.next;else{if(Lu(h),h=i=h.prev,h===h.next)break;a=!0}}while(a||h!==i);return i}function jd(c,i,a,h,m,w,C){if(!c)return;!C&&w&&function(T,R,L,z){let $=T;do{0===$.z&&($.z=ep($.x,$.y,R,L,z)),$.prevZ=$.prev,$.nextZ=$.next,$=$.next}while($!==T);$.prevZ.nextZ=null,$.prevZ=null,function(q){let Z,Q=1;do{let ne,ce=q;q=null;let Se=null;for(Z=0;ce;){Z++;let ge=ce,ye=0;for(let je=0;je<Q&&(ye++,ge=ge.nextZ,ge);je++);let Re=Q;for(;ye>0||Re>0&&ge;)0!==ye&&(0===Re||!ge||ce.z<=ge.z)?(ne=ce,ce=ce.nextZ,ye--):(ne=ge,ge=ge.nextZ,Re--),Se?Se.nextZ=ne:q=ne,ne.prevZ=Se,Se=ne;ce=ge}Se.nextZ=null,Q*=2}while(Z>1)}($)}(c,h,m,w);let E=c;for(;c.prev!==c.next;){const T=c.prev,R=c.next;if(w?Nu(c,h,m,w):zg(c))i.push(T.i,c.i,R.i),Lu(c),c=R.next,E=R.next;else if((c=R)===E){C?1===C?jd(c=j0(Gl(c),i),i,a,h,m,w,2):2===C&&jg(c,i,a,h,m,w):jd(Gl(c),i,a,h,m,w,1);break}}}function zg(c){const i=c.prev,a=c,h=c.next;if(tr(i,a,h)>=0)return!1;const m=i.x,w=a.x,C=h.x,E=i.y,T=a.y,R=h.y,L=Math.min(m,w,C),z=Math.min(E,T,R),$=Math.max(m,w,C),q=Math.max(E,T,R);let Z=h.next;for(;Z!==i;){if(Z.x>=L&&Z.x<=$&&Z.y>=z&&Z.y<=q&&Vd(m,E,w,T,C,R,Z.x,Z.y)&&tr(Z.prev,Z,Z.next)>=0)return!1;Z=Z.next}return!0}function Nu(c,i,a,h){const m=c.prev,w=c,C=c.next;if(tr(m,w,C)>=0)return!1;const E=m.x,T=w.x,R=C.x,L=m.y,z=w.y,$=C.y,q=Math.min(E,T,R),Z=Math.min(L,z,$),Q=Math.max(E,T,R),ne=Math.max(L,z,$),ce=ep(q,Z,i,a,h),Se=ep(Q,ne,i,a,h);let ge=c.prevZ,ye=c.nextZ;for(;ge&&ge.z>=ce&&ye&&ye.z<=Se;){if(ge.x>=q&&ge.x<=Q&&ge.y>=Z&&ge.y<=ne&&ge!==m&&ge!==C&&Vd(E,L,T,z,R,$,ge.x,ge.y)&&tr(ge.prev,ge,ge.next)>=0||(ge=ge.prevZ,ye.x>=q&&ye.x<=Q&&ye.y>=Z&&ye.y<=ne&&ye!==m&&ye!==C&&Vd(E,L,T,z,R,$,ye.x,ye.y)&&tr(ye.prev,ye,ye.next)>=0))return!1;ye=ye.nextZ}for(;ge&&ge.z>=ce;){if(ge.x>=q&&ge.x<=Q&&ge.y>=Z&&ge.y<=ne&&ge!==m&&ge!==C&&Vd(E,L,T,z,R,$,ge.x,ge.y)&&tr(ge.prev,ge,ge.next)>=0)return!1;ge=ge.prevZ}for(;ye&&ye.z<=Se;){if(ye.x>=q&&ye.x<=Q&&ye.y>=Z&&ye.y<=ne&&ye!==m&&ye!==C&&Vd(E,L,T,z,R,$,ye.x,ye.y)&&tr(ye.prev,ye,ye.next)>=0)return!1;ye=ye.nextZ}return!0}function j0(c,i){let a=c;do{const h=a.prev,m=a.next.next;!Ud(h,m)&&U0(h,a,a.next,m)&&rp(h,m)&&rp(m,h)&&(i.push(h.i,a.i,m.i),Lu(a),Lu(a.next),a=c=m),a=a.next}while(a!==c);return Gl(a)}function jg(c,i,a,h,m,w){let C=c;do{let E=C.next.next;for(;E!==C.prev;){if(C.i!==E.i&&tp(C,E)){let T=G0(C,E);return C=Gl(C,C.next),T=Gl(T,T.next),jd(C,i,a,h,m,w,0),void jd(T,i,a,h,m,w,0)}E=E.next}C=C.next}while(C!==c)}function Vg(c,i){let a=c.x-i.x;return 0===a&&(a=c.y-i.y,0===a)&&(a=(c.next.y-c.y)/(c.next.x-c.x)-(i.next.y-i.y)/(i.next.x-i.x)),a}function Jf(c,i){const a=function(m,w){let C=w;const E=m.x,T=m.y;let R,L=-1/0;if(Ud(m,C))return C;do{if(Ud(m,C.next))return C.next;if(T<=C.y&&T>=C.next.y&&C.next.y!==C.y){const Q=C.x+(T-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(Q<=E&&Q>L&&(L=Q,R=C.x<C.next.x?C:C.next,Q===E))return R}C=C.next}while(C!==w);if(!R)return null;const z=R,$=R.x,q=R.y;let Z=1/0;C=R;do{if(E>=C.x&&C.x>=$&&E!==C.x&&V0(T<q?E:L,T,$,q,T<q?L:E,T,C.x,C.y)){const Q=Math.abs(T-C.y)/(E-C.x);rp(C,m)&&(Q<Z||Q===Z&&(C.x>R.x||C.x===R.x&&Pv(R,C)))&&(R=C,Z=Q)}C=C.next}while(C!==z);return R}(c,i);if(!a)return i;const h=G0(a,c);return Gl(h,h.next),Gl(a,a.next)}function Pv(c,i){return tr(c.prev,c,i.prev)<0&&tr(i.next,c,c.next)<0}function ep(c,i,a,h,m){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-a)*m|0)|c<<8))|c<<4))|c<<2))|c<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-h)*m|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function kv(c){let i=c,a=c;do{(i.x<a.x||i.x===a.x&&i.y<a.y)&&(a=i),i=i.next}while(i!==c);return a}function V0(c,i,a,h,m,w,C,E){return(m-C)*(i-E)>=(c-C)*(w-E)&&(c-C)*(h-E)>=(a-C)*(i-E)&&(a-C)*(w-E)>=(m-C)*(h-E)}function Vd(c,i,a,h,m,w,C,E){return!(c===C&&i===E)&&V0(c,i,a,h,m,w,C,E)}function tp(c,i){return c.next.i!==i.i&&c.prev.i!==i.i&&!function(a,h){let m=a;do{if(m.i!==a.i&&m.next.i!==a.i&&m.i!==h.i&&m.next.i!==h.i&&U0(m,m.next,a,h))return!0;m=m.next}while(m!==a);return!1}(c,i)&&(rp(c,i)&&rp(i,c)&&function(a,h){let m=a,w=!1;const C=(a.x+h.x)/2,E=(a.y+h.y)/2;do{m.y>E!=m.next.y>E&&m.next.y!==m.y&&C<(m.next.x-m.x)*(E-m.y)/(m.next.y-m.y)+m.x&&(w=!w),m=m.next}while(m!==a);return w}(c,i)&&(tr(c.prev,c,i.prev)||tr(c,i.prev,i))||Ud(c,i)&&tr(c.prev,c,c.next)>0&&tr(i.prev,i,i.next)>0)}function tr(c,i,a){return(i.y-c.y)*(a.x-i.x)-(i.x-c.x)*(a.y-i.y)}function Ud(c,i){return c.x===i.x&&c.y===i.y}function U0(c,i,a,h){const m=np(tr(c,i,a)),w=np(tr(c,i,h)),C=np(tr(a,h,c)),E=np(tr(a,h,i));return m!==w&&C!==E||!(0!==m||!Kh(c,a,i))||!(0!==w||!Kh(c,h,i))||!(0!==C||!Kh(a,c,h))||!(0!==E||!Kh(a,i,h))}function Kh(c,i,a){return i.x<=Math.max(c.x,a.x)&&i.x>=Math.min(c.x,a.x)&&i.y<=Math.max(c.y,a.y)&&i.y>=Math.min(c.y,a.y)}function np(c){return c>0?1:c<0?-1:0}function rp(c,i){return tr(c.prev,c,c.next)<0?tr(c,i,c.next)>=0&&tr(c,c.prev,i)>=0:tr(c,i,c.prev)<0||tr(c,c.next,i)<0}function G0(c,i){const a=ip(c.i,c.x,c.y),h=ip(i.i,i.x,i.y),m=c.next,w=i.prev;return c.next=i,i.prev=c,a.next=m,m.prev=a,h.next=a,a.prev=h,w.next=h,h.prev=w,h}function op(c,i,a,h){const m=ip(c,i,a);return h?(m.next=h.next,m.prev=h,h.next.prev=m,h.next=m):(m.prev=m,m.next=m),m}function Lu(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function ip(c,i,a){return{i:c,x:i,y:a,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Fu{constructor(i,a){if(a>i)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=i,this._minGranularity=a}getGranularityForZoomLevel(i){return Math.max(Math.floor(this._baseZoomGranularity/(1<<i)),this._minGranularity,1)}}class Ug{constructor(i){this.fill=i.fill,this.line=i.line,this.tile=i.tile,this.stencil=i.stencil,this.circle=i.circle}}Ug.noSubdivision=new Ug({fill:new Fu(0,0),line:new Fu(0,0),tile:new Fu(0,0),stencil:new Fu(0,0),circle:1}),ht("SubdivisionGranularityExpression",Fu),ht("SubdivisionGranularitySetting",Ug);const Gd=-32768,Xh=32767;class Rv{constructor(i,a){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=i,this._granularityCellSize=an/i,this._canonical=a}_getKey(i,a){return(i+=32768)<<16|a+32768}_vertexToIndex(i,a){if(i<-32768||a<-32768||i>32767||a>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const h=0|Math.round(i),m=0|Math.round(a),w=this._getKey(h,m);if(this._vertexDictionary.has(w))return this._vertexDictionary.get(w);const C=this._vertexBuffer.length/2;return this._vertexDictionary.set(w,C),this._vertexBuffer.push(h,m),C}_subdivideTrianglesScanline(i){if(this._granularity<2)return function(m,w){const C=[];for(let E=0;E<w.length;E+=3){const T=w[E],R=w[E+1],L=w[E+2],z=m[2*T],$=m[2*T+1];(m[2*R]-z)*(m[2*L+1]-$)-(m[2*R+1]-$)*(m[2*L]-z)>0?(C.push(T),C.push(L),C.push(R)):(C.push(T),C.push(R),C.push(L))}return C}(this._vertexBuffer,i);const a=[],h=i.length;for(let m=0;m<h;m+=3){const w=[i[m+0],i[m+1],i[m+2]],C=[this._vertexBuffer[2*i[m+0]+0],this._vertexBuffer[2*i[m+0]+1],this._vertexBuffer[2*i[m+1]+0],this._vertexBuffer[2*i[m+1]+1],this._vertexBuffer[2*i[m+2]+0],this._vertexBuffer[2*i[m+2]+1]];let E=1/0,T=1/0,R=-1/0,L=-1/0;for(let Q=0;Q<3;Q++){const ne=C[2*Q],ce=C[2*Q+1];E=Math.min(E,ne),R=Math.max(R,ne),T=Math.min(T,ce),L=Math.max(L,ce)}if(E===R||T===L)continue;const z=Math.floor(E/this._granularityCellSize),$=Math.ceil(R/this._granularityCellSize),q=Math.floor(T/this._granularityCellSize),Z=Math.ceil(L/this._granularityCellSize);if(z!==$||q!==Z)for(let Q=q;Q<Z;Q++){const ne=this._scanlineGenerateVertexRingForCellRow(Q,C,w);ap(this._vertexBuffer,ne,a)}else a.push(...w)}return a}_scanlineGenerateVertexRingForCellRow(i,a,h){const m=i*this._granularityCellSize,w=m+this._granularityCellSize,C=[];for(let E=0;E<3;E++){const T=a[2*E],R=a[2*E+1],L=a[2*(E+1)%6],z=a[(2*(E+1)+1)%6],$=a[2*(E+2)%6],q=a[(2*(E+2)+1)%6],Z=L-T,Q=z-R,ne=0===Z,ce=0===Q,Se=(m-R)/Q,ge=(w-R)/Q,ye=Math.min(Se,ge),Re=Math.max(Se,ge);if(!ce&&(ye>=1||Re<=0)||ce&&(R<m||R>w)){z>=m&&z<=w&&C.push(h[(E+1)%3]);continue}!ce&&ye>0&&C.push(this._vertexToIndex(T+Z*ye,R+Q*ye));const je=T+Z*Math.max(ye,0),Ze=T+Z*Math.min(Re,1);ne||this._generateIntraEdgeVertices(C,T,R,L,z,je,Ze),!ce&&Re<1&&C.push(this._vertexToIndex(T+Z*Re,R+Q*Re)),(ce||z>=m&&z<=w)&&C.push(h[(E+1)%3]),!ce&&(z<=m||z>=w)&&this._generateInterEdgeVertices(C,T,R,L,z,$,q,Ze,m,w)}return C}_generateIntraEdgeVertices(i,a,h,m,w,C,E){const T=m-a,R=w-h,L=0===R,z=L?Math.min(a,m):Math.min(C,E),$=L?Math.max(a,m):Math.max(C,E),q=Math.floor(z/this._granularityCellSize)+1,Z=Math.ceil($/this._granularityCellSize)-1;if(L?a<m:C<E)for(let Q=q;Q<=Z;Q++){const ne=Q*this._granularityCellSize;i.push(this._vertexToIndex(ne,h+R*(ne-a)/T))}else for(let Q=Z;Q>=q;Q--){const ne=Q*this._granularityCellSize;i.push(this._vertexToIndex(ne,h+R*(ne-a)/T))}}_generateInterEdgeVertices(i,a,h,m,w,C,E,T,R,L){const z=w-h,$=C-m,q=E-w,Z=(R-w)/q,Q=(L-w)/q,ne=Math.min(Z,Q),ce=Math.max(Z,Q),Se=m+$*ne;let ge=Math.floor(Math.min(Se,T)/this._granularityCellSize)+1,ye=Math.ceil(Math.max(Se,T)/this._granularityCellSize)-1,Re=T<Se;const je=0===q;if(je&&(E===R||E===L))return;if(je||ne>=1||ce<=0){const ut=h-E,et=C+(a-C)*Math.min((R-E)/ut,(L-E)/ut);ge=Math.floor(Math.min(et,T)/this._granularityCellSize)+1,ye=Math.ceil(Math.max(et,T)/this._granularityCellSize)-1,Re=T<et}const Ze=z>0?L:R;if(Re)for(let ut=ge;ut<=ye;ut++)i.push(this._vertexToIndex(ut*this._granularityCellSize,Ze));else for(let ut=ye;ut>=ge;ut--)i.push(this._vertexToIndex(ut*this._granularityCellSize,Ze))}_generateOutline(i){const a=[];for(const h of i){const m=Bu(h,this._granularity,!0),w=this._pointArrayToIndices(m),C=[];for(let E=1;E<w.length;E++)C.push(w[E-1]),C.push(w[E]);a.push(C)}return a}_handlePoles(i){let a=!1,h=!1;this._canonical&&(0===this._canonical.y&&(a=!0),this._canonical.y===(1<<this._canonical.z)-1&&(h=!0)),(a||h)&&this._fillPoles(i,a,h)}_ensureNoPoleVertices(){const i=this._vertexBuffer;for(let a=0;a<i.length;a+=2){const h=i[a+1];h===Gd&&(i[a+1]=-32767),h===Xh&&(i[a+1]=32766)}}_generatePoleQuad(i,a,h,m,w,C){m>w!=(C===Gd)?(i.push(a),i.push(h),i.push(this._vertexToIndex(m,C)),i.push(h),i.push(this._vertexToIndex(w,C)),i.push(this._vertexToIndex(m,C))):(i.push(h),i.push(a),i.push(this._vertexToIndex(m,C)),i.push(this._vertexToIndex(w,C)),i.push(h),i.push(this._vertexToIndex(m,C)))}_fillPoles(i,a,h){const m=this._vertexBuffer,w=an,C=i.length;for(let E=2;E<C;E+=3){const T=i[E-2],R=i[E-1],L=i[E],z=m[2*T],$=m[2*T+1],q=m[2*R],Z=m[2*R+1],Q=m[2*L],ne=m[2*L+1];a&&(0===$&&0===Z&&this._generatePoleQuad(i,T,R,z,q,Gd),0===Z&&0===ne&&this._generatePoleQuad(i,R,L,q,Q,Gd),0===ne&&0===$&&this._generatePoleQuad(i,L,T,Q,z,Gd)),h&&($===w&&Z===w&&this._generatePoleQuad(i,T,R,z,q,Xh),Z===w&&ne===w&&this._generatePoleQuad(i,R,L,q,Q,Xh),ne===w&&$===w&&this._generatePoleQuad(i,L,T,Q,z,Xh))}}_initializeVertices(i){for(let a=0;a<i.length;a+=2)this._vertexToIndex(i[a],i[a+1])}subdividePolygonInternal(i,a){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:h,holeIndices:m}=function(E){const T=[],R=[];for(const L of E)if(0!==L.length){L!==E[0]&&T.push(R.length/2);for(let z=0;z<L.length;z++)R.push(L[z].x),R.push(L[z].y)}return{flattened:R,holeIndices:T}}(i);let w;this._initializeVertices(h);try{const E=function(R,L,z=2){const $=L&&L.length,q=$?L[0]*z:R.length;let Z=Bg(R,0,q,z,!0);const Q=[];if(!Z||Z.next===Z.prev)return Q;let ne,ce,Se;if($&&(Z=function(ge,ye,Re,je){const Ze=[];for(let ut=0,et=ye.length;ut<et;ut++){const st=Bg(ge,ye[ut]*je,ut<et-1?ye[ut+1]*je:ge.length,je,!1);st===st.next&&(st.steiner=!0),Ze.push(kv(st))}Ze.sort(Vg);for(let ut=0;ut<Ze.length;ut++)Re=Jf(Ze[ut],Re);return Re}(R,L,Z,z)),R.length>80*z){ne=R[0],ce=R[1];let ge=ne,ye=ce;for(let Re=z;Re<q;Re+=z){const je=R[Re],Ze=R[Re+1];je<ne&&(ne=je),Ze<ce&&(ce=Ze),je>ge&&(ge=je),Ze>ye&&(ye=Ze)}Se=Math.max(ge-ne,ye-ce),Se=0!==Se?32767/Se:0}return jd(Z,Q,z,ne,ce,Se,0),Q}(h,m),T=this._convertIndices(h,E);w=this._subdivideTrianglesScanline(T)}catch(E){console.error(E)}let C=[];return a&&(C=this._generateOutline(i)),this._ensureNoPoleVertices(),this._handlePoles(w),{verticesFlattened:this._vertexBuffer,indicesTriangles:w,indicesLineList:C}}_convertIndices(i,a){const h=[];for(let m=0;m<a.length;m++)h.push(this._vertexToIndex(i[2*a[m]],i[2*a[m]+1]));return h}_pointArrayToIndices(i){const a=[];for(let h=0;h<i.length;h++){const m=i[h];a.push(this._vertexToIndex(m.x,m.y))}return a}}function sp(c,i,a,h=!0){return new Rv(a,i).subdividePolygonInternal(c,h)}function Bu(c,i,a=!1){if(!c||c.length<1)return[];if(c.length<2)return[];const h=c[0],m=c[c.length-1],w=a&&(h.x!==m.x||h.y!==m.y);if(i<2)return w?[...c,c[0]]:[...c];const C=Math.floor(an/i),E=[];E.push(new Ye(c[0].x,c[0].y));const T=c.length,R=w?T:T-1;for(let L=0;L<R;L++){const z=c[L],$=L<T-1?c[L+1]:c[0],q=z.x,Z=z.y,Q=$.x,ne=$.y,ce=q!==Q,Se=Z!==ne;if(!ce&&!Se)continue;const ge=Q-q,ye=ne-Z,Re=Math.abs(ge),je=Math.abs(ye);let Ze=q,ut=Z;for(;;){const st=ge>0?(Math.floor(Ze/C)+1)*C:(Math.ceil(Ze/C)-1)*C,Dt=ye>0?(Math.floor(ut/C)+1)*C:(Math.ceil(ut/C)-1)*C,Xe=Math.abs(Ze-st),rt=Math.abs(ut-Dt),ze=Math.abs(Ze-Q),Pt=Math.abs(ut-ne),Bt=ce?Xe/Re:Number.POSITIVE_INFINITY,Ct=Se?rt/je:Number.POSITIVE_INFINITY;if((ze<=Xe||!ce)&&(Pt<=rt||!Se))break;if(Bt<Ct&&ce||!Se){Ze=st,ut+=ye*Bt;const xt=new Ye(Ze,Math.round(ut));E[E.length-1].x===xt.x&&E[E.length-1].y===xt.y||E.push(xt)}else{Ze+=ge*Ct,ut=Dt;const xt=new Ye(Math.round(Ze),ut);E[E.length-1].x===xt.x&&E[E.length-1].y===xt.y||E.push(xt)}}const et=new Ye(Q,ne);E[E.length-1].x===et.x&&E[E.length-1].y===et.y||E.push(et)}return E}function ap(c,i,a){if(0===i.length)throw new Error("Subdivision vertex ring is empty.");let h=0,m=c[2*i[0]];for(let T=1;T<i.length;T++){const R=c[2*i[T]];R<m&&(m=R,h=T)}const w=i.length;let C=h,E=(C+1)%w;for(;;){const T=C-1>=0?C-1:w-1,R=(E+1)%w,L=c[2*i[T]],z=c[2*i[R]],$=c[2*i[C]],q=c[2*i[C]+1],Z=c[2*i[E]+1];let Q=!1;if(L<z)Q=!0;else if(L>z)Q=!1;else{const ne=Z-q,ce=-(c[2*i[E]]-$),Se=q<Z?1:-1;((L-$)*ne+(c[2*i[T]+1]-q)*ce)*Se>((z-$)*ne+(c[2*i[R]+1]-q)*ce)*Se&&(Q=!0)}if(Q){const ne=i[T],ce=i[C],Se=i[E];ne!==ce&&ne!==Se&&ce!==Se&&a.push(Se,ce,ne),C--,C<0&&(C=w-1)}else{const ne=i[R],ce=i[C],Se=i[E];ne!==ce&&ne!==Se&&ce!==Se&&a.push(Se,ce,ne),E++,E>=w&&(E=0)}if(T===R)break}}function $0(c,i,a,h,m,w,C,E,T){const R=m.length/2,L=C&&E&&T;if(R<tn.MAX_VERTEX_ARRAY_LENGTH){const z=i.prepareSegment(R,a,h),$=z.vertexLength;for(let Q=0;Q<w.length;Q+=3)h.emplaceBack($+w[Q],$+w[Q+1],$+w[Q+2]);let q,Z;z.vertexLength+=R,z.primitiveLength+=w.length/3,L&&(Z=C.prepareSegment(R,a,E),q=Z.vertexLength,Z.vertexLength+=R);for(let Q=0;Q<m.length;Q+=2)c(m[Q],m[Q+1]);if(L)for(let Q=0;Q<T.length;Q++){const ne=T[Q];for(let ce=1;ce<ne.length;ce+=2)E.emplaceBack(q+ne[ce-1],q+ne[ce]);Z.primitiveLength+=ne.length/2}}else(function(z,$,q,Z,Q,ne){const ce=[];for(let je=0;je<Z.length/2;je++)ce.push(-1);const Se={count:0};let ge=0,ye=z.getOrCreateLatestSegment($,q),Re=ye.vertexLength;for(let je=2;je<Q.length;je+=3){const Ze=Q[je-2],ut=Q[je-1],et=Q[je];let st=ce[Ze]<ge,Dt=ce[ut]<ge,Xe=ce[et]<ge;ye.vertexLength+((st?1:0)+(Dt?1:0)+(Xe?1:0))>tn.MAX_VERTEX_ARRAY_LENGTH&&(ye=z.createNewSegment($,q),ge=Se.count,st=!0,Dt=!0,Xe=!0,Re=0);const rt=Uc(ce,Z,ne,Se,Ze,st,ye),ze=Uc(ce,Z,ne,Se,ut,Dt,ye),Pt=Uc(ce,Z,ne,Se,et,Xe,ye);q.emplaceBack(Re+rt-ge,Re+ze-ge,Re+Pt-ge),ye.primitiveLength++}})(i,a,h,m,w,c),L&&function(z,$,q,Z,Q,ne){const ce=[];for(let je=0;je<Z.length/2;je++)ce.push(-1);const Se={count:0};let ge=0,ye=z.getOrCreateLatestSegment($,q),Re=ye.vertexLength;for(let je=0;je<Q.length;je++){const Ze=Q[je];for(let ut=1;ut<Q[je].length;ut+=2){const et=Ze[ut-1],st=Ze[ut];let Dt=ce[et]<ge,Xe=ce[st]<ge;ye.vertexLength+((Dt?1:0)+(Xe?1:0))>tn.MAX_VERTEX_ARRAY_LENGTH&&(ye=z.createNewSegment($,q),ge=Se.count,Dt=!0,Xe=!0,Re=0);const rt=Uc(ce,Z,ne,Se,et,Dt,ye),ze=Uc(ce,Z,ne,Se,st,Xe,ye);q.emplaceBack(Re+rt-ge,Re+ze-ge),ye.primitiveLength++}}}(C,a,E,m,T,c),i.forceNewSegmentOnNextPrepare(),C?.forceNewSegmentOnNextPrepare()}function Uc(c,i,a,h,m,w,C){if(w){const E=h.count;return a(i[2*m],i[2*m+1]),c[m]=h.count,h.count++,C.vertexLength++,E}return c[m]}class $d{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Be,this.indexArray=new $n,this.indexArray2=new Bn,this.programConfigurations=new Ei(i.layers,i.zoom),this.segments=new tn,this.segments2=new tn,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(i,a,h){this.hasPattern=Xf("fill",this.layers,a);const m=this.layers[0].layout.get("fill-sort-key"),w=!m.isConstant(),C=[];for(const{feature:E,id:T,index:R,sourceLayerIndex:L}of i){const z=this.layers[0]._featureFilter.needGeometry,$=Ws(E,z);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom,{globalState:this.globalState}),$,h))continue;const q=w?m.evaluate($,{},h,a.availableImages):void 0,Z={id:T,properties:E.properties,type:E.type,sourceLayerIndex:L,index:R,geometry:z?$.geometry:nl(E),patterns:{},sortKey:q};C.push(Z)}w&&C.sort((E,T)=>E.sortKey-T.sortKey);for(const E of C){const{geometry:T,index:R,sourceLayerIndex:L}=E;if(this.hasPattern){const z=Qf("fill",this.layers,E,this.zoom,a);this.patternFeatures.push(z)}else this.addFeature(E,T,R,h,{},a.subdivisionGranularity);a.featureIndex.insert(i[R].feature,T,R,L,this.index)}}update(i,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,h)}addFeatures(i,a,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,a,h,i.subdivisionGranularity)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,z0),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,a,h,m,w,C){for(const E of fa(a,500)){const T=sp(E,m,C.fill.getGranularityForZoomLevel(m.z)),R=this.layoutVertexArray;$0((L,z)=>{R.emplaceBack(L,z)},this.segments,this.layoutVertexArray,this.indexArray,T.verticesFlattened,T.indicesTriangles,this.segments2,this.indexArray2,T.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,w,m)}}let Ov,Gg;ht("FillBucket",$d,{omit:["layers","patternFeatures"]});var $g={get paint(){return Gg=Gg||new ft({"fill-antialias":new k(Me.paint_fill["fill-antialias"]),"fill-opacity":new G(Me.paint_fill["fill-opacity"]),"fill-color":new G(Me.paint_fill["fill-color"]),"fill-outline-color":new G(Me.paint_fill["fill-outline-color"]),"fill-translate":new k(Me.paint_fill["fill-translate"]),"fill-translate-anchor":new k(Me.paint_fill["fill-translate-anchor"]),"fill-pattern":new ae(Me.paint_fill["fill-pattern"])})},get layout(){return Ov=Ov||new ft({"fill-sort-key":new G(Me.layout_fill["fill-sort-key"])})}};class lp extends Kn{constructor(i){super(i,$g)}recalculate(i,a){super.recalculate(i,a);const h=this.paint._values["fill-outline-color"];"constant"===h.value.kind&&void 0===h.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new $d(i)}queryRadius(){return Zh(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:i,geometry:a,transform:h,pixelsToTileUnits:m}){return Ag(Fd(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-h.bearingInRadians,m),a)}isTileClipped(){return!0}}const Nv=hr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Lv=hr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Fv}=Nv;class $l{constructor(i,a,h,m,w){this.properties={},this.extent=h,this.type=0,this.id=void 0,this._pbf=i,this._geometry=-1,this._keys=m,this._values=w,i.readFields(Bv,this,a)}loadGeometry(){const i=this._pbf;i.pos=this._geometry;const a=i.readVarint()+i.pos,h=[];let m,w=1,C=0,E=0,T=0;for(;i.pos<a;){if(C<=0){const R=i.readVarint();w=7&R,C=R>>3}if(C--,1===w||2===w)E+=i.readSVarint(),T+=i.readSVarint(),1===w&&(m&&h.push(m),m=[]),m&&m.push(new Ye(E,T));else{if(7!==w)throw new Error(`unknown command ${w}`);m&&m.push(m[0].clone())}}return m&&h.push(m),h}bbox(){const i=this._pbf;i.pos=this._geometry;const a=i.readVarint()+i.pos;let h=1,m=0,w=0,C=0,E=1/0,T=-1/0,R=1/0,L=-1/0;for(;i.pos<a;){if(m<=0){const z=i.readVarint();h=7&z,m=z>>3}if(m--,1===h||2===h)w+=i.readSVarint(),C+=i.readSVarint(),w<E&&(E=w),w>T&&(T=w),C<R&&(R=C),C>L&&(L=C);else if(7!==h)throw new Error(`unknown command ${h}`)}return[E,R,T,L]}toGeoJSON(i,a,h){const m=this.extent*Math.pow(2,h),w=this.extent*i,C=this.extent*a,E=this.loadGeometry();function T($){return[360*($.x+w)/m-180,360/Math.PI*Math.atan(Math.exp((1-2*($.y+C)/m)*Math.PI))-90]}function R($){return $.map(T)}let L;if(1===this.type){const $=[];for(const Z of E)$.push(Z[0]);const q=R($);L=1===$.length?{type:"Point",coordinates:q[0]}:{type:"MultiPoint",coordinates:q}}else if(2===this.type){const $=E.map(R);L=1===$.length?{type:"LineString",coordinates:$[0]}:{type:"MultiLineString",coordinates:$}}else{if(3!==this.type)throw new Error("unknown feature type");{const $=function(Z){const Q=Z.length;if(Q<=1)return[Z];const ne=[];let ce,Se;for(let ge=0;ge<Q;ge++){const ye=Hd(Z[ge]);0!==ye&&(void 0===Se&&(Se=ye<0),Se===ye<0?(ce&&ne.push(ce),ce=[Z[ge]]):ce&&ce.push(Z[ge]))}return ce&&ne.push(ce),ne}(E),q=[];for(const Z of $)q.push(Z.map(R));L=1===q.length?{type:"Polygon",coordinates:q[0]}:{type:"MultiPolygon",coordinates:q}}}const z={type:"Feature",geometry:L,properties:this.properties};return null!=this.id&&(z.id=this.id),z}}function Bv(c,i,a){1===c?i.id=a.readVarint():2===c?function(h,m){const w=h.readVarint()+h.pos;for(;h.pos<w;){const C=m._keys[h.readVarint()],E=m._values[h.readVarint()];m.properties[C]=E}}(a,i):3===c?i.type=a.readVarint():4===c&&(i._geometry=a.pos)}function Hd(c){let i=0;for(let a,h,m=0,w=c.length,C=w-1;m<w;C=m++)a=c[m],h=c[C],i+=(h.x-a.x)*(a.y+h.y);return i}$l.types=["Unknown","Point","LineString","Polygon"];class Gc{constructor(i,a){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(H0,this,a),this.length=this._features.length}feature(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];const a=this._pbf.readVarint()+this._pbf.pos;return new $l(this._pbf,a,this.extent,this._keys,this._values)}}function H0(c,i,a){15===c?i.version=a.readVarint():1===c?i.name=a.readString():5===c?i.extent=a.readVarint():2===c?i._features.push(a.pos):3===c?i._keys.push(a.readString()):4===c&&i._values.push(function(h){let m=null;const w=h.readVarint()+h.pos;for(;h.pos<w;){const C=h.readVarint()>>3;m=1===C?h.readString():2===C?h.readFloat():3===C?h.readDouble():4===C?h.readVarint64():5===C?h.readVarint():6===C?h.readSVarint():7===C?h.readBoolean():null}if(null==m)throw new Error("unknown feature value");return m}(a))}class W0{constructor(i,a){this.layers=i.readFields(Qh,{},a)}}function Qh(c,i,a){if(3===c){const h=new Gc(a,a.readVarint()+a.pos);h.length&&(i[h.name]=h)}}const Hg=Math.pow(2,13);function Wd(c,i,a,h,m,w,C,E){c.emplaceBack(i,a,2*Math.floor(h*Hg)+C,m*Hg*2,w*Hg*2,Math.round(E))}class cp{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.id),this.index=i.index,this.hasPattern=!1,this.layoutVertexArray=new ke,this.centroidVertexArray=new fe,this.indexArray=new $n,this.programConfigurations=new Ei(i.layers,i.zoom),this.segments=new tn,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(i,a,h){this.features=[],this.hasPattern=Xf("fill-extrusion",this.layers,a);for(const{feature:m,id:w,index:C,sourceLayerIndex:E}of i){const T=this.layers[0]._featureFilter.needGeometry,R=Ws(m,T);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom,{globalState:this.globalState}),R,h))continue;const L={id:w,sourceLayerIndex:E,index:C,geometry:T?R.geometry:nl(m),properties:m.properties,type:m.type,patterns:{}};this.hasPattern?this.features.push(Qf("fill-extrusion",this.layers,L,this.zoom,a)):this.addFeature(L,L.geometry,C,h,{},a.subdivisionGranularity),a.featureIndex.insert(m,L.geometry,C,E,this.index,!0)}}addFeatures(i,a,h){for(const m of this.features){const{geometry:w}=m;this.addFeature(m,w,m.index,a,h,i.subdivisionGranularity)}}update(i,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,h)}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.centroidVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Fv),this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,Lv.members,!0),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(i,a,h,m,w,C){for(const E of fa(a,500)){const T={x:0,y:0,sampleCount:0},R=this.layoutVertexArray.length;this.processPolygon(T,m,i,E,C);const L=this.layoutVertexArray.length-R,z=Math.floor(T.x/T.sampleCount),$=Math.floor(T.y/T.sampleCount);for(let q=0;q<L;q++)this.centroidVertexArray.emplaceBack(z,$)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,w,m)}processPolygon(i,a,h,m,w){if(m.length<1||q0(m[0]))return;for(const z of m)0!==z.length&&zv(i,z);const C={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},E=w.fill.getGranularityForZoomLevel(a.z),T="Polygon"===$l.types[h.type];for(const z of m){if(0===z.length||q0(z))continue;const $=Bu(z,E,T);this._generateSideFaces($,C)}if(!T)return;const R=sp(m,a,E,!1),L=this.layoutVertexArray;$0((z,$)=>{Wd(L,z,$,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,R.verticesFlattened,R.indicesTriangles)}_generateSideFaces(i,a){let h=0;for(let m=1;m<i.length;m++){const w=i[m],C=i[m-1];if(jv(w,C))continue;a.segment.vertexLength+4>tn.MAX_VERTEX_ARRAY_LENGTH&&(a.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const E=w.sub(C)._perp()._unit(),T=C.dist(w);h+T>32768&&(h=0),Wd(this.layoutVertexArray,w.x,w.y,E.x,E.y,0,0,h),Wd(this.layoutVertexArray,w.x,w.y,E.x,E.y,0,1,h),h+=T,Wd(this.layoutVertexArray,C.x,C.y,E.x,E.y,0,0,h),Wd(this.layoutVertexArray,C.x,C.y,E.x,E.y,0,1,h);const R=a.segment.vertexLength;this.indexArray.emplaceBack(R,R+2,R+1),this.indexArray.emplaceBack(R+1,R+2,R+3),a.segment.vertexLength+=4,a.segment.primitiveLength+=2}}}function zv(c,i){for(let a=0;a<i.length;a++){const h=i[a];a===i.length-1&&i[0].x===h.x&&i[0].y===h.y||(c.x+=h.x,c.y+=h.y,c.sampleCount++)}}function jv(c,i){return c.x===i.x&&(c.x<0||c.x>an)||c.y===i.y&&(c.y<0||c.y>an)}function q0(c){return c.every(i=>i.x<0)||c.every(i=>i.x>an)||c.every(i=>i.y<0)||c.every(i=>i.y>an)}let Z0;ht("FillExtrusionBucket",cp,{omit:["layers","features"]});var Vv={get paint(){return Z0=Z0||new ft({"fill-extrusion-opacity":new k(Me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new G(Me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new k(Me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new k(Me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ae(Me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new G(Me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new G(Me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new k(Me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Uv extends Kn{constructor(i){super(i,Vv)}createBucket(i){return new cp(i)}queryRadius(){return Zh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:i,feature:a,featureState:h,geometry:m,transform:w,pixelsToTileUnits:C,pixelPosMatrix:E}){const T=Fd(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-w.bearingInRadians,C),R=this.paint.get("fill-extrusion-height").evaluate(a,h),L=this.paint.get("fill-extrusion-base").evaluate(a,h),z=function(q,Z){const Q=[];for(const ne of q){const ce=[ne.x,ne.y,0,1];cr(ce,ce,Z),Q.push(new Ye(ce[0]/ce[3],ce[1]/ce[3]))}return Q}(T,E),$=function(q,Z,Q,ne){const ce=[],Se=[],ge=ne[8]*Z,ye=ne[9]*Z,Re=ne[10]*Z,je=ne[11]*Z,Ze=ne[8]*Q,ut=ne[9]*Q,et=ne[10]*Q,st=ne[11]*Q;for(const Dt of q){const Xe=[],rt=[];for(const ze of Dt){const Pt=ze.x,Bt=ze.y,Ct=ne[0]*Pt+ne[4]*Bt+ne[12],xt=ne[1]*Pt+ne[5]*Bt+ne[13],dn=ne[2]*Pt+ne[6]*Bt+ne[14],fr=ne[3]*Pt+ne[7]*Bt+ne[15],ro=dn+Re,Eo=fr+je,bs=Ct+Ze,Mi=xt+ut,Zr=dn+et,wr=fr+st,lr=new Ye((Ct+ge)/Eo,(xt+ye)/Eo);lr.z=ro/Eo,Xe.push(lr);const Mo=new Ye(bs/wr,Mi/wr);Mo.z=Zr/wr,rt.push(Mo)}ce.push(Xe),Se.push(rt)}return[ce,Se]}(m,L,R,E);return function(q,Z,Q){let ne=1/0;Ag(Q,Z)&&(ne=Gv(Q,Z[0]));for(let ce=0;ce<Z.length;ce++){const Se=Z[ce],ge=q[ce];for(let ye=0;ye<Se.length-1;ye++){const Re=Se[ye],je=[Re,Se[ye+1],ge[ye+1],ge[ye],Re];Hn(Q,je)&&(ne=Math.min(ne,Gv(Q,je)))}}return ne!==1/0&&ne}($[0],$[1],z)}}function qd(c,i){return c.x*i.x+c.y*i.y}function Gv(c,i){if(1===c.length){let a=0;const h=i[a++];let m;for(;!m||h.equals(m);)if(m=i[a++],!m)return 1/0;for(;a<i.length;a++){const w=i[a],C=c[0],E=m.sub(h),T=w.sub(h),R=C.sub(h),L=qd(E,E),z=qd(E,T),$=qd(T,T),q=qd(R,E),Z=qd(R,T),Q=L*$-z*z,ne=($*q-z*Z)/Q,ce=(L*Z-z*q)/Q,Se=h.z*(1-ne-ce)+m.z*ne+w.z*ce;if(isFinite(Se))return Se}return 1/0}{let a=1/0;for(const h of i)a=Math.min(a,h.z);return a}}const Y0=hr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:$v}=Y0,up=hr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Hv}=up,Wv=Math.cos(Math.PI/180*37.5),Wg=Math.pow(2,14)/.5;class dp{constructor(i){this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(a=>a.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Oe,this.layoutVertexArray2=new Fe,this.indexArray=new $n,this.programConfigurations=new Ei(i.layers,i.zoom),this.segments=new tn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(i,a,h){this.hasPattern=Xf("line",this.layers,a);const m=this.layers[0].layout.get("line-sort-key"),w=!m.isConstant(),C=[];for(const{feature:E,id:T,index:R,sourceLayerIndex:L}of i){const z=this.layers[0]._featureFilter.needGeometry,$=Ws(E,z);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom,{globalState:this.globalState}),$,h))continue;const q=w?m.evaluate($,{},h):void 0,Z={id:T,properties:E.properties,type:E.type,sourceLayerIndex:L,index:R,geometry:z?$.geometry:nl(E),patterns:{},sortKey:q};C.push(Z)}w&&C.sort((E,T)=>E.sortKey-T.sortKey);for(const E of C){const{geometry:T,index:R,sourceLayerIndex:L}=E;if(this.hasPattern){const z=Qf("line",this.layers,E,this.zoom,a);this.patternFeatures.push(z)}else this.addFeature(E,T,R,h,{},a.subdivisionGranularity);a.featureIndex.insert(i[R].feature,T,R,L,this.index)}}update(i,a,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,a,this.stateDependentLayers,h)}addFeatures(i,a,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,a,h,i.subdivisionGranularity)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,Hv)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,$v),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(i.properties,"mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,a,h,m,w,C){const E=this.layers[0].layout,T=E.get("line-join").evaluate(i,{}),R=E.get("line-cap"),L=E.get("line-miter-limit"),z=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const $ of a)this.addLine($,i,T,R,L,z,m,C);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,h,w,m)}addLine(i,a,h,m,w,C,E,T){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,i=Bu(i,E?T.line.getGranularityForZoomLevel(E.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<i.length-1;ge++)this.totalDistance+=i[ge].dist(i[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const R="Polygon"===$l.types[a.type];let L=i.length;for(;L>=2&&i[L-1].equals(i[L-2]);)L--;let z=0;for(;z<L-1&&i[z].equals(i[z+1]);)z++;if(L<(R?3:2))return;"bevel"===h&&(w=1.05);const $=this.overscaling<=16?122880/(512*this.overscaling):0,q=this.segments.prepareSegment(10*L,this.layoutVertexArray,this.indexArray);let Z,Q,ne,ce,Se;this.e1=this.e2=-1,R&&(Z=i[L-2],Se=i[z].sub(Z)._unit()._perp());for(let ge=z;ge<L;ge++){if(ne=ge===L-1?R?i[z+1]:void 0:i[ge+1],ne&&i[ge].equals(ne))continue;Se&&(ce=Se),Z&&(Q=Z),Z=i[ge],Se=ne?ne.sub(Z)._unit()._perp():ce,ce=ce||Se;let ye=ce.add(Se);0===ye.x&&0===ye.y||ye._unit();const Re=ce.x*Se.x+ce.y*Se.y,je=ye.x*Se.x+ye.y*Se.y,Ze=0!==je?1/je:1/0,ut=2*Math.sqrt(2-2*je),et=je<Wv&&Q&&ne,st=ce.x*Se.y-ce.y*Se.x>0;if(et&&ge>z){const rt=Z.dist(Q);if(rt>2*$){const ze=Z.sub(Z.sub(Q)._mult($/rt)._round());this.updateDistance(Q,ze),this.addCurrentVertex(ze,ce,0,0,q),Q=ze}}const Dt=Q&&ne;let Xe=Dt?h:R?"butt":m;if(Dt&&"round"===Xe&&(Ze<C?Xe="miter":Ze<=2&&(Xe="fakeround")),"miter"===Xe&&Ze>w&&(Xe="bevel"),"bevel"===Xe&&(Ze>2&&(Xe="flipbevel"),Ze<w&&(Xe="miter")),Q&&this.updateDistance(Q,Z),"miter"===Xe)ye._mult(Ze),this.addCurrentVertex(Z,ye,0,0,q);else if("flipbevel"===Xe){if(Ze>100)ye=Se.mult(-1);else{const rt=Ze*ce.add(Se).mag()/ce.sub(Se).mag();ye._perp()._mult(rt*(st?-1:1))}this.addCurrentVertex(Z,ye,0,0,q),this.addCurrentVertex(Z,ye.mult(-1),0,0,q)}else if("bevel"===Xe||"fakeround"===Xe){const rt=-Math.sqrt(Ze*Ze-1),ze=st?rt:0,Pt=st?0:rt;if(Q&&this.addCurrentVertex(Z,ce,ze,Pt,q),"fakeround"===Xe){const Bt=Math.round(180*ut/Math.PI/20);for(let Ct=1;Ct<Bt;Ct++){let xt=Ct/Bt;if(.5!==xt){const fr=xt-.5;xt+=xt*fr*(xt-1)*((1.0904+Re*(Re*(3.55645-1.43519*Re)-3.2452))*fr*fr+(.848013+Re*(.215638*Re-1.06021)))}const dn=Se.sub(ce)._mult(xt)._add(ce)._unit()._mult(st?-1:1);this.addHalfVertex(Z,dn.x,dn.y,!1,st,0,q)}}ne&&this.addCurrentVertex(Z,Se,-ze,-Pt,q)}else if("butt"===Xe)this.addCurrentVertex(Z,ye,0,0,q);else if("square"===Xe){const rt=Q?1:-1;this.addCurrentVertex(Z,ye,rt,rt,q)}else"round"===Xe&&(Q&&(this.addCurrentVertex(Z,ce,0,0,q),this.addCurrentVertex(Z,ce,1,1,q,!0)),ne&&(this.addCurrentVertex(Z,Se,-1,-1,q,!0),this.addCurrentVertex(Z,Se,0,0,q)));if(et&&ge<L-1){const rt=Z.dist(ne);if(rt>2*$){const ze=Z.add(ne.sub(Z)._mult($/rt)._round());this.updateDistance(Z,ze),this.addCurrentVertex(ze,Se,0,0,q),Z=ze}}}}addCurrentVertex(i,a,h,m,w,C=!1){const E=a.y*m-a.x,T=-a.y-a.x*m;this.addHalfVertex(i,a.x+a.y*h,a.y-a.x*h,C,!1,h,w),this.addHalfVertex(i,E,T,C,!0,-m,w),this.distance>Wg/2&&0===this.totalDistance&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(i,a,h,m,w,C))}addHalfVertex({x:i,y:a},h,m,w,C,E,T){const R=.5*(this.lineClips?this.scaledDistance*(Wg-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((i<<1)+(w?1:0),(a<<1)+(C?1:0),Math.round(63*h)+128,Math.round(63*m)+128,1+(0===E?0:E<0?-1:1)|(63&R)<<2,R>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const L=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,L,this.e2),T.primitiveLength++),C?this.e2=L:this.e1=L}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(i,a){this.distance+=i.dist(a),this.updateScaledDistance()}}let K0,X0;ht("LineBucket",dp,{omit:["layers","patternFeatures"]});var qg={get paint(){return X0=X0||new ft({"line-opacity":new G(Me.paint_line["line-opacity"]),"line-color":new G(Me.paint_line["line-color"]),"line-translate":new k(Me.paint_line["line-translate"]),"line-translate-anchor":new k(Me.paint_line["line-translate-anchor"]),"line-width":new G(Me.paint_line["line-width"]),"line-gap-width":new G(Me.paint_line["line-gap-width"]),"line-offset":new G(Me.paint_line["line-offset"]),"line-blur":new G(Me.paint_line["line-blur"]),"line-dasharray":new Ae(Me.paint_line["line-dasharray"]),"line-pattern":new ae(Me.paint_line["line-pattern"]),"line-gradient":new He(Me.paint_line["line-gradient"])})},get layout(){return K0=K0||new ft({"line-cap":new k(Me.layout_line["line-cap"]),"line-join":new G(Me.layout_line["line-join"]),"line-miter-limit":new k(Me.layout_line["line-miter-limit"]),"line-round-limit":new k(Me.layout_line["line-round-limit"]),"line-sort-key":new G(Me.layout_line["line-sort-key"])})}};class Zg extends G{possiblyEvaluate(i,a){return a=new Yn(Math.floor(a.zoom),{now:a.now,fadeDuration:a.fadeDuration,zoomHistory:a.zoomHistory,transition:a.transition}),super.possiblyEvaluate(i,a)}evaluate(i,a,h,m){return a=Qn({},a,{zoom:Math.floor(a.zoom)}),super.evaluate(i,a,h,m)}}let Jh;class qv extends Kn{constructor(i){super(i,qg),this.gradientVersion=0,Jh||(Jh=new Zg(qg.paint.properties["line-width"].specification),Jh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){if("line-gradient"===i){const a=this.gradientExpression();this.stepInterpolant=!(void 0===a._styleExpression)&&a._styleExpression.expression instanceof ar,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,a){super.recalculate(i,a),this.paint._values["line-floorwidth"]=Jh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new dp(i)}queryRadius(i){const a=i,h=zu(qh("line-width",this,a),qh("line-gap-width",this,a)),m=qh("line-offset",this,a);return h/2+Math.abs(m)+Zh(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:i,feature:a,featureState:h,geometry:m,transform:w,pixelsToTileUnits:C}){const E=Fd(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-w.bearingInRadians,C),T=C/2*zu(this.paint.get("line-width").evaluate(a,h),this.paint.get("line-gap-width").evaluate(a,h)),R=this.paint.get("line-offset").evaluate(a,h);return R&&(m=function(L,z){const $=[];for(let q=0;q<L.length;q++){const Z=L[q],Q=[];for(let ne=0;ne<Z.length;ne++){const ce=Z[ne-1],Se=Z[ne],ge=Z[ne+1],ye=0===ne?new Ye(0,0):Se.sub(ce)._unit()._perp(),Re=ne===Z.length-1?new Ye(0,0):ge.sub(Se)._unit()._perp(),je=ye._add(Re)._unit(),Ze=je.x*Re.x+je.y*Re.y;0!==Ze&&je._mult(1/Ze),Q.push(je._mult(z)._add(Se))}$.push(Q)}return $}(m,R*C)),function(L,z,$){for(let q=0;q<z.length;q++){const Z=z[q];if(L.length>=3)for(let Q=0;Q<Z.length;Q++)if(ku(L,Z[Q]))return!0;if(Pg(L,Z,$))return!0}return!1}(E,m,T)}isTileClipped(){return!0}}function zu(c,i){return i>0?i+2*c:c}const Q0=hr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),J0=hr([{name:"a_projected_pos",components:3,type:"Float32"}],4);hr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Zd=hr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);hr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const hp=hr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ef=hr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Zv(c,i,a){return c.sections.forEach(h=>{h.text=function(m,w,C){const E=w.layout.get("text-transform").evaluate(C,{});return"uppercase"===E?m=m.toLocaleUpperCase():"lowercase"===E&&(m=m.toLocaleLowerCase()),So.applyArabicShaping&&(m=So.applyArabicShaping(m)),m}(h.text,i,a)}),c}hr([{name:"triangle",components:3,type:"Uint16"}]),hr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),hr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),hr([{type:"Float32",name:"offsetX"}]),hr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),hr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Yd={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};const e_=4294967296,Yv=1/e_,Sa=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");class Yg{constructor(i=new Uint8Array(16)){this.buf=ArrayBuffer.isView(i)?i:new Uint8Array(i),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(i,a,h=this.length){for(;this.pos<h;){const m=this.readVarint(),w=m>>3,C=this.pos;this.type=7&m,i(w,a,this),this.pos===C&&this.skip(m)}return a}readMessage(i,a){return this.readFields(i,a,this.readVarint()+this.pos)}readFixed32(){const i=this.dataView.getUint32(this.pos,!0);return this.pos+=4,i}readSFixed32(){const i=this.dataView.getInt32(this.pos,!0);return this.pos+=4,i}readFixed64(){const i=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*e_;return this.pos+=8,i}readSFixed64(){const i=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*e_;return this.pos+=8,i}readFloat(){const i=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,i}readDouble(){const i=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,i}readVarint(i){const a=this.buf;let h,m;return m=a[this.pos++],h=127&m,m<128?h:(m=a[this.pos++],h|=(127&m)<<7,m<128?h:(m=a[this.pos++],h|=(127&m)<<14,m<128?h:(m=a[this.pos++],h|=(127&m)<<21,m<128?h:(m=a[this.pos],h|=(15&m)<<28,function(w,C,E){const T=E.buf;let R,L;if(L=T[E.pos++],R=(112&L)>>4,L<128||(L=T[E.pos++],R|=(127&L)<<3,L<128)||(L=T[E.pos++],R|=(127&L)<<10,L<128)||(L=T[E.pos++],R|=(127&L)<<17,L<128)||(L=T[E.pos++],R|=(127&L)<<24,L<128)||(L=T[E.pos++],R|=(1&L)<<31,L<128))return function Hl(c,i,a){return a?4294967296*i+(c>>>0):4294967296*(i>>>0)+(c>>>0)}(w,R,C);throw new Error("Expected varint not more than 10 bytes")}(h,i,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const i=this.readVarint();return i%2==1?(i+1)/-2:i/2}readBoolean(){return!!this.readVarint()}readString(){const i=this.readVarint()+this.pos,a=this.pos;return this.pos=i,i-a>=12&&Sa?Sa.decode(this.buf.subarray(a,i)):function(h,m,w){let C="",E=m;for(;E<w;){const T=h[E];let R,L,z,$=null,q=T>239?4:T>223?3:T>191?2:1;if(E+q>w)break;1===q?T<128&&($=T):2===q?(R=h[E+1],128==(192&R)&&($=(31&T)<<6|63&R,$<=127&&($=null))):3===q?(R=h[E+1],L=h[E+2],128==(192&R)&&128==(192&L)&&($=(15&T)<<12|(63&R)<<6|63&L,($<=2047||$>=55296&&$<=57343)&&($=null))):4===q&&(R=h[E+1],L=h[E+2],z=h[E+3],128==(192&R)&&128==(192&L)&&128==(192&z)&&($=(15&T)<<18|(63&R)<<12|(63&L)<<6|63&z,($<=65535||$>=1114112)&&($=null))),null===$?($=65533,q=1):$>65535&&($-=65536,C+=String.fromCharCode($>>>10&1023|55296),$=56320|1023&$),C+=String.fromCharCode($),E+=q}return C}(this.buf,a,i)}readBytes(){const i=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,i);return this.pos=i,a}readPackedVarint(i=[],a){const h=this.readPackedEnd();for(;this.pos<h;)i.push(this.readVarint(a));return i}readPackedSVarint(i=[]){const a=this.readPackedEnd();for(;this.pos<a;)i.push(this.readSVarint());return i}readPackedBoolean(i=[]){const a=this.readPackedEnd();for(;this.pos<a;)i.push(this.readBoolean());return i}readPackedFloat(i=[]){const a=this.readPackedEnd();for(;this.pos<a;)i.push(this.readFloat());return i}readPackedDouble(i=[]){const a=this.readPackedEnd();for(;this.pos<a;)i.push(this.readDouble());return i}readPackedFixed32(i=[]){const a=this.readPackedEnd();for(;this.pos<a;)i.push(this.readFixed32());return i}readPackedSFixed32(i=[]){const a=this.readPackedEnd();for(;this.pos<a;)i.push(this.readSFixed32());return i}readPackedFixed64(i=[]){const a=this.readPackedEnd();for(;this.pos<a;)i.push(this.readFixed64());return i}readPackedSFixed64(i=[]){const a=this.readPackedEnd();for(;this.pos<a;)i.push(this.readSFixed64());return i}readPackedEnd(){return 2===this.type?this.readVarint()+this.pos:this.pos+1}skip(i){const a=7&i;if(0===a)for(;this.buf[this.pos++]>127;);else if(2===a)this.pos=this.readVarint()+this.pos;else if(5===a)this.pos+=4;else{if(1!==a)throw new Error(`Unimplemented type: ${a}`);this.pos+=8}}writeTag(i,a){this.writeVarint(i<<3|a)}realloc(i){let a=this.length||16;for(;a<this.pos+i;)a*=2;if(a!==this.length){const h=new Uint8Array(a);h.set(this.buf),this.buf=h,this.dataView=new DataView(h.buffer),this.length=a}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(i){this.realloc(4),this.dataView.setInt32(this.pos,i,!0),this.pos+=4}writeSFixed32(i){this.realloc(4),this.dataView.setInt32(this.pos,i,!0),this.pos+=4}writeFixed64(i){this.realloc(8),this.dataView.setInt32(this.pos,-1&i,!0),this.dataView.setInt32(this.pos+4,Math.floor(i*Yv),!0),this.pos+=8}writeSFixed64(i){this.realloc(8),this.dataView.setInt32(this.pos,-1&i,!0),this.dataView.setInt32(this.pos+4,Math.floor(i*Yv),!0),this.pos+=8}writeVarint(i){(i=+i||0)>268435455||i<0?function(a,h){let m,w;if(a>=0?(m=a%4294967296|0,w=a/4294967296|0):(m=~(-a%4294967296),w=~(-a/4294967296),4294967295^m?m=m+1|0:(m=0,w=w+1|0)),a>=0x10000000000000000||a<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");var C,T;h.realloc(10),C=m,(T=h).buf[T.pos++]=127&C|128,C>>>=7,T.buf[T.pos++]=127&C|128,C>>>=7,T.buf[T.pos++]=127&C|128,C>>>=7,T.buf[T.pos++]=127&C|128,T.buf[T.pos]=127&(C>>>=7),function(C,E){const T=(7&C)<<4;E.buf[E.pos++]|=T|((C>>>=3)?128:0),C&&(E.buf[E.pos++]=127&C|((C>>>=7)?128:0),C&&(E.buf[E.pos++]=127&C|((C>>>=7)?128:0),C&&(E.buf[E.pos++]=127&C|((C>>>=7)?128:0),C&&(E.buf[E.pos++]=127&C|((C>>>=7)?128:0),C&&(E.buf[E.pos++]=127&C)))))}(w,h)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))}writeSVarint(i){this.writeVarint(i<0?2*-i-1:2*i)}writeBoolean(i){this.writeVarint(+i)}writeString(i){i=String(i),this.realloc(4*i.length),this.pos++;const a=this.pos;this.pos=function(m,w,C){for(let E,T,R=0;R<w.length;R++){if(E=w.charCodeAt(R),E>55295&&E<57344){if(!T){E>56319||R+1===w.length?(m[C++]=239,m[C++]=191,m[C++]=189):T=E;continue}if(E<56320){m[C++]=239,m[C++]=191,m[C++]=189,T=E;continue}E=T-55296<<10|E-56320|65536,T=null}else T&&(m[C++]=239,m[C++]=191,m[C++]=189,T=null);E<128?m[C++]=E:(E<2048?m[C++]=E>>6|192:(E<65536?m[C++]=E>>12|224:(m[C++]=E>>18|240,m[C++]=E>>12&63|128),m[C++]=E>>6&63|128),m[C++]=63&E|128)}return C}(this.buf,i,this.pos);const h=this.pos-a;h>=128&&fp(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h}writeFloat(i){this.realloc(4),this.dataView.setFloat32(this.pos,i,!0),this.pos+=4}writeDouble(i){this.realloc(8),this.dataView.setFloat64(this.pos,i,!0),this.pos+=8}writeBytes(i){const a=i.length;this.writeVarint(a),this.realloc(a);for(let h=0;h<a;h++)this.buf[this.pos++]=i[h]}writeRawMessage(i,a){this.pos++;const h=this.pos;i(a,this);const m=this.pos-h;m>=128&&fp(h,m,this),this.pos=h-1,this.writeVarint(m),this.pos+=m}writeMessage(i,a,h){this.writeTag(i,2),this.writeRawMessage(a,h)}writePackedVarint(i,a){a.length&&this.writeMessage(i,Kv,a)}writePackedSVarint(i,a){a.length&&this.writeMessage(i,Pw,a)}writePackedBoolean(i,a){a.length&&this.writeMessage(i,Qv,a)}writePackedFloat(i,a){a.length&&this.writeMessage(i,kw,a)}writePackedDouble(i,a){a.length&&this.writeMessage(i,Xv,a)}writePackedFixed32(i,a){a.length&&this.writeMessage(i,Rw,a)}writePackedSFixed32(i,a){a.length&&this.writeMessage(i,Ow,a)}writePackedFixed64(i,a){a.length&&this.writeMessage(i,Nw,a)}writePackedSFixed64(i,a){a.length&&this.writeMessage(i,Jv,a)}writeBytesField(i,a){this.writeTag(i,2),this.writeBytes(a)}writeFixed32Field(i,a){this.writeTag(i,5),this.writeFixed32(a)}writeSFixed32Field(i,a){this.writeTag(i,5),this.writeSFixed32(a)}writeFixed64Field(i,a){this.writeTag(i,1),this.writeFixed64(a)}writeSFixed64Field(i,a){this.writeTag(i,1),this.writeSFixed64(a)}writeVarintField(i,a){this.writeTag(i,0),this.writeVarint(a)}writeSVarintField(i,a){this.writeTag(i,0),this.writeSVarint(a)}writeStringField(i,a){this.writeTag(i,2),this.writeString(a)}writeFloatField(i,a){this.writeTag(i,5),this.writeFloat(a)}writeDoubleField(i,a){this.writeTag(i,1),this.writeDouble(a)}writeBooleanField(i,a){this.writeVarintField(i,+a)}}function fp(c,i,a){const h=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));a.realloc(h);for(let m=a.pos-1;m>=c;m--)a.buf[m+h]=a.buf[m]}function Kv(c,i){for(let a=0;a<c.length;a++)i.writeVarint(c[a])}function Pw(c,i){for(let a=0;a<c.length;a++)i.writeSVarint(c[a])}function kw(c,i){for(let a=0;a<c.length;a++)i.writeFloat(c[a])}function Xv(c,i){for(let a=0;a<c.length;a++)i.writeDouble(c[a])}function Qv(c,i){for(let a=0;a<c.length;a++)i.writeBoolean(c[a])}function Rw(c,i){for(let a=0;a<c.length;a++)i.writeFixed32(c[a])}function Ow(c,i){for(let a=0;a<c.length;a++)i.writeSFixed32(c[a])}function Nw(c,i){for(let a=0;a<c.length;a++)i.writeFixed64(c[a])}function Jv(c,i){for(let a=0;a<c.length;a++)i.writeSFixed64(c[a])}function eb(c,i,a){1===c&&a.readMessage(tb,i)}function tb(c,i,a){if(3===c){const{id:h,bitmap:m,width:w,height:C,left:E,top:T,advance:R}=a.readMessage(Kg,{});i.push({id:h,bitmap:new qs({width:w+6,height:C+6},m),metrics:{width:w,height:C,left:E,top:T,advance:R}})}}function Kg(c,i,a){1===c?i.id=a.readVarint():2===c?i.bitmap=a.readBytes():3===c?i.width=a.readVarint():4===c?i.height=a.readVarint():5===c?i.left=a.readSVarint():6===c?i.top=a.readSVarint():7===c&&(i.advance=a.readVarint())}function Kd(c){let i=0,a=0;for(const C of c)i+=C.w*C.h,a=Math.max(a,C.w);c.sort((C,E)=>E.h-C.h);const h=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),a),h:1/0}];let m=0,w=0;for(const C of c)for(let E=h.length-1;E>=0;E--){const T=h[E];if(!(C.w>T.w||C.h>T.h)){if(C.x=T.x,C.y=T.y,w=Math.max(w,C.y+C.h),m=Math.max(m,C.x+C.w),C.w===T.w&&C.h===T.h){const R=h.pop();R&&E<h.length&&(h[E]=R)}else C.h===T.h?(T.x+=C.w,T.w-=C.w):C.w===T.w?(T.y+=C.h,T.h-=C.h):(h.push({x:T.x+C.w,y:T.y,w:T.w-C.w,h:C.h}),T.y+=C.h,T.h-=C.h);break}}return{w:m,h:w,fill:i/(m*w)||0}}class tf{constructor(i,{pixelRatio:a,version:h,stretchX:m,stretchY:w,content:C,textFitWidth:E,textFitHeight:T}){this.paddedRect=i,this.pixelRatio=a,this.stretchX=m,this.stretchY=w,this.content=C,this.version=h,this.textFitWidth=E,this.textFitHeight=T}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class nf{constructor(i,a){const h={},m={};this.haveRenderCallbacks=[];const w=[];this.addImages(i,h,w),this.addImages(a,m,w);const{w:C,h:E}=Kd(w),T=new qo({width:C||1,height:E||1});for(const R in i){const L=i[R],z=h[R].paddedRect;qo.copy(L.data,T,{x:0,y:0},{x:z.x+1,y:z.y+1},L.data)}for(const R in a){const L=a[R],z=m[R].paddedRect,$=z.x+1,q=z.y+1,Z=L.data.width,Q=L.data.height;qo.copy(L.data,T,{x:0,y:0},{x:$,y:q},L.data),qo.copy(L.data,T,{x:0,y:Q-1},{x:$,y:q-1},{width:Z,height:1}),qo.copy(L.data,T,{x:0,y:0},{x:$,y:q+Q},{width:Z,height:1}),qo.copy(L.data,T,{x:Z-1,y:0},{x:$-1,y:q},{width:1,height:Q}),qo.copy(L.data,T,{x:0,y:0},{x:$+Z,y:q},{width:1,height:Q})}this.image=T,this.iconPositions=h,this.patternPositions=m}addImages(i,a,h){for(const m in i){const w=i[m],C={x:0,y:0,w:w.data.width+2,h:w.data.height+2};h.push(C),a[m]=new tf(C,w),w.hasRenderCallback&&this.haveRenderCallbacks.push(m)}}patchUpdatedImages(i,a){i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const h in i.updatedImages)this.patchUpdatedImage(this.iconPositions[h],i.getImage(h),a),this.patchUpdatedImage(this.patternPositions[h],i.getImage(h),a)}patchUpdatedImage(i,a,h){if(!i||!a||i.version===a.version)return;i.version=a.version;const[m,w]=i.tl;h.update(a.data,void 0,{x:m,y:w})}}var Wl;ht("ImagePosition",tf),ht("ImageAtlas",nf),W.ao=void 0,(Wl=W.ao||(W.ao={}))[Wl.none=0]="none",Wl[Wl.horizontal=1]="horizontal",Wl[Wl.vertical=2]="vertical",Wl[Wl.horizontalOnly=3]="horizontalOnly";class ql{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(i,a,h){const m=new ql;return m.scale=i||1,m.fontStack=a,m.verticalAlign=h||"bottom",m}static forImage(i,a){const h=new ql;return h.imageName=i,h.verticalAlign=a||"bottom",h}}class ju{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,a){const h=new ju;for(let m=0;m<i.sections.length;m++){const w=i.sections[m];w.image?h.addImageSection(w):h.addTextSection(w,a)}return h}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(){this.text=function(i){let a="";for(let h=0;h<i.length;h++){const m=i.charCodeAt(h+1)||null,w=i.charCodeAt(h-1)||null;a+=m&&Su(m)&&!Yd[i[h+1]]||w&&Su(w)&&!Yd[i[h-1]]||!Yd[i[h]]?i[h]:Yd[i[h]]}return a}(this.text)}trim(){let i=0;for(let h=0;h<this.text.length&&$c[this.text.charCodeAt(h)];h++)i++;let a=this.text.length;for(let h=this.text.length-1;h>=0&&h>=i&&$c[this.text.charCodeAt(h)];h--)a--;this.text=this.text.substring(i,a),this.sectionIndex=this.sectionIndex.slice(i,a)}substring(i,a){const h=new ju;return h.text=this.text.substring(i,a),h.sectionIndex=this.sectionIndex.slice(i,a),h.sections=this.sections,h}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,a)=>Math.max(i,this.sections[a].scale),0)}getMaxImageSize(i){let a=0,h=0;for(let m=0;m<this.length();m++){const w=this.getSection(m);if(w.imageName){const C=i[w.imageName];if(!C)continue;const E=C.displaySize;a=Math.max(a,E[0]),h=Math.max(h,E[1])}}return{maxImageWidth:a,maxImageHeight:h}}addTextSection(i,a){this.text+=i.text,this.sections.push(ql.forText(i.scale,i.fontStack||a,i.verticalAlign));const h=this.sections.length-1;for(let m=0;m<i.text.length;++m)this.sectionIndex.push(h)}addImageSection(i){const a=i.image?i.image.name:"";if(0===a.length)return void Le("Can't add FormattedSection with an empty image.");const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCharCode(h),this.sections.push(ql.forImage(a,i.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Le("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function pp(c,i,a,h,m,w,C,E,T,R,L,z,$,q,Z){const Q=ju.fromFeature(c,m);let ne;z===W.ao.vertical&&Q.verticalizePunctuation();const{processBidirectionalText:ce,processStyledBidirectionalText:Se}=So;if(ce&&1===Q.sections.length){ne=[];const Re=ce(Q.toString(),mp(Q,R,w,i,h,q));for(const je of Re){const Ze=new ju;Ze.text=je,Ze.sections=Q.sections;for(let ut=0;ut<je.length;ut++)Ze.sectionIndex.push(0);ne.push(Ze)}}else if(Se){ne=[];const Re=Se(Q.text,Q.sectionIndex,mp(Q,R,w,i,h,q));for(const je of Re){const Ze=new ju;Ze.text=je[0],Ze.sectionIndex=je[1],Ze.sections=Q.sections,ne.push(Ze)}}else ne=function(Re,je){const Ze=[],ut=Re.text;let et=0;for(const st of je)Ze.push(Re.substring(et,st)),et=st;return et<ut.length&&Ze.push(Re.substring(et,ut.length)),Ze}(Q,mp(Q,R,w,i,h,q));const ge=[],ye={positionedLines:ge,text:Q.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:z,iconsInText:!1,verticalizable:!1};return function(Re,je,Ze,ut,et,st,Dt,Xe,rt,ze,Pt,Bt){let Ct=0,xt=0,dn=0,fr=0;const ro="right"===Xe?1:"left"===Xe?0:.5,Eo=24/Bt;let bs=0;for(const wr of et){wr.trim();const lr=wr.getMaxScale(),Mo={positionedGlyphs:[],lineOffset:0};Re.positionedLines[bs]=Mo;const To=Mo.positionedGlyphs;let ii=0;if(!wr.length()){xt+=st,++bs;continue}const xs=rb(ut,wr,Eo);for(let Zi=0;Zi<wr.length();Zi++){const Yr=wr.getSection(Zi),go=wr.getSectionIndex(Zi),mo=wr.getCharCode(Zi),oo=rf(rt,Pt,mo);let nr;if(Yr.imageName){if(Re.iconsInText=!0,Yr.scale=Yr.scale*Eo,nr=ib(Yr,oo,lr,xs,ut),!nr)continue;ii=Math.max(ii,nr.imageOffset)}else if(nr=ob(Yr,mo,oo,xs,je,Ze),!nr)continue;const{rect:Ea,metrics:nh,baselineOffset:Ma}=nr;To.push({glyph:mo,imageName:Yr.imageName,x:Ct,y:xt+Ma+-17,vertical:oo,scale:Yr.scale,fontStack:Yr.fontStack,sectionIndex:go,metrics:nh,rect:Ea}),oo?(Re.verticalizable=!0,Ct+=(Yr.imageName?nh.advance:24)*Yr.scale+ze):Ct+=nh.advance*Yr.scale+ze}0!==To.length&&(dn=Math.max(Ct-ze,dn),sb(To,0,To.length-1,ro)),Ct=0,Mo.lineOffset=Math.max(ii,24*(lr-1));const po=st*lr+ii;xt+=po,fr=Math.max(po,fr),++bs}const{horizontalAlign:Mi,verticalAlign:Zr}=Qg(Dt);(function(wr,lr,Mo,To,ii,xs,po,Zi,Yr){const go=(lr-Mo)*ii;let mo=0;mo=xs!==po?-Zi*To- -17:-To*Yr*po+.5*po;for(const oo of wr)for(const nr of oo.positionedGlyphs)nr.x+=go,nr.y+=mo})(Re.positionedLines,ro,Mi,Zr,dn,fr,st,xt,et.length),Re.top+=-Zr*xt,Re.bottom=Re.top+xt,Re.left+=-Mi*dn,Re.right=Re.left+dn}(ye,i,a,h,ne,C,E,T,z,R,$,Z),!function(Re){for(const je of Re)if(0!==je.positionedGlyphs.length)return!1;return!0}(ge)&&ye}const $c={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},t_={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},n_={40:!0};function Hc(c,i,a,h,m,w){if(i.imageName){const C=h[i.imageName];return C?C.displaySize[0]*i.scale*24/w+m:0}{const C=a[i.fontStack],E=C&&C[c];return E?E.metrics.advance*i.scale+m:0}}function gp(c,i,a,h){const m=Math.pow(c-i,2);return h?c<i?m/2:2*m:m+Math.abs(a)*a}function nb(c,i,a){let h=0;return 10===c&&(h-=1e4),a&&(h+=150),40!==c&&65288!==c||(h+=50),41!==i&&65289!==i||(h+=50),h}function r_(c,i,a,h,m,w){let C=null,E=gp(i,a,m,w);for(const T of h){const R=gp(i-T.x,a,m,w)+T.badness;R<=E&&(C=T,E=R)}return{index:c,x:i,priorBreak:C,badness:E}}function Xg(c){return c?Xg(c.priorBreak).concat(c.index):[]}function mp(c,i,a,h,m,w){if(!c)return[];const C=[],E=function(z,$,q,Z,Q,ne){let ce=0;for(let Se=0;Se<z.length();Se++){const ge=z.getSection(Se);ce+=Hc(z.getCharCode(Se),ge,Z,Q,$,ne)}return ce/Math.max(1,Math.ceil(ce/q))}(c,i,a,h,m,w),T=c.text.indexOf("\u200b")>=0;let R=0;for(let z=0;z<c.length();z++){const $=c.getSection(z),q=c.getCharCode(z);if($c[q]||(R+=Hc(q,$,h,m,i,w)),z<c.length()-1){const Z=!((L=q)<11904)&&(!!on["CJK Compatibility Forms"](L)||!!on["CJK Compatibility"](L)||!!on["CJK Strokes"](L)||!!on["CJK Symbols and Punctuation"](L)||!!on["Enclosed CJK Letters and Months"](L)||!!on["Halfwidth and Fullwidth Forms"](L)||!!on["Ideographic Description Characters"](L)||!!on["Vertical Forms"](L)||wu.test(String.fromCodePoint(L)));(t_[q]||Z||$.imageName||z!==c.length()-2&&n_[c.getCharCode(z+1)])&&C.push(r_(z+1,R,E,C,nb(q,c.getCharCode(z+1),Z&&T),!1))}}var L;return Xg(r_(c.length(),R,E,C,0,!0))}function Qg(c){let i=.5,a=.5;switch(c){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:i,verticalAlign:a}}function rb(c,i,a){const h=24*i.getMaxScale(),{maxImageWidth:m,maxImageHeight:w}=i.getMaxImageSize(c),C=Math.max(h,w*a);return{verticalLineContentWidth:Math.max(h,m*a),horizontalLineContentHeight:C}}function o_(c){switch(c){case"top":return 0;case"center":return.5;default:return 1}}function rf(c,i,a){return!(c===W.ao.horizontal||!i&&!Cu(a)||i&&($c[a]||(h=a,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(h)))));var h}function ob(c,i,a,h,m,w){const C=w[c.fontStack],E=function(R,L,z,$){if(R&&R.rect)return R;const q=L[z.fontStack],Z=q&&q[$];return Z?{rect:null,metrics:Z.metrics}:null}(C&&C[i],m,c,i);if(null===E)return null;let T;if(a)T=h.verticalLineContentWidth-24*c.scale;else{const R=o_(c.verticalAlign);T=(h.horizontalLineContentHeight-24*c.scale)*R}return{rect:E.rect,metrics:E.metrics,baselineOffset:T}}function ib(c,i,a,h,m){const w=m[c.imageName];if(!w)return null;const C=w.paddedRect,E=w.displaySize,T={width:E[0],height:E[1],left:1,top:-3,advance:i?E[1]:E[0]};let R;if(i)R=h.verticalLineContentWidth-E[1]*c.scale;else{const L=o_(c.verticalAlign);R=(h.horizontalLineContentHeight-E[1]*c.scale)*L}return{rect:C,metrics:T,baselineOffset:R,imageOffset:(i?E[0]:E[1])*c.scale-24*a}}function sb(c,i,a,h){if(0===h)return;const m=c[a],w=(c[a].x+m.metrics.advance*m.scale)*h;for(let C=i;C<=a;C++)c[C].x-=w}function _p(c,i,a){const{horizontalAlign:h,verticalAlign:m}=Qg(a),w=i[0]-c.displaySize[0]*h,C=i[1]-c.displaySize[1]*m;return{image:c,top:C,bottom:C+c.displaySize[1],left:w,right:w+c.displaySize[0]}}function Jg(c){var i,a;let h=c.left,m=c.top,w=c.right-h,C=c.bottom-m;const E=null!==(i=c.image.textFitWidth)&&void 0!==i?i:"stretchOrShrink",T=null!==(a=c.image.textFitHeight)&&void 0!==a?a:"stretchOrShrink",R=(c.image.content[2]-c.image.content[0])/(c.image.content[3]-c.image.content[1]);if("proportional"===T){if("stretchOnly"===E&&w/C<R||"proportional"===E){const L=Math.ceil(C*R);h*=L/w,w=L}}else if("proportional"===E&&"stretchOnly"===T&&0!==R&&w/C>R){const L=Math.ceil(w/R);m*=L/C,C=L}return{x1:h,y1:m,x2:h+w,y2:m+C}}function em(c,i,a,h,m,w){const C=c.image;let E;if(C.content){const ne=C.content,ce=C.pixelRatio||1;E=[ne[0]/ce,ne[1]/ce,C.displaySize[0]-ne[2]/ce,C.displaySize[1]-ne[3]/ce]}const T=i.left*w,R=i.right*w;let L,z,$,q;"width"===a||"both"===a?(q=m[0]+T-h[3],z=m[0]+R+h[1]):(q=m[0]+(T+R-C.displaySize[0])/2,z=q+C.displaySize[0]);const Z=i.top*w,Q=i.bottom*w;return"height"===a||"both"===a?(L=m[1]+Z-h[0],$=m[1]+Q+h[2]):(L=m[1]+(Z+Q-C.displaySize[1])/2,$=L+C.displaySize[1]),{image:C,top:L,right:z,bottom:$,left:q,collisionPadding:E}}const rl=128,Wc=32640;function tm(c,i){const{expression:a}=i;if("constant"===a.kind)return{kind:"constant",layoutSize:a.evaluate(new Yn(c+1))};if("source"===a.kind)return{kind:"source"};{const{zoomStops:h,interpolationType:m}=a;let w=0;for(;w<h.length&&h[w]<=c;)w++;w=Math.max(0,w-1);let C=w;for(;C<h.length&&h[C]<c+1;)C++;C=Math.min(h.length-1,C);const E=h[w],T=h[C];return"composite"===a.kind?{kind:"composite",minZoom:E,maxZoom:T,interpolationType:m}:{kind:"camera",minZoom:E,maxZoom:T,minSize:a.evaluate(new Yn(E)),maxSize:a.evaluate(new Yn(T)),interpolationType:m}}}function sf(c,i,a){let h="never";const m=c.get(i);return m?h=m:c.get(a)&&(h="always"),h}const yp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function vp(c,i,a,h,m,w,C,E,T,R,L,z,$){const q=E?Math.min(Wc,Math.round(E[0])):0,Z=E?Math.min(Wc,Math.round(E[1])):0;c.emplaceBack(i,a,Math.round(32*h),Math.round(32*m),w,C,(q<<1)+(T?1:0),Z,16*R,16*L,256*z,256*$)}function nm(c,i,a){c.emplaceBack(i.x,i.y,a),c.emplaceBack(i.x,i.y,a),c.emplaceBack(i.x,i.y,a),c.emplaceBack(i.x,i.y,a)}function ab(c){for(const i of c.sections)if(hs(i.text))return!0;return!1}class rm{constructor(i){this.layoutVertexArray=new tt,this.indexArray=new $n,this.programConfigurations=i,this.segments=new tn,this.dynamicLayoutVertexArray=new qe,this.opacityVertexArray=new Mt,this.hasVisibleVertices=!1,this.placedSymbolArray=new Y}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(i,a,h,m){this.isEmpty()||(h&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Q0.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,J0.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,yp,!0),this.opacityVertexBuffer.itemSize=1),(h||m)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}ht("SymbolBuffers",rm);class om{constructor(i,a,h){this.layoutVertexArray=new i,this.layoutAttributes=a,this.indexArray=new h,this.segments=new tn,this.collisionVertexArray=new Sn}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Zd.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}ht("CollisionBuffers",om);class Xd{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.globalState=i.globalState,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(C=>C.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=tm(this.zoom,a["text-size"]),this.iconSizeData=tm(this.zoom,a["icon-size"]);const h=this.layers[0].layout,m=h.get("symbol-sort-key"),w=h.get("symbol-z-order");this.canOverlap="never"!==sf(h,"text-overlap","text-allow-overlap")||"never"!==sf(h,"icon-overlap","icon-allow-overlap")||h.get("text-ignore-placement")||h.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==w&&!m.isConstant(),this.sortFeaturesByY=("viewport-y"===w||"auto"===w&&!this.sortFeaturesByKey)&&this.canOverlap,"point"===h.get("symbol-placement")&&(this.writingModes=h.get("text-writing-mode").map(C=>W.ao[C])),this.stateDependentLayerIds=this.layers.filter(C=>C.isStateDependent()).map(C=>C.id),this.sourceID=i.sourceID}createArrays(){this.text=new rm(new Ei(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new rm(new Ei(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new ie,this.lineVertexArray=new ue,this.symbolInstances=new re,this.textAnchorOffsets=new he}calculateGlyphDependencies(i,a,h,m,w){for(let C=0;C<i.length;C++)if(a[i.charCodeAt(C)]=!0,(h||m)&&w){const E=Yd[i.charAt(C)];E&&(a[E.charCodeAt(0)]=!0)}}populate(i,a,h){const m=this.layers[0],w=m.layout,C=w.get("text-font"),E=w.get("text-field"),T=w.get("icon-image"),R=("constant"!==E.value.kind||E.value.value instanceof uo&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&("constant"!==C.value.kind||C.value.value.length>0),L="constant"!==T.value.kind||!!T.value.value||Object.keys(T.parameters).length>0,z=w.get("symbol-sort-key");if(this.features=[],!R&&!L)return;const $=a.iconDependencies,q=a.glyphDependencies,Z=a.availableImages,Q=new Yn(this.zoom,{globalState:this.globalState});for(const{feature:ne,id:ce,index:Se,sourceLayerIndex:ge}of i){const ye=m._featureFilter.needGeometry,Re=Ws(ne,ye);if(!m._featureFilter.filter(Q,Re,h))continue;let je,Ze;if(ye||(Re.geometry=nl(ne)),R){const et=m.getValueAndResolveTokens("text-field",Re,h,Z),st=uo.factory(et),Dt=this.hasRTLText=this.hasRTLText||ab(st);(!Dt||"unavailable"===So.getRTLTextPluginStatus()||Dt&&So.isParsed())&&(je=Zv(st,m,Re))}if(L){const et=m.getValueAndResolveTokens("icon-image",Re,h,Z);Ze=et instanceof Jr?et:Jr.fromString(et)}if(!je&&!Ze)continue;const ut=this.sortFeaturesByKey?z.evaluate(Re,{},h):void 0;if(this.features.push({id:ce,text:je,icon:Ze,index:Se,sourceLayerIndex:ge,geometry:Re.geometry,properties:ne.properties,type:$l.types[ne.type],sortKey:ut}),Ze&&($[Ze.name]=!0),je){const et=C.evaluate(Re,{},h).join(","),st="viewport"!==w.get("text-rotation-alignment")&&"point"!==w.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(W.ao.vertical)>=0;for(const Dt of je.sections)if(Dt.image)$[Dt.image.name]=!0;else{const Xe=ds(je.toString()),rt=Dt.fontStack||et,ze=q[rt]=q[rt]||{};this.calculateGlyphDependencies(Dt.text,ze,st,this.allowVerticalPlacement,Xe)}}}"line"===w.get("symbol-placement")&&(this.features=function(ne){const ce={},Se={},ge=[];let ye=0;function Re(et){ge.push(ne[et]),ye++}function je(et,st,Dt){const Xe=Se[et];return delete Se[et],Se[st]=Xe,ge[Xe].geometry[0].pop(),ge[Xe].geometry[0]=ge[Xe].geometry[0].concat(Dt[0]),Xe}function Ze(et,st,Dt){const Xe=ce[st];return delete ce[st],ce[et]=Xe,ge[Xe].geometry[0].shift(),ge[Xe].geometry[0]=Dt[0].concat(ge[Xe].geometry[0]),Xe}function ut(et,st,Dt){const Xe=Dt?st[0][st[0].length-1]:st[0][0];return`${et}:${Xe.x}:${Xe.y}`}for(let et=0;et<ne.length;et++){const st=ne[et],Dt=st.geometry,Xe=st.text?st.text.toString():null;if(!Xe){Re(et);continue}const rt=ut(Xe,Dt),ze=ut(Xe,Dt,!0);if(rt in Se&&ze in ce&&Se[rt]!==ce[ze]){const Pt=Ze(rt,ze,Dt),Bt=je(rt,ze,ge[Pt].geometry);delete ce[rt],delete Se[ze],Se[ut(Xe,ge[Bt].geometry,!0)]=Bt,ge[Pt].geometry=null}else rt in Se?je(rt,ze,Dt):ze in ce?Ze(rt,ze,Dt):(Re(et),ce[rt]=ye-1,Se[ze]=ye-1)}return ge.filter(et=>et.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ne,ce)=>ne.sortKey-ce.sortKey)}update(i,a,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,a,this.layers,h),this.icon.programConfigurations.updatePaintArrays(i,a,this.layers,h))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,a){const h=this.lineVertexArray.length;if(void 0!==i.segment){let m=i.dist(a[i.segment+1]),w=i.dist(a[i.segment]);const C={};for(let E=i.segment+1;E<a.length;E++)C[E]={x:a[E].x,y:a[E].y,tileUnitDistanceFromAnchor:m},E<a.length-1&&(m+=a[E+1].dist(a[E]));for(let E=i.segment||0;E>=0;E--)C[E]={x:a[E].x,y:a[E].y,tileUnitDistanceFromAnchor:w},E>0&&(w+=a[E-1].dist(a[E]));for(let E=0;E<a.length;E++){const T=C[E];this.lineVertexArray.emplaceBack(T.x,T.y,T.tileUnitDistanceFromAnchor)}}return{lineStartIndex:h,lineLength:this.lineVertexArray.length-h}}addSymbols(i,a,h,m,w,C,E,T,R,L,z,$){const q=i.indexArray,Z=i.layoutVertexArray,Q=i.segments.prepareSegment(4*a.length,Z,q,this.canOverlap?C.sortKey:void 0),ne=this.glyphOffsetArray.length,ce=Q.vertexLength,Se=this.allowVerticalPlacement&&E===W.ao.vertical?Math.PI/2:0,ge=C.text&&C.text.sections;for(let ye=0;ye<a.length;ye++){const{tl:Re,tr:je,bl:Ze,br:ut,tex:et,pixelOffsetTL:st,pixelOffsetBR:Dt,minFontScaleX:Xe,minFontScaleY:rt,glyphOffset:ze,isSDF:Pt,sectionIndex:Bt}=a[ye],Ct=Q.vertexLength,xt=ze[1];vp(Z,T.x,T.y,Re.x,xt+Re.y,et.x,et.y,h,Pt,st.x,st.y,Xe,rt),vp(Z,T.x,T.y,je.x,xt+je.y,et.x+et.w,et.y,h,Pt,Dt.x,st.y,Xe,rt),vp(Z,T.x,T.y,Ze.x,xt+Ze.y,et.x,et.y+et.h,h,Pt,st.x,Dt.y,Xe,rt),vp(Z,T.x,T.y,ut.x,xt+ut.y,et.x+et.w,et.y+et.h,h,Pt,Dt.x,Dt.y,Xe,rt),nm(i.dynamicLayoutVertexArray,T,Se),q.emplaceBack(Ct,Ct+2,Ct+1),q.emplaceBack(Ct+1,Ct+2,Ct+3),Q.vertexLength+=4,Q.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ze[0]),ye!==a.length-1&&Bt===a[ye+1].sectionIndex||i.programConfigurations.populatePaintArrays(Z.length,C,C.index,{},$,ge&&ge[Bt])}i.placedSymbolArray.emplaceBack(T.x,T.y,ne,this.glyphOffsetArray.length-ne,ce,R,L,T.segment,h?h[0]:0,h?h[1]:0,m[0],m[1],E,0,!1,0,z)}_addCollisionDebugVertex(i,a,h,m,w,C){return a.emplaceBack(0,0),i.emplaceBack(h.x,h.y,m,w,Math.round(C.x),Math.round(C.y))}addCollisionDebugVertices(i,a,h,m,w,C,E){const T=w.segments.prepareSegment(4,w.layoutVertexArray,w.indexArray),R=T.vertexLength,L=w.layoutVertexArray,z=w.collisionVertexArray,$=E.anchorX,q=E.anchorY;this._addCollisionDebugVertex(L,z,C,$,q,new Ye(i,a)),this._addCollisionDebugVertex(L,z,C,$,q,new Ye(h,a)),this._addCollisionDebugVertex(L,z,C,$,q,new Ye(h,m)),this._addCollisionDebugVertex(L,z,C,$,q,new Ye(i,m)),T.vertexLength+=4;const Z=w.indexArray;Z.emplaceBack(R,R+1),Z.emplaceBack(R+1,R+2),Z.emplaceBack(R+2,R+3),Z.emplaceBack(R+3,R),T.primitiveLength+=4}addDebugCollisionBoxes(i,a,h,m){for(let w=i;w<a;w++){const C=this.collisionBoxArray.get(w);this.addCollisionDebugVertices(C.x1,C.y1,C.x2,C.y2,m?this.textCollisionBox:this.iconCollisionBox,C.anchorPoint,h)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new om(nn,hp.members,Bn),this.iconCollisionBox=new om(nn,hp.members,Bn);for(let i=0;i<this.symbolInstances.length;i++){const a=this.symbolInstances.get(i);this.addDebugCollisionBoxes(a.textBoxStartIndex,a.textBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a,!0),this.addDebugCollisionBoxes(a.iconBoxStartIndex,a.iconBoxEndIndex,a,!1),this.addDebugCollisionBoxes(a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex,a,!1)}}_deserializeCollisionBoxesForSymbol(i,a,h,m,w,C,E,T,R){const L={};for(let z=a;z<h;z++){const $=i.get(z);L.textBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.textFeatureIndex=$.featureIndex;break}for(let z=m;z<w;z++){const $=i.get(z);L.verticalTextBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.verticalTextFeatureIndex=$.featureIndex;break}for(let z=C;z<E;z++){const $=i.get(z);L.iconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.iconFeatureIndex=$.featureIndex;break}for(let z=T;z<R;z++){const $=i.get(z);L.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},L.verticalIconFeatureIndex=$.featureIndex;break}return L}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const h=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,h.textBoxStartIndex,h.textBoxEndIndex,h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h.iconBoxStartIndex,h.iconBoxEndIndex,h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,a){const h=i.placedSymbolArray.get(a),m=h.vertexStartIndex+4*h.numGlyphs;for(let w=h.vertexStartIndex;w<m;w+=4)i.indexArray.emplaceBack(w,w+2,w+1),i.indexArray.emplaceBack(w+1,w+2,w+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const a=Math.sin(i),h=Math.cos(i),m=[],w=[],C=[];for(let E=0;E<this.symbolInstances.length;++E){C.push(E);const T=this.symbolInstances.get(E);m.push(0|Math.round(a*T.anchorX+h*T.anchorY)),w.push(T.featureIndex)}return C.sort((E,T)=>m[E]-m[T]||w[T]-w[E]),C}addToSortKeyRanges(i,a){const h=this.sortKeyRanges[this.sortKeyRanges.length-1];h&&h.sortKey===a?h.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const h=this.symbolInstances.get(a);this.featureSortOrder.push(h.featureIndex),[h.rightJustifiedTextSymbolIndex,h.centerJustifiedTextSymbolIndex,h.leftJustifiedTextSymbolIndex].forEach((m,w,C)=>{m>=0&&C.indexOf(m)===w&&this.addIndicesForPlacedSymbol(this.text,m)}),h.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,h.verticalPlacedTextSymbolIndex),h.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.placedIconSymbolIndex),h.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,h.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let bp,i_;ht("SymbolBucket",Xd,{omit:["layers","collisionBoxArray","features","compareText"]}),Xd.MAX_GLYPHS=65535,Xd.addDynamicAttributes=nm;var xp={get paint(){return i_=i_||new ft({"icon-opacity":new G(Me.paint_symbol["icon-opacity"]),"icon-color":new G(Me.paint_symbol["icon-color"]),"icon-halo-color":new G(Me.paint_symbol["icon-halo-color"]),"icon-halo-width":new G(Me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new G(Me.paint_symbol["icon-halo-blur"]),"icon-translate":new k(Me.paint_symbol["icon-translate"]),"icon-translate-anchor":new k(Me.paint_symbol["icon-translate-anchor"]),"text-opacity":new G(Me.paint_symbol["text-opacity"]),"text-color":new G(Me.paint_symbol["text-color"],{runtimeType:Er,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new G(Me.paint_symbol["text-halo-color"]),"text-halo-width":new G(Me.paint_symbol["text-halo-width"]),"text-halo-blur":new G(Me.paint_symbol["text-halo-blur"]),"text-translate":new k(Me.paint_symbol["text-translate"]),"text-translate-anchor":new k(Me.paint_symbol["text-translate-anchor"])})},get layout(){return bp=bp||new ft({"symbol-placement":new k(Me.layout_symbol["symbol-placement"]),"symbol-spacing":new k(Me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new k(Me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new G(Me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new k(Me.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new k(Me.layout_symbol["icon-allow-overlap"]),"icon-overlap":new k(Me.layout_symbol["icon-overlap"]),"icon-ignore-placement":new k(Me.layout_symbol["icon-ignore-placement"]),"icon-optional":new k(Me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new k(Me.layout_symbol["icon-rotation-alignment"]),"icon-size":new G(Me.layout_symbol["icon-size"]),"icon-text-fit":new k(Me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new k(Me.layout_symbol["icon-text-fit-padding"]),"icon-image":new G(Me.layout_symbol["icon-image"]),"icon-rotate":new G(Me.layout_symbol["icon-rotate"]),"icon-padding":new G(Me.layout_symbol["icon-padding"]),"icon-keep-upright":new k(Me.layout_symbol["icon-keep-upright"]),"icon-offset":new G(Me.layout_symbol["icon-offset"]),"icon-anchor":new G(Me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new k(Me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new k(Me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new k(Me.layout_symbol["text-rotation-alignment"]),"text-field":new G(Me.layout_symbol["text-field"]),"text-font":new G(Me.layout_symbol["text-font"]),"text-size":new G(Me.layout_symbol["text-size"]),"text-max-width":new G(Me.layout_symbol["text-max-width"]),"text-line-height":new k(Me.layout_symbol["text-line-height"]),"text-letter-spacing":new G(Me.layout_symbol["text-letter-spacing"]),"text-justify":new G(Me.layout_symbol["text-justify"]),"text-radial-offset":new G(Me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new k(Me.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new G(Me.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new G(Me.layout_symbol["text-anchor"]),"text-max-angle":new k(Me.layout_symbol["text-max-angle"]),"text-writing-mode":new k(Me.layout_symbol["text-writing-mode"]),"text-rotate":new G(Me.layout_symbol["text-rotate"]),"text-padding":new k(Me.layout_symbol["text-padding"]),"text-keep-upright":new k(Me.layout_symbol["text-keep-upright"]),"text-transform":new G(Me.layout_symbol["text-transform"]),"text-offset":new G(Me.layout_symbol["text-offset"]),"text-allow-overlap":new k(Me.layout_symbol["text-allow-overlap"]),"text-overlap":new k(Me.layout_symbol["text-overlap"]),"text-ignore-placement":new k(Me.layout_symbol["text-ignore-placement"]),"text-optional":new k(Me.layout_symbol["text-optional"])})}};class im{constructor(i){if(void 0===i.property.overrides)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=i.property.overrides?i.property.overrides.runtimeType:sa,this.defaultValue=i}evaluate(i){if(i.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(i.formattedSection))return a.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ht("FormatSectionOverride",im,{omit:["defaultValue"]});class wp extends Kn{constructor(i){super(i,xp)}recalculate(i,a){if(super.recalculate(i,a),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]="map"===this.layout.get("text-rotation-alignment")?"map":"viewport"),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){const h=this.layout.get("text-writing-mode");if(h){const m=[];for(const w of h)m.indexOf(w)<0&&m.push(w);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(i,a,h,m){const w=this.layout.get(i).evaluate(a,{},h,m),C=this._unevaluatedLayout._values[i];return C.isDataDriven()||kl(C.value)||!w?w:(E=a.properties,w.replace(/{([^{}]+)}/g,(R,L)=>E&&L in E?String(E[L]):""));var E}createBucket(i){return new Xd(i)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const i of xp.paint.overridableProperties){if(!wp.hasPaintOverride(this.layout,i))continue;const a=this.paint.get(i),h=new im(a),m=new bd(h,a.property.specification);let w=null;w="constant"===a.value.kind||"source"===a.value.kind?new Rl("source",m):new xd("composite",m,a.value.zoomStops),this.paint._values[i]=new $i(a.property,w,a.parameters)}}_handleOverridablePaintPropertyUpdate(i,a,h){return!(!this.layout||a.isDataDriven()||h.isDataDriven())&&wp.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,a){const h=i.get("text-field"),m=xp.paint.properties[a];let w=!1;const C=E=>{for(const T of E)if(m.overrides&&m.overrides.hasOverride(T))return void(w=!0)};if("constant"===h.value.kind&&h.value.value instanceof uo)C(h.value.value.sections);else if("source"===h.value.kind){const E=R=>{w||(R instanceof Ho&&Ot(R.value)===Fr?C(R.value.sections):R instanceof Ns?C(R.sections):R.eachChild(E))},T=h.value;T._styleExpression&&E(T._styleExpression.expression)}return w}}let Qd;var Cp={get paint(){return Qd=Qd||new ft({"background-color":new k(Me.paint_background["background-color"]),"background-pattern":new Ae(Me.paint_background["background-pattern"]),"background-opacity":new k(Me.paint_background["background-opacity"])})}};class Lw extends Kn{constructor(i){super(i,Cp)}}let s_;var a_={get paint(){return s_=s_||new ft({"raster-opacity":new k(Me.paint_raster["raster-opacity"]),"raster-hue-rotate":new k(Me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new k(Me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new k(Me.paint_raster["raster-brightness-max"]),"raster-saturation":new k(Me.paint_raster["raster-saturation"]),"raster-contrast":new k(Me.paint_raster["raster-contrast"]),"raster-resampling":new k(Me.paint_raster["raster-resampling"]),"raster-fade-duration":new k(Me.paint_raster["raster-fade-duration"])})}};class sm extends Kn{constructor(i){super(i,a_)}}class lb extends Kn{constructor(i){super(i,{}),this.onAdd=a=>{this.implementation.onAdd&&this.implementation.onAdd(a,a.painter.context.gl)},this.onRemove=a=>{this.implementation.onRemove&&this.implementation.onRemove(a,a.painter.context.gl)},this.implementation=i}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class l_{constructor(i){this._methodToThrottle=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Fw={once:!0},c_=6371008.8;class qc{constructor(i,a){if(isNaN(i)||isNaN(a))throw new Error(`Invalid LngLat object: (${i}, ${a})`);if(this.lng=+i,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new qc(ai(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const a=Math.PI/180,h=this.lat*a,m=i.lat*a,w=Math.sin(h)*Math.sin(m)+Math.cos(h)*Math.cos(m)*Math.cos((i.lng-this.lng)*a);return c_*Math.acos(Math.min(w,1))}static convert(i){if(i instanceof qc)return i;if(Array.isArray(i)&&(2===i.length||3===i.length))return new qc(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&"object"==typeof i&&null!==i)return new qc(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const am=2*Math.PI*c_;function lm(c){return am*Math.cos(c*Math.PI/180)}function cb(c){return(180+c)/360}function cm(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function u_(c,i){return c/lm(i)}function d_(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function ub(c,i){return c*lm(d_(i))}class Sp{constructor(i,a,h=0){this.x=+i,this.y=+a,this.z=+h}static fromLngLat(i,a=0){const h=qc.convert(i);return new Sp(cb(h.lng),cm(h.lat),u_(a,h.lat))}toLngLat(){return new qc(360*this.x-180,d_(this.y))}toAltitude(){return ub(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/am*(i=d_(this.y),1/Math.cos(i*Math.PI/180));var i}}function h_(c,i,a){var h=2*Math.PI*6378137/256/Math.pow(2,a);return[c*h-2*Math.PI*6378137/2,i*h-2*Math.PI*6378137/2]}class f_{constructor(i,a,h){if(w=a,C=h,(m=i)<0||m>25||C<0||C>=Math.pow(2,m)||w<0||w>=Math.pow(2,m))throw new Error(`x=${a}, y=${h}, z=${i} outside of bounds. 0<=x<${Math.pow(2,i)}, 0<=y<${Math.pow(2,i)} 0<=z<=25 `);var m,w,C;this.z=i,this.x=a,this.y=h,this.key=Jd(0,i,i,a,h)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,a,h){const m=(C=this.y,E=this.z,T=h_(256*(w=this.x),256*(C=Math.pow(2,E)-C-1),E),R=h_(256*(w+1),256*(C+1),E),T[0]+","+T[1]+","+R[0]+","+R[1]);var w,C,E,T,R;const L=function(z,$,q){let Z,Q="";for(let ne=z;ne>0;ne--)Z=1<<ne-1,Q+=($&Z?1:0)+(q&Z?2:0);return Q}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===h?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,a>1?"@2x":"").replace(/{quadkey}/g,L).replace(/{bbox-epsg-3857}/g,m)}isChildOf(i){const a=this.z-i.z;return a>0&&i.x===this.x>>a&&i.y===this.y>>a}getTilePoint(i){const a=Math.pow(2,this.z);return new Ye((i.x*a-this.x)*an,(i.y*a-this.y)*an)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Ep{constructor(i,a){this.wrap=i,this.canonical=a,this.key=Jd(i,a.z,a.z,a.x,a.y)}}class ys{constructor(i,a,h,m,w){if(this.terrainRttPosMatrix32f=null,i<h)throw new Error(`overscaledZ should be >= z; overscaledZ = ${i}; z = ${h}`);this.overscaledZ=i,this.wrap=a,this.canonical=new f_(h,+m,+w),this.key=Jd(a,i,h,m,w)}clone(){return new ys(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-i;return i>this.canonical.z?new ys(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ys(i,this.wrap,i,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(i,a){if(i>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${i}; overscaledZ = ${this.overscaledZ}`);const h=this.canonical.z-i;return i>this.canonical.z?Jd(this.wrap*+a,i,this.canonical.z,this.canonical.x,this.canonical.y):Jd(this.wrap*+a,i,i,this.canonical.x>>h,this.canonical.y>>h)}isChildOf(i){if(i.wrap!==this.wrap)return!1;const a=this.canonical.z-i.canonical.z;return 0===i.overscaledZ||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>a&&i.canonical.y===this.canonical.y>>a}children(i){if(this.overscaledZ>=i)return[new ys(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,h=2*this.canonical.x,m=2*this.canonical.y;return[new ys(a,this.wrap,a,h,m),new ys(a,this.wrap,a,h+1,m),new ys(a,this.wrap,a,h,m+1),new ys(a,this.wrap,a,h+1,m+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new ys(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new ys(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Ep(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(i){return this.canonical.getTilePoint(new Sp(i.x-this.wrap,i.y))}}function Jd(c,i,a,h,m){(c*=2)<0&&(c=-1*c-1);const w=1<<a;return(w*w*c+w*m+h).toString(36)+a.toString(36)+i.toString(36)}function af(c,i){return i?c.properties[i]:c.id}ht("CanonicalTileID",f_),ht("OverscaledTileID",ys,{omit:["terrainRttPosMatrix32f"]});class vs{constructor(){this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0}extend(i){return this.minX=Math.min(this.minX,i.x),this.minY=Math.min(this.minY,i.y),this.maxX=Math.max(this.maxX,i.x),this.maxY=Math.max(this.maxY,i.y),this}expandBy(i){return this.minX-=i,this.minY-=i,this.maxX+=i,this.maxY+=i,(this.minX>this.maxX||this.minY>this.maxY)&&(this.minX=1/0,this.maxX=-1/0,this.minY=1/0,this.maxY=-1/0),this}shrinkBy(i){return this.expandBy(-i)}map(i){const a=new vs;return a.extend(i(new Ye(this.minX,this.minY))),a.extend(i(new Ye(this.maxX,this.minY))),a.extend(i(new Ye(this.minX,this.maxY))),a.extend(i(new Ye(this.maxX,this.maxY))),a}static fromPoints(i){const a=new vs;for(const h of i)a.extend(h);return a}contains(i){return i.x>=this.minX&&i.x<=this.maxX&&i.y>=this.minY&&i.y<=this.maxY}empty(){return this.minX>this.maxX}width(){return this.maxX-this.minX}height(){return this.maxY-this.minY}covers(i){return!this.empty()&&!i.empty()&&i.minX>=this.minX&&i.maxX<=this.maxX&&i.minY>=this.minY&&i.maxY<=this.maxY}intersects(i){return!this.empty()&&!i.empty()&&i.minX<=this.maxX&&i.maxX>=this.minX&&i.minY<=this.maxY&&i.maxY>=this.minY}}class eh{constructor(i){this._stringToNumber={},this._numberToString=[];for(let a=0;a<i.length;a++){const h=i[a];this._stringToNumber[h]=a,this._numberToString[a]=h}}encode(i){return this._stringToNumber[i]}decode(i){if(i>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${i} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[i]}}class Mp{constructor(i,a,h,m,w){this.type="Feature",this._vectorTileFeature=i,i._z=a,i._x=h,i._y=m,this.properties=i.properties,this.id=w}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={geometry:this.geometry};for(const a in this)"_geometry"!==a&&"_vectorTileFeature"!==a&&(i[a]=this[a]);return i}}class Tp{constructor(i,a){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Ka(an,16,0),this.grid3D=new Ka(an,16,0),this.featureIndexArray=new ve,this.promoteId=a}insert(i,a,h,m,w,C){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(h,m,w);const T=C?this.grid3D:this.grid;for(let R=0;R<a.length;R++){const L=a[R],z=[1/0,1/0,-1/0,-1/0];for(let $=0;$<L.length;$++){const q=L[$];z[0]=Math.min(z[0],q.x),z[1]=Math.min(z[1],q.y),z[2]=Math.max(z[2],q.x),z[3]=Math.max(z[3],q.y)}z[0]<an&&z[1]<an&&z[2]>=0&&z[3]>=0&&T.insert(E,z[0],z[1],z[2],z[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new W0(new Yg(this.rawTileData)).layers,this.sourceLayerCoder=new eh(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(i,a,h,m){this.loadVTLayers();const w=i.params,C=an/i.tileSize/i.scale,E=Ui(w.filter),T=i.queryGeometry,R=i.queryPadding*C,L=vs.fromPoints(T),z=this.grid.query(L.minX-R,L.minY-R,L.maxX+R,L.maxY+R),$=vs.fromPoints(i.cameraQueryGeometry).expandBy(R),q=this.grid3D.query($.minX,$.minY,$.maxX,$.maxY,(ne,ce,Se,ge)=>function(ye,Re,je,Ze,ut){for(const st of ye)if(Re<=st.x&&je<=st.y&&Ze>=st.x&&ut>=st.y)return!0;const et=[new Ye(Re,je),new Ye(Re,ut),new Ye(Ze,ut),new Ye(Ze,je)];if(ye.length>2)for(const st of et)if(ku(ye,st))return!0;for(let st=0;st<ye.length-1;st++)if(Tv(ye[st],ye[st+1],et))return!0;return!1}(i.cameraQueryGeometry,ne-R,ce-R,Se+R,ge+R));for(const ne of q)z.push(ne);z.sort(th);const Z={};let Q;for(let ne=0;ne<z.length;ne++){const ce=z[ne];if(ce===Q)continue;Q=ce;const Se=this.featureIndexArray.get(ce);let ge=null;this.loadMatchingFeature(Z,Se.bucketIndex,Se.sourceLayerIndex,Se.featureIndex,E,w.layers,w.availableImages,a,h,m,(ye,Re,je)=>(ge||(ge=nl(ye)),Re.queryIntersectsFeature({queryGeometry:T,feature:ye,featureState:je,geometry:ge,zoom:this.z,transform:i.transform,pixelsToTileUnits:C,pixelPosMatrix:i.pixelPosMatrix,unwrappedTileID:this.tileID.toUnwrapped(),getElevation:i.getElevation})))}return Z}loadMatchingFeature(i,a,h,m,w,C,E,T,R,L,z){const $=this.bucketLayerIDs[a];if(C&&!$.some(ne=>C.has(ne)))return;const q=this.sourceLayerCoder.decode(h),Z=this.vtLayers[q].feature(m);if(w.needGeometry){const ne=Ws(Z,!0);if(!w.filter(new Yn(this.tileID.overscaledZ),ne,this.tileID.canonical))return}else if(!w.filter(new Yn(this.tileID.overscaledZ),Z))return;const Q=this.getId(Z,q);for(let ne=0;ne<$.length;ne++){const ce=$[ne];if(C&&!C.has(ce))continue;const Se=T[ce];if(!Se)continue;let ge={};Q&&L&&(ge=L.getState(Se.sourceLayer||"_geojsonTileLayer",Q));const ye=Qn({},R[ce]);ye.paint=p_(ye.paint,Se.paint,Z,ge,E),ye.layout=p_(ye.layout,Se.layout,Z,ge,E);const Re=!z||z(Z,Se,ge);if(!Re)continue;const je=new Mp(Z,this.z,this.x,this.y,Q);je.layer=ye;let Ze=i[ce];void 0===Ze&&(Ze=i[ce]=[]),Ze.push({featureIndex:m,feature:je,intersectionZ:Re})}}lookupSymbolFeatures(i,a,h,m,w,C,E,T){const R={};this.loadVTLayers();const L=Ui(w);for(const z of i)this.loadMatchingFeature(R,h,m,z,L,C,E,T,a);return R}hasLayer(i){for(const a of this.bucketLayerIDs)for(const h of a)if(i===h)return!0;return!1}getId(i,a){var h;let m=i.id;return this.promoteId&&(m=i.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[a]],"boolean"==typeof m&&(m=Number(m)),void 0===m&&!(null===(h=i.properties)||void 0===h)&&h.cluster&&this.promoteId&&(m=Number(i.properties.cluster_id))),m}}function p_(c,i,a,h,m){return li(c,(w,C)=>{const E=i instanceof Fc?i.get(C):null;return E&&E.evaluate?E.evaluate(a,h,m):E})}function th(c,i){return i-c}function um(c,i,a,h,m){const w=[];for(let C=0;C<c.length;C++){const E=c[C];let T;for(let R=0;R<E.length-1;R++){let L=E[R],z=E[R+1];L.x<i&&z.x<i||(L.x<i?L=new Ye(i,L.y+(i-L.x)/(z.x-L.x)*(z.y-L.y))._round():z.x<i&&(z=new Ye(i,L.y+(i-L.x)/(z.x-L.x)*(z.y-L.y))._round()),L.y<a&&z.y<a||(L.y<a?L=new Ye(L.x+(a-L.y)/(z.y-L.y)*(z.x-L.x),a)._round():z.y<a&&(z=new Ye(L.x+(a-L.y)/(z.y-L.y)*(z.x-L.x),a)._round()),L.x>=h&&z.x>=h||(L.x>=h?L=new Ye(h,L.y+(h-L.x)/(z.x-L.x)*(z.y-L.y))._round():z.x>=h&&(z=new Ye(h,L.y+(h-L.x)/(z.x-L.x)*(z.y-L.y))._round()),L.y>=m&&z.y>=m||(L.y>=m?L=new Ye(L.x+(m-L.y)/(z.y-L.y)*(z.x-L.x),m)._round():z.y>=m&&(z=new Ye(L.x+(m-L.y)/(z.y-L.y)*(z.x-L.x),m)._round()),T&&L.equals(T[T.length-1])||(T=[L],w.push(T)),T.push(z)))))}}return w}ht("FeatureIndex",Tp,{omit:["rawTileData","sourceLayerCoder"]});class Zc extends Ye{constructor(i,a,h,m){super(i,a),this.angle=h,void 0!==m&&(this.segment=m)}clone(){return new Zc(this.x,this.y,this.angle,this.segment)}}function db(c,i,a,h,m){if(void 0===i.segment||0===a)return!0;let w=i,C=i.segment+1,E=0;for(;E>-a/2;){if(C--,C<0)return!1;E-=c[C].dist(w),w=c[C]}E+=c[C].dist(c[C+1]),C++;const T=[];let R=0;for(;E<a/2;){const L=c[C],z=c[C+1];if(!z)return!1;let $=c[C-1].angleTo(L)-L.angleTo(z);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:E,angleDelta:$}),R+=$;E-T[0].distance>h;)R-=T.shift().angleDelta;if(R>m)return!1;C++,E+=L.dist(z)}return!0}function g_(c){let i=0;for(let a=0;a<c.length-1;a++)i+=c[a].dist(c[a+1]);return i}function m_(c,i,a){return c?.6*i*a:0}function __(c,i){return Math.max(c?c.right-c.left:0,i?i.right-i.left:0)}function Ip(c,i,a,h,m,w){const C=m_(a,m,w),E=__(a,h)*w;let T=0;const R=g_(c)/2;for(let L=0;L<c.length-1;L++){const z=c[L],$=c[L+1],q=z.dist($);if(T+q>R){const Z=(R-T)/q,Q=Wo.number(z.x,$.x,Z),ne=Wo.number(z.y,$.y,Z),ce=new Zc(Q,ne,$.angleTo(z),L);return ce._round(),!C||db(c,ce,E,C,i)?ce:void 0}T+=q}}function hb(c,i,a,h,m,w,C,E,T){const R=m_(h,w,C),L=__(h,m),z=L*C,$=0===c[0].x||c[0].x===T||0===c[0].y||c[0].y===T;return i-z<i/4&&(i=z+i/4),dm(c,$?i/2*E%i:(L/2+2*w)*C*E%i,i,R,a,z,$,!1,T)}function dm(c,i,a,h,m,w,C,E,T){const R=w/2,L=g_(c);let z=0,$=i-a,q=[];for(let Z=0;Z<c.length-1;Z++){const Q=c[Z],ne=c[Z+1],ce=Q.dist(ne),Se=ne.angleTo(Q);for(;$+a<z+ce;){$+=a;const ge=($-z)/ce,ye=Wo.number(Q.x,ne.x,ge),Re=Wo.number(Q.y,ne.y,ge);if(ye>=0&&ye<T&&Re>=0&&Re<T&&$-R>=0&&$+R<=L){const je=new Zc(ye,Re,Se,Z);je._round(),h&&!db(c,je,w,h,m)||q.push(je)}}z+=ce}return E||q.length||C||(q=dm(c,z/2,a,h,m,w,C,!0,T)),q}function lf(c,i,a,h){const m=[],w=c.image,C=w.pixelRatio,E=w.paddedRect.w-2,T=w.paddedRect.h-2;let R={x1:c.left,y1:c.top,x2:c.right,y2:c.bottom};const L=w.stretchX||[[0,E]],z=w.stretchY||[[0,T]],$=(ze,Pt)=>ze+Pt[1]-Pt[0],q=L.reduce($,0),Z=z.reduce($,0),Q=E-q,ne=T-Z;let ce=0,Se=q,ge=0,ye=Z,Re=0,je=Q,Ze=0,ut=ne;if(w.content&&h){const ze=w.content,Pt=ze[2]-ze[0],Bt=ze[3]-ze[1];(w.textFitWidth||w.textFitHeight)&&(R=Jg(c)),ce=Vu(L,0,ze[0]),ge=Vu(z,0,ze[1]),Se=Vu(L,ze[0],ze[2]),ye=Vu(z,ze[1],ze[3]),Re=ze[0]-ce,Ze=ze[1]-ge,je=Pt-Se,ut=Bt-ye}const et=R.x1,st=R.y1,Dt=R.x2-et,Xe=R.y2-st,rt=(ze,Pt,Bt,Ct)=>{const xt=Dp(ze.stretch-ce,Se,Dt,et),dn=Ap(ze.fixed-Re,je,ze.stretch,q),fr=Dp(Pt.stretch-ge,ye,Xe,st),ro=Ap(Pt.fixed-Ze,ut,Pt.stretch,Z),Eo=Dp(Bt.stretch-ce,Se,Dt,et),bs=Ap(Bt.fixed-Re,je,Bt.stretch,q),Mi=Dp(Ct.stretch-ge,ye,Xe,st),Zr=Ap(Ct.fixed-Ze,ut,Ct.stretch,Z),wr=new Ye(xt,fr),lr=new Ye(Eo,fr),Mo=new Ye(Eo,Mi),To=new Ye(xt,Mi),ii=new Ye(dn/C,ro/C),xs=new Ye(bs/C,Zr/C),po=i*Math.PI/180;if(po){const go=Math.sin(po),mo=Math.cos(po),oo=[mo,-go,go,mo];wr._matMult(oo),lr._matMult(oo),To._matMult(oo),Mo._matMult(oo)}const Zi=ze.stretch+ze.fixed,Yr=Pt.stretch+Pt.fixed;return{tl:wr,tr:lr,bl:To,br:Mo,tex:{x:w.paddedRect.x+1+Zi,y:w.paddedRect.y+1+Yr,w:Bt.stretch+Bt.fixed-Zi,h:Ct.stretch+Ct.fixed-Yr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ii,pixelOffsetBR:xs,minFontScaleX:je/C/Dt,minFontScaleY:ut/C/Xe,isSDF:a}};if(h&&(w.stretchX||w.stretchY)){const ze=y_(L,Q,q),Pt=y_(z,ne,Z);for(let Bt=0;Bt<ze.length-1;Bt++){const Ct=ze[Bt],xt=ze[Bt+1];for(let dn=0;dn<Pt.length-1;dn++)m.push(rt(Ct,Pt[dn],xt,Pt[dn+1]))}}else m.push(rt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:T+1}));return m}function Vu(c,i,a){let h=0;for(const m of c)h+=Math.max(i,Math.min(a,m[1]))-Math.max(i,Math.min(a,m[0]));return h}function y_(c,i,a){const h=[{fixed:-1,stretch:0}];for(const[m,w]of c){const C=h[h.length-1];h.push({fixed:m-C.stretch,stretch:C.stretch}),h.push({fixed:m-C.stretch,stretch:C.stretch+(w-m)})}return h.push({fixed:i+1,stretch:a}),h}function Dp(c,i,a,h){return c/i*a+h}function Ap(c,i,a,h){return c-i*a/h}ht("Anchor",Zc);class cf{constructor(i,a,h,m,w,C,E,T,R,L){var z;if(this.boxStartIndex=i.length,R){let $=C.top,q=C.bottom;const Z=C.collisionPadding;Z&&($-=Z[1],q+=Z[3]);let Q=q-$;Q>0&&(Q=Math.max(10,Q),this.circleDiameter=Q)}else{const $=null!==(z=C.image)&&void 0!==z&&z.content&&(C.image.textFitWidth||C.image.textFitHeight)?Jg(C):{x1:C.left,y1:C.top,x2:C.right,y2:C.bottom};$.y1=$.y1*E-T[0],$.y2=$.y2*E+T[2],$.x1=$.x1*E-T[3],$.x2=$.x2*E+T[1];const q=C.collisionPadding;if(q&&($.x1-=q[0]*E,$.y1-=q[1]*E,$.x2+=q[2]*E,$.y2+=q[3]*E),L){const Z=new Ye($.x1,$.y1),Q=new Ye($.x2,$.y1),ne=new Ye($.x1,$.y2),ce=new Ye($.x2,$.y2),Se=L*Math.PI/180;Z._rotate(Se),Q._rotate(Se),ne._rotate(Se),ce._rotate(Se),$.x1=Math.min(Z.x,Q.x,ne.x,ce.x),$.x2=Math.max(Z.x,Q.x,ne.x,ce.x),$.y1=Math.min(Z.y,Q.y,ne.y,ce.y),$.y2=Math.max(Z.y,Q.y,ne.y,ce.y)}i.emplaceBack(a.x,a.y,$.x1,$.y1,$.x2,$.y2,h,m,w)}this.boxEndIndex=i.length}}class v_{constructor(i=[],a=(h,m)=>h<m?-1:h>m?1:0){if(this.data=i,this.length=this.data.length,this.compare=a,this.length>0)for(let h=(this.length>>1)-1;h>=0;h--)this._down(h)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(0===this.length)return;const i=this.data[0],a=this.data.pop();return--this.length>0&&(this.data[0]=a,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:a,compare:h}=this,m=a[i];for(;i>0;){const w=i-1>>1,C=a[w];if(h(m,C)>=0)break;a[i]=C,i=w}a[i]=m}_down(i){const{data:a,compare:h}=this,m=this.length>>1,w=a[i];for(;i<m;){let C=1+(i<<1);const E=C+1;if(E<this.length&&h(a[E],a[C])<0&&(C=E),h(a[C],w)>=0)break;a[i]=a[C],i=C}a[i]=w}}function Bw(c,i=1,a=!1){const h=vs.fromPoints(c[0]),m=Math.min(h.width(),h.height());let w=m/2;const C=new v_([],fb),{minX:E,minY:T,maxX:R,maxY:L}=h;if(0===m)return new Ye(E,T);for(let q=E;q<R;q+=m)for(let Z=T;Z<L;Z+=m)C.push(new ol(q+w,Z+w,w,c));let z=function(q){let Z=0,Q=0,ne=0;const ce=q[0];for(let Se=0,ge=ce.length,ye=ge-1;Se<ge;ye=Se++){const Re=ce[Se],je=ce[ye],Ze=Re.x*je.y-je.x*Re.y;Q+=(Re.x+je.x)*Ze,ne+=(Re.y+je.y)*Ze,Z+=3*Ze}return new ol(Q/Z,ne/Z,0,q)}(c),$=C.length;for(;C.length;){const q=C.pop();(q.d>z.d||!z.d)&&(z=q,a&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,$)),q.max-z.d<=i||(w=q.h/2,C.push(new ol(q.p.x-w,q.p.y-w,w,c)),C.push(new ol(q.p.x+w,q.p.y-w,w,c)),C.push(new ol(q.p.x-w,q.p.y+w,w,c)),C.push(new ol(q.p.x+w,q.p.y+w,w,c)),$+=4)}return a&&(console.log(`num probes: ${$}`),console.log(`best distance: ${z.d}`)),z.p}function fb(c,i){return i.max-c.max}function ol(c,i,a,h){this.p=new Ye(c,i),this.h=a,this.d=function(m,w){let C=!1,E=1/0;for(let T=0;T<w.length;T++){const R=w[T];for(let L=0,z=R.length,$=z-1;L<z;$=L++){const q=R[L],Z=R[$];q.y>m.y!=Z.y>m.y&&m.x<(Z.x-q.x)*(m.y-q.y)/(Z.y-q.y)+q.x&&(C=!C),E=Math.min(E,kg(m,q,Z))}}return(C?1:-1)*Math.sqrt(E)}(this.p,h),this.max=this.d+this.h*Math.SQRT2}var Bo;W.aE=void 0,(Bo=W.aE||(W.aE={}))[Bo.center=1]="center",Bo[Bo.left=2]="left",Bo[Bo.right=3]="right",Bo[Bo.top=4]="top",Bo[Bo.bottom=5]="bottom",Bo[Bo["top-left"]=6]="top-left",Bo[Bo["top-right"]=7]="top-right",Bo[Bo["bottom-left"]=8]="bottom-left",Bo[Bo["bottom-right"]=9]="bottom-right";const Pp=Number.POSITIVE_INFINITY;function b_(c,i){return i[1]!==Pp?function(a,h,m){let w=0,C=0;switch(h=Math.abs(h),m=Math.abs(m),a){case"top-right":case"top-left":case"top":C=m-7;break;case"bottom-right":case"bottom-left":case"bottom":C=7-m}switch(a){case"top-right":case"bottom-right":case"right":w=-h;break;case"top-left":case"bottom-left":case"left":w=h}return[w,C]}(c,i[0],i[1]):function(a,h){let m=0,w=0;h<0&&(h=0);const C=h/Math.SQRT2;switch(a){case"top-right":case"top-left":w=C-7;break;case"bottom-right":case"bottom-left":w=7-C;break;case"bottom":w=7-h;break;case"top":w=h-7}switch(a){case"top-right":case"bottom-right":m=-C;break;case"top-left":case"bottom-left":m=C;break;case"left":m=h;break;case"right":m=-h}return[m,w]}(c,i[0])}function hm(c,i,a){var h;const m=c.layout,w=null===(h=m.get("text-variable-anchor-offset"))||void 0===h?void 0:h.evaluate(i,{},a);if(w){const E=w.values,T=[];for(let R=0;R<E.length;R+=2){const L=T[R]=E[R],z=E[R+1].map($=>24*$);L.startsWith("top")?z[1]-=7:L.startsWith("bottom")&&(z[1]+=7),T[R+1]=z}return new Ur(T)}const C=m.get("text-variable-anchor");if(C){let E;E=void 0!==c._unevaluatedLayout.getValue("text-radial-offset")?[24*m.get("text-radial-offset").evaluate(i,{},a),Pp]:m.get("text-offset").evaluate(i,{},a).map(R=>24*R);const T=[];for(const R of C)T.push(R,b_(R,E));return new Ur(T)}return null}function kp(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function pb(c,i,a,h,m,w,C,E,T,R,L,z){let $=w.textMaxSize.evaluate(i,{});void 0===$&&($=C);const q=c.layers[0].layout,Z=q.get("icon-offset").evaluate(i,{},L),Q=x_(a.horizontal),ne=C/24,ce=c.tilePixelRatio*ne,Se=c.tilePixelRatio*$/24,ge=c.tilePixelRatio*E,ye=c.tilePixelRatio*q.get("symbol-spacing"),Re=q.get("text-padding")*c.tilePixelRatio,je=function(Bt,Ct,xt,dn=1){const fr=Bt.get("icon-padding").evaluate(Ct,{},xt),ro=fr&&fr.values;return[ro[0]*dn,ro[1]*dn,ro[2]*dn,ro[3]*dn]}(q,i,L,c.tilePixelRatio),Ze=q.get("text-max-angle")/180*Math.PI,ut="viewport"!==q.get("text-rotation-alignment")&&"point"!==q.get("symbol-placement"),et="map"===q.get("icon-rotation-alignment")&&"point"!==q.get("symbol-placement"),st=q.get("symbol-placement"),Dt=ye/2,Xe=q.get("icon-text-fit");let rt;h&&"none"!==Xe&&(c.allowVerticalPlacement&&a.vertical&&(rt=em(h,a.vertical,Xe,q.get("icon-text-fit-padding"),Z,ne)),Q&&(h=em(h,Q,Xe,q.get("icon-text-fit-padding"),Z,ne)));const ze=L?z.line.getGranularityForZoomLevel(L.z):1,Pt=(Bt,Ct)=>{Ct.x<0||Ct.x>=an||Ct.y<0||Ct.y>=an||function(xt,dn,fr,ro,Eo,bs,Mi,Zr,wr,lr,Mo,To,ii,xs,po,Zi,Yr,go,mo,oo,nr,Ea,nh,Ma,_m){const rh=xt.addToLineVertexArray(dn,fr);let $u,Hu,oh,ih,Zs=0,C_=0,S_=0,ym=0,Np=-1,pf=-1;const sl={};let E_=fs("");if(xt.allowVerticalPlacement&&ro.vertical){const Zo=Zr.layout.get("text-rotate").evaluate(nr,{},Ma)+90;oh=new cf(wr,dn,lr,Mo,To,ro.vertical,ii,xs,po,Zo),Mi&&(ih=new cf(wr,dn,lr,Mo,To,Mi,Yr,go,po,Zo))}if(Eo){const Zo=Zr.layout.get("icon-rotate").evaluate(nr,{}),Yi="none"!==Zr.layout.get("icon-text-fit"),Yl=lf(Eo,Zo,nh,Yi),ws=Mi?lf(Mi,Zo,nh,Yi):void 0;Hu=new cf(wr,dn,lr,Mo,To,Eo,Yr,go,!1,Zo),Zs=4*Yl.length;const Kc=xt.iconSizeData;let Ta=null;"source"===Kc.kind?(Ta=[rl*Zr.layout.get("icon-size").evaluate(nr,{})],Ta[0]>Wc&&Le(`${xt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===Kc.kind&&(Ta=[rl*Ea.compositeIconSizes[0].evaluate(nr,{},Ma),rl*Ea.compositeIconSizes[1].evaluate(nr,{},Ma)],(Ta[0]>Wc||Ta[1]>Wc)&&Le(`${xt.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),xt.addSymbols(xt.icon,Yl,Ta,oo,mo,nr,W.ao.none,dn,rh.lineStartIndex,rh.lineLength,-1,Ma),Np=xt.icon.placedSymbolArray.length-1,ws&&(C_=4*ws.length,xt.addSymbols(xt.icon,ws,Ta,oo,mo,nr,W.ao.vertical,dn,rh.lineStartIndex,rh.lineLength,-1,Ma),pf=xt.icon.placedSymbolArray.length-1)}const vm=Object.keys(ro.horizontal);for(const Zo of vm){const Yi=ro.horizontal[Zo];if(!$u){E_=fs(Yi.text);const ws=Zr.layout.get("text-rotate").evaluate(nr,{},Ma);$u=new cf(wr,dn,lr,Mo,To,Yi,ii,xs,po,ws)}const Yl=1===Yi.positionedLines.length;if(S_+=fm(xt,dn,Yi,bs,Zr,po,nr,Zi,rh,ro.vertical?W.ao.horizontal:W.ao.horizontalOnly,Yl?vm:[Zo],sl,Np,Ea,Ma),Yl)break}ro.vertical&&(ym+=fm(xt,dn,ro.vertical,bs,Zr,po,nr,Zi,rh,W.ao.vertical,["vertical"],sl,pf,Ea,Ma));const bm=$u?$u.boxStartIndex:xt.collisionBoxArray.length,M_=$u?$u.boxEndIndex:xt.collisionBoxArray.length,T_=oh?oh.boxStartIndex:xt.collisionBoxArray.length,gb=oh?oh.boxEndIndex:xt.collisionBoxArray.length,mb=Hu?Hu.boxStartIndex:xt.collisionBoxArray.length,zw=Hu?Hu.boxEndIndex:xt.collisionBoxArray.length,xm=ih?ih.boxStartIndex:xt.collisionBoxArray.length,wm=ih?ih.boxEndIndex:xt.collisionBoxArray.length;let Ys=-1;const sh=(Zo,Yi)=>Zo&&Zo.circleDiameter?Math.max(Zo.circleDiameter,Yi):Yi;Ys=sh($u,Ys),Ys=sh(oh,Ys),Ys=sh(Hu,Ys),Ys=sh(ih,Ys);const Lp=Ys>-1?1:0;Lp&&(Ys*=_m/24),xt.glyphOffsetArray.length>=Xd.MAX_GLYPHS&&Le("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==nr.sortKey&&xt.addToSortKeyRanges(xt.symbolInstances.length,nr.sortKey);const _b=hm(Zr,nr,Ma),[yb,vb]=function(Zo,Yi){const Yl=Zo.length,ws=Yi?.values;if(ws?.length>0)for(let Kc=0;Kc<ws.length;Kc+=2){const Ta=ws[Kc+1];Zo.emplaceBack(W.aE[ws[Kc]],Ta[0],Ta[1])}return[Yl,Zo.length]}(xt.textAnchorOffsets,_b);xt.symbolInstances.emplaceBack(dn.x,dn.y,sl.right>=0?sl.right:-1,sl.center>=0?sl.center:-1,sl.left>=0?sl.left:-1,sl.vertical||-1,Np,pf,E_,bm,M_,T_,gb,mb,zw,xm,wm,lr,S_,ym,Zs,C_,Lp,0,ii,Ys,yb,vb)}(c,Ct,Bt,a,h,m,rt,c.layers[0],c.collisionBoxArray,i.index,i.sourceLayerIndex,c.index,ce,[Re,Re,Re,Re],ut,T,ge,je,et,Z,i,w,R,L,C)};if("line"===st)for(const Bt of um(i.geometry,0,0,an,an)){const Ct=Bu(Bt,ze),xt=hb(Ct,ye,Ze,a.vertical||Q,h,24,Se,c.overscaling,an);for(const dn of xt)Q&&Rp(c,Q.text,Dt,dn)||Pt(Ct,dn)}else if("line-center"===st){for(const Bt of i.geometry)if(Bt.length>1){const Ct=Bu(Bt,ze),xt=Ip(Ct,Ze,a.vertical||Q,h,24,Se);xt&&Pt(Ct,xt)}}else if("Polygon"===i.type)for(const Bt of fa(i.geometry,0)){const Ct=Bw(Bt,16);Pt(Bu(Bt[0],ze,!0),new Zc(Ct.x,Ct.y,0))}else if("LineString"===i.type)for(const Bt of i.geometry){const Ct=Bu(Bt,ze);Pt(Ct,new Zc(Ct[0].x,Ct[0].y,0))}else if("Point"===i.type)for(const Bt of i.geometry)for(const Ct of Bt)Pt([Ct],new Zc(Ct.x,Ct.y,0))}function fm(c,i,a,h,m,w,C,E,T,R,L,z,$,q,Z){const Q=function(Se,ge,ye,Re,je,Ze,ut,et){const st=Re.layout.get("text-rotate").evaluate(Ze,{})*Math.PI/180,Dt=[];for(const Xe of ge.positionedLines)for(const rt of Xe.positionedGlyphs){if(!rt.rect)continue;const ze=rt.rect||{};let Pt=4,Bt=!0,Ct=1,xt=0;const dn=(je||et)&&rt.vertical,fr=rt.metrics.advance*rt.scale/2;if(et&&ge.verticalizable&&(xt=Xe.lineOffset/2-(rt.imageName?-(24-rt.metrics.width*rt.scale)/2:24*(rt.scale-1))),rt.imageName){const go=ut[rt.imageName];Bt=go.sdf,Ct=go.pixelRatio,Pt=1/Ct}const ro=je?[rt.x+fr,rt.y]:[0,0];let Eo=je?[0,0]:[rt.x+fr+ye[0],rt.y+ye[1]-xt],bs=[0,0];dn&&(bs=Eo,Eo=[0,0]);const Mi=rt.metrics.isDoubleResolution?2:1,Zr=(rt.metrics.left-Pt)*rt.scale-fr+Eo[0],wr=(-rt.metrics.top-Pt)*rt.scale+Eo[1],lr=Zr+ze.w/Mi*rt.scale/Ct,Mo=wr+ze.h/Mi*rt.scale/Ct,To=new Ye(Zr,wr),ii=new Ye(lr,wr),xs=new Ye(Zr,Mo),po=new Ye(lr,Mo);if(dn){const go=new Ye(-fr,fr- -17),mo=-Math.PI/2,oo=12-fr,nr=new Ye(22-oo,-(rt.imageName?oo:0)),Ea=new Ye(...bs);To._rotateAround(mo,go)._add(nr)._add(Ea),ii._rotateAround(mo,go)._add(nr)._add(Ea),xs._rotateAround(mo,go)._add(nr)._add(Ea),po._rotateAround(mo,go)._add(nr)._add(Ea)}if(st){const go=Math.sin(st),mo=Math.cos(st),oo=[mo,-go,go,mo];To._matMult(oo),ii._matMult(oo),xs._matMult(oo),po._matMult(oo)}const Zi=new Ye(0,0),Yr=new Ye(0,0);Dt.push({tl:To,tr:ii,bl:xs,br:po,tex:ze,writingMode:ge.writingMode,glyphOffset:ro,sectionIndex:rt.sectionIndex,isSDF:Bt,pixelOffsetTL:Zi,pixelOffsetBR:Yr,minFontScaleX:0,minFontScaleY:0})}return Dt}(0,a,E,m,w,C,h,c.allowVerticalPlacement),ne=c.textSizeData;let ce=null;"source"===ne.kind?(ce=[rl*m.layout.get("text-size").evaluate(C,{})],ce[0]>Wc&&Le(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===ne.kind&&(ce=[rl*q.compositeTextSizes[0].evaluate(C,{},Z),rl*q.compositeTextSizes[1].evaluate(C,{},Z)],(ce[0]>Wc||ce[1]>Wc)&&Le(`${c.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),c.addSymbols(c.text,Q,ce,E,w,C,R,i,T.lineStartIndex,T.lineLength,$,Z);for(const Se of L)z[Se]=c.text.placedSymbolArray.length-1;return 4*Q.length}function x_(c){for(const i in c)return c[i];return null}function Rp(c,i,a,h){const m=c.compareText;if(i in m){const w=m[i];for(let C=w.length-1;C>=0;C--)if(h.dist(w[C])<a)return!0}else m[i]=[];return m[i].push(h),!1}const uf=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Uu{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,h]=new Uint8Array(i,0,2);if(219!==a)throw new Error("Data does not appear to be in a KDBush format.");const m=h>>4;if(1!==m)throw new Error(`Got v${m} data when expected v1.`);const w=uf[15&h];if(!w)throw new Error("Unrecognized array type.");const[C]=new Uint16Array(i,2,1),[E]=new Uint32Array(i,4,1);return new Uu(E,C,w,i)}constructor(i,a=64,h=Float64Array,m){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=h,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const w=uf.indexOf(this.ArrayType),C=2*i*this.ArrayType.BYTES_PER_ELEMENT,E=i*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-E%8)%8;if(w<0)throw new Error(`Unexpected typed array class: ${h}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+E+T,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+C+E+T),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+E+T,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+w]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=i)}add(i,a){const h=this._pos>>1;return this.ids[h]=h,this.coords[this._pos++]=i,this.coords[this._pos++]=a,h}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return pm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,a,h,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:w,coords:C,nodeSize:E}=this,T=[0,w.length-1,0],R=[];for(;T.length;){const L=T.pop()||0,z=T.pop()||0,$=T.pop()||0;if(z-$<=E){for(let ne=$;ne<=z;ne++){const ce=C[2*ne],Se=C[2*ne+1];ce>=i&&ce<=h&&Se>=a&&Se<=m&&R.push(w[ne])}continue}const q=$+z>>1,Z=C[2*q],Q=C[2*q+1];Z>=i&&Z<=h&&Q>=a&&Q<=m&&R.push(w[q]),(0===L?i<=Z:a<=Q)&&(T.push($),T.push(q-1),T.push(1-L)),(0===L?h>=Z:m>=Q)&&(T.push(q+1),T.push(z),T.push(1-L))}return R}within(i,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:w,nodeSize:C}=this,E=[0,m.length-1,0],T=[],R=h*h;for(;E.length;){const L=E.pop()||0,z=E.pop()||0,$=E.pop()||0;if(z-$<=C){for(let ne=$;ne<=z;ne++)df(w[2*ne],w[2*ne+1],i,a)<=R&&T.push(m[ne]);continue}const q=$+z>>1,Z=w[2*q],Q=w[2*q+1];df(Z,Q,i,a)<=R&&T.push(m[q]),(0===L?i-h<=Z:a-h<=Q)&&(E.push($),E.push(q-1),E.push(1-L)),(0===L?i+h>=Z:a+h>=Q)&&(E.push(q+1),E.push(z),E.push(1-L))}return T}}function pm(c,i,a,h,m,w){if(m-h<=a)return;const C=h+m>>1;w_(c,i,C,h,m,w),pm(c,i,a,h,C-1,1-w),pm(c,i,a,C+1,m,1-w)}function w_(c,i,a,h,m,w){for(;m>h;){if(m-h>600){const R=m-h+1,L=a-h+1,z=Math.log(R),$=.5*Math.exp(2*z/3),q=.5*Math.sqrt(z*$*(R-$)/R)*(L-R/2<0?-1:1);w_(c,i,a,Math.max(h,Math.floor(a-L*$/R+q)),Math.min(m,Math.floor(a+(R-L)*$/R+q)),w)}const C=i[2*a+w];let E=h,T=m;for(Gu(c,i,h,a),i[2*m+w]>C&&Gu(c,i,h,m);E<T;){for(Gu(c,i,E,T),E++,T--;i[2*E+w]<C;)E++;for(;i[2*T+w]>C;)T--}i[2*h+w]===C?Gu(c,i,h,T):(T++,Gu(c,i,T,m)),T<=a&&(h=T+1),a<=T&&(m=T-1)}}function Gu(c,i,a,h){Zl(c,a,h),Zl(i,2*a,2*h),Zl(i,2*a+1,2*h+1)}function Zl(c,i,a){const h=c[i];c[i]=c[a],c[a]=h}function df(c,i,a,h){const m=c-a,w=i-h;return m*m+w*w}var Op;W.cx=void 0,(Op=W.cx||(W.cx={})).create="create",Op.load="load",Op.fullLoad="fullLoad";let Yc=null,hf=[];const gm=1e3/60,mm="loadTime",il="fullLoadTime",ff={mark(c){performance.mark(c)},frame(c){const i=c;null!=Yc&&hf.push(i-Yc),Yc=i},clearMetrics(){Yc=null,hf=[],performance.clearMeasures(mm),performance.clearMeasures(il);for(const c in W.cx)performance.clearMarks(W.cx[c])},getPerformanceMetrics(){performance.measure(mm,W.cx.create,W.cx.load),performance.measure(il,W.cx.create,W.cx.fullLoad);const c=performance.getEntriesByName(mm)[0].duration,i=performance.getEntriesByName(il)[0].duration,a=hf.length,h=1/(hf.reduce((w,C)=>w+C,0)/a/1e3),m=hf.filter(w=>w>gm).reduce((w,C)=>w+(C-gm)/gm,0);return{loadTime:c,fullLoadTime:i,fps:h,percentDroppedFrames:m/(a+m)*100,totalFrames:a}}};W.$=an,W.A=sn,W.B=function([c,i,a]){return i+=90,i*=Math.PI/180,a*=Math.PI/180,{x:c*Math.cos(i)*Math.sin(a),y:c*Math.sin(i)*Math.sin(a),z:c*Math.cos(a)}},W.C=Wo,W.D=k,W.E=bt,W.F=Yn,W.G=$s,W.H=function(c){if(null==Vt){const i=c.navigator?c.navigator.userAgent:null;Vt=!!c.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return Vt},W.I=tf,W.J=class{constructor(c,i){this.target=c,this.mapId=i,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new l_(()=>this.process()),this.subscription=ki(this.target,"message",a=>this.receive(a),!1),this.globalScope=At(self)?c:window}registerMessageHandler(c,i){this.messageHandlers[c]=i}sendAsync(c,i){return new Promise((a,h)=>{const m=Math.round(1e18*Math.random()).toString(36).substring(0,10),w=i?ki(i.signal,"abort",()=>{w?.unsubscribe(),delete this.resolveRejects[m];const T={id:m,type:"<cancel>",origin:location.origin,targetMapId:c.targetMapId,sourceMapId:this.mapId};this.target.postMessage(T)},Fw):null;this.resolveRejects[m]={resolve:T=>{w?.unsubscribe(),a(T)},reject:T=>{w?.unsubscribe(),h(T)}};const C=[],E=Object.assign(Object.assign({},c),{id:m,sourceMapId:this.mapId,origin:location.origin,data:Ci(c.data,C)});this.target.postMessage(E,{transfer:C})})}receive(c){const i=c.data,a=i.id;if(!("file://"!==i.origin&&"file://"!==location.origin&&"resource://android"!==i.origin&&"resource://android"!==location.origin&&i.origin!==location.origin||i.targetMapId&&this.mapId!==i.targetMapId)){if("<cancel>"===i.type){delete this.tasks[a];const h=this.abortControllers[a];return delete this.abortControllers[a],void(h&&h.abort())}if(At(self)||i.mustQueue)return this.tasks[a]=i,this.taskQueue.push(a),void this.invoker.trigger();this.processTask(a,i)}}process(){if(0===this.taskQueue.length)return;const c=this.taskQueue.shift(),i=this.tasks[c];delete this.tasks[c],this.taskQueue.length>0&&this.invoker.trigger(),i&&this.processTask(c,i)}processTask(c,i){return y(this,void 0,void 0,function*(){if("<response>"===i.type){const m=this.resolveRejects[c];return delete this.resolveRejects[c],m?void(i.error?m.reject(cs(i.error)):m.resolve(cs(i.data))):void 0}if(!this.messageHandlers[i.type])return void this.completeTask(c,new Error(`Could not find a registered handler for ${i.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const a=cs(i.data),h=new AbortController;this.abortControllers[c]=h;try{const m=yield this.messageHandlers[i.type](i.sourceMapId,a,h);this.completeTask(c,null,m)}catch(m){this.completeTask(c,m)}})}completeTask(c,i,a){const h=[];delete this.abortControllers[c];const m={id:c,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:i?Ci(i):null,data:Ci(a,h)};this.target.postMessage(m,{transfer:h})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},W.K=te,W.L=function(){var c=new sn(16);return sn!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},W.M=function(c,i,a){var h,m,w,C,E,T,R,L,z,$,q,Z,Q=a[0],ne=a[1],ce=a[2];return i===c?(c[12]=i[0]*Q+i[4]*ne+i[8]*ce+i[12],c[13]=i[1]*Q+i[5]*ne+i[9]*ce+i[13],c[14]=i[2]*Q+i[6]*ne+i[10]*ce+i[14],c[15]=i[3]*Q+i[7]*ne+i[11]*ce+i[15]):(m=i[1],w=i[2],C=i[3],E=i[4],T=i[5],R=i[6],L=i[7],z=i[8],$=i[9],q=i[10],Z=i[11],c[0]=h=i[0],c[1]=m,c[2]=w,c[3]=C,c[4]=E,c[5]=T,c[6]=R,c[7]=L,c[8]=z,c[9]=$,c[10]=q,c[11]=Z,c[12]=h*Q+E*ne+z*ce+i[12],c[13]=m*Q+T*ne+$*ce+i[13],c[14]=w*Q+R*ne+q*ce+i[14],c[15]=C*Q+L*ne+Z*ce+i[15]),c},W.N=function(c,i,a){var h=a[0],m=a[1],w=a[2];return c[0]=i[0]*h,c[1]=i[1]*h,c[2]=i[2]*h,c[3]=i[3]*h,c[4]=i[4]*m,c[5]=i[5]*m,c[6]=i[6]*m,c[7]=i[7]*m,c[8]=i[8]*w,c[9]=i[9]*w,c[10]=i[10]*w,c[11]=i[11]*w,c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15],c},W.O=function(c,i,a){var h=i[0],m=i[1],w=i[2],C=i[3],E=i[4],T=i[5],R=i[6],L=i[7],z=i[8],$=i[9],q=i[10],Z=i[11],Q=i[12],ne=i[13],ce=i[14],Se=i[15],ge=a[0],ye=a[1],Re=a[2],je=a[3];return c[0]=ge*h+ye*E+Re*z+je*Q,c[1]=ge*m+ye*T+Re*$+je*ne,c[2]=ge*w+ye*R+Re*q+je*ce,c[3]=ge*C+ye*L+Re*Z+je*Se,c[4]=(ge=a[4])*h+(ye=a[5])*E+(Re=a[6])*z+(je=a[7])*Q,c[5]=ge*m+ye*T+Re*$+je*ne,c[6]=ge*w+ye*R+Re*q+je*ce,c[7]=ge*C+ye*L+Re*Z+je*Se,c[8]=(ge=a[8])*h+(ye=a[9])*E+(Re=a[10])*z+(je=a[11])*Q,c[9]=ge*m+ye*T+Re*$+je*ne,c[10]=ge*w+ye*R+Re*q+je*ce,c[11]=ge*C+ye*L+Re*Z+je*Se,c[12]=(ge=a[12])*h+(ye=a[13])*E+(Re=a[14])*z+(je=a[15])*Q,c[13]=ge*m+ye*T+Re*$+je*ne,c[14]=ge*w+ye*R+Re*q+je*ce,c[15]=ge*C+ye*L+Re*Z+je*Se,c},W.P=Ye,W.Q=function(c,i){const a={};for(let h=0;h<i.length;h++){const m=i[h];m in c&&(a[m]=c[m])}return a},W.R=qo,W.S=qc,W.T=Ou,W.U=cm,W.V=cb,W.W=Ht,W.X=Ut,W.Y=ao,W.Z=ys,W._=y,W.a=K,W.a$=gn,W.a0=function(c,i){var a,h,m,w;if(!c)return i??{};if(!i)return c;const C=Object.assign({},c);if(i.removeAll&&(C.removeAll=!0),i.remove){const E=new Set(C.remove?C.remove.concat(i.remove):i.remove);C.remove=Array.from(E.values())}if(i.add){const E=C.add?C.add.concat(i.add):i.add,T=new Map(E.map(R=>[R.id,R]));C.add=Array.from(T.values())}if(i.update){const E=new Map(null===(a=C.update)||void 0===a?void 0:a.map(T=>[T.id,T]));for(const T of i.update){const R=null!==(h=E.get(T.id))&&void 0!==h?h:{id:T.id};T.newGeometry&&(R.newGeometry=T.newGeometry),T.addOrUpdateProperties&&(R.addOrUpdateProperties=(null!==(m=R.addOrUpdateProperties)&&void 0!==m?m:[]).concat(T.addOrUpdateProperties)),T.removeProperties&&(R.removeProperties=(null!==(w=R.removeProperties)&&void 0!==w?w:[]).concat(T.removeProperties)),T.removeAllProperties&&(R.removeAllProperties=!0),E.set(T.id,R)}C.update=Array.from(E.values())}return C},W.a1=Sp,W.a2=vs,W.a3=25,W.a4=f_,W.a5=c=>{const i=window.document.createElement("video");return i.muted=!0,new Promise(a=>{i.onloadstart=()=>{a(i)};for(const h of c){const m=window.document.createElement("source");Ne(h)||(i.crossOrigin="Anonymous"),m.src=h,i.appendChild(m)}})},W.a6=Ke,W.a7=function(){return Lt++},W.a8=V,W.a9=Xd,W.aA=function(c){let i=1/0,a=1/0,h=-1/0,m=-1/0;for(const w of c)i=Math.min(i,w.x),a=Math.min(a,w.y),h=Math.max(h,w.x),m=Math.max(m,w.y);return[i,a,h,m]},W.aB=24,W.aC=fn,W.aD=function(c,i,a,h,m=!1){if(!a[0]&&!a[1])return[0,0];const w=m?"map"===h?-c.bearingInRadians:0:"viewport"===h?c.bearingInRadians:0;if(w){const C=Math.sin(w),E=Math.cos(w);a=[a[0]*E-a[1]*C,a[0]*C+a[1]*E]}return[m?a[0]:fn(i,a[0],c.zoom),m?a[1]:fn(i,a[1],c.zoom)]},W.aF=sf,W.aG=kp,W.aH=Qg,W.aI=Uu,W.aJ=hr,W.aK=Ug,W.aL=fe,W.aM=tn,W.aN=$n,W.aO=ai,W.aP=qn,W.aQ=ub,W.aR=Ge,W.aS=Nt,W.aT=function(c){var i=new sn(3);return i[0]=c[0],i[1]=c[1],i[2]=c[2],i},W.aU=function(c,i,a){return c[0]=i[0]-a[0],c[1]=i[1]-a[1],c[2]=i[2]-a[2],c},W.aV=function(c,i){var a=i[0],h=i[1],m=i[2],w=a*a+h*h+m*m;return w>0&&(w=1/Math.sqrt(w)),c[0]=i[0]*w,c[1]=i[1]*w,c[2]=i[2]*w,c},W.aW=ir,W.aX=function(c,i){return c[0]*i[0]+c[1]*i[1]+c[2]*i[2]},W.aY=function(c,i,a){return c[0]=i[0]*a[0],c[1]=i[1]*a[1],c[2]=i[2]*a[2],c[3]=i[3]*a[3],c},W.aZ=Vo,W.a_=function(c,i,a){const h=i[0]*a[0]+i[1]*a[1]+i[2]*a[2];return 0===h?null:(-(c[0]*a[0]+c[1]*a[1]+c[2]*a[2])-a[3])/h},W.aa=Ui,W.ab=Ws,W.ac=Mp,W.ad=function(c){const i={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,h,m,w)=>{const C=m||w;return i[h]=!C||C.toLowerCase(),""}),i["max-age"]){const a=parseInt(i["max-age"],10);isNaN(a)?delete i["max-age"]:i["max-age"]=a}return i},W.ae=ci,W.af=function(c){return Math.pow(2,c)},W.ag=_r,W.ah=Or,W.ai=85.051129,W.aj=u_,W.ak=function(c){return Math.log(c)/Math.LN2},W.al=function(c){var i=c[0],a=c[1];return i*i+a*a},W.am=function(c,i){const a=[];for(const h in c)h in i||a.push(h);return a},W.an=function(c,i){let a=0,h=0;if("constant"===c.kind)h=c.layoutSize;else if("source"!==c.kind){const{interpolationType:m,minZoom:w,maxZoom:C}=c,E=m?Or(vr.interpolationFactor(m,i,w,C),0,1):0;"camera"===c.kind?h=Wo.number(c.minSize,c.maxSize,E):a=E}return{uSizeT:a,uSize:h}},W.ap=function(c,{uSize:i,uSizeT:a},{lowerSize:h,upperSize:m}){return"source"===c.kind?h/rl:"composite"===c.kind?Wo.number(h/rl,m/rl,a):i},W.aq=function(c,i){var a=i[0],h=i[1],m=i[2],w=i[3],C=i[4],E=i[5],T=i[6],R=i[7],L=i[8],z=i[9],$=i[10],q=i[11],Z=i[12],Q=i[13],ne=i[14],ce=i[15],Se=a*E-h*C,ge=a*T-m*C,ye=a*R-w*C,Re=h*T-m*E,je=h*R-w*E,Ze=m*R-w*T,ut=L*Q-z*Z,et=L*ne-$*Z,st=L*ce-q*Z,Dt=z*ne-$*Q,Xe=z*ce-q*Q,rt=$*ce-q*ne,ze=Se*rt-ge*Xe+ye*Dt+Re*st-je*et+Ze*ut;return ze?(c[0]=(E*rt-T*Xe+R*Dt)*(ze=1/ze),c[1]=(m*Xe-h*rt-w*Dt)*ze,c[2]=(Q*Ze-ne*je+ce*Re)*ze,c[3]=($*je-z*Ze-q*Re)*ze,c[4]=(T*st-C*rt-R*et)*ze,c[5]=(a*rt-m*st+w*et)*ze,c[6]=(ne*ye-Z*Ze-ce*ge)*ze,c[7]=(L*Ze-$*ye+q*ge)*ze,c[8]=(C*Xe-E*st+R*ut)*ze,c[9]=(h*st-a*Xe-w*ut)*ze,c[10]=(Z*je-Q*ye+ce*Se)*ze,c[11]=(z*ye-L*je-q*Se)*ze,c[12]=(E*et-C*Dt-T*ut)*ze,c[13]=(a*Dt-h*et+m*ut)*ze,c[14]=(Q*ge-Z*Re-ne*Se)*ze,c[15]=(L*Re-z*ge+$*Se)*ze,c):null},W.ar=Qo,W.as=function(c){return Math.hypot(c[0],c[1])},W.at=function(c){return c[0]=0,c[1]=0,c},W.au=function(c,i,a){return c[0]=i[0]*a,c[1]=i[1]*a,c},W.av=nm,W.aw=cr,W.ax=function(c,i,a,h){const m=i.y-c.y,w=i.x-c.x,C=h.y-a.y,E=h.x-a.x,T=C*w-E*m;if(0===T)return null;const R=(E*(c.y-a.y)-C*(c.x-a.x))/T;return new Ye(c.x+R*w,c.y+R*m)},W.ay=um,W.az=Hn,W.b=bn,W.b$=class extends b{},W.b0=function(c,i,a){return c[0]=i[0]*a,c[1]=i[1]*a,c[2]=i[2]*a,c[3]=i[3]*a,c},W.b1=function(c,i){return c[0]*i[0]+c[1]*i[1]+c[2]*i[2]+c[3]},W.b2=Ep,W.b3=Jd,W.b4=function(c,i,a,h,m){var w,C=1/Math.tan(i/2);return c[0]=C/a,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=C,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,null!=m&&m!==1/0?(c[10]=(m+h)*(w=1/(h-m)),c[14]=2*m*h*w):(c[10]=-1,c[14]=-2*h),c},W.b5=function(c){var i=new sn(16);return i[0]=c[0],i[1]=c[1],i[2]=c[2],i[3]=c[3],i[4]=c[4],i[5]=c[5],i[6]=c[6],i[7]=c[7],i[8]=c[8],i[9]=c[9],i[10]=c[10],i[11]=c[11],i[12]=c[12],i[13]=c[13],i[14]=c[14],i[15]=c[15],i},W.b6=function(c,i,a){var h=Math.sin(a),m=Math.cos(a),w=i[0],C=i[1],E=i[2],T=i[3],R=i[4],L=i[5],z=i[6],$=i[7];return i!==c&&(c[8]=i[8],c[9]=i[9],c[10]=i[10],c[11]=i[11],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[0]=w*m+R*h,c[1]=C*m+L*h,c[2]=E*m+z*h,c[3]=T*m+$*h,c[4]=R*m-w*h,c[5]=L*m-C*h,c[6]=z*m-E*h,c[7]=$*m-T*h,c},W.b7=function(c,i,a){var h=Math.sin(a),m=Math.cos(a),w=i[4],C=i[5],E=i[6],T=i[7],R=i[8],L=i[9],z=i[10],$=i[11];return i!==c&&(c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=i[3],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[4]=w*m+R*h,c[5]=C*m+L*h,c[6]=E*m+z*h,c[7]=T*m+$*h,c[8]=R*m-w*h,c[9]=L*m-C*h,c[10]=z*m-E*h,c[11]=$*m-T*h,c},W.b8=function(){const c=new Float32Array(16);return _r(c),c},W.b9=function(){const c=new Float64Array(16);return _r(c),c},W.bA=function(c,i){const a=Un(c,360),h=Un(i,360),m=h-a,w=h>a?m-360:m+360;return Math.abs(m)<Math.abs(w)?m:w},W.bB=function(c){return c[0]=0,c[1]=0,c[2]=0,c},W.bC=function(c,i,a,h){const m=Math.sqrt(c*c+i*i),w=Math.sqrt(a*a+h*h);c/=m,i/=m,a/=w,h/=w;const C=Math.acos(c*a+i*h);return-i*a+c*h>0?C:-C},W.bD=function(c,i){const a=Un(c,2*Math.PI),h=Un(i,2*Math.PI);return Math.min(Math.abs(a-h),Math.abs(a-h+2*Math.PI),Math.abs(a-h-2*Math.PI))},W.bE=function(){const c={},i=Me.$version;for(const a in Me.$root){const h=Me.$root[a];if(h.required){let m=null;m="version"===a?i:"array"===h.type?[]:{},null!=m&&(c[a]=m)}}return c},W.bF=us,W.bG=be,W.bH=function c(i,a){if(Array.isArray(i)){if(!Array.isArray(a)||i.length!==a.length)return!1;for(let h=0;h<i.length;h++)if(!c(i[h],a[h]))return!1;return!0}if("object"==typeof i&&null!==i&&null!==a){if("object"!=typeof a||Object.keys(i).length!==Object.keys(a).length)return!1;for(const h in i)if(!c(i[h],a[h]))return!1;return!0}return i===a},W.bI=function(c){c=c.slice();const i=Object.create(null);for(let a=0;a<c.length;a++)i[c[a].id]=c[a];for(let a=0;a<c.length;a++)"ref"in c[a]&&(c[a]=Jt(c[a],i[c[a].ref]));return c},W.bJ=function(c){if("custom"===c.type)return new lb(c);switch(c.type){case"background":return new Lw(c);case"circle":return new Iv(c);case"color-relief":return new Av(c);case"fill":return new lp(c);case"fill-extrusion":return new Uv(c);case"heatmap":return new zd(c);case"hillshade":return new L0(c);case"line":return new qv(c);case"raster":return new sm(c);case"symbol":return new wp(c)}},W.bK=Nr,W.bL=function(c,i){if(!c)return[{command:"setStyle",args:[i]}];let a=[];try{if(!Et(c.version,i.version))return[{command:"setStyle",args:[i]}];Et(c.center,i.center)||a.push({command:"setCenter",args:[i.center]}),Et(c.state,i.state)||a.push({command:"setGlobalState",args:[i.state]}),Et(c.centerAltitude,i.centerAltitude)||a.push({command:"setCenterAltitude",args:[i.centerAltitude]}),Et(c.zoom,i.zoom)||a.push({command:"setZoom",args:[i.zoom]}),Et(c.bearing,i.bearing)||a.push({command:"setBearing",args:[i.bearing]}),Et(c.pitch,i.pitch)||a.push({command:"setPitch",args:[i.pitch]}),Et(c.roll,i.roll)||a.push({command:"setRoll",args:[i.roll]}),Et(c.sprite,i.sprite)||a.push({command:"setSprite",args:[i.sprite]}),Et(c.glyphs,i.glyphs)||a.push({command:"setGlyphs",args:[i.glyphs]}),Et(c.transition,i.transition)||a.push({command:"setTransition",args:[i.transition]}),Et(c.light,i.light)||a.push({command:"setLight",args:[i.light]}),Et(c.terrain,i.terrain)||a.push({command:"setTerrain",args:[i.terrain]}),Et(c.sky,i.sky)||a.push({command:"setSky",args:[i.sky]}),Et(c.projection,i.projection)||a.push({command:"setProjection",args:[i.projection]});const h={},m=[];!function(C,E,T,R){let L;for(L in E=E||{},C=C||{})Object.prototype.hasOwnProperty.call(C,L)&&(Object.prototype.hasOwnProperty.call(E,L)||Zn(L,T,R));for(L in E)Object.prototype.hasOwnProperty.call(E,L)&&(Object.prototype.hasOwnProperty.call(C,L)?Et(C[L],E[L])||("geojson"===C[L].type&&"geojson"===E[L].type&&sr(C,E,L)?Zt(T,{command:"setGeoJSONSourceData",args:[L,E[L].data]}):Gn(L,E,T,R)):kn(L,E,T))}(c.sources,i.sources,m,h);const w=[];c.layers&&c.layers.forEach(C=>{"source"in C&&h[C.source]?a.push({command:"removeLayer",args:[C.id]}):w.push(C)}),a=a.concat(m),function(C,E,T){E=E||[];const R=(C=C||[]).map(un),L=E.map(un),z=C.reduce(yr,{}),$=E.reduce(yr,{}),q=R.slice(),Z=Object.create(null);let Q,ne,ce,Se,ge;for(let ye=0,Re=0;ye<R.length;ye++)Q=R[ye],Object.prototype.hasOwnProperty.call($,Q)?Re++:(Zt(T,{command:"removeLayer",args:[Q]}),q.splice(q.indexOf(Q,Re),1));for(let ye=0,Re=0;ye<L.length;ye++)Q=L[L.length-1-ye],q[q.length-1-ye]!==Q&&(Object.prototype.hasOwnProperty.call(z,Q)?(Zt(T,{command:"removeLayer",args:[Q]}),q.splice(q.lastIndexOf(Q,q.length-Re),1)):Re++,Se=q[q.length-ye],Zt(T,{command:"addLayer",args:[$[Q],Se]}),q.splice(q.length-ye,0,Q),Z[Q]=!0);for(let ye=0;ye<L.length;ye++)if(Q=L[ye],ne=z[Q],ce=$[Q],!Z[Q]&&!Et(ne,ce))if(Et(ne.source,ce.source)&&Et(ne["source-layer"],ce["source-layer"])&&Et(ne.type,ce.type)){for(ge in rn(ne.layout,ce.layout,T,Q,null,"setLayoutProperty"),rn(ne.paint,ce.paint,T,Q,null,"setPaintProperty"),Et(ne.filter,ce.filter)||Zt(T,{command:"setFilter",args:[Q,ce.filter]}),Et(ne.minzoom,ce.minzoom)&&Et(ne.maxzoom,ce.maxzoom)||Zt(T,{command:"setLayerZoomRange",args:[Q,ce.minzoom,ce.maxzoom]}),ne)Object.prototype.hasOwnProperty.call(ne,ge)&&"layout"!==ge&&"paint"!==ge&&"filter"!==ge&&"metadata"!==ge&&"minzoom"!==ge&&"maxzoom"!==ge&&(0===ge.indexOf("paint.")?rn(ne[ge],ce[ge],T,Q,ge.slice(6),"setPaintProperty"):Et(ne[ge],ce[ge])||Zt(T,{command:"setLayerProperty",args:[Q,ge,ce[ge]]}));for(ge in ce)Object.prototype.hasOwnProperty.call(ce,ge)&&!Object.prototype.hasOwnProperty.call(ne,ge)&&"layout"!==ge&&"paint"!==ge&&"filter"!==ge&&"metadata"!==ge&&"minzoom"!==ge&&"maxzoom"!==ge&&(0===ge.indexOf("paint.")?rn(ne[ge],ce[ge],T,Q,ge.slice(6),"setPaintProperty"):Et(ne[ge],ce[ge])||Zt(T,{command:"setLayerProperty",args:[Q,ge,ce[ge]]}))}else Zt(T,{command:"removeLayer",args:[Q]}),Se=q[q.lastIndexOf(Q)+1],Zt(T,{command:"addLayer",args:[ce,Se]})}(w,i.layers,a)}catch(h){console.warn("Unable to compute style diff:",h),a=[{command:"setStyle",args:[i]}]}return a},W.bM=function(c){const i=[],a=c.id;return void 0===a&&i.push({message:`layers.${a}: missing required property "id"`}),void 0===c.render&&i.push({message:`layers.${a}: missing required method "render"`}),c.renderingMode&&"2d"!==c.renderingMode&&"3d"!==c.renderingMode&&i.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),i},W.bN=li,W.bO=oa,W.bP=class extends oi{constructor(c,i){super(c,i),this.current=0}set(c){this.current!==c&&(this.current=c,this.gl.uniform1i(this.location,c))}},W.bQ=Wr,W.bR=class extends oi{constructor(c,i){super(c,i),this.current=gs}set(c){if(c[12]!==this.current[12]||c[0]!==this.current[0])return this.current=c,void this.gl.uniformMatrix4fv(this.location,!1,c);for(let i=1;i<16;i++)if(c[i]!==this.current[i]){this.current=c,this.gl.uniformMatrix4fv(this.location,!1,c);break}}},W.bS=Br,W.bT=class extends oi{constructor(c,i){super(c,i),this.current=[0,0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]||(this.current=c,this.gl.uniform3f(this.location,c[0],c[1],c[2]))}},W.bU=class extends oi{constructor(c,i){super(c,i),this.current=[0,0]}set(c){c[0]===this.current[0]&&c[1]===this.current[1]||(this.current=c,this.gl.uniform2f(this.location,c[0],c[1]))}},W.bV=Mn,W.bW=function(c,i){var a=Math.sin(i),h=Math.cos(i);return c[0]=h,c[1]=a,c[2]=0,c[3]=-a,c[4]=h,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},W.bX=function(c,i,a){var h=i[0],m=i[1],w=i[2];return c[0]=h*a[0]+m*a[3]+w*a[6],c[1]=h*a[1]+m*a[4]+w*a[7],c[2]=h*a[2]+m*a[5]+w*a[8],c},W.bY=function(c,i,a,h,m,w,C){var E=1/(i-a),T=1/(h-m),R=1/(w-C);return c[0]=-2*E,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*T,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*R,c[11]=0,c[12]=(i+a)*E,c[13]=(m+h)*T,c[14]=(C+w)*R,c[15]=1,c},W.bZ=class extends oi{constructor(c,i){super(c,i),this.current=new Array}set(c){if(c!=this.current){this.current=c;const i=new Float32Array(4*c.length);for(let a=0;a<c.length;a++)i[4*a]=c[a].r,i[4*a+1]=c[a].g,i[4*a+2]=c[a].b,i[4*a+3]=c[a].a;this.gl.uniform4fv(this.location,i)}}},W.b_=class extends oi{constructor(c,i){super(c,i),this.current=new Array}set(c){if(c!=this.current){this.current=c;const i=new Float32Array(c);this.gl.uniform1fv(this.location,i)}}},W.ba=function(){return new Float64Array(16)},W.bb=function(c,i,a){const h=new Float64Array(4);return Wn(h,c,i-90,a),h},W.bc=function(c,i,a,h){var m,w,C,E,T,R=i[0],L=i[1],z=i[2],$=i[3],q=a[0],Z=a[1],Q=a[2],ne=a[3];return(w=R*q+L*Z+z*Q+$*ne)<0&&(w=-w,q=-q,Z=-Z,Q=-Q,ne=-ne),1-w>Gt?(m=Math.acos(w),C=Math.sin(m),E=Math.sin((1-h)*m)/C,T=Math.sin(h*m)/C):(E=1-h,T=h),c[0]=E*R+T*q,c[1]=E*L+T*Z,c[2]=E*z+T*Q,c[3]=E*$+T*ne,c},W.bd=function(c){const i=new Float64Array(9);var a,h,m,w,C,E,T,R,L,z,$,q,Z,Q,ne,ce,Se,ge;z=(m=(h=c)[0])*(T=m+m),$=(w=h[1])*T,Z=(C=h[2])*T,Q=C*(R=w+w),ce=(E=h[3])*T,Se=E*R,ge=E*(L=C+C),(a=i)[0]=1-(q=w*R)-(ne=C*L),a[3]=$-ge,a[6]=Z+Se,a[1]=$+ge,a[4]=1-z-ne,a[7]=Q-ce,a[2]=Z-Se,a[5]=Q+ce,a[8]=1-z-q;const ye=qn(-Math.asin(Or(i[2],-1,1)));let Re,je;return Math.hypot(i[5],i[8])<.001?(Re=0,je=-qn(Math.atan2(i[3],i[4]))):(Re=qn(0===i[5]&&0===i[8]?0:Math.atan2(i[5],i[8])),je=qn(0===i[1]&&0===i[0]?0:Math.atan2(i[1],i[0]))),{roll:Re,pitch:ye+90,bearing:je}},W.be=function(c,i){return c.roll==i.roll&&c.pitch==i.pitch&&c.bearing==i.bearing},W.bf=Qt,W.bg=Ul,W.bh=Gd,W.bi=Xh,W.bj=Fu,W.bk=yo,W.bl=Rr,W.bm=Nn,W.bn=function(c,i,a,h,m){return yo(h,m,Or((c-i)/(a-i),0,1))},W.bo=Un,W.bp=function(){return new Float64Array(3)},W.bq=function(c,i,a,h){return c[0]=i[0]+a[0]*h,c[1]=i[1]+a[1]*h,c[2]=i[2]+a[2]*h,c},W.br=Wn,W.bs=function(c,i,a){var h=a[0],m=a[1],w=a[2],C=i[0],E=i[1],T=i[2],R=m*T-w*E,L=w*C-h*T,z=h*E-m*C,$=m*z-w*L,q=w*R-h*z,Z=h*L-m*R,Q=2*a[3];return L*=Q,z*=Q,q*=2,Z*=2,c[0]=C+(R*=Q)+($*=2),c[1]=E+L+q,c[2]=T+z+Z,c},W.bt=function(c,i,a){const h=(m=[c[0],c[1],c[2],i[0],i[1],i[2],a[0],a[1],a[2]])[0]*((L=m[8])*(C=m[4])-(E=m[5])*(R=m[7]))+m[1]*(-L*(w=m[3])+E*(T=m[6]))+m[2]*(R*w-C*T);var m,w,C,E,T,R,L;if(0===h)return null;const z=ir([],[i[0],i[1],i[2]],[a[0],a[1],a[2]]),$=ir([],[a[0],a[1],a[2]],[c[0],c[1],c[2]]),q=ir([],[c[0],c[1],c[2]],[i[0],i[1],i[2]]),Z=Ge([],z,-c[3]);return Nt(Z,Z,Ge([],$,-i[3])),Nt(Z,Z,Ge([],q,-a[3])),Ge(Z,Z,1/h),Z},W.bu=c_,W.bv=function(){return new Float64Array(4)},W.bw=function(c,i,a,h){var m=[],w=[];return m[0]=i[0]-a[0],m[1]=i[1]-a[1],m[2]=i[2]-a[2],w[0]=m[0]*Math.cos(h)-m[1]*Math.sin(h),w[1]=m[0]*Math.sin(h)+m[1]*Math.cos(h),w[2]=m[2],c[0]=w[0]+a[0],c[1]=w[1]+a[1],c[2]=w[2]+a[2],c},W.bx=function(c,i,a,h){var m=[],w=[];return m[0]=i[0]-a[0],m[1]=i[1]-a[1],m[2]=i[2]-a[2],w[0]=m[0],w[1]=m[1]*Math.cos(h)-m[2]*Math.sin(h),w[2]=m[1]*Math.sin(h)+m[2]*Math.cos(h),c[0]=w[0]+a[0],c[1]=w[1]+a[1],c[2]=w[2]+a[2],c},W.by=function(c,i,a,h){var m=[],w=[];return m[0]=i[0]-a[0],m[1]=i[1]-a[1],m[2]=i[2]-a[2],w[0]=m[2]*Math.sin(h)+m[0]*Math.cos(h),w[1]=m[1],w[2]=m[2]*Math.cos(h)-m[0]*Math.sin(h),c[0]=w[0]+a[0],c[1]=w[1]+a[1],c[2]=w[2]+a[2],c},W.bz=function(c,i,a){var h=Math.sin(a),m=Math.cos(a),w=i[0],C=i[1],E=i[2],T=i[3],R=i[8],L=i[9],z=i[10],$=i[11];return i!==c&&(c[4]=i[4],c[5]=i[5],c[6]=i[6],c[7]=i[7],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15]),c[0]=w*m-R*h,c[1]=C*m-L*h,c[2]=E*m-z*h,c[3]=T*m-$*h,c[8]=w*h+R*m,c[9]=C*h+L*m,c[10]=E*h+z*m,c[11]=T*h+$*m,c},W.c=xe,W.c0=ef,W.c1=class extends u{},W.c2=Og,W.c3=function(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))},W.c4=Yf,W.c5=function(c,i,a){var h=i[0],m=i[1],w=i[2],C=a[3]*h+a[7]*m+a[11]*w+a[15];return c[0]=(a[0]*h+a[4]*m+a[8]*w+a[12])/(C=C||1),c[1]=(a[1]*h+a[5]*m+a[9]*w+a[13])/C,c[2]=(a[2]*h+a[6]*m+a[10]*w+a[14])/C,c},W.c6=class extends Id{},W.c7=class extends N{},W.c8=function(c,i){return c[0]===i[0]&&c[1]===i[1]&&c[2]===i[2]&&c[3]===i[3]&&c[4]===i[4]&&c[5]===i[5]&&c[6]===i[6]&&c[7]===i[7]&&c[8]===i[8]&&c[9]===i[9]&&c[10]===i[10]&&c[11]===i[11]&&c[12]===i[12]&&c[13]===i[13]&&c[14]===i[14]&&c[15]===i[15]},W.c9=function(c,i){var a=c[0],h=c[1],m=c[2],w=c[3],C=c[4],E=c[5],T=c[6],R=c[7],L=c[8],z=c[9],$=c[10],q=c[11],Z=c[12],Q=c[13],ne=c[14],ce=c[15],Se=i[0],ge=i[1],ye=i[2],Re=i[3],je=i[4],Ze=i[5],ut=i[6],et=i[7],st=i[8],Dt=i[9],Xe=i[10],rt=i[11],ze=i[12],Pt=i[13],Bt=i[14],Ct=i[15];return Math.abs(a-Se)<=Gt*Math.max(1,Math.abs(a),Math.abs(Se))&&Math.abs(h-ge)<=Gt*Math.max(1,Math.abs(h),Math.abs(ge))&&Math.abs(m-ye)<=Gt*Math.max(1,Math.abs(m),Math.abs(ye))&&Math.abs(w-Re)<=Gt*Math.max(1,Math.abs(w),Math.abs(Re))&&Math.abs(C-je)<=Gt*Math.max(1,Math.abs(C),Math.abs(je))&&Math.abs(E-Ze)<=Gt*Math.max(1,Math.abs(E),Math.abs(Ze))&&Math.abs(T-ut)<=Gt*Math.max(1,Math.abs(T),Math.abs(ut))&&Math.abs(R-et)<=Gt*Math.max(1,Math.abs(R),Math.abs(et))&&Math.abs(L-st)<=Gt*Math.max(1,Math.abs(L),Math.abs(st))&&Math.abs(z-Dt)<=Gt*Math.max(1,Math.abs(z),Math.abs(Dt))&&Math.abs($-Xe)<=Gt*Math.max(1,Math.abs($),Math.abs(Xe))&&Math.abs(q-rt)<=Gt*Math.max(1,Math.abs(q),Math.abs(rt))&&Math.abs(Z-ze)<=Gt*Math.max(1,Math.abs(Z),Math.abs(ze))&&Math.abs(Q-Pt)<=Gt*Math.max(1,Math.abs(Q),Math.abs(Pt))&&Math.abs(ne-Bt)<=Gt*Math.max(1,Math.abs(ne),Math.abs(Bt))&&Math.abs(ce-Ct)<=Gt*Math.max(1,Math.abs(ce),Math.abs(Ct))},W.cA=function(c,i){K.REGISTERED_PROTOCOLS[c]=i},W.cB=function(c){delete K.REGISTERED_PROTOCOLS[c]},W.cC=function(c,i){const a={};for(let m=0;m<c.length;m++){const w=i&&i[c[m].id]||Lh(c[m]);i&&(i[c[m].id]=w);let C=a[w];C||(C=a[w]=[]),C.push(c[m])}const h=[];for(const m in a)h.push(a[m]);return h},W.cD=ht,W.cE=eh,W.cF=Tp,W.cG=nf,W.cH=function(c){c.bucket.createArrays(),c.bucket.tilePixelRatio=an/(512*c.bucket.overscaling),c.bucket.compareText={},c.bucket.iconsNeedLinear=!1;const i=c.bucket.layers[0],a=i.layout,h=i._unevaluatedLayout._values,m={layoutIconSize:h["icon-size"].possiblyEvaluate(new Yn(c.bucket.zoom+1),c.canonical),layoutTextSize:h["text-size"].possiblyEvaluate(new Yn(c.bucket.zoom+1),c.canonical),textMaxSize:h["text-size"].possiblyEvaluate(new Yn(18))};if("composite"===c.bucket.textSizeData.kind){const{minZoom:R,maxZoom:L}=c.bucket.textSizeData;m.compositeTextSizes=[h["text-size"].possiblyEvaluate(new Yn(R),c.canonical),h["text-size"].possiblyEvaluate(new Yn(L),c.canonical)]}if("composite"===c.bucket.iconSizeData.kind){const{minZoom:R,maxZoom:L}=c.bucket.iconSizeData;m.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new Yn(R),c.canonical),h["icon-size"].possiblyEvaluate(new Yn(L),c.canonical)]}const w=24*a.get("text-line-height"),C="viewport"!==a.get("text-rotation-alignment")&&"point"!==a.get("symbol-placement"),E=a.get("text-keep-upright"),T=a.get("text-size");for(const R of c.bucket.features){const L=a.get("text-font").evaluate(R,{},c.canonical).join(","),z=T.evaluate(R,{},c.canonical),$=m.layoutTextSize.evaluate(R,{},c.canonical),q=m.layoutIconSize.evaluate(R,{},c.canonical),Z={horizontal:{},vertical:void 0},Q=R.text;let ne,ce=[0,0];if(Q){const ye=Q.toString(),Re=24*a.get("text-letter-spacing").evaluate(R,{},c.canonical),je=xu(ye)?Re:0,Ze=a.get("text-anchor").evaluate(R,{},c.canonical),ut=hm(i,R,c.canonical);if(!ut){const Xe=a.get("text-radial-offset").evaluate(R,{},c.canonical);ce=Xe?b_(Ze,[24*Xe,Pp]):a.get("text-offset").evaluate(R,{},c.canonical).map(rt=>24*rt)}let et=C?"center":a.get("text-justify").evaluate(R,{},c.canonical);const st="point"===a.get("symbol-placement")?24*a.get("text-max-width").evaluate(R,{},c.canonical):1/0,Dt=()=>{c.bucket.allowVerticalPlacement&&ds(ye)&&(Z.vertical=pp(Q,c.glyphMap,c.glyphPositions,c.imagePositions,L,st,w,Ze,"left",je,ce,W.ao.vertical,!0,$,z))};if(!C&&ut){const Xe=new Set;if("auto"===et)for(let ze=0;ze<ut.values.length;ze+=2)Xe.add(kp(ut.values[ze]));else Xe.add(et);let rt=!1;for(const ze of Xe)if(!Z.horizontal[ze])if(rt)Z.horizontal[ze]=Z.horizontal[0];else{const Pt=pp(Q,c.glyphMap,c.glyphPositions,c.imagePositions,L,st,w,"center",ze,je,ce,W.ao.horizontal,!1,$,z);Pt&&(Z.horizontal[ze]=Pt,rt=1===Pt.positionedLines.length)}Dt()}else{"auto"===et&&(et=kp(Ze));const Xe=pp(Q,c.glyphMap,c.glyphPositions,c.imagePositions,L,st,w,Ze,et,je,ce,W.ao.horizontal,!1,$,z);Xe&&(Z.horizontal[et]=Xe),Dt(),ds(ye)&&C&&E&&(Z.vertical=pp(Q,c.glyphMap,c.glyphPositions,c.imagePositions,L,st,w,Ze,et,je,ce,W.ao.vertical,!1,$,z))}}let Se=!1;if(R.icon&&R.icon.name){const ye=c.imageMap[R.icon.name];ye&&(ne=_p(c.imagePositions[R.icon.name],a.get("icon-offset").evaluate(R,{},c.canonical),a.get("icon-anchor").evaluate(R,{},c.canonical)),Se=!!ye.sdf,void 0===c.bucket.sdfIcons?c.bucket.sdfIcons=Se:c.bucket.sdfIcons!==Se&&Le("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ye.pixelRatio!==c.bucket.pixelRatio||0!==a.get("icon-rotate").constantOr(1))&&(c.bucket.iconsNeedLinear=!0))}const ge=x_(Z.horizontal)||Z.vertical;c.bucket.iconsInText=!!ge&&ge.iconsInText,(ge||ne)&&pb(c.bucket,R,Z,ne,c.imageMap,m,$,q,ce,Se,c.canonical,c.subdivisionGranularity)}c.showCollisionBoxes&&c.bucket.generateCollisionDebugBuffers()},W.cI=dp,W.cJ=$d,W.cK=cp,W.cL=W0,W.cM=Yg,W.cN=class{constructor(c){this._marks={start:[c.url,"start"].join("#"),end:[c.url,"end"].join("#"),measure:c.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let c=performance.getEntriesByName(this._marks.measure);return 0===c.length&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),c=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),c}},W.cO=function(c,i,a,h,m){return y(this,void 0,void 0,function*(){if(Ut())try{return yield ao(c,i,a,h,m)}catch{}return function(w,C,E,T,R){const L=w.width,z=w.height;Ds&&Pi||(Ds=new OffscreenCanvas(L,z),Pi=Ds.getContext("2d",{willReadFrequently:!0})),Ds.width=L,Ds.height=z,Pi.drawImage(w,0,0,L,z);const $=Pi.getImageData(C,E,T,R);return Pi.clearRect(0,0,L,z),$.data}(c,i,a,h,m)})},W.cP=Kf,W.cQ=En,W.cR=Gc,W.cS=$l,W.cT=$a,W.cU=function(c,i){const a=new Map;if(null!=c)if("Feature"===c.type)a.set(af(c,i),c);else for(const h of c.features)a.set(af(h,i),h);return a},W.cV=function(c,i){if(null==c)return!0;if("Feature"===c.type)return null!=af(c,i);if("FeatureCollection"===c.type){const a=new Set;for(const h of c.features){const m=af(h,i);if(null==m||a.has(m))return!1;a.add(m)}return!0}return!1},W.cW=function(c,i,a){var h,m,w,C;if(i.removeAll&&c.clear(),i.remove)for(const E of i.remove)c.delete(E);if(i.add)for(const E of i.add){const T=af(E,a);null!=T&&c.set(T,E)}if(i.update)for(const E of i.update){let T=c.get(E.id);if(null==T)continue;const R=!E.removeAllProperties&&((null===(h=E.removeProperties)||void 0===h?void 0:h.length)>0||(null===(m=E.addOrUpdateProperties)||void 0===m?void 0:m.length)>0);if((E.newGeometry||E.removeAllProperties||R)&&(T=Object.assign({},T),c.set(E.id,T),R&&(T.properties=Object.assign({},T.properties))),E.newGeometry&&(T.geometry=E.newGeometry),E.removeAllProperties)T.properties={};else if((null===(w=E.removeProperties)||void 0===w?void 0:w.length)>0)for(const L of E.removeProperties)Object.prototype.hasOwnProperty.call(T.properties,L)&&delete T.properties[L];if((null===(C=E.addOrUpdateProperties)||void 0===C?void 0:C.length)>0)for(const{key:L,value:z}of E.addOrUpdateProperties)T.properties[L]=z}},W.cX=So,W.ca=function(c,i){return c[0]=i[0],c[1]=i[1],c[2]=i[2],c[3]=i[3],c[4]=i[4],c[5]=i[5],c[6]=i[6],c[7]=i[7],c[8]=i[8],c[9]=i[9],c[10]=i[10],c[11]=i[11],c[12]=i[12],c[13]=i[13],c[14]=i[14],c[15]=i[15],c},W.cb=c=>"symbol"===c.type,W.cc=c=>"circle"===c.type,W.cd=c=>"heatmap"===c.type,W.ce=c=>"line"===c.type,W.cf=c=>"fill"===c.type,W.cg=c=>"fill-extrusion"===c.type,W.ch=c=>"hillshade"===c.type,W.ci=c=>"color-relief"===c.type,W.cj=c=>"raster"===c.type,W.ck=c=>"background"===c.type,W.cl=c=>"custom"===c.type,W.cm=vo,W.cn=function(c,i,a){const h=Vn(i.x-a.x,i.y-a.y),m=Vn(c.x-a.x,c.y-a.y);var w,C;return qn(Math.atan2(h[0]*m[1]-h[1]*m[0],(w=h)[0]*(C=m)[0]+w[1]*C[1]))},W.co=Uo,W.cp=function(c,i){return Go[i]&&(c instanceof MouseEvent||c instanceof WheelEvent)},W.cq=function(c,i){return Ri[i]&&"touches"in c},W.cr=function(c){return Ri[c]||Go[c]},W.cs=function(c,i,a){var h=i[0],m=i[1];return c[0]=a[0]*h+a[4]*m+a[12],c[1]=a[1]*h+a[5]*m+a[13],c},W.ct=function(c,i){const{x:a,y:h}=Sp.fromLngLat(i);return!(c<0||c>25||h<0||h>=1||a<0||a>=1)},W.cu=function(c,i){return c[0]=i[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=i[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=i[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},W.cv=class extends Du{},W.cw=ff,W.cy=function(c){return c.message===Ao},W.cz=de,W.d=Ne,W.e=Qn,W.f=c=>y(void 0,void 0,void 0,function*(){if(0===c.byteLength)return createImageBitmap(new ImageData(1,1));const i=new Blob([new Uint8Array(c)],{type:"image/png"});try{return createImageBitmap(i)}catch(a){throw new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),W.g=ee,W.h=c=>new Promise((i,a)=>{const h=new Image;h.onload=()=>{i(h),URL.revokeObjectURL(h.src),h.onload=null,window.requestAnimationFrame(()=>{h.src=Lr})},h.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const m=new Blob([new Uint8Array(c)],{type:"image/png"});h.src=c.byteLength?URL.createObjectURL(m):Lr}),W.i=At,W.j=(c,i)=>we(Qn(c,{type:"json"}),i),W.k=We,W.l=Ue,W.m=we,W.n=(c,i)=>we(Qn(c,{type:"arrayBuffer"}),i),W.o=function(c){return new Yg(c).readFields(eb,[])},W.p=Kd,W.q=qs,W.r=ft,W.s=ki,W.t=Gh,W.u=on,W.v=Me,W.w=Le,W.x=Vh,W.y=ls,W.z=Ya}),p("worker",0,function(W){class y{constructor(K){this.keyCache={},K&&this.replace(K)}replace(K){this._layerConfigs={},this._layers={},this.update(K,[])}update(K,ee){for(const de of K){this._layerConfigs[de.id]=de;const be=this._layers[de.id]=W.bJ(de);be._featureFilter=W.aa(be.filter),this.keyCache[de.id]&&delete this.keyCache[de.id]}for(const de of ee)delete this.keyCache[de],delete this._layerConfigs[de],delete this._layers[de];this.familiesBySource={};const te=W.cC(Object.values(this._layerConfigs),this.keyCache);for(const de of te){const be=de.map(We=>this._layers[We.id]),we=be[0];if("none"===we.visibility)continue;const Ne=we.source||"";let Ee=this.familiesBySource[Ne];Ee||(Ee=this.familiesBySource[Ne]={});const Ve=we.sourceLayer||"_geojsonTileLayer";let Ue=Ee[Ve];Ue||(Ue=Ee[Ve]=[]),Ue.push(be)}}}class Ye{constructor(K){const ee={},te=[];for(const Ne in K){const Ee=K[Ne],Ve=ee[Ne]={};for(const Ue in Ee){const We=Ee[+Ue];if(!We||0===We.bitmap.width||0===We.bitmap.height)continue;const bt={x:0,y:0,w:We.bitmap.width+2,h:We.bitmap.height+2};te.push(bt),Ve[Ue]={rect:bt,metrics:We.metrics}}}const{w:de,h:be}=W.p(te),we=new W.q({width:de||1,height:be||1});for(const Ne in K){const Ee=K[Ne];for(const Ve in Ee){const Ue=Ee[+Ve];if(!Ue||0===Ue.bitmap.width||0===Ue.bitmap.height)continue;const We=ee[Ne][Ve].rect;W.q.copy(Ue.bitmap,we,{x:0,y:0},{x:We.x+1,y:We.y+1},Ue.bitmap)}}this.image=we,this.positions=ee}}W.cD("GlyphAtlas",Ye);class En{constructor(K){this.tileID=new W.Z(K.tileID.overscaledZ,K.tileID.wrap,K.tileID.canonical.z,K.tileID.canonical.x,K.tileID.canonical.y),this.uid=K.uid,this.zoom=K.zoom,this.pixelRatio=K.pixelRatio,this.tileSize=K.tileSize,this.source=K.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=K.showCollisionBoxes,this.collectResourceTiming=!!K.collectResourceTiming,this.returnDependencies=!!K.returnDependencies,this.promoteId=K.promoteId,this.inFlightDependencies=[],this.globalState=K.globalState}parse(K,ee,te,de,be){return W._(this,void 0,void 0,function*(){this.status="parsing",this.data=K,this.collisionBoxArray=new W.a8;const we=new W.cE(Object.keys(K.layers).sort()),Ne=new W.cF(this.tileID,this.promoteId);Ne.bucketLayerIDs=[];const Ee={},Ve={featureIndex:Ne,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:te,subdivisionGranularity:be},Ue=ee.familiesBySource[this.source];for(const rn in Ue){const un=K.layers[rn];if(!un)continue;1===un.version&&W.w(`Vector tile source "${this.source}" layer "${rn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const yr=we.encode(rn),Ke=[];for(let Qr=0;Qr<un.length;Qr++){const ur=un.feature(Qr),ia=Ne.getId(ur,rn);Ke.push({feature:ur,id:ia,index:Qr,sourceLayerIndex:yr})}for(const Qr of Ue[rn]){const ur=Qr[0];ur.source!==this.source&&W.w(`layer.source = ${ur.source} does not equal this.source = ${this.source}`),ur.minzoom&&this.zoom<Math.floor(ur.minzoom)||ur.maxzoom&&this.zoom>=ur.maxzoom||"none"!==ur.visibility&&(yn(Qr,this.zoom,te),(Ee[ur.id]=ur.createBucket({index:Ne.bucketLayerIDs.length,layers:Qr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:yr,sourceID:this.source,globalState:this.globalState})).populate(Ke,Ve,this.tileID.canonical),Ne.bucketLayerIDs.push(Qr.map(ia=>ia.id)))}}const We=W.bN(Ve.glyphDependencies,rn=>Object.keys(rn).map(Number));this.inFlightDependencies.forEach(rn=>rn?.abort()),this.inFlightDependencies=[];let bt=Promise.resolve({});if(Object.keys(We).length){const rn=new AbortController;this.inFlightDependencies.push(rn),bt=de.sendAsync({type:"GG",data:{stacks:We,source:this.source,tileID:this.tileID,type:"glyphs"}},rn)}const Me=Object.keys(Ve.iconDependencies);let Ft=Promise.resolve({});if(Me.length){const rn=new AbortController;this.inFlightDependencies.push(rn),Ft=de.sendAsync({type:"GI",data:{icons:Me,source:this.source,tileID:this.tileID,type:"icons"}},rn)}const Jt=Object.keys(Ve.patternDependencies);let Et=Promise.resolve({});if(Jt.length){const rn=new AbortController;this.inFlightDependencies.push(rn),Et=de.sendAsync({type:"GI",data:{icons:Jt,source:this.source,tileID:this.tileID,type:"patterns"}},rn)}const[Zt,kn,Zn]=yield Promise.all([bt,Ft,Et]),Gn=new Ye(Zt),sr=new W.cG(kn,Zn);for(const rn in Ee){const un=Ee[rn];un instanceof W.a9?(yn(un.layers,this.zoom,te),W.cH({bucket:un,glyphMap:Zt,glyphPositions:Gn.positions,imageMap:kn,imagePositions:sr.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:Ve.subdivisionGranularity})):un.hasPattern&&(un instanceof W.cI||un instanceof W.cJ||un instanceof W.cK)&&(yn(un.layers,this.zoom,te),un.addFeatures(Ve,this.tileID.canonical,sr.patternPositions))}return this.status="done",{buckets:Object.values(Ee).filter(rn=>!rn.isEmpty()),featureIndex:Ne,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Gn.image,imageAtlas:sr,glyphMap:this.returnDependencies?Zt:null,iconMap:this.returnDependencies?kn:null,glyphPositions:this.returnDependencies?Gn.positions:null}})}}function yn(xe,K,ee){const te=new W.F(K);for(const de of xe)de.recalculate(te,ee)}class vn{constructor(K,ee,te){this.actor=K,this.layerIndex=ee,this.availableImages=te,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(K,ee){return W._(this,void 0,void 0,function*(){const te=yield W.n(K.request,ee);try{return{vectorTile:new W.cL(new W.cM(te.data)),rawData:te.data,cacheControl:te.cacheControl,expires:te.expires}}catch(de){const be=new Uint8Array(te.data);let we=`Unable to parse the tile at ${K.request.url}, `;throw we+=31===be[0]&&139===be[1]?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${de.message}`,new Error(we)}})}loadTile(K){return W._(this,void 0,void 0,function*(){const ee=K.uid,te=!!(K&&K.request&&K.request.collectResourceTiming)&&new W.cN(K.request),de=new En(K);this.loading[ee]=de;const be=new AbortController;de.abort=be;try{const we=yield this.loadVectorTile(K,be);if(delete this.loading[ee],!we)return null;const Ne=we.rawData,Ee={};we.expires&&(Ee.expires=we.expires),we.cacheControl&&(Ee.cacheControl=we.cacheControl);const Ve={};if(te){const We=te.finish();We&&(Ve.resourceTiming=JSON.parse(JSON.stringify(We)))}de.vectorTile=we.vectorTile;const Ue=de.parse(we.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity);this.loaded[ee]=de,this.fetching[ee]={rawTileData:Ne,cacheControl:Ee,resourceTiming:Ve};try{const We=yield Ue;return W.e({rawTileData:Ne.slice(0)},We,Ee,Ve)}finally{delete this.fetching[ee]}}catch(we){throw delete this.loading[ee],de.status="done",this.loaded[ee]=de,we}})}reloadTile(K){return W._(this,void 0,void 0,function*(){const ee=K.uid;if(!this.loaded||!this.loaded[ee])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const te=this.loaded[ee];if(te.showCollisionBoxes=K.showCollisionBoxes,te.globalState=K.globalState,"parsing"===te.status){const de=yield te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity);let be;if(this.fetching[ee]){const{rawTileData:we,cacheControl:Ne,resourceTiming:Ee}=this.fetching[ee];delete this.fetching[ee],be=W.e({rawTileData:we.slice(0)},de,Ne,Ee)}else be=de;return be}if("done"===te.status&&te.vectorTile)return te.parse(te.vectorTile,this.layerIndex,this.availableImages,this.actor,K.subdivisionGranularity)})}abortTile(K){return W._(this,void 0,void 0,function*(){const ee=this.loading,te=K.uid;ee&&ee[te]&&ee[te].abort&&(ee[te].abort.abort(),delete ee[te])})}removeTile(K){return W._(this,void 0,void 0,function*(){this.loaded&&this.loaded[K.uid]&&delete this.loaded[K.uid]})}}class mt{constructor(){this.loaded={}}loadTile(K){return W._(this,void 0,void 0,function*(){const{uid:ee,encoding:te,rawImageData:de,redFactor:be,greenFactor:we,blueFactor:Ne,baseShift:Ee}=K,Ve=de.width+2,Ue=de.height+2,We=W.b(de)?new W.R({width:Ve,height:Ue},yield W.cO(de,-1,-1,Ve,Ue)):de,bt=new W.cP(ee,We,te,be,we,Ne,Ee);return this.loaded=this.loaded||{},this.loaded[ee]=bt,bt})}removeTile(K){const ee=this.loaded,te=K.uid;ee&&ee[te]&&delete ee[te]}}var Ce,Qe,_t=function(){if(Qe)return Ce;function xe(ee,te){if(0!==ee.length){K(ee[0],te);for(var de=1;de<ee.length;de++)K(ee[de],!te)}}function K(ee,te){for(var de=0,be=0,we=0,Ne=ee.length,Ee=Ne-1;we<Ne;Ee=we++){var Ve=(ee[we][0]-ee[Ee][0])*(ee[Ee][1]+ee[we][1]),Ue=de+Ve;be+=Math.abs(de)>=Math.abs(Ve)?de-Ue+Ve:Ve-Ue+de,de=Ue}de+be>=0!=!!te&&ee.reverse()}return Qe=1,Ce=function ee(te,de){var be,we=te&&te.type;if("FeatureCollection"===we)for(be=0;be<te.features.length;be++)ee(te.features[be],de);else if("GeometryCollection"===we)for(be=0;be<te.geometries.length;be++)ee(te.geometries[be],de);else if("Feature"===we)ee(te.geometry,de);else if("Polygon"===we)xe(te.coordinates,de);else if("MultiPolygon"===we)for(be=0;be<te.coordinates.length;be++)xe(te.coordinates[be],de);return te}}(),Ht=W.cQ(_t);class Ut extends W.cS{constructor(K,ee){super(new W.cM,0,ee,[],[]),this.feature=K,this.type=K.type,this.properties=K.tags?K.tags:{},"id"in K&&("string"==typeof K.id?this.id=parseInt(K.id,10):"number"!=typeof K.id||isNaN(K.id)||(this.id=K.id))}loadGeometry(){const K=[],ee=1===this.feature.type?[this.feature.geometry]:this.feature.geometry;for(const te of ee){const de=[];for(const be of te)de.push(new W.P(be[0],be[1]));K.push(de)}return K}}class Gt extends W.cR{constructor(K,ee){super(new W.cM),this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.version=ee?ee.version:1,this.extent=ee?ee.extent:4096,this.length=K.length,this.features=K}feature(K){return new Ut(this.features[K],this.extent)}}function sn(xe,K){K.writeVarintField(15,xe.version||1),K.writeStringField(1,xe.name||""),K.writeVarintField(5,xe.extent||4096);const ee={keys:[],values:[],keycache:{},valuecache:{}};for(let be=0;be<xe.length;be++)ee.feature=xe.feature(be),K.writeMessage(2,Mn,ee);const te=ee.keys;for(const be of te)K.writeStringField(3,be);const de=ee.values;for(const be of de)K.writeMessage(4,Nt,be)}function Mn(xe,K){if(!xe.feature)return;const ee=xe.feature;void 0!==ee.id&&K.writeVarintField(1,ee.id),K.writeMessage(2,_r,xe),K.writeVarintField(3,ee.type),K.writeMessage(4,Cn,ee)}function _r(xe,K){for(const ee in xe.feature?.properties){let te=xe.feature.properties[ee],de=xe.keycache[ee];if(null===te)continue;void 0===de&&(xe.keys.push(ee),de=xe.keys.length-1,xe.keycache[ee]=de),K.writeVarint(de),"string"!=typeof te&&"boolean"!=typeof te&&"number"!=typeof te&&(te=JSON.stringify(te));const be=typeof te+":"+te;let we=xe.valuecache[be];void 0===we&&(xe.values.push(te),we=xe.values.length-1,xe.valuecache[be]=we),K.writeVarint(we)}}function zt(xe,K){return(K<<3)+(7&xe)}function Vo(xe){return xe<<1^xe>>31}function Cn(xe,K){const ee=xe.loadGeometry(),te=xe.type;let de=0,be=0;for(const we of ee){let Ne=1;1===te&&(Ne=we.length),K.writeVarint(zt(1,Ne));const Ee=3===te?we.length-1:we.length;for(let Ve=0;Ve<Ee;Ve++){1===Ve&&1!==te&&K.writeVarint(zt(2,Ee-1));const Ue=we[Ve].x-de,We=we[Ve].y-be;K.writeVarint(Vo(Ue)),K.writeVarint(Vo(We)),de+=Ue,be+=We}3===xe.type&&K.writeVarint(zt(7,1))}}function Nt(xe,K){const ee=typeof xe;"string"===ee?K.writeStringField(1,xe):"boolean"===ee?K.writeBooleanField(7,xe):"number"===ee&&(xe%1!=0?K.writeDoubleField(3,xe):xe<0?K.writeSVarintField(6,xe):K.writeVarintField(5,xe))}const Ge={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:xe=>xe},ir=Math.fround||(Tn=new Float32Array(1),xe=>(Tn[0]=+xe,Tn[0]));var Tn;class gn{constructor(K){this.options=Object.assign(Object.create(Ge),K),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(K){const{log:ee,minZoom:te,maxZoom:de}=this.options;ee&&console.time("total time");const be=`prepare ${K.length} points`;ee&&console.time(be),this.points=K;const we=[];for(let Ee=0;Ee<K.length;Ee++){const Ve=K[Ee];if(!Ve.geometry)continue;const[Ue,We]=Ve.geometry.coordinates,bt=ir(Wn(Ue)),Me=ir(Qo(We));we.push(bt,Me,1/0,Ee,-1,1),this.options.reduce&&we.push(0)}let Ne=this.trees[de+1]=this._createTree(we);ee&&console.timeEnd(be);for(let Ee=de;Ee>=te;Ee--){const Ve=+Date.now();Ne=this.trees[Ee]=this._createTree(this._cluster(Ne,Ee)),ee&&console.log("z%d: %d clusters in %dms",Ee,Ne.numItems,+Date.now()-Ve)}return ee&&console.timeEnd("total time"),this}getClusters(K,ee){let te=((K[0]+180)%360+360)%360-180;const de=Math.max(-90,Math.min(90,K[1]));let be=180===K[2]?180:((K[2]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,K[3]));if(K[2]-K[0]>=360)te=-180,be=180;else if(te>be){const We=this.getClusters([te,de,180,we],ee),bt=this.getClusters([-180,de,be,we],ee);return We.concat(bt)}const Ne=this.trees[this._limitZoom(ee)],Ee=Ne.range(Wn(te),Qo(we),Wn(be),Qo(de)),Ve=Ne.data,Ue=[];for(const We of Ee){const bt=this.stride*We;Ue.push(Ve[bt+5]>1?cr(Ve,bt,this.clusterProps):this.points[Ve[bt+3]])}return Ue}getChildren(K){const ee=this._getOriginId(K),te=this._getOriginZoom(K),de="No cluster with the specified id.",be=this.trees[te];if(!be)throw new Error(de);const we=be.data;if(ee*this.stride>=we.length)throw new Error(de);const Ne=this.options.radius/(this.options.extent*Math.pow(2,te-1)),Ee=be.within(we[ee*this.stride],we[ee*this.stride+1],Ne),Ve=[];for(const Ue of Ee){const We=Ue*this.stride;we[We+4]===K&&Ve.push(we[We+5]>1?cr(we,We,this.clusterProps):this.points[we[We+3]])}if(0===Ve.length)throw new Error(de);return Ve}getLeaves(K,ee,te){const de=[];return this._appendLeaves(de,K,ee=ee||10,te=te||0,0),de}getTile(K,ee,te){const de=this.trees[this._limitZoom(K)],be=Math.pow(2,K),{extent:we,radius:Ne}=this.options,Ee=Ne/we,Ve=(te-Ee)/be,Ue=(te+1+Ee)/be,We={features:[]};return this._addTileFeatures(de.range((ee-Ee)/be,Ve,(ee+1+Ee)/be,Ue),de.data,ee,te,be,We),0===ee&&this._addTileFeatures(de.range(1-Ee/be,Ve,1,Ue),de.data,be,te,be,We),ee===be-1&&this._addTileFeatures(de.range(0,Ve,Ee/be,Ue),de.data,-1,te,be,We),We.features.length?We:null}getClusterExpansionZoom(K){let ee=this._getOriginZoom(K)-1;for(;ee<=this.options.maxZoom;){const te=this.getChildren(K);if(ee++,1!==te.length)break;K=te[0].properties.cluster_id}return ee}_appendLeaves(K,ee,te,de,be){const we=this.getChildren(ee);for(const Ne of we){const Ee=Ne.properties;if(Ee&&Ee.cluster?be+Ee.point_count<=de?be+=Ee.point_count:be=this._appendLeaves(K,Ee.cluster_id,te,de,be):be<de?be++:K.push(Ne),K.length===te)break}return be}_createTree(K){const ee=new W.aI(K.length/this.stride|0,this.options.nodeSize,Float32Array);for(let te=0;te<K.length;te+=this.stride)ee.add(K[te],K[te+1]);return ee.finish(),ee.data=K,ee}_addTileFeatures(K,ee,te,de,be,we){for(const Ne of K){const Ee=Ne*this.stride,Ve=ee[Ee+5]>1;let Ue,We,bt;if(Ve)Ue=Sr(ee,Ee,this.clusterProps),We=ee[Ee],bt=ee[Ee+1];else{const Jt=this.points[ee[Ee+3]];Ue=Jt.properties;const[Et,Zt]=Jt.geometry.coordinates;We=Wn(Et),bt=Qo(Zt)}const Me={type:1,geometry:[[Math.round(this.options.extent*(We*be-te)),Math.round(this.options.extent*(bt*be-de))]],tags:Ue};let Ft;Ft=Ve||this.options.generateId?ee[Ee+3]:this.points[ee[Ee+3]].id,void 0!==Ft&&(Me.id=Ft),we.features.push(Me)}}_limitZoom(K){return Math.max(this.options.minZoom,Math.min(Math.floor(+K),this.options.maxZoom+1))}_cluster(K,ee){const{radius:te,extent:de,reduce:be,minPoints:we}=this.options,Ne=te/(de*Math.pow(2,ee)),Ee=K.data,Ve=[],Ue=this.stride;for(let We=0;We<Ee.length;We+=Ue){if(Ee[We+2]<=ee)continue;Ee[We+2]=ee;const bt=Ee[We],Me=Ee[We+1],Ft=K.within(Ee[We],Ee[We+1],Ne),Jt=Ee[We+5];let Et=Jt;for(const Zt of Ft){const kn=Zt*Ue;Ee[kn+2]>ee&&(Et+=Ee[kn+5])}if(Et>Jt&&Et>=we){let Zt,kn=bt*Jt,Zn=Me*Jt,Gn=-1;const sr=(We/Ue<<5)+(ee+1)+this.points.length;for(const rn of Ft){const un=rn*Ue;if(Ee[un+2]<=ee)continue;Ee[un+2]=ee;const yr=Ee[un+5];kn+=Ee[un]*yr,Zn+=Ee[un+1]*yr,Ee[un+4]=sr,be&&(Zt||(Zt=this._map(Ee,We,!0),Gn=this.clusterProps.length,this.clusterProps.push(Zt)),be(Zt,this._map(Ee,un)))}Ee[We+4]=sr,Ve.push(kn/Et,Zn/Et,1/0,sr,-1,Et),be&&Ve.push(Gn)}else{for(let Zt=0;Zt<Ue;Zt++)Ve.push(Ee[We+Zt]);if(Et>1)for(const Zt of Ft){const kn=Zt*Ue;if(!(Ee[kn+2]<=ee)){Ee[kn+2]=ee;for(let Zn=0;Zn<Ue;Zn++)Ve.push(Ee[kn+Zn])}}}}return Ve}_getOriginId(K){return K-this.points.length>>5}_getOriginZoom(K){return(K-this.points.length)%32}_map(K,ee,te){if(K[ee+5]>1){const we=this.clusterProps[K[ee+6]];return te?Object.assign({},we):we}const de=this.points[K[ee+3]].properties,be=this.options.map(de);return te&&be===de?Object.assign({},be):be}}function cr(xe,K,ee){return{type:"Feature",id:xe[K+3],properties:Sr(xe,K,ee),geometry:{type:"Point",coordinates:[(te=xe[K],360*(te-.5)),Vn(xe[K+1])]}};var te}function Sr(xe,K,ee){const te=xe[K+5],de=te>=1e4?`${Math.round(te/1e3)}k`:te>=1e3?Math.round(te/100)/10+"k":te,be=xe[K+6],we=-1===be?{}:Object.assign({},ee[be]);return Object.assign(we,{cluster:!0,cluster_id:xe[K+3],point_count:te,point_count_abbreviated:de})}function Wn(xe){return xe/360+.5}function Qo(xe){const K=Math.sin(xe*Math.PI/180),ee=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return ee<0?0:ee>1?1:ee}function Vn(xe){const K=(180-360*xe)*Math.PI/180;return 360*Math.atan(Math.exp(K))/Math.PI-90}function an(xe,K,ee,te){let de=te;const be=K+(ee-K>>1);let we,Ne=ee-K;const Ee=xe[K],Ve=xe[K+1],Ue=xe[ee],We=xe[ee+1];for(let bt=K+3;bt<ee;bt+=3){const Me=fn(xe[bt],xe[bt+1],Ee,Ve,Ue,We);if(Me>de)we=bt,de=Me;else if(Me===de){const Ft=Math.abs(bt-be);Ft<Ne&&(we=bt,Ne=Ft)}}de>te&&(we-K>3&&an(xe,K,we,te),xe[we+2]=de,ee-we>3&&an(xe,we,ee,te))}function fn(xe,K,ee,te,de,be){let we=de-ee,Ne=be-te;if(0!==we||0!==Ne){const Ee=((xe-ee)*we+(K-te)*Ne)/(we*we+Ne*Ne);Ee>1?(ee=de,te=be):Ee>0&&(ee+=we*Ee,te+=Ne*Ee)}return we=xe-ee,Ne=K-te,we*we+Ne*Ne}function Un(xe,K,ee,te){const de={id:xe??null,type:K,geometry:ee,tags:te,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if("Point"===K||"MultiPoint"===K||"LineString"===K)yo(de,ee);else if("Polygon"===K)yo(de,ee[0]);else if("MultiLineString"===K)for(const be of ee)yo(de,be);else if("MultiPolygon"===K)for(const be of ee)yo(de,be[0]);return de}function yo(xe,K){for(let ee=0;ee<K.length;ee+=3)xe.minX=Math.min(xe.minX,K[ee]),xe.minY=Math.min(xe.minY,K[ee+1]),xe.maxX=Math.max(xe.maxX,K[ee]),xe.maxY=Math.max(xe.maxY,K[ee+1])}function Rr(xe,K,ee,te){if(!K.geometry)return;const de=K.geometry.coordinates;if(de&&0===de.length)return;const be=K.geometry.type,we=Math.pow(ee.tolerance/((1<<ee.maxZoom)*ee.extent),2);let Ne=[],Ee=K.id;if(ee.promoteId?Ee=K.properties[ee.promoteId]:ee.generateId&&(Ee=te||0),"Point"===be)vo(de,Ne);else if("MultiPoint"===be)for(const Ve of de)vo(Ve,Ne);else if("LineString"===be)Uo(de,Ne,we,!1);else if("MultiLineString"===be){if(ee.lineMetrics){for(const Ve of de)Ne=[],Uo(Ve,Ne,we,!1),xe.push(Un(Ee,"LineString",Ne,K.properties));return}Or(de,Ne,we,!1)}else if("Polygon"===be)Or(de,Ne,we,!0);else{if("MultiPolygon"!==be){if("GeometryCollection"===be){for(const Ve of K.geometry.geometries)Rr(xe,{id:Ee,geometry:Ve,properties:K.properties},ee,te);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const Ve of de){const Ue=[];Or(Ve,Ue,we,!0),Ne.push(Ue)}}xe.push(Un(Ee,be,Ne,K.properties))}function vo(xe,K){K.push(ai(xe[0]),Qn(xe[1]),0)}function Uo(xe,K,ee,te){let de,be,we=0;for(let Ee=0;Ee<xe.length;Ee++){const Ve=ai(xe[Ee][0]),Ue=Qn(xe[Ee][1]);K.push(Ve,Ue,0),Ee>0&&(we+=te?(de*Ue-Ve*be)/2:Math.sqrt(Math.pow(Ve-de,2)+Math.pow(Ue-be,2))),de=Ve,be=Ue}const Ne=K.length-3;K[2]=1,an(K,0,Ne,ee),K[Ne+2]=1,K.size=Math.abs(we),K.start=0,K.end=K.size}function Or(xe,K,ee,te){for(let de=0;de<xe.length;de++){const be=[];Uo(xe[de],be,ee,te),K.push(be)}}function ai(xe){return xe/360+.5}function Qn(xe){const K=Math.sin(xe*Math.PI/180),ee=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return ee<0?0:ee>1?1:ee}function Lt(xe,K,ee,te,de,be,we,Ne){if(te/=K,be>=(ee/=K)&&we<te)return xe;if(we<ee||be>=te)return null;const Ee=[];for(const Ve of xe){const Ue=Ve.geometry;let We=Ve.type;const bt=0===de?Ve.minX:Ve.minY,Me=0===de?Ve.maxX:Ve.maxY;if(bt>=ee&&Me<te){Ee.push(Ve);continue}if(Me<ee||bt>=te)continue;let Ft=[];if("Point"===We||"MultiPoint"===We)li(Ue,Ft,ee,te,de);else if("LineString"===We)oa(Ue,Ft,ee,te,de,!1,Ne.lineMetrics);else if("MultiLineString"===We)Jn(Ue,Ft,ee,te,de,!1);else if("Polygon"===We)Jn(Ue,Ft,ee,te,de,!0);else if("MultiPolygon"===We)for(const Jt of Ue){const Et=[];Jn(Jt,Et,ee,te,de,!0),Et.length&&Ft.push(Et)}if(Ft.length){if(Ne.lineMetrics&&"LineString"===We){for(const Jt of Ft)Ee.push(Un(Ve.id,We,Jt,Ve.tags));continue}"LineString"!==We&&"MultiLineString"!==We||(1===Ft.length?(We="LineString",Ft=Ft[0]):We="MultiLineString"),"Point"!==We&&"MultiPoint"!==We||(We=3===Ft.length?"Point":"MultiPoint"),Ee.push(Un(Ve.id,We,Ft,Ve.tags))}}return Ee.length?Ee:null}function li(xe,K,ee,te,de){for(let be=0;be<xe.length;be+=3){const we=xe[be+de];we>=ee&&we<=te&&Le(K,xe[be],xe[be+1],xe[be+2])}}function oa(xe,K,ee,te,de,be,we){let Ne=Nr(xe);const Ee=0===de?gt:At;let Ve,Ue,We=xe.start;for(let Et=0;Et<xe.length-3;Et+=3){const Zt=xe[Et],kn=xe[Et+1],Zn=xe[Et+2],Gn=xe[Et+3],sr=xe[Et+4],rn=0===de?Zt:kn,un=0===de?Gn:sr;let yr=!1;we&&(Ve=Math.sqrt(Math.pow(Zt-Gn,2)+Math.pow(kn-sr,2))),rn<ee?un>ee&&(Ue=Ee(Ne,Zt,kn,Gn,sr,ee),we&&(Ne.start=We+Ve*Ue)):rn>te?un<te&&(Ue=Ee(Ne,Zt,kn,Gn,sr,te),we&&(Ne.start=We+Ve*Ue)):Le(Ne,Zt,kn,Zn),un<ee&&rn>=ee&&(Ue=Ee(Ne,Zt,kn,Gn,sr,ee),yr=!0),un>te&&rn<=te&&(Ue=Ee(Ne,Zt,kn,Gn,sr,te),yr=!0),!be&&yr&&(we&&(Ne.end=We+Ve*Ue),K.push(Ne),Ne=Nr(xe)),we&&(We+=Ve)}let bt=xe.length-3;const Me=xe[bt],Ft=xe[bt+1],Jt=0===de?Me:Ft;Jt>=ee&&Jt<=te&&Le(Ne,Me,Ft,xe[bt+2]),bt=Ne.length-3,be&&bt>=3&&(Ne[bt]!==Ne[0]||Ne[bt+1]!==Ne[1])&&Le(Ne,Ne[0],Ne[1],Ne[2]),Ne.length&&K.push(Ne)}function Nr(xe){const K=[];return K.size=xe.size,K.start=xe.start,K.end=xe.end,K}function Jn(xe,K,ee,te,de,be){for(const we of xe)oa(we,K,ee,te,de,be,!1)}function Le(xe,K,ee,te){xe.push(K,ee,te)}function gt(xe,K,ee,te,de,be){const we=(be-K)/(te-K);return Le(xe,be,ee+(de-ee)*we,1),we}function At(xe,K,ee,te,de,be){const we=(be-ee)/(de-ee);return Le(xe,K+(te-K)*we,be,1),we}function Vt(xe,K){const ee=[];for(let te=0;te<xe.length;te++){const de=xe[te],be=de.type;let we;if("Point"===be||"MultiPoint"===be||"LineString"===be)we=bn(de.geometry,K);else if("MultiLineString"===be||"Polygon"===be){we=[];for(const Ne of de.geometry)we.push(bn(Ne,K))}else if("MultiPolygon"===be){we=[];for(const Ne of de.geometry){const Ee=[];for(const Ve of Ne)Ee.push(bn(Ve,K));we.push(Ee)}}ee.push(Un(de.id,be,we,de.tags))}return ee}function bn(xe,K){const ee=[];ee.size=xe.size,void 0!==xe.start&&(ee.start=xe.start,ee.end=xe.end);for(let te=0;te<xe.length;te+=3)ee.push(xe[te]+K,xe[te+1],xe[te+2]);return ee}function Lr(xe,K){if(xe.transformed)return xe;const ee=1<<xe.z,te=xe.x,de=xe.y;for(const be of xe.features){const we=be.geometry,Ne=be.type;if(be.geometry=[],1===Ne)for(let Ee=0;Ee<we.length;Ee+=2)be.geometry.push(ao(we[Ee],we[Ee+1],K,ee,te,de));else for(let Ee=0;Ee<we.length;Ee++){const Ve=[];for(let Ue=0;Ue<we[Ee].length;Ue+=2)Ve.push(ao(we[Ee][Ue],we[Ee][Ue+1],K,ee,te,de));be.geometry.push(Ve)}}return xe.transformed=!0,xe}function ao(xe,K,ee,te,de,be){return[Math.round(ee*(xe*te-de)),Math.round(ee*(K*te-be))]}function Ds(xe,K,ee,te,de){const be=K===de.maxZoom?0:de.tolerance/((1<<K)*de.extent),we={features:[],numPoints:0,numSimplified:0,numFeatures:xe.length,source:null,x:ee,y:te,z:K,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const Ne of xe)Pi(we,Ne,be,de);return we}function Pi(xe,K,ee,te){const de=K.geometry,be=K.type,we=[];if(xe.minX=Math.min(xe.minX,K.minX),xe.minY=Math.min(xe.minY,K.minY),xe.maxX=Math.max(xe.maxX,K.maxX),xe.maxY=Math.max(xe.maxY,K.maxY),"Point"===be||"MultiPoint"===be)for(let Ne=0;Ne<de.length;Ne+=3)we.push(de[Ne],de[Ne+1]),xe.numPoints++,xe.numSimplified++;else if("LineString"===be)ki(we,de,xe,ee,!1,!1);else if("MultiLineString"===be||"Polygon"===be)for(let Ne=0;Ne<de.length;Ne++)ki(we,de[Ne],xe,ee,"Polygon"===be,0===Ne);else if("MultiPolygon"===be)for(let Ne=0;Ne<de.length;Ne++){const Ee=de[Ne];for(let Ve=0;Ve<Ee.length;Ve++)ki(we,Ee[Ve],xe,ee,!0,0===Ve)}if(we.length){let Ne=K.tags||null;if("LineString"===be&&te.lineMetrics){Ne={};for(const Ve in K.tags)Ne[Ve]=K.tags[Ve];Ne.mapbox_clip_start=de.start/de.size,Ne.mapbox_clip_end=de.end/de.size}const Ee={geometry:we,type:"Polygon"===be||"MultiPolygon"===be?3:"LineString"===be||"MultiLineString"===be?2:1,tags:Ne};null!==K.id&&(Ee.id=K.id),xe.features.push(Ee)}}function ki(xe,K,ee,te,de,be){const we=te*te;if(te>0&&K.size<(de?we:te))return void(ee.numPoints+=K.length/3);const Ne=[];for(let Ee=0;Ee<K.length;Ee+=3)(0===te||K[Ee+2]>we)&&(ee.numSimplified++,Ne.push(K[Ee],K[Ee+1])),ee.numPoints++;de&&function(Ee,Ve){let Ue=0;for(let We=0,bt=Ee.length,Me=bt-2;We<bt;Me=We,We+=2)Ue+=(Ee[We]-Ee[Me])*(Ee[We+1]+Ee[Me+1]);if(Ue>0===Ve)for(let We=0,bt=Ee.length;We<bt/2;We+=2){const Me=Ee[We],Ft=Ee[We+1];Ee[We]=Ee[bt-2-We],Ee[We+1]=Ee[bt-1-We],Ee[bt-2-We]=Me,Ee[bt-1-We]=Ft}}(Ne,be),xe.push(Ne)}const ci={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class qn{constructor(K,ee){const te=(ee=this.options=function(be,we){for(const Ne in we)be[Ne]=we[Ne];return be}(Object.create(ci),ee)).debug;if(te&&console.time("preprocess data"),ee.maxZoom<0||ee.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ee.promoteId&&ee.generateId)throw new Error("promoteId and generateId cannot be used together.");let de=function(be,we){const Ne=[];if("FeatureCollection"===be.type)for(let Ee=0;Ee<be.features.length;Ee++)Rr(Ne,be.features[Ee],we,Ee);else Rr(Ne,"Feature"===be.type?be:{geometry:be},we);return Ne}(K,ee);this.tiles={},this.tileCoords=[],te&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ee.indexMaxZoom,ee.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),de=function(be,we){const Ne=we.buffer/we.extent;let Ee=be;const Ve=Lt(be,1,-1-Ne,Ne,0,-1,2,we),Ue=Lt(be,1,1-Ne,2+Ne,0,-1,2,we);return(Ve||Ue)&&(Ee=Lt(be,1,-Ne,1+Ne,0,-1,2,we)||[],Ve&&(Ee=Vt(Ve,1).concat(Ee)),Ue&&(Ee=Ee.concat(Vt(Ue,-1)))),Ee}(de,ee),de.length&&this.splitTile(de,0,0,0),te&&(de.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(K,ee,te,de,be,we,Ne){const Ee=[K,ee,te,de],Ve=this.options,Ue=Ve.debug;for(;Ee.length;){de=Ee.pop(),te=Ee.pop(),ee=Ee.pop(),K=Ee.pop();const We=1<<ee,bt=Ri(ee,te,de);let Me=this.tiles[bt];if(!Me&&(Ue>1&&console.time("creation"),Me=this.tiles[bt]=Ds(K,ee,te,de,Ve),this.tileCoords.push({z:ee,x:te,y:de}),Ue)){Ue>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ee,te,de,Me.numFeatures,Me.numPoints,Me.numSimplified),console.timeEnd("creation"));const yr=`z${ee}`;this.stats[yr]=(this.stats[yr]||0)+1,this.total++}if(Me.source=K,null==be){if(ee===Ve.indexMaxZoom||Me.numPoints<=Ve.indexMaxPoints)continue}else{if(ee===Ve.maxZoom||ee===be)continue;if(null!=be){const yr=be-ee;if(te!==we>>yr||de!==Ne>>yr)continue}}if(Me.source=null,0===K.length)continue;Ue>1&&console.time("clipping");const Ft=.5*Ve.buffer/Ve.extent,Jt=.5-Ft,Et=.5+Ft,Zt=1+Ft;let kn=null,Zn=null,Gn=null,sr=null,rn=Lt(K,We,te-Ft,te+Et,0,Me.minX,Me.maxX,Ve),un=Lt(K,We,te+Jt,te+Zt,0,Me.minX,Me.maxX,Ve);K=null,rn&&(kn=Lt(rn,We,de-Ft,de+Et,1,Me.minY,Me.maxY,Ve),Zn=Lt(rn,We,de+Jt,de+Zt,1,Me.minY,Me.maxY,Ve),rn=null),un&&(Gn=Lt(un,We,de-Ft,de+Et,1,Me.minY,Me.maxY,Ve),sr=Lt(un,We,de+Jt,de+Zt,1,Me.minY,Me.maxY,Ve),un=null),Ue>1&&console.timeEnd("clipping"),Ee.push(kn||[],ee+1,2*te,2*de),Ee.push(Zn||[],ee+1,2*te,2*de+1),Ee.push(Gn||[],ee+1,2*te+1,2*de),Ee.push(sr||[],ee+1,2*te+1,2*de+1)}}getTile(K,ee,te){K=+K,ee=+ee,te=+te;const de=this.options,{extent:be,debug:we}=de;if(K<0||K>24)return null;const Ne=1<<K,Ee=Ri(K,ee=ee+Ne&Ne-1,te);if(this.tiles[Ee])return Lr(this.tiles[Ee],be);we>1&&console.log("drilling down to z%d-%d-%d",K,ee,te);let Ve,Ue=K,We=ee,bt=te;for(;!Ve&&Ue>0;)Ue--,We>>=1,bt>>=1,Ve=this.tiles[Ri(Ue,We,bt)];return Ve&&Ve.source?(we>1&&(console.log("found parent tile z%d-%d-%d",Ue,We,bt),console.time("drilling down")),this.splitTile(Ve.source,Ue,We,bt,K,ee,te),we>1&&console.timeEnd("drilling down"),this.tiles[Ee]?Lr(this.tiles[Ee],be):null):null}}function Ri(xe,K,ee){return 32*((1<<xe)*ee+K)+xe}class Go extends vn{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(K,ee){return W._(this,void 0,void 0,function*(){const te=K.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const de=this._geoJSONIndex.getTile(te.z,te.x,te.y);if(!de)return null;const be=new Gt(de.features,{version:2,extent:W.$});let we=function(Ne){const Ee=new W.cM;return function(Ve,Ue){for(const We in Ve.layers)Ue.writeMessage(3,sn,Ve.layers[We])}(Ne,Ee),Ee.finish()}(be);return 0===we.byteOffset&&we.byteLength===we.buffer.byteLength||(we=new Uint8Array(we)),{vectorTile:be,rawData:we.buffer}})}loadData(K){return W._(this,void 0,void 0,function*(){var ee;null===(ee=this._pendingRequest)||void 0===ee||ee.abort();const te=!!(K&&K.request&&K.request.collectResourceTiming)&&new W.cN(K.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(K,this._pendingRequest);const de=yield this._pendingData;this._geoJSONIndex=K.cluster?new gn(function({superclusterOptions:we,clusterProperties:Ne}){if(!Ne||!we)return we;const Ee={},Ve={},Ue={accumulated:null,zoom:0},We={properties:null},bt=Object.keys(Ne);for(const Me of bt){const[Ft,Jt]=Ne[Me],Et=W.cT(Jt),Zt=W.cT("string"==typeof Ft?[Ft,["accumulated"],["get",Me]]:Ft);Ee[Me]=Et.value,Ve[Me]=Zt.value}return we.map=Me=>{We.properties=Me;const Ft={};for(const Jt of bt)Ft[Jt]=Ee[Jt].evaluate(Ue,We);return Ft},we.reduce=(Me,Ft)=>{We.properties=Ft;for(const Jt of bt)Ue.accumulated=Me[Jt],Me[Jt]=Ve[Jt].evaluate(Ue,We)},we}(K)).load(de.features):new qn(de,K.geojsonVtOptions),this.loaded={};const be={data:de};if(te){const we=te.finish();we&&(be.resourceTiming={},be.resourceTiming[K.source]=JSON.parse(JSON.stringify(we)))}return be}catch(de){if(delete this._pendingRequest,W.cy(de))return{abandoned:!0};throw de}})}getData(){return W._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(K){const ee=this.loaded;return ee&&ee[K.uid]?super.reloadTile(K):this.loadTile(K)}loadAndProcessGeoJSON(K,ee){return W._(this,void 0,void 0,function*(){let te=yield this.loadGeoJSON(K,ee);if(delete this._pendingRequest,"object"!=typeof te)throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`);if(Ht(te,!0),K.filter){const de=W.cT(K.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===de.result)throw new Error(de.value.map(we=>`${we.key}: ${we.message}`).join(", "));te={type:"FeatureCollection",features:te.features.filter(we=>de.value.evaluate({zoom:0},we))}}return te})}loadGeoJSON(K,ee){return W._(this,void 0,void 0,function*(){const{promoteId:te}=K;if(K.request){const de=yield W.j(K.request,ee);return this._dataUpdateable=W.cV(de.data,te)?W.cU(de.data,te):void 0,de.data}if("string"==typeof K.data)try{const de=JSON.parse(K.data);return this._dataUpdateable=W.cV(de,te)?W.cU(de,te):void 0,de}catch{throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`)}if(!K.dataDiff)throw new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${K.source}`);return W.cW(this._dataUpdateable,K.dataDiff,te),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(K){return W._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(K){return this._geoJSONIndex.getClusterExpansionZoom(K.clusterId)}getClusterChildren(K){return this._geoJSONIndex.getChildren(K.clusterId)}getClusterLeaves(K){return this._geoJSONIndex.getLeaves(K.clusterId,K.limit,K.offset)}}class Ao{constructor(K){this.self=K,this.actor=new W.J(K),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(ee,te)=>{if(this.externalWorkerSourceTypes[ee])throw new Error(`Worker source with name "${ee}" already registered.`);this.externalWorkerSourceTypes[ee]=te},this.self.addProtocol=W.cA,this.self.removeProtocol=W.cB,this.self.registerRTLTextPlugin=ee=>{W.cX.setMethods(ee)},this.actor.registerMessageHandler("LDT",(ee,te)=>this._getDEMWorkerSource(ee,te.source).loadTile(te)),this.actor.registerMessageHandler("RDT",(ee,te)=>W._(this,void 0,void 0,function*(){this._getDEMWorkerSource(ee,te.source).removeTile(te)})),this.actor.registerMessageHandler("GCEZ",(ee,te)=>W._(this,void 0,void 0,function*(){return this._getWorkerSource(ee,te.type,te.source).getClusterExpansionZoom(te)})),this.actor.registerMessageHandler("GCC",(ee,te)=>W._(this,void 0,void 0,function*(){return this._getWorkerSource(ee,te.type,te.source).getClusterChildren(te)})),this.actor.registerMessageHandler("GCL",(ee,te)=>W._(this,void 0,void 0,function*(){return this._getWorkerSource(ee,te.type,te.source).getClusterLeaves(te)})),this.actor.registerMessageHandler("LD",(ee,te)=>this._getWorkerSource(ee,te.type,te.source).loadData(te)),this.actor.registerMessageHandler("GD",(ee,te)=>this._getWorkerSource(ee,te.type,te.source).getData()),this.actor.registerMessageHandler("LT",(ee,te)=>this._getWorkerSource(ee,te.type,te.source).loadTile(te)),this.actor.registerMessageHandler("RT",(ee,te)=>this._getWorkerSource(ee,te.type,te.source).reloadTile(te)),this.actor.registerMessageHandler("AT",(ee,te)=>this._getWorkerSource(ee,te.type,te.source).abortTile(te)),this.actor.registerMessageHandler("RMT",(ee,te)=>this._getWorkerSource(ee,te.type,te.source).removeTile(te)),this.actor.registerMessageHandler("RS",(ee,te)=>W._(this,void 0,void 0,function*(){if(!this.workerSources[ee]||!this.workerSources[ee][te.type]||!this.workerSources[ee][te.type][te.source])return;const de=this.workerSources[ee][te.type][te.source];delete this.workerSources[ee][te.type][te.source],void 0!==de.removeSource&&de.removeSource(te)})),this.actor.registerMessageHandler("RM",ee=>W._(this,void 0,void 0,function*(){delete this.layerIndexes[ee],delete this.availableImages[ee],delete this.workerSources[ee],delete this.demWorkerSources[ee]})),this.actor.registerMessageHandler("SR",(ee,te)=>W._(this,void 0,void 0,function*(){this.referrer=te})),this.actor.registerMessageHandler("SRPS",(ee,te)=>this._syncRTLPluginState(ee,te)),this.actor.registerMessageHandler("IS",(ee,te)=>W._(this,void 0,void 0,function*(){this.self.importScripts(te)})),this.actor.registerMessageHandler("SI",(ee,te)=>this._setImages(ee,te)),this.actor.registerMessageHandler("UL",(ee,te)=>W._(this,void 0,void 0,function*(){this._getLayerIndex(ee).update(te.layers,te.removedIds)})),this.actor.registerMessageHandler("SL",(ee,te)=>W._(this,void 0,void 0,function*(){this._getLayerIndex(ee).replace(te)}))}_setImages(K,ee){return W._(this,void 0,void 0,function*(){this.availableImages[K]=ee;for(const te in this.workerSources[K]){const de=this.workerSources[K][te];for(const be in de)de[be].availableImages=ee}})}_syncRTLPluginState(K,ee){return W._(this,void 0,void 0,function*(){return yield W.cX.syncState(ee,this.self.importScripts)})}_getAvailableImages(K){let ee=this.availableImages[K];return ee||(ee=[]),ee}_getLayerIndex(K){let ee=this.layerIndexes[K];return ee||(ee=this.layerIndexes[K]=new y),ee}_getWorkerSource(K,ee,te){if(this.workerSources[K]||(this.workerSources[K]={}),this.workerSources[K][ee]||(this.workerSources[K][ee]={}),!this.workerSources[K][ee][te]){const de={sendAsync:(be,we)=>(be.targetMapId=K,this.actor.sendAsync(be,we))};switch(ee){case"vector":this.workerSources[K][ee][te]=new vn(de,this._getLayerIndex(K),this._getAvailableImages(K));break;case"geojson":this.workerSources[K][ee][te]=new Go(de,this._getLayerIndex(K),this._getAvailableImages(K));break;default:this.workerSources[K][ee][te]=new this.externalWorkerSourceTypes[ee](de,this._getLayerIndex(K),this._getAvailableImages(K))}}return this.workerSources[K][ee][te]}_getDEMWorkerSource(K,ee){return this.demWorkerSources[K]||(this.demWorkerSources[K]={}),this.demWorkerSources[K][ee]||(this.demWorkerSources[K][ee]=new mt),this.demWorkerSources[K][ee]}}return W.i(self)&&(self.worker=new Ao(self)),Ao}),p("index",0,function(W,y){function En(){var b=new y.A(4);return y.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let yn,vn;const mt={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(b,o,u){const f=requestAnimationFrame(x=>{_(),o(x)}),{unsubscribe:_}=y.s(b.signal,"abort",()=>{_(),cancelAnimationFrame(f),u(y.c())},!1)},frameAsync(b){return new Promise((o,u)=>{this.frame(b,o,u)})},getImageData(b,o=0){return this.getImageCanvasContext(b).getImageData(-o,-o,b.width+2*o,b.height+2*o)},getImageCanvasContext(b){const o=window.document.createElement("canvas"),u=o.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return o.width=b.width,o.height=b.height,u.drawImage(b,0,0,b.width,b.height),u},resolveURL:b=>(yn||(yn=document.createElement("a")),yn.href=b,yn.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(null==vn&&(vn=matchMedia("(prefers-reduced-motion: reduce)")),vn.matches)}};class Ce{static testProp(o){if(!Ce.docStyle)return o[0];for(let u=0;u<o.length;u++)if(o[u]in Ce.docStyle)return o[u];return o[0]}static create(o,u,f){const _=window.document.createElement(o);return void 0!==u&&(_.className=u),f&&f.appendChild(_),_}static createNS(o,u){return window.document.createElementNS(o,u)}static disableDrag(){Ce.docStyle&&Ce.selectProp&&(Ce.userSelect=Ce.docStyle[Ce.selectProp],Ce.docStyle[Ce.selectProp]="none")}static enableDrag(){Ce.docStyle&&Ce.selectProp&&(Ce.docStyle[Ce.selectProp]=Ce.userSelect)}static setTransform(o,u){o.style[Ce.transformProp]=u}static addEventListener(o,u,f,_={}){o.addEventListener(u,f,"passive"in _?_:_.capture)}static removeEventListener(o,u,f,_={}){o.removeEventListener(u,f,"passive"in _?_:_.capture)}static suppressClickInternal(o){o.preventDefault(),o.stopPropagation(),window.removeEventListener("click",Ce.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",Ce.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",Ce.suppressClickInternal,!0)},0)}static getScale(o){const u=o.getBoundingClientRect();return{x:u.width/o.offsetWidth||1,y:u.height/o.offsetHeight||1,boundingClientRect:u}}static getPoint(o,u,f){const _=u.boundingClientRect;return new y.P((f.clientX-_.left)/u.x-o.clientLeft,(f.clientY-_.top)/u.y-o.clientTop)}static mousePos(o,u){const f=Ce.getScale(o);return Ce.getPoint(o,f,u)}static touchPos(o,u){const f=[],_=Ce.getScale(o);for(let x=0;x<u.length;x++)f.push(Ce.getPoint(o,_,u[x]));return f}static mouseButton(o){return o.button}static remove(o){o.parentNode&&o.parentNode.removeChild(o)}static sanitize(o){const u=(new DOMParser).parseFromString(o,"text/html").body||document.createElement("body"),f=u.querySelectorAll("script");for(const _ of f)_.remove();return Ce.clean(u),u.innerHTML}static isPossiblyDangerous(o,u){const f=u.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(o)||!f.includes("javascript:")&&!f.includes("data:"))||!!o.startsWith("on")||void 0}static clean(o){const u=o.children;for(const f of u)Ce.removeAttributes(f),Ce.clean(f)}static removeAttributes(o){for(const{name:u,value:f}of o.attributes)Ce.isPossiblyDangerous(u,f)&&o.removeAttribute(u)}}Ce.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,Ce.selectProp=Ce.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),Ce.transformProp=Ce.testProp(["transform","WebkitTransform"]);const Qe={supported:!1,testSupport:function(b){!Ut&&Ht&&(Gt?sn(b):_t=b)}};let _t,Ht,Ut=!1,Gt=!1;function sn(b){const o=b.createTexture();b.bindTexture(b.TEXTURE_2D,o);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,Ht),b.isContextLost())return;Qe.supported=!0}catch{}b.deleteTexture(o),Ut=!0}var Mn;typeof document<"u"&&(Ht=document.createElement("img"),Ht.onload=()=>{_t&&sn(_t),_t=null,Gt=!0},Ht.onerror=()=>{Ut=!0,_t=null},Ht.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let o,u,f,_;b.resetRequestQueue=()=>{o=[],u=0,f=0,_={}},b.addThrottleControl=D=>{const N=f++;return _[N]=D,N},b.removeThrottleControl=D=>{delete _[D],S()},b.getImage=(D,N,F=!0)=>new Promise((U,V)=>{Qe.supported&&(D.headers||(D.headers={}),D.headers.accept="image/webp,*/*"),y.e(D,{type:"image"}),o.push({abortController:N,requestParameters:D,supportImageRefresh:F,state:"queued",onError:H=>{V(H)},onSuccess:H=>{U(H)}}),S()});const x=D=>y._(this,void 0,void 0,function*(){D.state="running";const{requestParameters:N,supportImageRefresh:F,onError:U,onSuccess:V,abortController:H}=D,Y=!1===F&&!y.i(self)&&!y.g(N.url)&&(!N.headers||Object.keys(N.headers).reduce((ie,ue)=>ie&&"accept"===ue,!0));u++;const oe=Y?I(N,H):y.m(N,H);try{const ie=yield oe;delete D.abortController,D.state="completed",ie.data instanceof HTMLImageElement||y.b(ie.data)?V(ie):ie.data&&V({data:yield(re=ie.data,"function"==typeof createImageBitmap?y.f(re):y.h(re)),cacheControl:ie.cacheControl,expires:ie.expires})}catch(ie){delete D.abortController,U(ie)}finally{u--,S()}var re}),S=()=>{const D=(()=>{for(const N of Object.keys(_))if(_[N]())return!0;return!1})()?y.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:y.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let N=u;N<D&&o.length>0;N++){const F=o.shift();F.abortController.signal.aborted?N--:x(F)}},I=(D,N)=>new Promise((F,U)=>{const V=new Image,H=D.url,Y=D.credentials;Y&&"include"===Y?V.crossOrigin="use-credentials":(Y&&"same-origin"===Y||!y.d(H))&&(V.crossOrigin="anonymous"),N.signal.addEventListener("abort",()=>{V.src="",U(y.c())}),V.fetchPriority="high",V.onload=()=>{V.onerror=V.onload=null,F({data:V})},V.onerror=()=>{V.onerror=V.onload=null,N.signal.aborted||U(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},V.src=H})}(Mn||(Mn={})),Mn.resetRequestQueue();class _r{constructor(o){this._transformRequestFn=o??null}transformRequest(o,u){return this._transformRequestFn&&this._transformRequestFn(o,u)||{url:o}}setTransformRequest(o){this._transformRequestFn=o}}function zt(b){const o=[];if("string"==typeof b)o.push({id:"default",url:b});else if(b&&b.length>0){const u=[];for(const{id:f,url:_}of b){const x=`${f}${_}`;-1===u.indexOf(x)&&(u.push(x),o.push({id:f,url:_}))}}return o}function Vo(b,o,u){try{const f=new URL(b);return f.pathname+=`${o}${u}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}function Cn(b){const{userImage:o}=b;return!!(o&&o.render&&o.render())&&(b.data.replace(new Uint8Array(o.data.buffer)),!0)}class Nt extends y.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new y.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:u,promiseResolve:f}of this.requestors)f(this._getImagesForIds(u));this.requestors=[]}}getImage(o){const u=this.images[o];if(u&&!u.data&&u.spriteData){const f=u.spriteData;u.data=new y.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),u.spriteData=null}return u}addImage(o,u){if(this.images[o])throw new Error(`Image id ${o} already exist, use updateImage instead`);this._validate(o,u)&&(this.images[o]=u)}_validate(o,u){let f=!0;const _=u.data||u.spriteData;return this._validateStretch(u.stretchX,_&&_.width)||(this.fire(new y.k(new Error(`Image "${o}" has invalid "stretchX" value`))),f=!1),this._validateStretch(u.stretchY,_&&_.height)||(this.fire(new y.k(new Error(`Image "${o}" has invalid "stretchY" value`))),f=!1),this._validateContent(u.content,u)||(this.fire(new y.k(new Error(`Image "${o}" has invalid "content" value`))),f=!1),f}_validateStretch(o,u){if(!o)return!0;let f=0;for(const _ of o){if(_[0]<f||_[1]<_[0]||u<_[1])return!1;f=_[1]}return!0}_validateContent(o,u){if(!o)return!0;if(4!==o.length)return!1;const f=u.spriteData,_=f&&f.width||u.data.width,x=f&&f.height||u.data.height;return!(o[0]<0||_<o[0]||o[1]<0||x<o[1]||o[2]<0||_<o[2]||o[3]<0||x<o[3]||o[2]<o[0]||o[3]<o[1])}updateImage(o,u,f=!0){const _=this.getImage(o);if(f&&(_.data.width!==u.data.width||_.data.height!==u.data.height))throw new Error(`size mismatch between old image (${_.data.width}x${_.data.height}) and new image (${u.data.width}x${u.data.height}).`);u.version=_.version+1,this.images[o]=u,this.updatedImages[o]=!0}removeImage(o){const u=this.images[o];delete this.images[o],delete this.patterns[o],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o){return new Promise((u,f)=>{let _=!0;if(!this.isLoaded())for(const x of o)this.images[x]||(_=!1);this.isLoaded()||_?u(this._getImagesForIds(o)):this.requestors.push({ids:o,promiseResolve:u})})}_getImagesForIds(o){const u={};for(const f of o){let _=this.getImage(f);_||(this.fire(new y.l("styleimagemissing",{id:f})),_=this.getImage(f)),_?u[f]={data:_.data.clone(),pixelRatio:_.pixelRatio,sdf:_.sdf,version:_.version,stretchX:_.stretchX,stretchY:_.stretchY,content:_.content,textFitWidth:_.textFitWidth,textFitHeight:_.textFitHeight,hasRenderCallback:!(!_.userImage||!_.userImage.render)}:y.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return u}getPixelSize(){const{width:o,height:u}=this.atlasImage;return{width:o,height:u}}getPattern(o){const u=this.patterns[o],f=this.getImage(o);if(!f)return null;if(u&&u.position.version===f.version)return u.position;if(u)u.position.version=f.version;else{const _={w:f.data.width+2,h:f.data.height+2,x:0,y:0},x=new y.I(_,f);this.patterns[o]={bin:_,position:x}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const u=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new y.T(o,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const x in this.patterns)o.push(this.patterns[x].bin);const{w:u,h:f}=y.p(o),_=this.atlasImage;_.resize({width:u||1,height:f||1});for(const x in this.patterns){const{bin:S}=this.patterns[x],I=S.x+1,D=S.y+1,N=this.getImage(x).data,F=N.width,U=N.height;y.R.copy(N,_,{x:0,y:0},{x:I,y:D},{width:F,height:U}),y.R.copy(N,_,{x:0,y:U-1},{x:I,y:D-1},{width:F,height:1}),y.R.copy(N,_,{x:0,y:0},{x:I,y:D+U},{width:F,height:1}),y.R.copy(N,_,{x:F-1,y:0},{x:I-1,y:D},{width:1,height:U}),y.R.copy(N,_,{x:0,y:0},{x:I+F,y:D},{width:1,height:U})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const u of o){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const f=this.getImage(u);f||y.w(`Image with ID: "${u}" was not found`),Cn(f)&&this.updateImage(u,f)}}}const Ge=1e20;function ir(b,o,u,f,_,x,S,I,D){for(let N=o;N<o+f;N++)Tn(b,u*x+N,x,_,S,I,D);for(let N=u;N<u+_;N++)Tn(b,N*x+o,1,f,S,I,D)}function Tn(b,o,u,f,_,x,S){x[0]=0,S[0]=-Ge,S[1]=Ge,_[0]=b[o];for(let I=1,D=0,N=0;I<f;I++){_[I]=b[o+I*u];const F=I*I;do{const U=x[D];N=(_[I]-_[U]+F-U*U)/(I-U)/2}while(N<=S[D]&&--D>-1);D++,x[D]=I,S[D]=N,S[D+1]=Ge}for(let I=0,D=0;I<f;I++){for(;S[D+1]<I;)D++;const N=x[D],F=I-N;b[o+I*u]=_[N]+F*F}}class gn{constructor(o,u){this.requestManager=o,this.localIdeographFontFamily=u,this.entries={}}setURL(o){this.url=o}getGlyphs(o){return y._(this,void 0,void 0,function*(){const u=[];for(const x in o)for(const S of o[x])u.push(this._getAndCacheGlyphsPromise(x,S));const f=yield Promise.all(u),_={};for(const{stack:x,id:S,glyph:I}of f)_[x]||(_[x]={}),_[x][S]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics};return _})}_getAndCacheGlyphsPromise(o,u){return y._(this,void 0,void 0,function*(){let f=this.entries[o];f||(f=this.entries[o]={glyphs:{},requests:{},ranges:{}});let _=f.glyphs[u];if(void 0!==_)return{stack:o,id:u,glyph:_};if(_=this._tinySDF(f,o,u),_)return f.glyphs[u]=_,{stack:o,id:u,glyph:_};const x=Math.floor(u/256);if(256*x>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[x])return{stack:o,id:u,glyph:_};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[x]){const I=gn.loadGlyphRange(o,x,this.url,this.requestManager);f.requests[x]=I}const S=yield f.requests[x];for(const I in S)this._doesCharSupportLocalGlyph(+I)||(f.glyphs[+I]=S[+I]);return f.ranges[x]=!0,{stack:o,id:u,glyph:S[u]||null}})}_doesCharSupportLocalGlyph(o){return!!this.localIdeographFontFamily&&(new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(o))||y.u["CJK Unified Ideographs"](o)||y.u["Hangul Syllables"](o)||y.u.Hiragana(o)||y.u.Katakana(o)||y.u["CJK Symbols and Punctuation"](o)||y.u["Halfwidth and Fullwidth Forms"](o))}_tinySDF(o,u,f){const _=this.localIdeographFontFamily;if(!_||!this._doesCharSupportLocalGlyph(f))return;let x=o.tinySDF;if(!x){let I="400";/bold/i.test(u)?I="900":/medium/i.test(u)?I="500":/light/i.test(u)&&(I="200"),x=o.tinySDF=new gn.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:_,fontWeight:I})}const S=x.draw(String.fromCharCode(f));return{id:f,bitmap:new y.q({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}gn.loadGlyphRange=function(b,o,u,f){return y._(this,void 0,void 0,function*(){const _=256*o,x=_+255,S=f.transformRequest(u.replace("{fontstack}",b).replace("{range}",`${_}-${x}`),"Glyphs"),I=yield y.n(S,new AbortController);if(!I||!I.data)throw new Error(`Could not load glyph range. range: ${o}, ${_}-${x}`);const D={};for(const N of y.o(I.data))D[N.id]=N;return D})},gn.TinySDF=class{constructor({fontSize:b=24,buffer:o=3,radius:u=8,cutoff:f=.25,fontFamily:_="sans-serif",fontWeight:x="normal",fontStyle:S="normal",lang:I=null}={}){this.buffer=o,this.cutoff=f,this.radius=u,this.lang=I;const D=this.size=b+4*o,N=this._createCanvas(D),F=this.ctx=N.getContext("2d",{willReadFrequently:!0});F.font=`${S} ${x} ${b}px ${_}`,F.textBaseline="alphabetic",F.textAlign="left",F.fillStyle="black",this.gridOuter=new Float64Array(D*D),this.gridInner=new Float64Array(D*D),this.f=new Float64Array(D),this.z=new Float64Array(D+1),this.v=new Uint16Array(D)}_createCanvas(b){const o=document.createElement("canvas");return o.width=o.height=b,o}draw(b){const{width:o,actualBoundingBoxAscent:u,actualBoundingBoxDescent:f,actualBoundingBoxLeft:_,actualBoundingBoxRight:x}=this.ctx.measureText(b),S=Math.ceil(u),I=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(x-_))),D=Math.min(this.size-this.buffer,S+Math.ceil(f)),N=I+2*this.buffer,F=D+2*this.buffer,U=Math.max(N*F,0),V=new Uint8ClampedArray(U),H={data:V,width:N,height:F,glyphWidth:I,glyphHeight:D,glyphTop:S,glyphLeft:0,glyphAdvance:o};if(0===I||0===D)return H;const{ctx:Y,buffer:oe,gridInner:re,gridOuter:ie}=this;this.lang&&(Y.lang=this.lang),Y.clearRect(oe,oe,I,D),Y.fillText(b,oe,oe+S);const ue=Y.getImageData(oe,oe,I,D);ie.fill(Ge,0,U),re.fill(0,0,U);for(let pe=0;pe<D;pe++)for(let he=0;he<I;he++){const me=ue.data[4*(pe*I+he)+3]/255;if(0===me)continue;const ve=(pe+oe)*N+he+oe;if(1===me)ie[ve]=0,re[ve]=Ge;else{const fe=.5-me;ie[ve]=fe>0?fe*fe:0,re[ve]=fe<0?fe*fe:0}}ir(ie,0,0,N,F,N,this.f,this.v,this.z),ir(re,oe,oe,I,D,N,this.f,this.v,this.z);for(let pe=0;pe<U;pe++){const he=Math.sqrt(ie[pe])-Math.sqrt(re[pe]);V[pe]=Math.round(255-255*(he/this.radius+this.cutoff))}return H}};class cr{constructor(){this.specification=y.v.light.position}possiblyEvaluate(o,u){return y.B(o.expression.evaluate(u))}interpolate(o,u,f){return{x:y.C.number(o.x,u.x,f),y:y.C.number(o.y,u.y,f),z:y.C.number(o.z,u.z,f)}}}let Sr;class Wn extends y.E{constructor(o){super(),Sr=Sr||new y.r({anchor:new y.D(y.v.light.anchor),position:new cr,color:new y.D(y.v.light.color),intensity:new y.D(y.v.light.intensity)}),this._transitionable=new y.t(Sr),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,u={}){if(!this._validate(y.x,o,u))for(const f in o){const _=o[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),_):this._transitionable.setValue(f,_)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,f){return(!f||!1!==f.validate)&&y.y(this,o.call(y.z,{value:u,style:{glyphs:!0,sprite:!0},styleSpec:y.v}))}}const Qo=new y.r({"sky-color":new y.D(y.v.sky["sky-color"]),"horizon-color":new y.D(y.v.sky["horizon-color"]),"fog-color":new y.D(y.v.sky["fog-color"]),"fog-ground-blend":new y.D(y.v.sky["fog-ground-blend"]),"horizon-fog-blend":new y.D(y.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new y.D(y.v.sky["sky-horizon-blend"]),"atmosphere-blend":new y.D(y.v.sky["atmosphere-blend"])});class Vn extends y.E{constructor(o){super(),this._transitionable=new y.t(Qo),this.setSky(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new y.F(0))}setSky(o,u={}){if(!this._validate(y.G,o,u)){o||(o={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in o){const _=o[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),_):this._transitionable.setValue(f,_)}}}getSky(){return this._transitionable.serialize()}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,u,f={}){return!1!==f?.validate&&y.y(this,o.call(y.z,y.e({value:u,style:{glyphs:!0,sprite:!0},styleSpec:y.v})))}calculateFogBlendOpacity(o){return o<60?0:o<70?(o-60)/10:1}}class an{constructor(o,u){this.width=o,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(o,u){const f=o.join(",")+String(u);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(o,u)),this.dashEntry[f]}getDashRanges(o,u,f){const _=[];let x=o.length%2==1?-o[o.length-1]*f:0,S=o[0]*f,I=!0;_.push({left:x,right:S,isDash:I,zeroLength:0===o[0]});let D=o[0];for(let N=1;N<o.length;N++){I=!I;const F=o[N];x=D*f,D+=F,S=D*f,_.push({left:x,right:S,isDash:I,zeroLength:0===F})}return _}addRoundDash(o,u,f){const _=u/2;for(let x=-f;x<=f;x++){const S=this.width*(this.nextRow+f+x);let I=0,D=o[I];for(let N=0;N<this.width;N++){N/D.right>1&&(D=o[++I]);const F=Math.abs(N-D.left),U=Math.abs(N-D.right),V=Math.min(F,U);let H;const Y=x/f*(_+1);if(D.isDash){const oe=_-Math.abs(Y);H=Math.sqrt(V*V+oe*oe)}else H=_-Math.sqrt(V*V+Y*Y);this.data[S+N]=Math.max(0,Math.min(255,H+128))}}}addRegularDash(o){for(let I=o.length-1;I>=0;--I){const D=o[I],N=o[I+1];D.zeroLength?o.splice(I,1):N&&N.isDash===D.isDash&&(N.left=D.left,o.splice(I,1))}const u=o[0],f=o[o.length-1];u.isDash===f.isDash&&(u.left=f.left-this.width,f.right=u.right+this.width);const _=this.width*this.nextRow;let x=0,S=o[x];for(let I=0;I<this.width;I++){I/S.right>1&&(S=o[++x]);const D=Math.abs(I-S.left),N=Math.abs(I-S.right),F=Math.min(D,N);this.data[_+I]=Math.max(0,Math.min(255,(S.isDash?F:-F)+128))}}addDash(o,u){const f=u?7:0,_=2*f+1;if(this.nextRow+_>this.height)return y.w("LineAtlas out of space"),null;let x=0;for(let I=0;I<o.length;I++)x+=o[I];if(0!==x){const I=this.width/x,D=this.getDashRanges(o,this.width,I);u?this.addRoundDash(D,I,f):this.addRegularDash(D)}const S={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:x};return this.nextRow+=_,this.dirty=!0,S}bind(o){const u=o.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))}}const fn="maplibre_preloaded_worker_pool";class Un{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<Un.workerCount;)this.workers.push(new Worker(y.a.WORKER_URL));return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],0===this.numActive()&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[fn]}numActive(){return Object.keys(this.active).length}}const yo=Math.floor(mt.hardwareConcurrency/2);let Rr,vo;function Uo(){return Rr||(Rr=new Un),Rr}Un.workerCount=y.H(globalThis)?Math.max(Math.min(yo,3),1):1;class Or{constructor(o,u){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=u;const f=this.workerPool.acquire(u);for(let _=0;_<f.length;_++){const x=new y.J(f[_],u);x.name=`Worker ${_}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(o,u){const f=[];for(const _ of this.actors)f.push(_.sendAsync({type:o,data:u}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(o=!0){this.actors.forEach(u=>{u.remove()}),this.actors=[],o&&this.workerPool.release(this.id)}registerMessageHandler(o,u){for(const f of this.actors)f.registerMessageHandler(o,u)}}function ai(){return vo||(vo=new Or(Uo(),y.K),vo.registerMessageHandler("GR",(b,o,u)=>y.m(o,u))),vo}function Qn(b,o){const u=y.L();return y.M(u,u,[1,1,0]),y.N(u,u,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?y.O(u,u,b.calculatePosMatrix(o.toUnwrapped())):u}function Lt(b,o,u,f,_,x,S){var I;const D=function(V,H,Y){if(V)for(const oe of V){const re=H[oe];if(re&&re.source===Y&&"fill-extrusion"===re.type)return!0}else for(const oe in H){const re=H[oe];if(re.source===Y&&"fill-extrusion"===re.type)return!0}return!1}(null!==(I=_?.layers)&&void 0!==I?I:null,o,b.id),N=x.maxPitchScaleFactor(),F=b.tilesIn(f,N,D);F.sort(li);const U=[];for(const V of F)U.push({wrappedTileID:V.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(o,u,b._state,V.queryGeometry,V.cameraQueryGeometry,V.scale,_,x,N,Qn(b.transform,V.tileID),S?(H,Y)=>S(V.tileID,H,Y):void 0)});return function(V,H){for(const Y in V)for(const oe of V[Y])oa(oe,H);return V}(function(V){const H={},Y={};for(const oe of V){const re=oe.queryResults,ie=oe.wrappedTileID,ue=Y[ie]=Y[ie]||{};for(const pe in re){const he=re[pe],me=ue[pe]=ue[pe]||{},ve=H[pe]=H[pe]||[];for(const fe of he)me[fe.featureIndex]||(me[fe.featureIndex]=!0,ve.push(fe))}}return H}(U),b)}function li(b,o){const u=b.tileID,f=o.tileID;return u.overscaledZ-f.overscaledZ||u.canonical.y-f.canonical.y||u.wrap-f.wrap||u.canonical.x-f.canonical.x}function oa(b,o){const u=b.feature,f=o.getFeatureState(u.layer["source-layer"],u.id);u.source=u.layer.source,u.layer["source-layer"]&&(u.sourceLayer=u.layer["source-layer"]),u.state=f}function Nr(b,o,u){return y._(this,void 0,void 0,function*(){let f=b;if(b.url?f=(yield y.j(o.transformRequest(b.url,"Source"),u)).data:yield mt.frameAsync(u),!f)return null;const _=y.Q(y.e(f,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(_.vectorLayerIds=f.vector_layers.map(x=>x.id)),_})}class Jn{constructor(o,u){o&&(u?this.setSouthWest(o).setNorthEast(u):Array.isArray(o)&&(4===o.length?this.setSouthWest([o[0],o[1]]).setNorthEast([o[2],o[3]]):this.setSouthWest(o[0]).setNorthEast(o[1])))}setNorthEast(o){return this._ne=o instanceof y.S?new y.S(o.lng,o.lat):y.S.convert(o),this}setSouthWest(o){return this._sw=o instanceof y.S?new y.S(o.lng,o.lat):y.S.convert(o),this}extend(o){const u=this._sw,f=this._ne;let _,x;if(o instanceof y.S)_=o,x=o;else{if(!(o instanceof Jn))return Array.isArray(o)?4===o.length||o.every(Array.isArray)?this.extend(Jn.convert(o)):this.extend(y.S.convert(o)):o&&("lng"in o||"lon"in o)&&"lat"in o?this.extend(y.S.convert(o)):this;if(_=o._sw,x=o._ne,!_||!x)return this}return u||f?(u.lng=Math.min(_.lng,u.lng),u.lat=Math.min(_.lat,u.lat),f.lng=Math.max(x.lng,f.lng),f.lat=Math.max(x.lat,f.lat)):(this._sw=new y.S(_.lng,_.lat),this._ne=new y.S(x.lng,x.lat)),this}getCenter(){return new y.S((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new y.S(this.getWest(),this.getNorth())}getSouthEast(){return new y.S(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(o){const{lng:u,lat:f}=y.S.convert(o);let _=this._sw.lng<=u&&u<=this._ne.lng;return this._sw.lng>this._ne.lng&&(_=this._sw.lng>=u&&u>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&_}static convert(o){return o instanceof Jn?o:o&&new Jn(o)}static fromLngLat(o,u=0){const f=360*u/40075017,_=f/Math.cos(Math.PI/180*o.lat);return new Jn(new y.S(o.lng-_,o.lat-f),new y.S(o.lng+_,o.lat+f))}adjustAntiMeridian(){const o=new y.S(this._sw.lng,this._sw.lat),u=new y.S(this._ne.lng,this._ne.lat);return new Jn(o,o.lng>u.lng?new y.S(u.lng+360,u.lat):u)}}class Le{constructor(o,u,f){this.bounds=Jn.convert(this.validateBounds(o)),this.minzoom=u||0,this.maxzoom=f||24}validateBounds(o){return Array.isArray(o)&&4===o.length?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const u=Math.pow(2,o.z),f=Math.floor(y.V(this.bounds.getWest())*u),_=Math.floor(y.U(this.bounds.getNorth())*u),x=Math.ceil(y.V(this.bounds.getEast())*u),S=Math.ceil(y.U(this.bounds.getSouth())*u);return o.x>=f&&o.x<x&&o.y>=_&&o.y<S}}class gt extends y.E{constructor(o,u,f,_){if(super(),this.id=o,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,y.e(this,y.Q(u,["url","scheme","tileSize","promoteId"])),this._options=y.e({type:"vector"},u),this._collectResourceTiming=u.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_)}load(){return y._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new y.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield Nr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),o&&(y.e(this,o),o.bounds&&(this.tileBounds=new Le(o.bounds,this.minzoom,this.maxzoom)),this.fire(new y.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new y.l("data",{dataType:"source",sourceDataType:"content"})))}catch(o){this._tileJSONRequest=null,this.fire(new y.k(o))}})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}setSourceProperty(o){this._tileJSONRequest&&this._tileJSONRequest.abort(),o(),this.load()}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return y.e({},this._options)}loadTile(o){return y._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(u,"Tile"),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};f.request.collectResourceTiming=this._collectResourceTiming;let _="RT";if(o.actor&&"expired"!==o.state){if("loading"===o.state)return new Promise((x,S)=>{o.reloadPromise={resolve:x,reject:S}})}else o.actor=this.dispatcher.getActor(),_="LT";o.abortController=new AbortController;try{const x=yield o.actor.sendAsync({type:_,data:f},o.abortController);if(delete o.abortController,o.aborted)return;this._afterTileLoadWorkerResponse(o,x)}catch(x){if(delete o.abortController,o.aborted)return;if(x&&404!==x.status)throw x;this._afterTileLoadWorkerResponse(o,null)}})}_afterTileLoadWorkerResponse(o,u){if(u&&u.resourceTiming&&(o.resourceTiming=u.resourceTiming),u&&this.map._refreshExpiredTiles&&o.setExpiryData(u),o.loadVectorData(u,this.map.painter),o.reloadPromise){const f=o.reloadPromise;o.reloadPromise=null,this.loadTile(o).then(f.resolve).catch(f.reject)}}abortTile(o){return y._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.actor&&(yield o.actor.sendAsync({type:"AT",data:{uid:o.uid,type:this.type,source:this.id}}))})}unloadTile(o){return y._(this,void 0,void 0,function*(){o.unloadVectorData(),o.actor&&(yield o.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class At extends y.E{constructor(o,u,f,_){super(),this.id=o,this.dispatcher=f,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=y.e({type:"raster"},u),y.e(this,y.Q(u,["url","scheme","tileSize"]))}load(){return y._(this,arguments,void 0,function*(o=!1){this._loaded=!1,this.fire(new y.l("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const u=yield Nr(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,u&&(y.e(this,u),u.bounds&&(this.tileBounds=new Le(u.bounds,this.minzoom,this.maxzoom)),this.fire(new y.l("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new y.l("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:o})))}catch(u){this._tileJSONRequest=null,this.fire(new y.k(u))}})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(o){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),o(),this.load(!0)}setTiles(o){return this.setSourceProperty(()=>{this._options.tiles=o}),this}setUrl(o){return this.setSourceProperty(()=>{this.url=o,this._options.url=o}),this}serialize(){return y.e({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o){return y._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);o.abortController=new AbortController;try{const f=yield Mn.getImage(this.map._requestManager.transformRequest(u,"Tile"),o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&(f.cacheControl||f.expires)&&o.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const _=this.map.painter.context,x=_.gl,S=f.data;o.texture=this.map.painter.getTileTexture(S.width),o.texture?o.texture.update(S,{useMipmap:!0}):(o.texture=new y.T(_,S,x.RGBA,{useMipmap:!0}),o.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE,x.LINEAR_MIPMAP_NEAREST)),o.state="loaded"}}catch(f){if(delete o.abortController,o.aborted)o.state="unloaded";else if(f)throw o.state="errored",f}})}abortTile(o){return y._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController)})}unloadTile(o){return y._(this,void 0,void 0,function*(){o.texture&&this.map.painter.saveTileTexture(o.texture)})}hasTransition(){return!1}}class Vt extends At{constructor(o,u,f,_){super(o,u,f,_),this.type="raster-dem",this.maxzoom=22,this._options=y.e({type:"raster-dem"},u),this.encoding=u.encoding||"mapbox",this.redFactor=u.redFactor,this.greenFactor=u.greenFactor,this.blueFactor=u.blueFactor,this.baseShift=u.baseShift}loadTile(o){return y._(this,void 0,void 0,function*(){const u=o.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(u,"Tile");o.neighboringTiles=this._getNeighboringTiles(o.tileID),o.abortController=new AbortController;try{const _=yield Mn.getImage(f,o.abortController,this.map._refreshExpiredTiles);if(delete o.abortController,o.aborted)return void(o.state="unloaded");if(_&&_.data){const x=_.data;this.map._refreshExpiredTiles&&(_.cacheControl||_.expires)&&o.setExpiryData({cacheControl:_.cacheControl,expires:_.expires});const S=y.b(x)&&y.W()?x:yield this.readImageNow(x),I={type:this.type,uid:o.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!o.actor||"expired"===o.state){o.actor=this.dispatcher.getActor();const D=yield o.actor.sendAsync({type:"LDT",data:I});o.dem=D,o.needsHillshadePrepare=!0,o.needsTerrainPrepare=!0,o.state="loaded"}}}catch(_){if(delete o.abortController,o.aborted)o.state="unloaded";else if(_)throw o.state="errored",_}})}readImageNow(o){return y._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&y.X()){const u=o.width+2,f=o.height+2;try{return new y.R({width:u,height:f},yield y.Y(o,-1,-1,u,f))}catch{}}return mt.getImageData(o,1)})}_getNeighboringTiles(o){const u=o.canonical,f=Math.pow(2,u.z),_=(u.x-1+f)%f,x=0===u.x?o.wrap-1:o.wrap,S=(u.x+1+f)%f,I=u.x+1===f?o.wrap+1:o.wrap,D={};return D[new y.Z(o.overscaledZ,x,u.z,_,u.y).key]={backfilled:!1},D[new y.Z(o.overscaledZ,I,u.z,S,u.y).key]={backfilled:!1},u.y>0&&(D[new y.Z(o.overscaledZ,x,u.z,_,u.y-1).key]={backfilled:!1},D[new y.Z(o.overscaledZ,o.wrap,u.z,u.x,u.y-1).key]={backfilled:!1},D[new y.Z(o.overscaledZ,I,u.z,S,u.y-1).key]={backfilled:!1}),u.y+1<f&&(D[new y.Z(o.overscaledZ,x,u.z,_,u.y+1).key]={backfilled:!1},D[new y.Z(o.overscaledZ,o.wrap,u.z,u.x,u.y+1).key]={backfilled:!1},D[new y.Z(o.overscaledZ,I,u.z,S,u.y+1).key]={backfilled:!1}),D}unloadTile(o){return y._(this,void 0,void 0,function*(){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&(yield o.actor.sendAsync({type:"RDT",data:{type:this.type,uid:o.uid,source:this.id}}))})}}class bn extends y.E{constructor(o,u,f,_){super(),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._isUpdatingWorker=!1,this._pendingWorkerUpdate={data:u.data},this.actor=f.getActor(),this.setEventedParent(_),this._data=u.data,this._options=y.e({},u),this._collectResourceTiming=u.collectResourceTiming,void 0!==u.maxzoom&&(this.maxzoom=u.maxzoom),u.type&&(this.type=u.type),u.attribution&&(this.attribution=u.attribution),this.promoteId=u.promoteId,void 0!==u.clusterMaxZoom&&this.maxzoom<=u.clusterMaxZoom&&y.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${u.clusterMaxZoom}".`),this.workerOptions=y.e({source:this.id,cluster:u.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(void 0!==u.buffer?u.buffer:128),tolerance:this._pixelsToTileUnits(void 0!==u.tolerance?u.tolerance:.375),extent:y.$,maxZoom:this.maxzoom,lineMetrics:u.lineMetrics||!1,generateId:u.generateId||!1},superclusterOptions:{maxZoom:this._getClusterMaxZoom(u.clusterMaxZoom),minPoints:Math.max(2,u.clusterMinPoints||2),extent:y.$,radius:this._pixelsToTileUnits(u.clusterRadius||50),log:!1,generateId:u.generateId||!1},clusterProperties:u.clusterProperties,filter:u.filter},u.workerOptions),"string"==typeof this.promoteId&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(o){return o*(y.$/this.tileSize)}_getClusterMaxZoom(o){const u=o?Math.round(o):this.maxzoom-1;return Number.isInteger(o)||void 0===o||y.w(`Integer expected for option 'clusterMaxZoom': provided value "${o}" rounded to "${u}"`),u}load(){return y._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(o){this.map=o,this.load()}setData(o){return this._data=o,this._pendingWorkerUpdate={data:o},this._updateWorkerData(),this}updateData(o){return this._pendingWorkerUpdate.diff=y.a0(this._pendingWorkerUpdate.diff,o),this._updateWorkerData(),this}getData(){return y._(this,void 0,void 0,function*(){const o=y.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:o})})}getCoordinatesFromGeometry(o){return"GeometryCollection"===o.type?o.geometries.map(u=>u.coordinates).flat(1/0):o.coordinates.flat(1/0)}getBounds(){return y._(this,void 0,void 0,function*(){const o=new Jn,u=yield this.getData();let f;switch(u.type){case"FeatureCollection":f=u.features.map(_=>this.getCoordinatesFromGeometry(_.geometry)).flat(1/0);break;case"Feature":f=this.getCoordinatesFromGeometry(u.geometry);break;default:f=this.getCoordinatesFromGeometry(u)}if(0==f.length)return o;for(let _=0;_<f.length-1;_+=2)o.extend([f[_],f[_+1]]);return o})}setClusterOptions(o){return this.workerOptions.cluster=o.cluster,o&&(void 0!==o.clusterRadius&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(o.clusterRadius)),void 0!==o.clusterMaxZoom&&(this.workerOptions.superclusterOptions.maxZoom=this._getClusterMaxZoom(o.clusterMaxZoom))),this._updateWorkerData(),this}getClusterExpansionZoom(o){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:o,source:this.id}})}getClusterChildren(o){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:o,source:this.id}})}getClusterLeaves(o,u,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:o,limit:u,offset:f}})}_updateWorkerData(){return y._(this,void 0,void 0,function*(){if(this._isUpdatingWorker)return;const{data:o,diff:u}=this._pendingWorkerUpdate;if(!o&&!u)return void y.w(`No data or diff provided to GeoJSONSource ${this.id}.`);const f=y.e({type:this.type},this.workerOptions);o?("string"==typeof o?(f.request=this.map._requestManager.transformRequest(mt.resolveURL(o),"Source"),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(o),this._pendingWorkerUpdate.data=void 0):u&&(f.dataDiff=u,this._pendingWorkerUpdate.diff=void 0),this._isUpdatingWorker=!0,this.fire(new y.l("dataloading",{dataType:"source"}));try{const _=yield this.actor.sendAsync({type:"LD",data:f});if(this._isUpdatingWorker=!1,this._removed||_.abandoned)return void this.fire(new y.l("dataabort",{dataType:"source"}));this._data=_.data;let x=null;_.resourceTiming&&_.resourceTiming[this.id]&&(x=_.resourceTiming[this.id].slice(0));const S={dataType:"source"};this._collectResourceTiming&&x&&x.length>0&&y.e(S,{resourceTiming:x}),this.fire(new y.l("data",Object.assign(Object.assign({},S),{sourceDataType:"metadata"}))),this.fire(new y.l("data",Object.assign(Object.assign({},S),{sourceDataType:"content"})))}catch(_){if(this._isUpdatingWorker=!1,this._removed)return void this.fire(new y.l("dataabort",{dataType:"source"}));this.fire(new y.k(_))}finally{(this._pendingWorkerUpdate.data||this._pendingWorkerUpdate.diff)&&this._updateWorkerData()}})}loaded(){return!this._isUpdatingWorker&&void 0===this._pendingWorkerUpdate.data&&void 0===this._pendingWorkerUpdate.diff}loadTile(o){return y._(this,void 0,void 0,function*(){const u=o.actor?"RT":"LT";o.actor=this.actor;const f={type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity,globalState:this.map.getGlobalState()};o.abortController=new AbortController;const _=yield this.actor.sendAsync({type:u,data:f},o.abortController);delete o.abortController,o.unloadVectorData(),o.aborted||o.loadVectorData(_,this.map.painter,"RT"===u)})}abortTile(o){return y._(this,void 0,void 0,function*(){o.abortController&&(o.abortController.abort(),delete o.abortController),o.aborted=!0})}unloadTile(o){return y._(this,void 0,void 0,function*(){o.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:o.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return y.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class Lr extends y.E{constructor(o,u,f,_){super(),this.flippedWindingOrder=!1,this.id=o,this.dispatcher=f,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(_),this.options=u}load(o){return y._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new y.l("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const u=yield Mn.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,u&&u.data&&(this.image=u.data,o&&(this.coordinates=o),this._finishLoading())}catch(u){this._request=null,this._loaded=!0,this.fire(new y.k(u))}})}loaded(){return this._loaded}updateImage(o){return o.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=o.url,this.load(o.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new y.l("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(o){this.coordinates=o;const u=o.map(y.a1.fromLngLat);var f;return this.tileID=function(_){const x=y.a2.fromPoints(_),S=x.width(),I=x.height(),D=Math.max(S,I),N=Math.max(0,Math.floor(-Math.log(D)/Math.LN2)),F=Math.pow(2,N);return new y.a4(N,Math.floor((x.minX+x.maxX)/2*F),Math.floor((x.minY+x.maxY)/2*F))}(u),this.terrainTileRanges=this._getOverlappingTileRanges(u),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=u.map(_=>this.tileID.getTilePoint(_)._round()),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new y.l("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const o=this.map.painter.context,u=o.gl;this.texture||(this.texture=new y.T(o,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const _ in this.tiles){const x=this.tiles[_];"loaded"!==x.state&&(x.state="loaded",x.texture=this.texture,f=!0)}f&&this.fire(new y.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(o){return y._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={}):o.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}_getOverlappingTileRanges(o){const{minX:u,minY:f,maxX:_,maxY:x}=y.a2.fromPoints(o),S={};for(let I=0;I<=y.a3;I++){const D=Math.pow(2,I),N=Math.floor(u*D),F=Math.floor(f*D),U=Math.floor(_*D),V=Math.floor(x*D);S[I]={minTileX:N,minTileY:F,maxTileX:U,maxTileY:V}}return S}}class ao extends Lr{constructor(o,u,f,_){super(o,u,f,_),this.roundZoom=!0,this.type="video",this.options=u}load(){return y._(this,void 0,void 0,function*(){this._loaded=!1;const o=this.options;this.urls=[];for(const u of o.urls)this.urls.push(this.map._requestManager.transformRequest(u,"Source").url);try{const u=yield y.a5(this.urls);if(this._loaded=!0,!u)return;this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(u){this.fire(new y.k(u))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(o){if(this.video){const u=this.video.seekable;o<u.start(0)||o>u.end(0)?this.fire(new y.k(new y.a6(`sources.${this.id}`,null,`Playback for this video can be set only between the ${u.start(0)} and ${u.end(0)}-second mark.`))):this.video.currentTime=o}}getVideo(){return this.video}onAdd(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const o=this.map.painter.context,u=o.gl;this.texture?this.video.paused||(this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE),u.texSubImage2D(u.TEXTURE_2D,0,0,0,u.RGBA,u.UNSIGNED_BYTE,this.video)):(this.texture=new y.T(o,this.video,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));let f=!1;for(const _ in this.tiles){const x=this.tiles[_];"loaded"!==x.state&&(x.state="loaded",x.texture=this.texture,f=!0)}f&&this.fire(new y.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Ds extends Lr{constructor(o,u,f,_){super(o,u,f,_),u.coordinates?Array.isArray(u.coordinates)&&4===u.coordinates.length&&!u.coordinates.some(x=>!Array.isArray(x)||2!==x.length||x.some(S=>"number"!=typeof S))||this.fire(new y.k(new y.a6(`sources.${o}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new y.k(new y.a6(`sources.${o}`,null,'missing required property "coordinates"'))),u.animate&&"boolean"!=typeof u.animate&&this.fire(new y.k(new y.a6(`sources.${o}`,null,'optional "animate" property must be a boolean value'))),u.canvas?"string"==typeof u.canvas||u.canvas instanceof HTMLCanvasElement||this.fire(new y.k(new y.a6(`sources.${o}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new y.k(new y.a6(`sources.${o}`,null,'missing required property "canvas"'))),this.options=u,this.animate=void 0===u.animate||u.animate}load(){return y._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new y.k(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const u=this.map.painter.context,f=u.gl;this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new y.T(u,this.canvas,f.RGBA,{premultiply:!0});let _=!1;for(const x in this.tiles){const S=this.tiles[x];"loaded"!==S.state&&(S.state="loaded",S.texture=this.texture,_=!0)}_&&this.fire(new y.l("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const o of[this.canvas.width,this.canvas.height])if(isNaN(o)||o<=0)return!0;return!1}}const Pi={},ki=b=>{switch(b){case"geojson":return bn;case"image":return Lr;case"raster":return At;case"raster-dem":return Vt;case"vector":return gt;case"video":return ao;case"canvas":return Ds}return Pi[b]},ci="RTLPluginLoaded";class qn extends y.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=ai()}_syncState(o){return this.status=o,this.dispatcher.broadcast("SRPS",{pluginStatus:o,pluginURL:this.url}).catch(u=>{throw this.status="error",u})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(o){return y._(this,arguments,void 0,function*(u,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=mt.resolveURL(u),!this.url)throw new Error(`requested url ${u} is invalid`);if("unavailable"===this.status){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if("requested"===this.status)return this._requestImport()})}_requestImport(){return y._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new y.l(ci))})}lazyLoad(){"unavailable"===this.status?this.status="requested":"deferred"===this.status&&this._requestImport()}}let Ri=null;function Go(){return Ri||(Ri=new qn),Ri}class Ao{constructor(o,u){this.timeAdded=0,this.fadeEndTime=0,this.tileID=o,this.uid=y.a7(),this.uses=0,this.tileSize=u,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(o){const u=o+this.timeAdded;u<this.fadeEndTime||(this.fadeEndTime=u)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}clearTextures(o){this.demTexture&&o.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(o,u,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=function(_,x){const S={};if(!x)return S;for(const I of _){const D=I.layerIds.map(N=>x.getLayer(N)).filter(Boolean);if(0!==D.length){I.layers=D,I.stateDependentLayerIds&&(I.stateDependentLayers=I.stateDependentLayerIds.map(N=>D.filter(F=>F.id===N)[0]));for(const N of D)S[N.id]=I}}return S}(o.buckets,u?.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const x=this.buckets[_];if(x instanceof y.a9){if(this.hasSymbolBuckets=!0,!f)break;x.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const x=this.buckets[_];if(x instanceof y.a9&&x.hasRTLText){this.hasRTLText=!0,Go().lazyLoad();break}}this.queryPadding=0;for(const _ in this.buckets){const x=this.buckets[_];this.queryPadding=Math.max(this.queryPadding,u.style.getLayer(_).queryRadius(x))}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage)}else this.collisionBoxArray=new y.a8}unloadVectorData(){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(o){return this.buckets[o.id]}upload(o){for(const f in this.buckets){const _=this.buckets[f];_.uploadPending()&&_.upload(o)}const u=o.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new y.T(o,this.imageAtlas.image,u.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new y.T(o,this.glyphAtlasImage,u.ALPHA),this.glyphAtlasImage=null)}prepare(o){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture)}queryRenderedFeatures(o,u,f,_,x,S,I,D,N,F,U){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:_,cameraQueryGeometry:x,scale:S,tileSize:this.tileSize,pixelPosMatrix:F,transform:D,params:I,queryPadding:this.queryPadding*N,getElevation:U},o,u,f):{}}querySourceFeatures(o,u){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const _=f.loadVTLayers(),x=u&&u.sourceLayer?u.sourceLayer:"",S=_._geojsonTileLayer||_[x];if(!S)return;const I=y.aa(u&&u.filter),{z:D,x:N,y:F}=this.tileID.canonical,U={z:D,x:N,y:F};for(let V=0;V<S.length;V++){const H=S.feature(V);if(I.needGeometry){const re=y.ab(H,!0);if(!I.filter(new y.F(this.tileID.overscaledZ),re,this.tileID.canonical))continue}else if(!I.filter(new y.F(this.tileID.overscaledZ),H))continue;const Y=f.getId(H,x),oe=new y.ac(H,D,N,F,Y);oe.tile=U,o.push(oe)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(o){const u=this.expirationTime;if(o.cacheControl){const f=y.ad(o.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const f=Date.now();let _=!1;if(this.expirationTime>f)_=!1;else if(u)if(this.expirationTime<u)_=!0;else{const x=this.expirationTime-u;x?this.expirationTime=f+Math.max(x,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(o,u){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(o).length)return;const f=this.latestFeatureIndex.loadVTLayers();for(const _ in this.buckets){if(!u.style.hasLayer(_))continue;const x=this.buckets[_],S=x.layers[0].sourceLayer||"_geojsonTileLayer",I=f[S],D=o[S];if(!I||!D||0===Object.keys(D).length)continue;x.update(D,I,this.imageAtlas&&this.imageAtlas.patternPositions||{});const N=u&&u.style&&u.style.getLayer(_);N&&(this.queryPadding=Math.max(this.queryPadding,N.queryRadius(x)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<mt.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=mt.now()+o}setDependencies(o,u){const f={};for(const _ of u)f[_]=!0;this.dependencies[o]=f}hasDependency(o,u){for(const f of o){const _=this.dependencies[f];if(_)for(const x of u)if(_[x])return!0}return!1}}class xe{constructor(o,u){this.max=o,this.onRemove=u,this.reset()}reset(){for(const o in this.data)for(const u of this.data[o])u.timeout&&clearTimeout(u.timeout),this.onRemove(u.value);return this.data={},this.order=[],this}add(o,u,f){const _=o.wrapped().key;void 0===this.data[_]&&(this.data[_]=[]);const x={value:u,timeout:void 0};if(void 0!==f&&(x.timeout=setTimeout(()=>{this.remove(o,x)},f)),this.data[_].push(x),this.order.push(_),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const u=this.data[o].shift();return u.timeout&&clearTimeout(u.timeout),0===this.data[o].length&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),u.value}getByKey(o){const u=this.data[o];return u?u[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,u){if(!this.has(o))return this;const f=o.wrapped().key,_=void 0===u?0:this.data[f].indexOf(u),x=this.data[f][_];return this.data[f].splice(_,1),x.timeout&&clearTimeout(x.timeout),0===this.data[f].length&&delete this.data[f],this.onRemove(x.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this}filter(o){const u=[];for(const f in this.data)for(const _ of this.data[f])o(_.value)||u.push(_);for(const f of u)this.remove(f.value.tileID,f)}}class K{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,u,f){const _=String(u);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][_]=this.stateChanges[o][_]||{},y.e(this.stateChanges[o][_],f),null===this.deletedStates[o]){this.deletedStates[o]={};for(const x in this.state[o])x!==_&&(this.deletedStates[o][x]=null)}else if(this.deletedStates[o]&&null===this.deletedStates[o][_]){this.deletedStates[o][_]={};for(const x in this.state[o][_])f[x]||(this.deletedStates[o][_][x]=null)}else for(const x in f)this.deletedStates[o]&&this.deletedStates[o][_]&&null===this.deletedStates[o][_][x]&&delete this.deletedStates[o][_][x]}removeFeatureState(o,u,f){if(null===this.deletedStates[o])return;const _=String(u);if(this.deletedStates[o]=this.deletedStates[o]||{},f&&void 0!==u)null!==this.deletedStates[o][_]&&(this.deletedStates[o][_]=this.deletedStates[o][_]||{},this.deletedStates[o][_][f]=null);else if(void 0!==u)if(this.stateChanges[o]&&this.stateChanges[o][_])for(f in this.deletedStates[o][_]={},this.stateChanges[o][_])this.deletedStates[o][_][f]=null;else this.deletedStates[o][_]=null;else this.deletedStates[o]=null}getState(o,u){const f=String(u),_=y.e({},(this.state[o]||{})[f],(this.stateChanges[o]||{})[f]);if(null===this.deletedStates[o])return{};if(this.deletedStates[o]){const x=this.deletedStates[o][u];if(null===x)return{};for(const S in x)delete _[S]}return _}initializeTileState(o,u){o.setFeatureState(this.state,u)}coalesceChanges(o,u){const f={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const x={};for(const S in this.stateChanges[_])this.state[_][S]||(this.state[_][S]={}),y.e(this.state[_][S],this.stateChanges[_][S]),x[S]=this.state[_][S];f[_]=x}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const x={};if(null===this.deletedStates[_])for(const S in this.state[_])x[S]={},this.state[_][S]={};else for(const S in this.deletedStates[_]){if(null===this.deletedStates[_][S])this.state[_][S]={};else for(const I of Object.keys(this.deletedStates[_][S]))delete this.state[_][S][I];x[S]=this.state[_][S]}f[_]=f[_]||{},y.e(f[_],x)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(f).length)for(const _ in o)o[_].setFeatureState(f,u)}}const ee=89.25;function te(b,o){const u=y.ah(o.lat,-y.ai,y.ai);return new y.P(y.V(o.lng)*b,y.U(u)*b)}function de(b,o){return new y.a1(o.x/b,o.y/b).toLngLat()}function be(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(y.ae(90-b.pitch)),Math.tan(y.ae(ee-b.pitch)))}function we(b,o){const u=b.canonical,f=o/y.af(u.z),_=u.x+Math.pow(2,u.z)*b.wrap,x=y.ag(new Float64Array(16));return y.M(x,x,[_*f,u.y*f,0]),y.N(x,x,[f/y.$,f/y.$,1]),x}function Ne(b,o,u,f,_){const x=y.a1.fromLngLat(b,o),S=_*y.aj(1,b.lat),I=S*Math.cos(y.ae(u)),D=Math.sqrt(S*S-I*I),N=D*Math.sin(y.ae(-f)),F=D*Math.cos(y.ae(-f));return new y.a1(x.x+N,x.y+F,x.z+I)}function Ee(b,o,u){const f=o.intersectsFrustum(b);if(!u||0===f)return f;const _=o.intersectsPlane(u);return 0===_?0:2===f&&2===_?2:1}function Ve(b,o,u){let f=0;const _=(u-o)/10;for(let x=0;x<10;x++)f+=_*Math.pow(Math.cos(o+(x+.5)/10*(u-o)),b);return f}function Ue(b,o){return function(u,f,_,x,S){const I=2*((b-1)/y.ak(Math.cos(y.ae(ee-S))/Math.cos(y.ae(ee)))-1),D=Math.acos(_/x),N=2*Ve(I-1,0,y.ae(S/2)),F=Math.min(y.ae(ee),D+y.ae(S/2)),U=Ve(I-1,Math.min(F,D-y.ae(S/2)),F),V=Math.atan(f/_),H=Math.hypot(f,_);let Y=u;return Y+=y.ak(x/H/Math.max(.5,Math.cos(y.ae(S/2)))),Y+=I*y.ak(Math.cos(V))/2,Y-=y.ak(Math.max(1,U/N/o))/2,Y}}const We=Ue(9.314,3);function bt(b,o){const u=(o.roundZoom?Math.round:Math.floor)(b.zoom+y.ak(b.tileSize/o.tileSize));return Math.max(0,u)}function Me(b,o){const u=b.getCameraFrustum(),f=b.getClippingPlane(),_=b.screenPointToMercatorCoordinate(b.getCameraPoint()),x=y.a1.fromLngLat(b.center,b.elevation);_.z=x.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const S=b.getCoveringTilesDetailsProvider(),I=S.allowVariableZoom(b,o),D=bt(b,o),N=o.minzoom||0,F=void 0!==o.maxzoom?o.maxzoom:b.maxZoom,U=Math.min(Math.max(0,D),F),V=Math.pow(2,U),H=[V*_.x,V*_.y,0],Y=[V*x.x,V*x.y,0],oe=Math.hypot(x.x-_.x,x.y-_.y),re=Math.abs(x.z-_.z),ie=Math.hypot(oe,re),ue=me=>({zoom:0,x:0,y:0,wrap:me,fullyVisible:!1}),pe=[],he=[];if(b.renderWorldCopies&&S.allowWorldCopies())for(let me=1;me<=3;me++)pe.push(ue(-me)),pe.push(ue(me));for(pe.push(ue(0));pe.length>0;){const me=pe.pop(),ve=me.x,fe=me.y;let Te=me.fullyVisible;const Be={x:ve,y:fe,z:me.zoom},ke=S.getTileBoundingVolume(Be,me.wrap,b.elevation,o);if(!Te){const tt=Ee(u,ke,f);if(0===tt)continue;Te=2===tt}const Oe=S.distanceToTile2d(_.x,_.y,Be,ke);let Fe=D;I&&(Fe=(o.calculateTileZoom||We)(b.zoom+y.ak(b.tileSize/o.tileSize),Oe,re,ie,b.fov)),Fe=(o.roundZoom?Math.round:Math.floor)(Fe),Fe=Math.max(0,Fe);const Je=Math.min(Fe,F);if(me.wrap=S.getWrap(x,Be,me.wrap),me.zoom>=Je){if(me.zoom<N)continue;const tt=U-me.zoom,qe=H[0]-.5-(ve<<tt),Mt=H[1]-.5-(fe<<tt),nn=o.reparseOverscaled?Math.max(me.zoom,Fe):me.zoom;he.push({tileID:new y.Z(me.zoom===F?nn:me.zoom,me.wrap,me.zoom,ve,fe),distanceSq:y.al([Y[0]-.5-ve,Y[1]-.5-fe]),tileDistanceToCamera:Math.sqrt(qe*qe+Mt*Mt)})}else for(let tt=0;tt<4;tt++)pe.push({zoom:me.zoom+1,x:(ve<<1)+tt%2,y:(fe<<1)+(tt>>1),wrap:me.wrap,fullyVisible:Te})}return he.sort((me,ve)=>me.distanceSq-ve.distanceSq).map(me=>me.tileID)}const Ft=y.a2.fromPoints([new y.P(0,0),new y.P(y.$,y.$)]);class Jt extends y.E{constructor(o,u,f){super(),this.id=o,this.dispatcher=f,this.on("data",_=>this._dataHandler(_)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((_,x,S,I)=>{const D=new(ki(x.type))(_,x,S,I);if(D.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${D.id}`);return D})(o,u,f,this),this._tiles={},this._cache=new xe(0,_=>this._unloadTile(_)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new K,this._didEmitContent=!1,this._updated=!1}onAdd(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._maxTileCacheZoomLevels=o?o._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(o)}onRemove(o){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(o)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(void 0===this.used&&void 0===this.usedForTerrain||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const o in this._tiles){const u=this._tiles[o];if("loaded"!==u.state&&"errored"!==u.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(o,u,f){return y._(this,void 0,void 0,function*(){try{yield this._source.loadTile(o),this._tileLoaded(o,u,f)}catch(_){o.state="errored",404!==_.status?this._source.fire(new y.k(_,{tile:o})):this.update(this.transform,this.terrain)}})}_unloadTile(o){this._source.unloadTile&&this._source.unloadTile(o)}_abortTile(o){this._source.abortTile&&this._source.abortTile(o),this._source.fire(new y.l("dataabort",{tile:o,coord:o.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const u in this._tiles){const f=this._tiles[u];f.upload(o),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(Et).map(o=>o.key)}getRenderableIds(o){const u=[];for(const f in this._tiles)this._isIdRenderable(f,o)&&u.push(this._tiles[f]);return o?u.sort((f,_)=>{const x=f.tileID,S=_.tileID,I=new y.P(x.canonical.x,x.canonical.y)._rotate(-this.transform.bearingInRadians),D=new y.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return x.overscaledZ-S.overscaledZ||D.y-I.y||D.x-I.x}).map(f=>f.tileID.key):u.map(f=>f.tileID).sort(Et).map(f=>f.key)}hasRenderableParent(o){const u=this.findLoadedParent(o,0);return!!u&&this._isIdRenderable(u.tileID.key)}_isIdRenderable(o,u){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(u||!this._tiles[o].holdingForFade())}reload(o){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const u in this._tiles)o?this._reloadTile(u,"expired"):"errored"!==this._tiles[u].state&&this._reloadTile(u,"reloading")}}_reloadTile(o,u){return y._(this,void 0,void 0,function*(){const f=this._tiles[o];f&&("loading"!==f.state&&(f.state=u),yield this._loadTile(f,o,u))})}_tileLoaded(o,u,f){o.timeAdded=mt.now(),"expired"===f&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(u,o),"raster-dem"===this.getSource().type&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),o.aborted||this._source.fire(new y.l("data",{dataType:"source",tile:o,coord:o.tileID}))}_backfillDEM(o){const u=this.getRenderableIds();for(let _=0;_<u.length;_++){const x=u[_];if(o.neighboringTiles&&o.neighboringTiles[x]){const S=this.getTileByID(x);f(o,S),f(S,o)}}function f(_,x){_.needsHillshadePrepare=!0,_.needsTerrainPrepare=!0;let S=x.tileID.canonical.x-_.tileID.canonical.x;const I=x.tileID.canonical.y-_.tileID.canonical.y,D=Math.pow(2,_.tileID.canonical.z),N=x.tileID.key;0===S&&0===I||Math.abs(I)>1||(Math.abs(S)>1&&(1===Math.abs(S+D)?S+=D:1===Math.abs(S-D)&&(S-=D)),x.dem&&_.dem&&(_.dem.backfillBorder(x.dem,S,I),_.neighboringTiles&&_.neighboringTiles[N]&&(_.neighboringTiles[N].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,u,f,_){for(const x in this._tiles){let S=this._tiles[x];if(_[x]||!S.hasData()||S.tileID.overscaledZ<=u||S.tileID.overscaledZ>f)continue;let I=S.tileID;for(;S&&S.tileID.overscaledZ>u+1;){const N=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[N.key],S&&S.hasData()&&(I=N)}let D=I;for(;D.overscaledZ>u;)if(D=D.scaledTo(D.overscaledZ-1),o[D.key]||o[D.canonical.key]){_[I.key]=I;break}}}findLoadedParent(o,u){if(o.key in this._loadedParentTiles){const f=this._loadedParentTiles[o.key];return f&&f.tileID.overscaledZ>=u?f:null}for(let f=o.overscaledZ-1;f>=u;f--){const _=o.scaledTo(f),x=this._getLoadedTile(_);if(x)return x}}findLoadedSibling(o){return this._getLoadedTile(o)}_getLoadedTile(o){const u=this._tiles[o.key];return u&&u.hasData()?u:this._cache.getByKey(o.wrapped().key)}updateCacheSize(o){const u=Math.ceil(o.width/this._source.tileSize)+1,f=Math.ceil(o.height/this._source.tileSize)+1,_=Math.floor(u*f*(null===this._maxTileCacheZoomLevels?y.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),x="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(x)}handleWrapJump(o){const u=Math.round((o-(void 0===this._prevLng?o:this._prevLng))/360);if(this._prevLng=o,u){const f={};for(const _ in this._tiles){const x=this._tiles[_];x.tileID=x.tileID.unwrapTo(x.tileID.wrap+u),f[x.tileID.key]=x}this._tiles=f;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(_,this._tiles[_])}}_updateCoveredAndRetainedTiles(o,u,f,_,x,S){const I={},D={},N=Object.keys(o),F=mt.now();for(const U of N){const V=o[U],H=this._tiles[U];if(!H||0!==H.fadeEndTime&&H.fadeEndTime<=F)continue;const Y=this.findLoadedParent(V,u),oe=this.findLoadedSibling(V),re=Y||oe||null;re&&(this._addTile(re.tileID),I[re.tileID.key]=re.tileID),D[U]=V}this._retainLoadedChildren(D,_,f,o);for(const U in I)o[U]||(this._coveredTiles[U]=!0,o[U]=I[U]);if(S){const U={},V={};for(const H of x)this._tiles[H.key].hasData()?U[H.key]=H:V[H.key]=H;for(const H in V){const Y=V[H].children(this._source.maxzoom);this._tiles[Y[0].key]&&this._tiles[Y[1].key]&&this._tiles[Y[2].key]&&this._tiles[Y[3].key]&&(U[Y[0].key]=o[Y[0].key]=Y[0],U[Y[1].key]=o[Y[1].key]=Y[1],U[Y[2].key]=o[Y[2].key]=Y[2],U[Y[3].key]=o[Y[3].key]=Y[3],delete V[H])}for(const H in V){const Y=V[H],oe=this.findLoadedParent(Y,this._source.minzoom),re=this.findLoadedSibling(Y),ie=oe||re||null;if(ie){U[ie.tileID.key]=o[ie.tileID.key]=ie.tileID;for(const ue in U)U[ue].isChildOf(ie.tileID)&&delete U[ue]}}for(const H in this._tiles)U[H]||(this._coveredTiles[H]=!0)}}update(o,u){if(!this._sourceLoaded||this._paused)return;let f;this.transform=o,this.terrain=u,this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(F=>new y.Z(F.canonical.z,F.wrap,F.canonical.z,F.canonical.x,F.canonical.y)):(f=Me(o,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:u,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter(F=>this._source.hasTile(F)))):f=[];const _=bt(o,this._source),x=Math.max(_-Jt.maxOverzooming,this._source.minzoom),S=Math.max(_+Jt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const F={};for(const U of f)if(U.canonical.z>this._source.minzoom){const V=U.scaledTo(U.canonical.z-1);F[V.key]=V;const H=U.scaledTo(Math.max(this._source.minzoom,Math.min(U.canonical.z,5)));F[H.key]=H}f=f.concat(Object.values(F))}const I=0===f.length&&!this._updated&&this._didEmitContent;this._updated=!0,I&&this.fire(new y.l("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const D=this._updateRetainedTiles(f,_);Zt(this._source.type)&&this._updateCoveredAndRetainedTiles(D,x,S,_,f,u);for(const F in D)this._tiles[F].clearFadeHold();const N=y.am(this._tiles,D);for(const F of N){const U=this._tiles[F];U.hasSymbolBuckets&&!U.holdingForFade()?U.setHoldDuration(this.map._fadeDuration):U.hasSymbolBuckets&&!U.symbolFadeFinished()||this._removeTile(F)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)}_updateRetainedTiles(o,u){var f;const _={},x={},S=Math.max(u-Jt.maxOverzooming,this._source.minzoom),I=Math.max(u+Jt.maxUnderzooming,this._source.minzoom),D={};for(const N of o){const F=this._addTile(N);_[N.key]=N,F.hasData()||u<this._source.maxzoom&&(D[N.key]=N)}this._retainLoadedChildren(D,u,I,_);for(const N of o){let F=this._tiles[N.key];if(F.hasData())continue;if(u+1>this._source.maxzoom){const V=N.children(this._source.maxzoom)[0],H=this.getTile(V);if(H&&H.hasData()){_[V.key]=V;continue}}else{const V=N.children(this._source.maxzoom);if(_[V[0].key]&&_[V[1].key]&&_[V[2].key]&&_[V[3].key])continue}let U=F.wasRequested();for(let V=N.overscaledZ-1;V>=S;--V){const H=N.scaledTo(V);if(x[H.key])break;if(x[H.key]=!0,F=this.getTile(H),!F&&U&&(F=this._addTile(H)),F){const Y=F.hasData();if((Y||!(null!==(f=this.map)&&void 0!==f&&f.cancelPendingTileRequestsWhileZooming)||U)&&(_[H.key]=H),U=F.wasRequested(),Y)break}}}return _}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const u=[];let f,_=this._tiles[o].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){f=this._loadedParentTiles[_.key];break}u.push(_.key);const x=_.scaledTo(_.overscaledZ-1);if(f=this._getLoadedTile(x),f)break;_=x}for(const x of u)this._loadedParentTiles[x]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const o in this._tiles){const u=this._tiles[o].tileID,f=this._getLoadedTile(u);this._loadedSiblingTiles[u.key]=f}}_addTile(o){let u=this._tiles[o.key];if(u)return u;u=this._cache.getAndRemove(o),u&&(this._setTileReloadTimer(o.key,u),u.tileID=o,this._state.initializeTileState(u,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,u)));const f=u;return u||(u=new Ao(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(u,o.key,u.state)),u.uses++,this._tiles[o.key]=u,f||this._source.fire(new y.l("dataloading",{tile:u,coord:u.tileID,dataType:"source"})),u}_setTileReloadTimer(o,u){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const f=u.getExpiryTimeout();f&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},f))}refreshTiles(o){for(const u in this._tiles)(this._isIdRenderable(u)||"errored"==this._tiles[u].state)&&o.some(f=>f.equals(this._tiles[u].tileID.canonical))&&this._reloadTile(u,"expired")}_removeTile(o){const u=this._tiles[o];u&&(u.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),u.uses>0||(u.hasData()&&"reloading"!==u.state?this._cache.add(u.tileID,u,u.getExpiryTimeout()):(u.aborted=!0,this._abortTile(u),this._unloadTile(u))))}_dataHandler(o){const u=o.sourceDataType;"source"===o.dataType&&"metadata"===u&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===o.dataType&&"content"===u&&(this.reload(o.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(o);this._cache.reset()}tilesIn(o,u,f){const _=[],x=this.transform;if(!x)return _;const S=x.getCoveringTilesDetailsProvider().allowWorldCopies(),I=f?x.getCameraQueryGeometry(o):o,D=H=>x.screenPointToMercatorCoordinate(H,this.terrain),N=this.transformBbox(o,D,!S),F=this.transformBbox(I,D,!S),U=this.getIds(),V=y.a2.fromPoints(F);for(let H=0;H<U.length;H++){const Y=this._tiles[U[H]];if(Y.holdingForFade())continue;const oe=S?[Y.tileID]:[Y.tileID.unwrapTo(-1),Y.tileID.unwrapTo(0)],re=Math.pow(2,x.zoom-Y.tileID.overscaledZ),ie=u*Y.queryPadding*y.$/Y.tileSize/re;for(const ue of oe){const pe=V.map(he=>ue.getTilePoint(new y.a1(he.x,he.y)));if(pe.expandBy(ie),pe.intersects(Ft)){const he=N.map(ve=>ue.getTilePoint(ve)),me=F.map(ve=>ue.getTilePoint(ve));_.push({tile:Y,tileID:S?ue:ue.unwrapTo(0),queryGeometry:he,cameraQueryGeometry:me,scale:re})}}}return _}transformBbox(o,u,f){let _=o.map(u);if(f){const x=y.a2.fromPoints(o);x.shrinkBy(.001*Math.min(x.width(),x.height()));const S=x.map(u);y.a2.fromPoints(_).covers(S)||(_=_.map(I=>I.x>.5?new y.a1(I.x-1,I.y,I.z):I))}return _}getVisibleCoordinates(o){const u=this.getRenderableIds(o).map(f=>this._tiles[f].tileID);return this.transform&&this.transform.populateCache(u),u}hasTransition(){if(this._source.hasTransition())return!0;if(Zt(this._source.type)){const o=mt.now();for(const u in this._tiles)if(this._tiles[u].fadeEndTime>=o)return!0}return!1}setFeatureState(o,u,f){this._state.updateState(o=o||"_geojsonTileLayer",u,f)}removeFeatureState(o,u,f){this._state.removeFeatureState(o=o||"_geojsonTileLayer",u,f)}getFeatureState(o,u){return this._state.getState(o=o||"_geojsonTileLayer",u)}setDependencies(o,u,f){const _=this._tiles[o];_&&_.setDependencies(u,f)}reloadTilesForDependencies(o,u){for(const f in this._tiles)this._tiles[f].hasDependency(o,u)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(o,u))}}function Et(b,o){const u=Math.abs(2*b.wrap)-+(b.wrap<0),f=Math.abs(2*o.wrap)-+(o.wrap<0);return b.overscaledZ-o.overscaledZ||f-u||o.canonical.y-b.canonical.y||o.canonical.x-b.canonical.x}function Zt(b){return"raster"===b||"image"===b||"video"===b}Jt.maxOverzooming=10,Jt.maxUnderzooming=3;class kn{constructor(o,u){this.reset(o,u)}reset(o,u){this.points=o||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(1===this.points.length)return this.points[0];o=y.ah(o,0,1);let u=1,f=this._distances[u];const _=o*this.paddedLength+this.padding;for(;f<_&&u<this._distances.length;)f=this._distances[++u];const x=u-1,S=this._distances[x],I=f-S,D=I>0?(_-S)/I:0;return this.points[x].mult(1-D).add(this.points[u].mult(D))}}function Zn(b,o){let u=!0;return"always"===b||"never"!==b&&"never"!==o||(u=!1),u}class Gn{constructor(o,u,f){const _=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(o/f),this.yCellCount=Math.ceil(u/f);for(let S=0;S<this.xCellCount*this.yCellCount;S++)_.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=u,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,u,f,_,x){this._forEachCell(u,f,_,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(u),this.bboxes.push(f),this.bboxes.push(_),this.bboxes.push(x)}insertCircle(o,u,f,_){this._forEachCell(u-_,f-_,u+_,f+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(u),this.circles.push(f),this.circles.push(_)}_insertBoxCell(o,u,f,_,x,S){this.boxCells[x].push(S)}_insertCircleCell(o,u,f,_,x,S){this.circleCells[x].push(S)}_query(o,u,f,_,x,S,I){if(f<0||o>this.width||_<0||u>this.height)return[];const D=[];if(o<=0&&u<=0&&this.width<=f&&this.height<=_){if(x)return[{key:null,x1:o,y1:u,x2:f,y2:_}];for(let N=0;N<this.boxKeys.length;N++)D.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const F=this.circles[3*N],U=this.circles[3*N+1],V=this.circles[3*N+2];D.push({key:this.circleKeys[N],x1:F-V,y1:U-V,x2:F+V,y2:U+V})}}else this._forEachCell(o,u,f,_,this._queryCell,D,{hitTest:x,overlapMode:S,seenUids:{box:{},circle:{}}},I);return D}query(o,u,f,_){return this._query(o,u,f,_,!1,null)}hitTest(o,u,f,_,x,S){return this._query(o,u,f,_,!0,x,S).length>0}hitTestCircle(o,u,f,_,x){const S=o-f,I=o+f,D=u-f,N=u+f;if(I<0||S>this.width||N<0||D>this.height)return!1;const F=[];return this._forEachCell(S,D,I,N,this._queryCellCircle,F,{hitTest:!0,overlapMode:_,circle:{x:o,y:u,radius:f},seenUids:{box:{},circle:{}}},x),F.length>0}_queryCell(o,u,f,_,x,S,I,D){const{seenUids:N,hitTest:F,overlapMode:U}=I,V=this.boxCells[x];if(null!==V){const Y=this.bboxes;for(const oe of V)if(!N.box[oe]){N.box[oe]=!0;const re=4*oe,ie=this.boxKeys[oe];if(o<=Y[re+2]&&u<=Y[re+3]&&f>=Y[re+0]&&_>=Y[re+1]&&(!D||D(ie))&&(!F||!Zn(U,ie.overlapMode))&&(S.push({key:ie,x1:Y[re],y1:Y[re+1],x2:Y[re+2],y2:Y[re+3]}),F))return!0}}const H=this.circleCells[x];if(null!==H){const Y=this.circles;for(const oe of H)if(!N.circle[oe]){N.circle[oe]=!0;const re=3*oe,ie=this.circleKeys[oe];if(this._circleAndRectCollide(Y[re],Y[re+1],Y[re+2],o,u,f,_)&&(!D||D(ie))&&(!F||!Zn(U,ie.overlapMode))){const ue=Y[re],pe=Y[re+1],he=Y[re+2];if(S.push({key:ie,x1:ue-he,y1:pe-he,x2:ue+he,y2:pe+he}),F)return!0}}}return!1}_queryCellCircle(o,u,f,_,x,S,I,D){const{circle:N,seenUids:F,overlapMode:U}=I,V=this.boxCells[x];if(null!==V){const Y=this.bboxes;for(const oe of V)if(!F.box[oe]){F.box[oe]=!0;const re=4*oe,ie=this.boxKeys[oe];if(this._circleAndRectCollide(N.x,N.y,N.radius,Y[re+0],Y[re+1],Y[re+2],Y[re+3])&&(!D||D(ie))&&!Zn(U,ie.overlapMode))return S.push(!0),!0}}const H=this.circleCells[x];if(null!==H){const Y=this.circles;for(const oe of H)if(!F.circle[oe]){F.circle[oe]=!0;const re=3*oe,ie=this.circleKeys[oe];if(this._circlesCollide(Y[re],Y[re+1],Y[re+2],N.x,N.y,N.radius)&&(!D||D(ie))&&!Zn(U,ie.overlapMode))return S.push(!0),!0}}}_forEachCell(o,u,f,_,x,S,I,D){const N=this._convertToXCellCoord(o),F=this._convertToYCellCoord(u),U=this._convertToXCellCoord(f),V=this._convertToYCellCoord(_);for(let H=N;H<=U;H++)for(let Y=F;Y<=V;Y++)if(x.call(this,o,u,f,_,this.xCellCount*Y+H,S,I,D))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,u,f,_,x,S){const I=_-o,D=x-u,N=f+S;return N*N>I*I+D*D}_circleAndRectCollide(o,u,f,_,x,S,I){const D=(S-_)/2,N=Math.abs(o-(_+D));if(N>D+f)return!1;const F=(I-x)/2,U=Math.abs(u-(x+F));if(U>F+f)return!1;if(N<=D||U<=F)return!0;const V=N-D,H=U-F;return V*V+H*H<=f*f}}function sr(b,o,u){const f=y.L();if(!b){const{vecSouth:U,vecEast:V}=un(o),H=En();H[0]=V[0],H[1]=V[1],H[2]=U[0],H[3]=U[1],_=H,(F=(S=(x=H)[0])*(N=x[3])-(D=x[2])*(I=x[1]))&&(_[0]=N*(F=1/F),_[1]=-I*F,_[2]=-D*F,_[3]=S*F),f[0]=H[0],f[1]=H[1],f[4]=H[2],f[5]=H[3]}var _,x,S,I,D,N,F;return y.N(f,f,[1/u,1/u,1]),f}function rn(b,o,u,f){if(b){const _=y.L();if(!o){const{vecSouth:x,vecEast:S}=un(u);_[0]=S[0],_[1]=S[1],_[4]=x[0],_[5]=x[1]}return y.N(_,_,[f,f,1]),_}return u.pixelsToClipSpaceMatrix}function un(b){const o=Math.cos(b.rollInRadians),u=Math.sin(b.rollInRadians),f=Math.cos(b.pitchInRadians),_=Math.cos(b.bearingInRadians),x=Math.sin(b.bearingInRadians),S=y.ar();S[0]=-_*f*u-x*o,S[1]=-x*f*u+_*o;const I=y.as(S);I<1e-9?y.at(S):y.au(S,S,1/I);const D=y.ar();D[0]=_*f*o-x*u,D[1]=x*f*o+_*u;const N=y.as(D);return N<1e-9?y.at(D):y.au(D,D,1/N),{vecEast:D,vecSouth:S}}function yr(b,o,u,f){let _;f?(_=[b,o,f(b,o),1],y.aw(_,_,u)):(_=[b,o,0,1],Aa(_,_,u));const x=_[3];return{point:new y.P(_[0]/x,_[1]/x),signedDistanceFromCamera:x,isOccluded:!1}}function Ke(b,o){return.5+b/o*.5}function Qr(b,o){return b.x>=-o[0]&&b.x<=o[0]&&b.y>=-o[1]&&b.y<=o[1]}function ur(b,o,u,f,_,x,S,I,D,N,F,U,V){const H=u?b.textSizeData:b.iconSizeData,Y=y.an(H,o.transform.zoom),oe=[256/o.width*2+1,256/o.height*2+1],re=u?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;re.clear();const ie=b.lineVertexArray,ue=u?b.text.placedSymbolArray:b.icon.placedSymbolArray,pe=o.transform.width/o.transform.height;let he=!1;for(let me=0;me<ue.length;me++){const ve=ue.get(me);if(ve.hidden||ve.writingMode===y.ao.vertical&&!he){di(ve.numGlyphs,re);continue}he=!1;const fe=new y.P(ve.anchorX,ve.anchorY),Te={getElevation:V,pitchedLabelPlaneMatrix:f,lineVertexArray:ie,pitchWithMap:x,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:o.transform,tileAnchorPoint:fe,unwrappedTileID:D,width:N,height:F,translation:U},Be=As(ve.anchorX,ve.anchorY,Te);if(!Qr(Be.point,oe)){di(ve.numGlyphs,re);continue}const ke=Ke(o.transform.cameraToCenterDistance,Be.signedDistanceFromCamera),Oe=y.ap(H,Y,ve),Fe=x?Oe*o.transform.getPitchedTextCorrection(ve.anchorX,ve.anchorY,D)/ke:Oe*ke,Je=at({projectionContext:Te,pitchedLabelPlaneMatrixInverse:_,symbol:ve,fontSize:Fe,flip:!1,keepUpright:S,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:re,aspectRatio:pe,rotateToLine:I});he=Je.useVertical,(Je.notEnoughRoom||he||Je.needsFlipping&&at({projectionContext:Te,pitchedLabelPlaneMatrixInverse:_,symbol:ve,fontSize:Fe,flip:!0,keepUpright:S,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:re,aspectRatio:pe,rotateToLine:I}).notEnoughRoom)&&di(ve.numGlyphs,re)}u?b.text.dynamicLayoutVertexBuffer.updateData(re):b.icon.dynamicLayoutVertexBuffer.updateData(re)}function ia(b,o,u,f,_,x,S,I){const D=x.glyphStartIndex+x.numGlyphs,N=x.lineStartIndex,F=x.lineStartIndex+x.lineLength,U=o.getoffsetX(x.glyphStartIndex),V=o.getoffsetX(D-1),H=Fr(b*U,u,f,_,x.segment,N,F,I,S);if(!H)return null;const Y=Fr(b*V,u,f,_,x.segment,N,F,I,S);return Y?I.projectionCache.anyProjectionOccluded?null:{first:H,last:Y}:null}function sa(b,o,u,f){return b===y.ao.horizontal&&Math.abs(u.y-o.y)>Math.abs(u.x-o.x)*f?{useVertical:!0}:(b===y.ao.vertical?o.y<u.y:o.x>u.x)?{needsFlipping:!0}:null}function at(b){const{projectionContext:o,pitchedLabelPlaneMatrixInverse:u,symbol:f,fontSize:_,flip:x,keepUpright:S,glyphOffsetArray:I,dynamicLayoutVertexArray:D,aspectRatio:N,rotateToLine:F}=b,U=_/24,V=f.lineOffsetX*U,H=f.lineOffsetY*U;let Y;if(f.numGlyphs>1){const oe=f.glyphStartIndex+f.numGlyphs,re=f.lineStartIndex,ie=f.lineStartIndex+f.lineLength,ue=ia(U,I,V,H,x,f,F,o);if(!ue)return{notEnoughRoom:!0};const pe=ui(ue.first.point.x,ue.first.point.y,o,u),he=ui(ue.last.point.x,ue.last.point.y,o,u);if(S&&!x){const me=sa(f.writingMode,pe,he,N);if(me)return me}Y=[ue.first];for(let me=f.glyphStartIndex+1;me<oe-1;me++){const ve=Fr(U*I.getoffsetX(me),V,H,x,f.segment,re,ie,o,F);if(!ve)return{notEnoughRoom:!0};Y.push(ve)}Y.push(ue.last)}else{if(S&&!x){const re=Er(o.tileAnchorPoint.x,o.tileAnchorPoint.y,o).point,ie=f.lineStartIndex+f.segment+1,ue=new y.P(o.lineVertexArray.getx(ie),o.lineVertexArray.gety(ie)),pe=Er(ue.x,ue.y,o),he=pe.signedDistanceFromCamera>0?pe.point:Yt(o.tileAnchorPoint,ue,re,1,o),me=ui(re.x,re.y,o,u),ve=ui(he.x,he.y,o,u),fe=sa(f.writingMode,me,ve,N);if(fe)return fe}const oe=Fr(U*I.getoffsetX(f.glyphStartIndex),V,H,x,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,o,F);if(!oe||o.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};Y=[oe]}for(const oe of Y)y.av(D,oe.point,oe.angle);return{}}function Yt(b,o,u,f,_){const x=b.add(b.sub(o)._unit()),S=Er(x.x,x.y,_).point,I=u.sub(S);return u.add(I._mult(f/I.mag()))}function Kt(b,o,u){const f=o.projectionCache;if(f.projections[b])return f.projections[b];const _=new y.P(o.lineVertexArray.getx(b),o.lineVertexArray.gety(b)),x=Er(_.x,_.y,o);if(x.signedDistanceFromCamera>0)return f.projections[b]=x.point,f.anyProjectionOccluded=f.anyProjectionOccluded||x.isOccluded,x.point;const S=b-u.direction;return Yt(0===u.distanceFromAnchor?o.tileAnchorPoint:new y.P(o.lineVertexArray.getx(S),o.lineVertexArray.gety(S)),_,u.previousVertex,u.absOffsetX-u.distanceFromAnchor+1,o)}function Er(b,o,u){const f=b+u.translation[0],_=o+u.translation[1];let x;return u.pitchWithMap?(x=yr(f,_,u.pitchedLabelPlaneMatrix,u.getElevation),x.isOccluded=!1):(x=u.transform.projectTileCoordinates(f,_,u.unwrappedTileID,u.getElevation),x.point.x=(.5*x.point.x+.5)*u.width,x.point.y=(.5*-x.point.y+.5)*u.height),x}function ui(b,o,u,f){if(u.pitchWithMap){const _=[b,o,0,1];return y.aw(_,_,f),u.transform.projectTileCoordinates(_[0]/_[3],_[1]/_[3],u.unwrappedTileID,u.getElevation).point}return{x:b/u.width*2-1,y:1-o/u.height*2}}function As(b,o,u){return u.transform.projectTileCoordinates(b,o,u.unwrappedTileID,u.getElevation)}function jt(b,o,u){return b._unit()._perp()._mult(o*u)}function aa(b,o,u,f,_,x,S,I,D){if(I.projectionCache.offsets[b])return I.projectionCache.offsets[b];const N=u.add(o);if(b+D.direction<f||b+D.direction>=_)return I.projectionCache.offsets[b]=N,N;const F=Kt(b+D.direction,I,D),U=jt(F.sub(u),S,D.direction),V=u.add(U),H=F.add(U);return I.projectionCache.offsets[b]=y.ax(x,N,V,H)||N,I.projectionCache.offsets[b]}function Fr(b,o,u,f,_,x,S,I,D){const N=f?b-o:b+o;let F=N>0?1:-1,U=0;f&&(F*=-1,U=Math.PI),F<0&&(U+=Math.PI);let V,H=F>0?x+_:x+_+1;I.projectionCache.cachedAnchorPoint?V=I.projectionCache.cachedAnchorPoint:(V=Er(I.tileAnchorPoint.x,I.tileAnchorPoint.y,I).point,I.projectionCache.cachedAnchorPoint=V);let Y,oe,re=V,ie=V,ue=0,pe=0;const he=Math.abs(N),me=[];let ve;for(;ue+pe<=he;){if(H+=F,H<x||H>=S)return null;ue+=pe,ie=re,oe=Y;const Be={absOffsetX:he,direction:F,distanceFromAnchor:ue,previousVertex:ie};if(re=Kt(H,I,Be),0===u)me.push(ie),ve=re.sub(ie);else{let ke;const Oe=re.sub(ie);ke=0===Oe.mag()?jt(Kt(H+F,I,Be).sub(re),u,F):jt(Oe,u,F),oe||(oe=ie.add(ke)),Y=aa(H,ke,re,x,S,oe,u,I,Be),me.push(oe),ve=Y.sub(oe)}pe=ve.mag()}const fe=ve._mult((he-ue)/pe)._add(oe||ie),Te=U+Math.atan2(re.y-ie.y,re.x-ie.x);return me.push(fe),{point:fe,angle:D?Te:0,path:me}}const cc=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function di(b,o){for(let u=0;u<b;u++){const f=o.length;o.resize(f+4),o.float32.set(cc,3*f)}}function Aa(b,o,u){const f=o[0],_=o[1];return b[0]=u[0]*f+u[4]*_+u[12],b[1]=u[1]*f+u[5]*_+u[13],b[3]=u[3]*f+u[7]*_+u[15],b}const Rn=100;class bo{constructor(o,u=new Gn(o.width+200,o.height+200,25),f=new Gn(o.width+200,o.height+200,25)){this.transform=o,this.grid=u,this.ignoredGrid=f,this.pitchFactor=Math.cos(o.pitch*Math.PI/180)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Rn,this.screenBottomBoundary=o.height+Rn,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(o,u,f,_,x,S,I,D,N,F,U,V){const H=this.projectAndGetPerspectiveRatio(o.anchorPointX+D[0],o.anchorPointY+D[1],x,F,V),Y=f*H.perspectiveRatio;let oe;if(S||I)oe=this._projectCollisionBox(o,Y,_,x,S,I,D,H,F,U,V);else{const ve=H.x+(U?U.x*Y:0),fe=H.y+(U?U.y*Y:0);oe={allPointsOccluded:!1,box:[ve+o.x1*Y,fe+o.y1*Y,ve+o.x2*Y,fe+o.y2*Y]}}const[re,ie,ue,pe]=oe.box,he=S?oe.allPointsOccluded:H.isOccluded;let me=he;return me||(me=H.perspectiveRatio<this.perspectiveRatioCutoff),me||(me=!this.isInsideGrid(re,ie,ue,pe)),me||"always"!==u&&this.grid.hitTest(re,ie,ue,pe,u,N)?{box:[re,ie,ue,pe],placeable:!1,offscreen:!1,occluded:he}:{box:[re,ie,ue,pe],placeable:!0,offscreen:this.isOffscreen(re,ie,ue,pe),occluded:he}}placeCollisionCircles(o,u,f,_,x,S,I,D,N,F,U,V,H,Y){const oe=[],re=new y.P(u.anchorX,u.anchorY),ie=this.getPerspectiveRatio(re.x,re.y,S,Y),ue=(N?x*this.transform.getPitchedTextCorrection(u.anchorX,u.anchorY,S)/ie:x*ie)/y.aB,pe={getElevation:Y,pitchedLabelPlaneMatrix:I,lineVertexArray:f,pitchWithMap:N,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:re,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:H},he=ia(ue,_,u.lineOffsetX*ue,u.lineOffsetY*ue,!1,u,!1,pe);let me=!1,ve=!1,fe=!0;if(he){const Te=.5*U*ie+V,Be=new y.P(-100,-100),ke=new y.P(this.screenRightBoundary,this.screenBottomBoundary),Oe=new kn,Fe=he.first,Je=he.last;let tt=[];for(let nn=Fe.path.length-1;nn>=1;nn--)tt.push(Fe.path[nn]);for(let nn=1;nn<Je.path.length;nn++)tt.push(Je.path[nn]);const qe=2.5*Te;if(N){const nn=this.projectPathToScreenSpace(tt,pe);tt=nn.some(Sn=>Sn.signedDistanceFromCamera<=0)?[]:nn.map(Sn=>Sn.point)}let Mt=[];if(tt.length>0){const nn=tt[0].clone(),Sn=tt[0].clone();for(let $n=1;$n<tt.length;$n++)nn.x=Math.min(nn.x,tt[$n].x),nn.y=Math.min(nn.y,tt[$n].y),Sn.x=Math.max(Sn.x,tt[$n].x),Sn.y=Math.max(Sn.y,tt[$n].y);Mt=nn.x>=Be.x&&Sn.x<=ke.x&&nn.y>=Be.y&&Sn.y<=ke.y?[tt]:Sn.x<Be.x||nn.x>ke.x||Sn.y<Be.y||nn.y>ke.y?[]:y.ay([tt],Be.x,Be.y,ke.x,ke.y)}for(const nn of Mt){Oe.reset(nn,.25*Te);let Sn=0;Sn=Oe.length<=.5*Te?1:Math.ceil(Oe.paddedLength/qe)+1;for(let $n=0;$n<Sn;$n++){const Bn=$n/Math.max(Sn-1,1),br=Oe.lerp(Bn),Dr=br.x+Rn,tn=br.y+Rn;oe.push(Dr,tn,Te,0);const zn=Dr-Te,xr=tn-Te,Ar=Dr+Te,no=tn+Te;if(fe=fe&&this.isOffscreen(zn,xr,Ar,no),ve=ve||this.isInsideGrid(zn,xr,Ar,no),"always"!==o&&this.grid.hitTestCircle(Dr,tn,Te,o,F)&&(me=!0,!D))return{circles:[],offscreen:!1,collisionDetected:me}}}}return{circles:!D&&me||!ve||ie<this.perspectiveRatioCutoff?[]:oe,offscreen:fe,collisionDetected:me}}projectPathToScreenSpace(o,u){return function(_){let x=0,S=0,I=0,D=0;for(let N=0;N<_.length;N++)_[N].isOccluded?(I=N+1,D=0):(D++,D>S&&(S=D,x=I));return _.slice(x,x+S)}(function(_,x){const S=y.L();return y.aq(S,x.pitchedLabelPlaneMatrix),_.map(I=>{const D=yr(I.x,I.y,S,x.getElevation),N=x.transform.projectTileCoordinates(D.point.x,D.point.y,x.unwrappedTileID,x.getElevation);return N.point.x=(.5*N.point.x+.5)*x.width,N.point.y=(.5*-N.point.y+.5)*x.height,N})}(o,u))}queryRenderedSymbols(o){if(0===o.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const u=[],f=new y.a2;for(const U of o){const V=new y.P(U.x+Rn,U.y+Rn);f.extend(V),u.push(V)}const{minX:_,minY:x,maxX:S,maxY:I}=f,D=this.grid.query(_,x,S,I).concat(this.ignoredGrid.query(_,x,S,I)),N={},F={};for(const U of D){const V=U.key;if(void 0===N[V.bucketInstanceId]&&(N[V.bucketInstanceId]={}),N[V.bucketInstanceId][V.featureIndex])continue;const H=[new y.P(U.x1,U.y1),new y.P(U.x2,U.y1),new y.P(U.x2,U.y2),new y.P(U.x1,U.y2)];y.az(u,H)&&(N[V.bucketInstanceId][V.featureIndex]=!0,void 0===F[V.bucketInstanceId]&&(F[V.bucketInstanceId]=[]),F[V.bucketInstanceId].push(V.featureIndex))}return F}insertCollisionBox(o,u,f,_,x,S){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:x,collisionGroupID:S,overlapMode:u},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,u,f,_,x,S){const I=f?this.ignoredGrid:this.grid,D={bucketInstanceId:_,featureIndex:x,collisionGroupID:S,overlapMode:u};for(let N=0;N<o.length;N+=4)I.insertCircle(D,o[N],o[N+1],o[N+2])}projectAndGetPerspectiveRatio(o,u,f,_,x){if(x){let S;_?(S=[o,u,_(o,u),1],y.aw(S,S,x)):(S=[o,u,0,1],Aa(S,S,x));const I=S[3];return{x:(S[0]/I+1)/2*this.transform.width+Rn,y:(-S[1]/I+1)/2*this.transform.height+Rn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/I*.5,isOccluded:!1,signedDistanceFromCamera:I}}{const S=this.transform.projectTileCoordinates(o,u,f,_);return{x:(S.point.x+1)/2*this.transform.width+Rn,y:(1-S.point.y)/2*this.transform.height+Rn,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(o,u,f,_){const x=this.transform.projectTileCoordinates(o,u,f,_);return.5+this.transform.cameraToCenterDistance/x.signedDistanceFromCamera*.5}isOffscreen(o,u,f,_){return f<Rn||o>=this.screenRightBoundary||_<Rn||u>this.screenBottomBoundary}isInsideGrid(o,u,f,_){return f>=0&&o<this.gridRightBoundary&&_>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const o=y.ag([]);return y.M(o,o,[-100,-100,0]),o}_projectCollisionBox(o,u,f,_,x,S,I,D,N,F,U){let V=1,H=0,Y=0,oe=1;const re=o.anchorPointX+I[0],ie=o.anchorPointY+I[1];if(S&&!x){const tt=this.projectAndGetPerspectiveRatio(re+1,ie,_,N,U),qe=tt.x-D.x,Mt=Math.atan((tt.y-D.y)/qe)+(qe<0?Math.PI:0),nn=Math.sin(Mt),Sn=Math.cos(Mt);V=Sn,H=nn,Y=-nn,oe=Sn}else if(!S&&x){const tt=un(this.transform);V=tt.vecEast[0],H=tt.vecEast[1],Y=tt.vecSouth[0],oe=tt.vecSouth[1]}let ue=D.x,pe=D.y,he=u;x&&(ue=re,pe=ie,he=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),he*=this.transform.getPitchedTextCorrection(re,ie,_),F||(he*=y.ah(.5+D.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),F&&(ue+=V*F.x*he+Y*F.y*he,pe+=H*F.x*he+oe*F.y*he);const me=o.x1*he,ve=o.x2*he,fe=(me+ve)/2,Te=o.y1*he,Be=o.y2*he,ke=(Te+Be)/2,Oe=[{offsetX:me,offsetY:Te},{offsetX:fe,offsetY:Te},{offsetX:ve,offsetY:Te},{offsetX:ve,offsetY:ke},{offsetX:ve,offsetY:Be},{offsetX:fe,offsetY:Be},{offsetX:me,offsetY:Be},{offsetX:me,offsetY:ke}];let Fe=[];for(const{offsetX:tt,offsetY:qe}of Oe)Fe.push(new y.P(ue+V*tt+Y*qe,pe+H*tt+oe*qe));let Je=!1;if(x){const tt=Fe.map(qe=>this.projectAndGetPerspectiveRatio(qe.x,qe.y,_,N,U));Je=tt.some(qe=>!qe.isOccluded),Fe=tt.map(qe=>new y.P(qe.x,qe.y))}else Je=!0;return{box:y.aA(Fe),allPointsOccluded:!Je}}}class Po{constructor(o,u,f,_){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?u:-u))):_&&f?1:0,this.placed=f}isHidden(){return 0===this.opacity&&!this.placed}}class In{constructor(o,u,f,_,x){this.text=new Po(o?o.text:null,u,f,x),this.icon=new Po(o?o.icon:null,u,_,x)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Oi{constructor(o,u,f){this.text=o,this.icon=u,this.skipFade=f}}class Pa{constructor(o,u,f,_,x){this.bucketInstanceId=o,this.featureIndex=u,this.sourceLayerIndex=f,this.bucketIndex=_,this.tileID=x}}class xo{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const u=++this.maxGroupID;this.collisionGroups[o]={ID:u,predicate:f=>f.collisionGroupID===u}}return this.collisionGroups[o]}}function ko(b,o,u,f,_){const{horizontalAlign:x,verticalAlign:S}=y.aH(b);return new y.P(-(x-.5)*o+f[0]*_,-(S-.5)*u+f[1]*_)}class Ps{constructor(o,u,f,_,x){this.transform=o.clone(),this.terrain=u,this.collisionIndex=new bo(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new xo(_),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(o){const u=this.terrain;return u?(f,_)=>u.getElevation(o,f,_):null}getBucketParts(o,u,f,_){const x=f.getBucket(u),S=f.latestFeatureIndex;if(!x||!S||u.id!==x.layerIds[0])return;const I=f.collisionBoxArray,D=x.layers[0].layout,N=x.layers[0].paint,F=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),U=f.tileSize/y.$,V=f.tileID.toUnwrapped(),H="map"===D.get("text-rotation-alignment"),Y=y.aC(f,1,this.transform.zoom),oe=y.aD(this.collisionIndex.transform,f,N.get("text-translate"),N.get("text-translate-anchor")),re=y.aD(this.collisionIndex.transform,f,N.get("icon-translate"),N.get("icon-translate-anchor")),ie=sr(H,this.transform,Y);this.retainedQueryData[x.bucketInstanceId]=new Pa(x.bucketInstanceId,S,x.sourceLayerIndex,x.index,f.tileID);const ue={bucket:x,layout:D,translationText:oe,translationIcon:re,unwrappedTileID:V,pitchedLabelPlaneMatrix:ie,scale:F,textPixelRatio:U,holdingForFade:f.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:y.an(x.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(_)for(const pe of x.sortKeyRanges){const{sortKey:he,symbolInstanceStart:me,symbolInstanceEnd:ve}=pe;o.push({sortKey:he,symbolInstanceStart:me,symbolInstanceEnd:ve,parameters:ue})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:ue})}attemptAnchorPlacement(o,u,f,_,x,S,I,D,N,F,U,V,H,Y,oe,re,ie,ue,pe,he){const me=y.aE[o.textAnchor],ve=[o.textOffset0,o.textOffset1],fe=ko(me,f,_,ve,x),Te=this.collisionIndex.placeCollisionBox(u,V,D,N,F,I,S,re,U.predicate,pe,fe,he);if((!ue||this.collisionIndex.placeCollisionBox(ue,V,D,N,F,I,S,ie,U.predicate,pe,fe,he).placeable)&&Te.placeable){let Be;if(this.prevPlacement&&this.prevPlacement.variableOffsets[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID]&&this.prevPlacement.placements[H.crossTileID].text&&(Be=this.prevPlacement.variableOffsets[H.crossTileID].anchor),0===H.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[H.crossTileID]={textOffset:ve,width:f,height:_,anchor:me,textBoxScale:x,prevAnchor:Be},this.markUsedJustification(Y,me,H,oe),Y.allowVerticalPlacement&&(this.markUsedOrientation(Y,oe,H),this.placedOrientations[H.crossTileID]=oe),{shift:fe,placedGlyphBoxes:Te}}}placeLayerBucketPart(o,u,f){const{bucket:_,layout:x,translationText:S,translationIcon:I,unwrappedTileID:D,pitchedLabelPlaneMatrix:N,textPixelRatio:F,holdingForFade:U,collisionBoxArray:V,partiallyEvaluatedTextSize:H,collisionGroup:Y}=o.parameters,oe=x.get("text-optional"),re=x.get("icon-optional"),ie=y.aF(x,"text-overlap","text-allow-overlap"),ue="always"===ie,pe=y.aF(x,"icon-overlap","icon-allow-overlap"),he="always"===pe,me="map"===x.get("text-rotation-alignment"),ve="map"===x.get("text-pitch-alignment"),fe="none"!==x.get("icon-text-fit"),Te="viewport-y"===x.get("symbol-z-order"),Be=ue&&(he||!_.hasIconData()||re),ke=he&&(ue||!_.hasTextData()||oe);!_.collisionArrays&&V&&_.deserializeCollisionBoxes(V);const Oe=this.retainedQueryData[_.bucketInstanceId].tileID,Fe=this._getTerrainElevationFunc(Oe),Je=this.transform.getFastPathSimpleProjectionMatrix(Oe),tt=(qe,Mt,nn)=>{var Sn,$n;if(u[qe.crossTileID])return;if(U)return void(this.placements[qe.crossTileID]=new Oi(!1,!1,!1));let Bn=!1,br=!1,Dr=!0,tn=null,zn={box:null,placeable:!1,offscreen:null,occluded:!1},xr={placeable:!1},Ar=null,no=null,Lo=null,Hi=0,Qa=0,Ja=0;Mt.textFeatureIndex?Hi=Mt.textFeatureIndex:qe.useRuntimeCollisionCircles&&(Hi=qe.featureIndex),Mt.verticalTextFeatureIndex&&(Qa=Mt.verticalTextFeatureIndex);const Vl=Mt.textBox;if(Vl){const Si=Br=>{let Wr=y.ao.horizontal;if(_.allowVerticalPlacement&&!Br&&this.prevPlacement){const gs=this.prevPlacement.placedOrientations[qe.crossTileID];gs&&(this.placedOrientations[qe.crossTileID]=gs,Wr=gs,this.markUsedOrientation(_,Wr,qe))}return Wr},ps=(Br,Wr)=>{if(_.allowVerticalPlacement&&qe.numVerticalGlyphVertices>0&&Mt.verticalTextBox){for(const gs of _.writingModes)if(gs===y.ao.vertical?(zn=Wr(),xr=zn):zn=Br(),zn&&zn.placeable)break}else zn=Br()},oi=qe.textAnchorOffsetStartIndex,Ul=qe.textAnchorOffsetEndIndex;if(Ul===oi){const Br=(Wr,gs)=>{const qr=this.collisionIndex.placeCollisionBox(Wr,ie,F,Oe,D,ve,me,S,Y.predicate,Fe,void 0,Je);return qr&&qr.placeable&&(this.markUsedOrientation(_,gs,qe),this.placedOrientations[qe.crossTileID]=gs),qr};ps(()=>Br(Vl,y.ao.horizontal),()=>{const Wr=Mt.verticalTextBox;return _.allowVerticalPlacement&&qe.numVerticalGlyphVertices>0&&Wr?Br(Wr,y.ao.vertical):{box:null,offscreen:null}}),Si(zn&&zn.placeable)}else{let Br=y.aE[null===($n=null===(Sn=this.prevPlacement)||void 0===Sn?void 0:Sn.variableOffsets[qe.crossTileID])||void 0===$n?void 0:$n.anchor];const Wr=(qr,jc,Vc)=>{const ms=qr.x2-qr.x1,_s=qr.y2-qr.y1,tl=qe.textBoxScale,Wi=fe&&"never"===pe?jc:null;let Ei=null,Hh="never"===ie?1:2,Wh="never";Br&&Hh++;for(let Rd=0;Rd<Hh;Rd++){for(let Od=oi;Od<Ul;Od++){const nl=_.textAnchorOffsets.get(Od);if(Br&&nl.textAnchor!==Br)continue;const Ws=this.attemptAnchorPlacement(nl,qr,ms,_s,tl,me,ve,F,Oe,D,Y,Wh,qe,_,Vc,S,I,Wi,Fe);if(Ws&&(Ei=Ws.placedGlyphBoxes,Ei&&Ei.placeable))return Bn=!0,tn=Ws.shift,Ei}Br?Br=null:Wh=ie}return f&&!Ei&&(Ei={box:this.collisionIndex.placeCollisionBox(Vl,"always",F,Oe,D,ve,me,S,Y.predicate,Fe,void 0,Je).box,offscreen:!1,placeable:!1,occluded:!1}),Ei};ps(()=>Wr(Vl,Mt.iconBox,y.ao.horizontal),()=>{const qr=Mt.verticalTextBox;return _.allowVerticalPlacement&&(!zn||!zn.placeable)&&qe.numVerticalGlyphVertices>0&&qr?Wr(qr,Mt.verticalIconBox,y.ao.vertical):{box:null,occluded:!0,offscreen:null}}),zn&&(Bn=zn.placeable,Dr=zn.offscreen);const gs=Si(zn&&zn.placeable);if(!Bn&&this.prevPlacement){const qr=this.prevPlacement.variableOffsets[qe.crossTileID];qr&&(this.variableOffsets[qe.crossTileID]=qr,this.markUsedJustification(_,qr.anchor,qe,gs))}}}if(Ar=zn,Bn=Ar&&Ar.placeable,Dr=Ar&&Ar.offscreen,qe.useRuntimeCollisionCircles){const Si=_.text.placedSymbolArray.get(qe.centerJustifiedTextSymbolIndex),ps=y.ap(_.textSizeData,H,Si),oi=x.get("text-padding");no=this.collisionIndex.placeCollisionCircles(ie,Si,_.lineVertexArray,_.glyphOffsetArray,ps,D,N,f,ve,Y.predicate,qe.collisionCircleDiameter,oi,S,Fe),no.circles.length&&no.collisionDetected&&!f&&y.w("Collisions detected, but collision boxes are not shown"),Bn=ue||no.circles.length>0&&!no.collisionDetected,Dr=Dr&&no.offscreen}if(Mt.iconFeatureIndex&&(Ja=Mt.iconFeatureIndex),Mt.iconBox){const Si=ps=>this.collisionIndex.placeCollisionBox(ps,pe,F,Oe,D,ve,me,I,Y.predicate,Fe,fe&&tn?tn:void 0,Je);xr&&xr.placeable&&Mt.verticalIconBox?(Lo=Si(Mt.verticalIconBox),br=Lo.placeable):(Lo=Si(Mt.iconBox),br=Lo.placeable),Dr=Dr&&Lo.offscreen}const fs=oe||0===qe.numHorizontalGlyphVertices&&0===qe.numVerticalGlyphVertices,Fo=re||0===qe.numIconVertices;fs||Fo?Fo?fs||(br=br&&Bn):Bn=br&&Bn:br=Bn=br&&Bn;const el=br&&Lo.placeable;if(Bn&&Ar.placeable&&this.collisionIndex.insertCollisionBox(Ar.box,ie,x.get("text-ignore-placement"),_.bucketInstanceId,xr&&xr.placeable&&Qa?Qa:Hi,Y.ID),el&&this.collisionIndex.insertCollisionBox(Lo.box,pe,x.get("icon-ignore-placement"),_.bucketInstanceId,Ja,Y.ID),no&&Bn&&this.collisionIndex.insertCollisionCircles(no.circles,ie,x.get("text-ignore-placement"),_.bucketInstanceId,Hi,Y.ID),f&&this.storeCollisionData(_.bucketInstanceId,nn,Mt,Ar,Lo,no),0===qe.crossTileID)throw new Error("symbolInstance.crossTileID can't be 0");if(0===_.bucketInstanceId)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[qe.crossTileID]=new Oi((Bn||Be)&&!Ar?.occluded,(br||ke)&&!Lo?.occluded,Dr||_.justReloaded),u[qe.crossTileID]=!0};if(Te){if(0!==o.symbolInstanceStart)throw new Error("bucket.bucketInstanceId should be 0");const qe=_.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let Mt=qe.length-1;Mt>=0;--Mt){const nn=qe[Mt];tt(_.symbolInstances.get(nn),_.collisionArrays[nn],nn)}}else for(let qe=o.symbolInstanceStart;qe<o.symbolInstanceEnd;qe++)tt(_.symbolInstances.get(qe),_.collisionArrays[qe],qe);_.justReloaded=!1}storeCollisionData(o,u,f,_,x,S){if(f.textBox||f.iconBox){let I,D;this.collisionBoxArrays.has(o)?I=this.collisionBoxArrays.get(o):(I=new Map,this.collisionBoxArrays.set(o,I)),I.has(u)?D=I.get(u):(D={text:null,icon:null},I.set(u,D)),f.textBox&&(D.text=_.box),f.iconBox&&(D.icon=x.box)}if(S){let I=this.collisionCircleArrays[o];void 0===I&&(I=this.collisionCircleArrays[o]=[]);for(let D=0;D<S.circles.length;D+=4)I.push(S.circles[D+0]-Rn),I.push(S.circles[D+1]-Rn),I.push(S.circles[D+2]),I.push(S.collisionDetected?1:0)}}markUsedJustification(o,u,f,_){let x;x=_===y.ao.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[y.aG(u)];const S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const I of S)I>=0&&(o.text.placedSymbolArray.get(I).crossTileID=x>=0&&I!==x?0:f.crossTileID)}markUsedOrientation(o,u,f){const _=u===y.ao.horizontal||u===y.ao.horizontalOnly?u:0,x=u===y.ao.vertical?u:0,S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const I of S)o.text.placedSymbolArray.get(I).placedOrientation=_;f.verticalPlacedTextSymbolIndex&&(o.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=x)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let f=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const _=u?u.symbolFadeChange(o):1,x=u?u.opacities:{},S=u?u.variableOffsets:{},I=u?u.placedOrientations:{};for(const D in this.placements){const N=this.placements[D],F=x[D];F?(this.opacities[D]=new In(F,_,N.text,N.icon),f=f||N.text!==F.text.placed||N.icon!==F.icon.placed):(this.opacities[D]=new In(null,_,N.text,N.icon,N.skipFade),f=f||N.text||N.icon)}for(const D in x){const N=x[D];if(!this.opacities[D]){const F=new In(N,_,!1,!1);F.isHidden()||(this.opacities[D]=F,f=f||N.text.placed||N.icon.placed)}}for(const D in S)this.variableOffsets[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.variableOffsets[D]=S[D]);for(const D in I)this.placedOrientations[D]||!this.opacities[D]||this.opacities[D].isHidden()||(this.placedOrientations[D]=I[D]);if(u&&void 0===u.lastPlacementChangeTime)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=o:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:o)}updateLayerOpacities(o,u){const f={};for(const _ of u){const x=_.getBucket(o);x&&_.latestFeatureIndex&&o.id===x.layerIds[0]&&this.updateBucketOpacities(x,_.tileID,f,_.collisionBoxArray)}}updateBucketOpacities(o,u,f,_){o.hasTextData()&&(o.text.opacityVertexArray.clear(),o.text.hasVisibleVertices=!1),o.hasIconData()&&(o.icon.opacityVertexArray.clear(),o.icon.hasVisibleVertices=!1),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const x=o.layers[0],S=x.layout,I=new In(null,0,!1,!1,!0),D=S.get("text-allow-overlap"),N=S.get("icon-allow-overlap"),F=x._unevaluatedLayout.hasValue("text-variable-anchor")||x._unevaluatedLayout.hasValue("text-variable-anchor-offset"),U="map"===S.get("text-rotation-alignment"),V="map"===S.get("text-pitch-alignment"),H="none"!==S.get("icon-text-fit"),Y=new In(null,0,D&&(N||!o.hasIconData()||S.get("icon-optional")),N&&(D||!o.hasTextData()||S.get("text-optional")),!0);!o.collisionArrays&&_&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(_);const oe=(ie,ue,pe)=>{for(let he=0;he<ue/4;he++)ie.opacityVertexArray.emplaceBack(pe);ie.hasVisibleVertices=ie.hasVisibleVertices||pe!==la},re=this.collisionBoxArrays.get(o.bucketInstanceId);for(let ie=0;ie<o.symbolInstances.length;ie++){const ue=o.symbolInstances.get(ie),{numHorizontalGlyphVertices:pe,numVerticalGlyphVertices:he,crossTileID:me}=ue;let ve=this.opacities[me];f[me]?ve=I:ve||(ve=Y,this.opacities[me]=ve),f[me]=!0;const fe=ue.numIconVertices>0,Te=this.placedOrientations[ue.crossTileID],Be=Te===y.ao.vertical,ke=Te===y.ao.horizontal||Te===y.ao.horizontalOnly;if(pe>0||he>0){const Fe=iu(ve.text);oe(o.text,pe,Be?la:Fe),oe(o.text,he,ke?la:Fe);const Je=ve.text.isHidden();[ue.rightJustifiedTextSymbolIndex,ue.centerJustifiedTextSymbolIndex,ue.leftJustifiedTextSymbolIndex].forEach(Mt=>{Mt>=0&&(o.text.placedSymbolArray.get(Mt).hidden=Je||Be?1:0)}),ue.verticalPlacedTextSymbolIndex>=0&&(o.text.placedSymbolArray.get(ue.verticalPlacedTextSymbolIndex).hidden=Je||ke?1:0);const tt=this.variableOffsets[ue.crossTileID];tt&&this.markUsedJustification(o,tt.anchor,ue,Te);const qe=this.placedOrientations[ue.crossTileID];qe&&(this.markUsedJustification(o,"left",ue,qe),this.markUsedOrientation(o,qe,ue))}if(fe){const Fe=iu(ve.icon),Je=!(H&&ue.verticalPlacedIconSymbolIndex&&Be);ue.placedIconSymbolIndex>=0&&(oe(o.icon,ue.numIconVertices,Je?Fe:la),o.icon.placedSymbolArray.get(ue.placedIconSymbolIndex).hidden=ve.icon.isHidden()),ue.verticalPlacedIconSymbolIndex>=0&&(oe(o.icon,ue.numVerticalIconVertices,Je?la:Fe),o.icon.placedSymbolArray.get(ue.verticalPlacedIconSymbolIndex).hidden=ve.icon.isHidden())}const Oe=re&&re.has(ie)?re.get(ie):{text:null,icon:null};if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const Fe=o.collisionArrays[ie];if(Fe){let Je=new y.P(0,0);if(Fe.textBox||Fe.verticalTextBox){let tt=!0;if(F){const qe=this.variableOffsets[me];qe?(Je=ko(qe.anchor,qe.width,qe.height,qe.textOffset,qe.textBoxScale),U&&Je._rotate(V?-this.transform.bearingInRadians:this.transform.bearingInRadians)):tt=!1}if(Fe.textBox||Fe.verticalTextBox){let qe;Fe.textBox&&(qe=Be),Fe.verticalTextBox&&(qe=ke),ka(o.textCollisionBox.collisionVertexArray,ve.text.placed,!tt||qe,Oe.text,Je.x,Je.y)}}if(Fe.iconBox||Fe.verticalIconBox){const tt=!(ke||!Fe.verticalIconBox);let qe;Fe.iconBox&&(qe=tt),Fe.verticalIconBox&&(qe=!tt),ka(o.iconCollisionBox.collisionVertexArray,ve.icon.placed,qe,Oe.icon,H?Je.x:0,H?Je.y:0)}}}}if(o.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.text.opacityVertexArray.length!==o.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${o.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${o.text.layoutVertexArray.length}) / 4`);if(o.icon.opacityVertexArray.length!==o.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${o.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${o.icon.layoutVertexArray.length}) / 4`);o.bucketInstanceId in this.collisionCircleArrays&&(o.collisionCircleArray=this.collisionCircleArrays[o.bucketInstanceId],delete this.collisionCircleArrays[o.bucketInstanceId])}symbolFadeChange(o){return 0===this.fadeDuration?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,u){const f=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*f>o}setStale(){this.stale=!0}}function ka(b,o,u,f,_,x){f&&0!==f.length||(f=[0,0,0,0]);const S=f[0]-Rn,I=f[1]-Rn,D=f[2]-Rn,N=f[3]-Rn;b.emplaceBack(o?1:0,u?1:0,_||0,x||0,S,I),b.emplaceBack(o?1:0,u?1:0,_||0,x||0,D,I),b.emplaceBack(o?1:0,u?1:0,_||0,x||0,D,N),b.emplaceBack(o?1:0,u?1:0,_||0,x||0,S,N)}const nu=Math.pow(2,25),ru=Math.pow(2,24),hi=Math.pow(2,17),sd=Math.pow(2,16),uc=Math.pow(2,9),ou=Math.pow(2,8),pl=Math.pow(2,1);function iu(b){if(0===b.opacity&&!b.placed)return 0;if(1===b.opacity&&b.placed)return 4294967295;const o=b.placed?1:0,u=Math.floor(127*b.opacity);return u*nu+o*ru+u*hi+o*sd+u*uc+o*ou+u*pl+o}const la=0;class dc{constructor(o){this._sortAcrossTiles="viewport-y"!==o.layout.get("symbol-z-order")&&!o.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(o,u,f,_,x){const S=this._bucketParts;for(;this._currentTileIndex<o.length;)if(u.getBucketParts(S,_,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((I,D)=>I.sortKey-D.sortKey));this._currentPartIndex<S.length;)if(u.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,x())return!0;return!1}}class fi{constructor(o,u,f,_,x,S,I,D){this.placement=new Ps(o,u,S,I,D),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(o,u,f){const _=mt.now(),x=()=>!this._forceFullPlacement&&mt.now()-_>2;for(;this._currentPlacementIndex>=0;){const S=u[o[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if("symbol"===S.type&&(!S.minzoom||S.minzoom<=I)&&(!S.maxzoom||S.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new dc(S)),this._inProgressLayer.continuePlacement(f[S.source],this.placement,this._showCollisionBoxes,S,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Jo=512/y.$/2;class er{constructor(o,u,f){this.tileID=o,this.bucketInstanceId=f,this._symbolsByKey={};const _=new Map;for(let x=0;x<u.length;x++){const S=u.get(x),I=S.key,D=_.get(I);D?D.push(S):_.set(I,[S])}for(const[x,S]of _){const I={positions:S.map(D=>({x:Math.floor(D.anchorX*Jo),y:Math.floor(D.anchorY*Jo)})),crossTileIDs:S.map(D=>D.crossTileID)};if(I.positions.length>128){const D=new y.aI(I.positions.length,16,Uint16Array);for(const{x:N,y:F}of I.positions)D.add(N,F);D.finish(),delete I.positions,I.index=D}this._symbolsByKey[x]=I}}getScaledCoordinates(o,u){const{x:f,y:_,z:x}=this.tileID.canonical,{x:S,y:I,z:D}=u.canonical,N=Jo/Math.pow(2,D-x),F=(I*y.$+o.anchorY)*N,U=_*y.$*Jo;return{x:Math.floor((S*y.$+o.anchorX)*N-f*y.$*Jo),y:Math.floor(F-U)}}findMatches(o,u,f){const _=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let x=0;x<o.length;x++){const S=o.get(x);if(S.crossTileID)continue;const I=this._symbolsByKey[S.key];if(!I)continue;const D=this.getScaledCoordinates(S,u);if(I.index){const N=I.index.range(D.x-_,D.y-_,D.x+_,D.y+_).sort();for(const F of N){const U=I.crossTileIDs[F];if(!f[U]){f[U]=!0,S.crossTileID=U;break}}}else if(I.positions)for(let N=0;N<I.positions.length;N++){const F=I.positions[N],U=I.crossTileIDs[N];if(Math.abs(F.x-D.x)<=_&&Math.abs(F.y-D.y)<=_&&!f[U]){f[U]=!0,S.crossTileID=U;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:o})=>o)}}class gl{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class lo{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const u=Math.round((o-this.lng)/360);if(0!==u)for(const f in this.indexes){const _=this.indexes[f],x={};for(const S in _){const I=_[S];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+u),x[I.tileID.key]=I}this.indexes[f]=x}this.lng=o}addBucket(o,u,f){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let x=0;x<u.symbolInstances.length;x++)u.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]={});const _=this.usedCrossTileIDs[o.overscaledZ];for(const x in this.indexes){const S=this.indexes[x];if(Number(x)>o.overscaledZ)for(const I in S){const D=S[I];D.tileID.isChildOf(o)&&D.findMatches(u.symbolInstances,o,_)}else{const I=S[o.scaledTo(Number(x)).key];I&&I.findMatches(u.symbolInstances,o,_)}}for(let x=0;x<u.symbolInstances.length;x++){const S=u.symbolInstances.get(x);S.crossTileID||(S.crossTileID=f.generate(),_[S.crossTileID]=!0)}return void 0===this.indexes[o.overscaledZ]&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new er(o,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(o,u){for(const f of u.getCrossTileIDsLists())for(const _ of f)delete this.usedCrossTileIDs[o][_]}removeStaleBuckets(o){let u=!1;for(const f in this.indexes){const _=this.indexes[f];for(const x in _)o[_[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,_[x]),delete _[x],u=!0)}return u}}class ks{constructor(){this.layerIndexes={},this.crossTileIDs=new gl,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,u,f){let _=this.layerIndexes[o.id];void 0===_&&(_=this.layerIndexes[o.id]=new lo);let x=!1;const S={};_.handleWrapJump(f);for(const I of u){const D=I.getBucket(o);D&&o.id===D.layerIds[0]&&(D.bucketInstanceId||(D.bucketInstanceId=++this.maxBucketInstanceId),_.addBucket(I.tileID,D,this.crossTileIDs)&&(x=!0),S[D.bucketInstanceId]=!0)}return _.removeStaleBuckets(S)&&(x=!0),x}pruneUnusedLayers(o){const u={};o.forEach(f=>{u[f]=!0});for(const f in this.layerIndexes)u[f]||delete this.layerIndexes[f]}}var ts="void main() {fragColor=vec4(1.0);}";const co={prelude:Xt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nout highp vec4 fragColor;","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c\n);}\n#ifdef TERRAIN3D\nuniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;\n#endif\nconst highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {\n#ifdef TERRAIN3D\nhighp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));\n#else\nreturn 1.0;\n#endif\n}float calculate_visibility(vec4 pos) {\n#ifdef TERRAIN3D\nvec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;\n#else\nreturn 1.0;\n#endif\n}float ele(vec2 pos) {\n#ifdef TERRAIN3D\nvec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;\n#else\nreturn 0.0;\n#endif\n}float get_elevation(vec2 pos) {\n#ifdef TERRAIN3D\n#ifdef GLOBE\nif ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}\n#endif\nvec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;\n#else\nreturn 0.0;\n#endif\n}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;"),projectionMercator:Xt("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:Xt("","#define GLOBE_RADIUS 6371008.8\nuniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos\n);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); \nif (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len\n);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}"),background:Xt("uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:Xt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Xt("in vec3 v_data;in float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {\n#ifdef GLOBE\nvec3 center_vector=projectToSphere(circle_center);\n#endif\nfloat angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {\n#ifdef GLOBE\nvec4 projected_center=interpolateProjection(circle_center,center_vector,ele);\n#else\nvec4 projected_center=projectTileWithElevation(circle_center,ele);\n#endif\ncorner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}\n#ifdef GLOBE\nvec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);\n#else\ngl_Position=projectTileWithElevation(corner_position,ele);\n#endif\n} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),clippingMask:Xt(ts,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:Xt("uniform highp float u_intensity;in vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);\n#ifdef GLOBE\nvec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);\n#else\ngl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));\n#endif\n}"),heatmapTexture:Xt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Xt("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Xt("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),colorRelief:Xt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;uniform vec4 u_unpack;uniform sampler2D u_elevation_stops;uniform sampler2D u_color_stops;uniform int u_color_ramp_size;uniform float u_opacity;in vec2 v_pos;float getElevation(vec2 coord) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}float getElevationStop(int stop) {float x=(float(stop)+0.5)/float(u_color_ramp_size);vec4 data=texture(u_elevation_stops,vec2(x,0))*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {float el=getElevation(v_pos);int r=(u_color_ramp_size-1);int l=0;float el_l=getElevationStop(l);float el_r=getElevationStop(r);while(r-l > 1){int m=(r+l)/2;float el_m=getElevationStop(m);if(el < el_m){r=m;el_r=el_m;}else\n{l=m;el_l=el_m;}}float x=(float(l)+(el-el_l)/(el_r-el_l)+0.5)/float(u_color_ramp_size);fragColor=u_opacity*texture(u_color_stops,vec2(x,0));\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_dimension;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_pos/8192.0)*scale+epsilon;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),debug:Xt("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:Xt(ts,"in vec2 a_pos;void main() {\n#ifdef GLOBE\ngl_Position=projectTileFor3D(a_pos,0.0);\n#else\ngl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);\n#endif\n}"),fill:Xt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nfragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_fill_translate;in vec2 a_pos;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);}"),fillOutline:Xt("in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}"),fillOutlinePattern:Xt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n}"),fillPattern:Xt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),fillExtrusion:Xt("in vec4 v_color;void main() {fragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\nout vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nfloat colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);\n#ifdef GLOBE\nmat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);\n#endif\ndirectional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),fillExtrusionPattern:Xt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;\n#ifdef TERRAIN3D\nin vec2 a_centroid;\n#endif\n#ifdef GLOBE\nout vec3 v_sphere_pos;\n#endif\nout vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;\n#ifdef TERRAIN3D\nfloat height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);\n#else\nfloat height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;\n#endif\nbase=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;\n#ifdef GLOBE\nvec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);\n#else\ngl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);\n#endif\nvec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),hillshadePrepare:Xt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack);}void main() {vec2 epsilon=1.0/u_dimension;float tileSize=u_dimension.x-2.0;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))*tileSize/pow(2.0,exaggeration+(28.2562-u_zoom));fragColor=clamp(vec4(deriv.x/8.0+0.5,deriv.y/8.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Xt("uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform float u_exaggeration;uniform vec4 u_accent;uniform int u_method;uniform float u_altitudes[NUM_ILLUMINATION_SOURCES];uniform float u_azimuths[NUM_ILLUMINATION_SOURCES];uniform vec4 u_shadows[NUM_ILLUMINATION_SOURCES];uniform vec4 u_highlights[NUM_ILLUMINATION_SOURCES];\n#define PI 3.141592653589793\n#define STANDARD 0\n#define COMBINED 1\n#define IGOR 2\n#define MULTIDIRECTIONAL 3\n#define BASIC 4\nfloat get_aspect(vec2 deriv){return deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);}void igor_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float aspect=get_aspect(deriv);float azimuth=u_azimuths[0]+PI;float slope_stength=atan(length(deriv))*2.0/PI;float aspect_strength=1.0-abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);float shadow_strength=slope_stength*aspect_strength;float highlight_strength=slope_stength*(1.0-aspect_strength);fragColor=u_shadows[0]*shadow_strength+u_highlights[0]*highlight_strength;}void standard_hillshade(vec2 deriv){float azimuth=u_azimuths[0]+PI;float slope=atan(0.625*length(deriv));float aspect=get_aspect(deriv);float intensity=u_exaggeration;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadows[0],u_highlights[0],shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;}void basic_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor=u_highlights[0]*(2.0*shade-1.0);}else\n{fragColor=u_shadows[0]*(1.0-2.0*shade);}}void multidirectional_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;fragColor=vec4(0,0,0,0);for(int i=0; i < NUM_ILLUMINATION_SOURCES; i++){float cos_alt=cos(u_altitudes[i]);float sin_alt=sin(u_altitudes[i]);float cos_az=-cos(u_azimuths[i]);float sin_az=-sin(u_azimuths[i]);float cang=(sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv));float shade=clamp(cang,0.0,1.0);if(shade > 0.5){fragColor+=u_highlights[i]*(2.0*shade-1.0)/float(NUM_ILLUMINATION_SOURCES);}else\n{fragColor+=u_shadows[i]*(1.0-2.0*shade)/float(NUM_ILLUMINATION_SOURCES);}}}void combined_hillshade(vec2 deriv){deriv=deriv*u_exaggeration*2.0;float azimuth=u_azimuths[0]+PI;float cos_az=cos(azimuth);float sin_az=sin(azimuth);float cos_alt=cos(u_altitudes[0]);float sin_alt=sin(u_altitudes[0]);float cang=acos((sin_alt-(deriv.y*cos_az*cos_alt-deriv.x*sin_az*cos_alt))/sqrt(1.0+dot(deriv,deriv)));cang=clamp(cang,0.0,PI/2.0);float shade=cang*atan(length(deriv))*4.0/PI/PI;float highlight=(PI/2.0-cang)*atan(length(deriv))*4.0/PI/PI;fragColor=u_shadows[0]*shade+u_highlights[0]*highlight;}void main() {vec4 pixel=texture(u_image,v_pos);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));vec2 deriv=((pixel.rg*8.0)-4.0)/scaleFactor;if (u_method==BASIC) {basic_hillshade(deriv);} else if (u_method==COMBINED) {combined_hillshade(deriv);} else if (u_method==IGOR) {igor_hillshade(deriv);} else if (u_method==MULTIDIRECTIONAL) {multidirectional_hillshade(deriv);} else if (u_method==STANDARD) {standard_hillshade(deriv);} else {standard_hillshade(deriv);}\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:Xt("uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),lineGradient:Xt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nin vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_width2=vec2(outset,inset);}"),linePattern:Xt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),lineSDF:Xt("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;\n#ifdef GLOBE\nin float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);\n#ifdef GLOBE\nif (v_depth > 1.0) {discard;}\n#endif\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nin vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;\n#ifdef GLOBE\nout float v_depth;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;\n#ifdef GLOBE\nv_depth=gl_Position.z/gl_Position.w;\n#endif\n#ifdef TERRAIN3D\nv_gamma_scale=1.0;\n#else\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#endif\nv_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),raster:Xt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;\n#ifdef GLOBE\nif (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}\n#endif\nv_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Xt("uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}"),symbolSDF:Xt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:Xt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\nfragColor=vec4(1.0);\n#endif\n}","in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;\n#ifdef GLOBE\nif(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}\n#endif\nvec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrain:Xt("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:Xt("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:Xt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:Xt("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:Xt("in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758\n);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}","in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:Xt("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function Xt(b,o){const u=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=o.match(/in ([\w]+) ([\w]+)/g),_=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=o.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=x?x.concat(_):_,I={};return{fragmentSource:b=b.replace(u,(D,N,F,U,V)=>(I[V]=!0,"define"===N?`\n#ifndef HAS_UNIFORM_u_${V}\nin ${F} ${U} ${V};\n#else\nuniform ${F} ${U} u_${V};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${V}\n    ${F} ${U} ${V} = u_${V};\n#endif\n`)),vertexSource:o=o.replace(u,(D,N,F,U,V)=>{const H="float"===U?"vec2":"vec4",Y=V.match(/color/)?"color":H;return I[V]?"define"===N?`\n#ifndef HAS_UNIFORM_u_${V}\nuniform lowp float u_${V}_t;\nin ${F} ${H} a_${V};\nout ${F} ${U} ${V};\n#else\nuniform ${F} ${U} u_${V};\n#endif\n`:"vec4"===Y?`\n#ifndef HAS_UNIFORM_u_${V}\n    ${V} = a_${V};\n#else\n    ${F} ${U} ${V} = u_${V};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${V}\n    ${V} = unpack_mix_${Y}(a_${V}, u_${V}_t);\n#else\n    ${F} ${U} ${V} = u_${V};\n#endif\n`:"define"===N?`\n#ifndef HAS_UNIFORM_u_${V}\nuniform lowp float u_${V}_t;\nin ${F} ${H} a_${V};\n#else\nuniform ${F} ${U} u_${V};\n#endif\n`:"vec4"===Y?`\n#ifndef HAS_UNIFORM_u_${V}\n    ${F} ${U} ${V} = a_${V};\n#else\n    ${F} ${U} ${V} = u_${V};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${V}\n    ${F} ${U} ${V} = unpack_mix_${Y}(a_${V}, u_${V}_t);\n#else\n    ${F} ${U} ${V} = u_${V};\n#endif\n`}),staticAttributes:f,staticUniforms:S}}class ns{constructor(o,u,f){this.vertexBuffer=o,this.indexBuffer=u,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var pi=y.aJ([{name:"a_pos",type:"Int16",components:2}]);const $o="#define PROJECTION_MERCATOR",Ni="mercator";class Qt{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return Ni}get shaderDefine(){return $o}get shaderPreludeCode(){return co.projectionMercator}get vertexShaderPreludeCode(){return co.projectionMercator.vertexSource}get subdivisionGranularity(){return y.aK.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(o){}getMeshFromTileID(o,u,f,_,x){if(this._cachedMesh)return this._cachedMesh;const S=new y.aL;S.emplaceBack(0,0),S.emplaceBack(y.$,0),S.emplaceBack(0,y.$),S.emplaceBack(y.$,y.$);const I=o.createVertexBuffer(S,pi.members),D=y.aM.simpleSegment(0,0,4,2),N=new y.aN;N.emplaceBack(1,0,2),N.emplaceBack(1,2,3);const F=o.createIndexBuffer(N);return this._cachedMesh=new ns(I,F,D),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(o){}}class ca{constructor(o=0,u=0,f=0,_=0){if(isNaN(o)||o<0||isNaN(u)||u<0||isNaN(f)||f<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=u,this.left=f,this.right=_}interpolate(o,u,f){return null!=u.top&&null!=o.top&&(this.top=y.C.number(o.top,u.top,f)),null!=u.bottom&&null!=o.bottom&&(this.bottom=y.C.number(o.bottom,u.bottom,f)),null!=u.left&&null!=o.left&&(this.left=y.C.number(o.left,u.left,f)),null!=u.right&&null!=o.right&&(this.right=y.C.number(o.right,u.right,f)),this}getCenter(o,u){const f=y.ah((this.left+o-this.right)/2,0,o),_=y.ah((this.top+u-this.bottom)/2,0,u);return new y.P(f,_)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new ca(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Ra(b,o){if(!b.renderWorldCopies||b.lngRange)return;const u=o.lng-b.center.lng;o.lng+=u>180?-360:u<-180?360:0}function ml(b){return Math.max(0,Math.floor(b))}class uo{constructor(o,u,f,_,x,S){this._callbacks=o,this._tileSize=512,this._renderWorldCopies=void 0===S||!!S,this._minZoom=u||0,this._maxZoom=f||22,this._minPitch=_??0,this._maxPitch=x??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new y.S(0,0),this._elevation=0,this._zoom=0,this._tileZoom=ml(this._zoom),this._scale=y.af(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new ca,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(o,u,f){this._latRange=o.latRange,this._lngRange=o.lngRange,this._width=o.width,this._height=o.height,this._center=o.center,this._elevation=o.elevation,this._minElevationForCurrentTile=o.minElevationForCurrentTile,this._zoom=o.zoom,this._tileZoom=ml(this._zoom),this._scale=y.af(this._zoom),this._bearingInRadians=o.bearingInRadians,this._fovInRadians=o.fovInRadians,this._pitchInRadians=o.pitchInRadians,this._rollInRadians=o.rollInRadians,this._unmodified=o.unmodified,this._edgeInsets=new ca(o.padding.top,o.padding.bottom,o.padding.left,o.padding.right),this._minZoom=o.minZoom,this._maxZoom=o.maxZoom,this._minPitch=o.minPitch,this._maxPitch=o.maxPitch,this._renderWorldCopies=o.renderWorldCopies,this._cameraToCenterDistance=o.cameraToCenterDistance,this._nearZ=o.nearZ,this._farZ=o.farZ,this._autoCalculateNearFarZ=!f&&o.autoCalculateNearFarZ,u&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(o){this._minElevationForCurrentTile=o}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(o){this._minZoom!==o&&(this._minZoom=o,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(o){this._minPitch!==o&&(this._minPitch=o,this.setPitch(Math.max(this.pitch,o)))}get maxPitch(){return this._maxPitch}setMaxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.setPitch(Math.min(this.pitch,o)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(o){void 0===o?o=!0:null===o&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new y.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(o){const u=y.aO(o,-180,180)*Math.PI/180;var f,_,x,S,I,D,N,F,U;this._bearingInRadians!==u&&(this._unmodified=!1,this._bearingInRadians=u,this._calcMatrices(),this._rotationMatrix=En(),f=this._rotationMatrix,x=-this._bearingInRadians,S=(_=this._rotationMatrix)[0],I=_[1],D=_[2],N=_[3],F=Math.sin(x),U=Math.cos(x),f[0]=S*U+D*F,f[1]=I*U+N*F,f[2]=S*-F+D*U,f[3]=I*-F+N*U)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(o){const u=y.ah(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==u&&(this._unmodified=!1,this._pitchInRadians=u,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(o){const u=o/180*Math.PI;this._rollInRadians!==u&&(this._unmodified=!1,this._rollInRadians=u,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return y.aP(this._fovInRadians)}setFov(o){o=y.ah(o,.1,150),this.fov!==o&&(this._unmodified=!1,this._fovInRadians=y.ae(o),this._calcMatrices())}get zoom(){return this._zoom}setZoom(o){const u=this.getConstrained(this._center,o).zoom;this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this._tileZoom=Math.max(0,Math.floor(u)),this._scale=y.af(u),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(o){o!==this._elevation&&(this._elevation=o,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(o,u){this._autoCalculateNearFarZ=!1,this._nearZ=o,this._farZ=u,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,u,f){this._unmodified=!1,this._edgeInsets.interpolate(o,u,f),this._constrain(),this._calcMatrices()}resize(o,u,f=!0){this._width=o,this._height=u,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&2===this._latRange.length&&this._lngRange&&2===this._lngRange.length?new Jn([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(o){o?(this._lngRange=[o.getWest(),o.getEast()],this._latRange=[o.getSouth(),o.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-y.ai,y.ai])}getConstrained(o,u){return this._callbacks.getConstrained(o,u)}getCameraQueryGeometry(o,u){if(1===u.length)return[u[0],o];{const{minX:f,minY:_,maxX:x,maxY:S}=y.a2.fromPoints(u).extend(o);return[new y.P(f,_),new y.P(x,_),new y.P(x,S),new y.P(f,S),new y.P(f,_)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const o=this._unmodified,{center:u,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(u),this.setZoom(f),this._unmodified=o,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let o=y.ag(new Float64Array(16));y.N(o,o,[this._width/2,-this._height/2,1]),y.M(o,o,[1,-1,0]),this._clipSpaceToPixelsMatrix=o,o=y.ag(new Float64Array(16)),y.N(o,o,[1,-1,1]),y.M(o,o,[-1,-1,0]),y.N(o,o,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=o,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(o,u,f,_){const x=void 0!==f?f:this.bearing,S=_=void 0!==_?_:this.pitch,I=y.a1.fromLngLat(o,u),D=-Math.cos(y.ae(S)),N=Math.sin(y.ae(S)),F=N*Math.sin(y.ae(x)),U=-N*Math.cos(y.ae(x));let V=this.elevation;const H=u-V;let Y;D*H>=0||Math.abs(D)<.1?(Y=1e4,V=u+Y*D):Y=-H/D;let oe,re,ie=y.aQ(1,I.y),ue=0;do{if(ue+=1,ue>10)break;re=Y/ie,oe=new y.a1(I.x+F*re,I.y+U*re),ie=1/oe.meterInMercatorCoordinateUnits()}while(Math.abs(Y-re*ie)>1e-12);return{center:oe.toLngLat(),elevation:V,zoom:y.ak(this.height/2/Math.tan(this.fovInRadians/2)/re/this.tileSize)}}recalculateZoomAndCenter(o){if(this.elevation-o==0)return;const u=y.aj(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/u,_=y.a1.fromLngLat(this.center,this.elevation),x=Ne(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=o;const S=this.calculateCenterFromCameraLngLatAlt(x.toLngLat(),y.aQ(x.z,_.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const o=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new y.P(o*Math.sin(this.rollInRadians),o*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const o=y.aj(1,this.center.lat)*this.worldSize;return Ne(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/o).toLngLat()}getMercatorTileCoordinates(o){if(!o)return[0,0,1,1];const u=o.canonical.z>=0?1<<o.canonical.z:Math.pow(2,o.canonical.z);return[o.canonical.x/u,o.canonical.y/u,1/u/y.$,1/u/y.$]}}class Mr{constructor(o,u){this.min=o,this.max=u,this.center=y.aR([],y.aS([],this.min,this.max),.5)}quadrant(o){const u=[o%2==0,o<2],f=y.aT(this.min),_=y.aT(this.max);for(let x=0;x<u.length;x++)f[x]=u[x]?this.min[x]:this.center[x],_[x]=u[x]?this.center[x]:this.max[x];return _[2]=this.max[2],new Mr(f,_)}distanceX(o){return Math.max(Math.min(this.max[0],o[0]),this.min[0])-o[0]}distanceY(o){return Math.max(Math.min(this.max[1],o[1]),this.min[1])-o[1]}intersectsFrustum(o){let u=!0;for(let f=0;f<o.planes.length;f++){const _=this.intersectsPlane(o.planes[f]);if(0===_)return 0;1===_&&(u=!1)}return u?2:o.aabb.min[0]>this.max[0]||o.aabb.min[1]>this.max[1]||o.aabb.min[2]>this.max[2]||o.aabb.max[0]<this.min[0]||o.aabb.max[1]<this.min[1]||o.aabb.max[2]<this.min[2]?0:1}intersectsPlane(o){let u=o[3],f=o[3];for(let _=0;_<3;_++)o[_]>0?(u+=o[_]*this.min[_],f+=o[_]*this.max[_]):(f+=o[_]*this.min[_],u+=o[_]*this.max[_]);return u>=0?2:f<0?0:1}}class ho{distanceToTile2d(o,u,f,_){const x=_.distanceX([o,u]),S=_.distanceY([o,u]);return Math.hypot(x,S)}getWrap(o,u,f){return f}getTileBoundingVolume(o,u,f,_){var x,S;let I=0,D=0;if(_?.terrain){const F=new y.Z(o.z,u,o.z,o.x,o.y),U=_.terrain.getMinMaxElevation(F);I=null!==(x=U.minElevation)&&void 0!==x?x:Math.min(0,f),D=null!==(S=U.maxElevation)&&void 0!==S?S:Math.max(0,f)}const N=1<<o.z;return new Mr([u+o.x/N,o.y/N,I],[u+(o.x+1)/N,(o.y+1)/N,D])}allowVariableZoom(o,u){const f=o.fov*(Math.abs(Math.cos(o.rollInRadians))*o.height+Math.abs(Math.sin(o.rollInRadians))*o.width)/o.height,_=y.ah(78.5-f/2,0,60);return!!u.terrain||o.pitch>_}allowWorldCopies(){return!0}prepareNextFrame(){}}class Tr{constructor(o,u,f){this.points=o,this.planes=u,this.aabb=f}static fromInvProjectionMatrix(o,u=1,f=0,_,x){const S=x?[[6,5,4],[0,1,2],[0,3,7],[2,1,5],[3,2,6],[0,4,5]]:[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],I=Math.pow(2,f),D=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(V=>function(H,Y,oe,re){const ie=y.aw([],H,Y),ue=1/ie[3]/oe*re;return y.aY(ie,ie,[ue,ue,1/ie[3],ue])}(V,o,u,I));_&&function(V,H,Y,oe){const re=oe?4:0,ie=oe?0:4;let ue=0;const pe=[],he=[];for(let fe=0;fe<4;fe++){const Te=y.aU([],V[fe+ie],V[fe+re]),Be=y.aZ(Te);y.aR(Te,Te,1/Be),pe.push(Be),he.push(Te)}for(let fe=0;fe<4;fe++){const Te=y.a_(V[fe+re],he[fe],Y);ue=null!==Te&&Te>=0?Math.max(ue,Te):Math.max(ue,pe[fe])}const me=function(fe,Te){const Be=y.aU([],fe[Te[0]],fe[Te[1]]),ke=y.aU([],fe[Te[2]],fe[Te[1]]),Oe=[0,0,0,0];return y.aV(Oe,y.aW([],Be,ke)),Oe[3]=-y.aX(Oe,fe[Te[0]]),Oe}(V,H),ve=function(fe,Te){const Be=y.a$(fe),ke=y.b0([],fe,1/Be),Oe=y.aU([],Te,y.aR([],ke,y.aX(Te,ke))),Fe=y.a$(Oe);if(Fe>0){const Je=Math.sqrt(1-ke[3]*ke[3]),tt=y.aR([],ke,-ke[3]),qe=y.aS([],tt,y.aR([],Oe,Je/Fe));return y.b1(Te,qe)}return null}(Y,me);if(null!==ve){const fe=ve/y.aX(he[0],me);ue=Math.min(ue,fe)}for(let fe=0;fe<4;fe++){const Te=Math.min(ue,pe[fe]);V[fe+ie]=[V[fe+re][0]+he[fe][0]*Te,V[fe+re][1]+he[fe][1]*Te,V[fe+re][2]+he[fe][2]*Te,1]}}(D,S[0],_,x);const N=S.map(V=>{const H=y.aU([],D[V[0]],D[V[1]]),Y=y.aU([],D[V[2]],D[V[1]]),oe=y.aV([],y.aW([],H,Y)),re=-y.aX(oe,D[V[1]]);return oe.concat(re)}),F=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],U=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const V of D)for(let H=0;H<3;H++)F[H]=Math.min(F[H],V[H]),U[H]=Math.max(U[H],V[H]);return new Tr(D,N,new Mr(F,U))}}class Dn{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,u,f){return this._helper.interpolatePadding(o,u,f)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,u,f=!0){this._helper.resize(o,u,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}overrideNearFarZ(o,u){this._helper.overrideNearFarZ(o,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o,u){}constructor(o,u,f,_,x){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new uo({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,I)=>this.getConstrained(S,I)},o,u,f,_,x),this._coveringTilesDetailsProvider=new ho}clone(){const o=new Dn;return o.apply(this),o}apply(o,u,f){this._helper.apply(o,u,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(o){const u=[new y.b2(0,o)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new y.P(0,0)),_=this.screenPointToMercatorCoordinate(new y.P(this._helper._width,0)),x=this.screenPointToMercatorCoordinate(new y.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new y.P(0,this._helper._height)),I=Math.floor(Math.min(f.x,_.x,x.x,S.x)),D=Math.floor(Math.max(f.x,_.x,x.x,S.x)),N=1;for(let F=I-N;F<=D+N;F++)0!==F&&u.push(new y.b2(F,o))}return u}getCameraFrustum(){return Tr.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){const u=this.screenPointToLocation(this.centerPoint,o),f=o?o.getElevationForLngLatZoom(u,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(o,u){const f=y.aj(this.elevation,this.center.lat),_=this.screenPointToMercatorCoordinateAtZ(u,f),x=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),S=y.a1.fromLngLat(o),I=new y.a1(S.x-(_.x-x.x),S.y-(_.y-x.y));this.setCenter(I?.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(o,u){return u?this.coordinatePoint(y.a1.fromLngLat(o),u.getElevationForLngLatZoom(o,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(y.a1.fromLngLat(o))}screenPointToLocation(o,u){var f;return null===(f=this.screenPointToMercatorCoordinate(o,u))||void 0===f?void 0:f.toLngLat()}screenPointToMercatorCoordinate(o,u){if(u){const f=u.pointCoordinate(o);if(null!=f)return f}return this.screenPointToMercatorCoordinateAtZ(o)}screenPointToMercatorCoordinateAtZ(o,u){const f=u||0,_=[o.x,o.y,0,1],x=[o.x,o.y,1,1];y.aw(_,_,this._pixelMatrixInverse),y.aw(x,x,this._pixelMatrixInverse);const S=_[3],I=x[3],D=_[1]/S,N=x[1]/I,F=_[2]/S,U=x[2]/I,V=F===U?0:(f-F)/(U-F);return new y.a1(y.C.number(_[0]/S,x[0]/I,V)/this.worldSize,y.C.number(D,N,V)/this.worldSize,f)}coordinatePoint(o,u=0,f=this._pixelMatrix){const _=[o.x*this.worldSize,o.y*this.worldSize,u,1];return y.aw(_,_,f),new y.P(_[0]/_[3],_[1]/_[3])}getBounds(){const o=Math.max(0,this._helper._height/2-be(this));return(new Jn).extend(this.screenPointToLocation(new y.P(0,o))).extend(this.screenPointToLocation(new y.P(this._helper._width,o))).extend(this.screenPointToLocation(new y.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new y.P(0,this._helper._height)))}isPointOnMapSurface(o,u){return u?null!=u.pointCoordinate(o):o.y>this.height/2-be(this)}calculatePosMatrix(o,u=!1,f){var _;const x=null!==(_=o.key)&&void 0!==_?_:y.b3(o.wrap,o.canonical.z,o.canonical.z,o.canonical.x,o.canonical.y),S=u?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(x)){const N=S.get(x);return f?N.f32:N.f64}const I=we(o,this.worldSize);y.O(I,u?this._alignedProjMatrix:this._viewProjMatrix,I);const D={f64:I,f32:new Float32Array(I)};return S.set(x,D),f?D.f32:D.f64}calculateFogMatrix(o){const u=o.key,f=this._fogMatrixCacheF32;if(f.has(u))return f.get(u);const _=we(o,this.worldSize);return y.O(_,this._fogMatrix,_),f.set(u,new Float32Array(_)),f.get(u)}getConstrained(o,u){u=y.ah(+u,this.minZoom,this.maxZoom);const f={center:new y.S(o.lng,o.lat),zoom:u};let _=this._helper._lngRange;if(!this._helper._renderWorldCopies&&null===_){const pe=179.9999999999;_=[-pe,pe]}const x=this.tileSize*y.af(f.zoom);let S=0,I=x,D=0,N=x,F=0,U=0;const{x:V,y:H}=this.size;if(this._helper._latRange){const pe=this._helper._latRange;S=y.U(pe[1])*x,I=y.U(pe[0])*x,I-S<H&&(F=H/(I-S))}_&&(D=y.aO(y.V(_[0])*x,0,x),N=y.aO(y.V(_[1])*x,0,x),N<D&&(N+=x),N-D<V&&(U=V/(N-D)));const{x:Y,y:oe}=te(x,o);let re,ie;const ue=Math.max(U||0,F||0);if(ue){const pe=new y.P(U?(N+D)/2:Y,F?(I+S)/2:oe);return f.center=de(x,pe).wrap(),f.zoom+=y.ak(ue),f}if(this._helper._latRange){const pe=H/2;oe-pe<S&&(ie=S+pe),oe+pe>I&&(ie=I-pe)}if(_){const pe=(D+N)/2;let he=Y;this._helper._renderWorldCopies&&(he=y.aO(Y,pe-x/2,pe+x/2));const me=V/2;he-me<D&&(re=D+me),he+me>N&&(re=N-me)}if(void 0!==re||void 0!==ie){const pe=new y.P(re??Y,ie??oe);f.center=de(x,pe).wrap()}return f}calculateCenterFromCameraLngLatAlt(o,u,f,_){return this._helper.calculateCenterFromCameraLngLatAlt(o,u,f,_)}_calculateNearFarZIfNeeded(o,u,f){if(!this._helper.autoCalculateNearFarZ)return;const _=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),x=o-_*this._helper._pixelPerMeter/Math.cos(u),S=_<0?x:o,I=Math.PI/2+this.pitchInRadians,D=y.ae(this.fov)*(Math.abs(Math.cos(y.ae(this.roll)))*this.height+Math.abs(Math.sin(y.ae(this.roll)))*this.width)/this.height*(.5+f.y/this.height),N=Math.sin(D)*S/Math.sin(y.ah(Math.PI-I-D,.01,Math.PI-.01)),F=be(this),U=Math.atan(F/this._helper.cameraToCenterDistance),V=y.ae(.75),H=U>V?2*U*(.5+f.y/(2*F)):V,Y=Math.sin(H)*S/Math.sin(y.ah(Math.PI-I-H,.01,Math.PI-.01)),oe=Math.min(N,Y);this._helper._farZ=1.01*(Math.cos(Math.PI/2-u)*oe+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const o=this.centerOffset,u=te(this.worldSize,this.center),f=u.x,_=u.y;this._helper._pixelPerMeter=y.aj(1,this.center.lat)*this.worldSize;const x=y.ae(Math.min(this.pitch,ee)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(x));let I;this._calculateNearFarZIfNeeded(S,x,o),I=new Float64Array(16),y.b4(I,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),y.aq(this._invProjMatrix,I),I[8]=2*-o.x/this._helper._width,I[9]=2*o.y/this._helper._height,this._projectionMatrix=y.b5(I),y.N(I,I,[1,-1,1]),y.M(I,I,[0,0,-this._helper.cameraToCenterDistance]),y.b6(I,I,-this.rollInRadians),y.b7(I,I,this.pitchInRadians),y.b6(I,I,-this.bearingInRadians),y.M(I,I,[-f,-_,0]),this._mercatorMatrix=y.N([],I,[this.worldSize,this.worldSize,this.worldSize]),y.N(I,I,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=y.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,I),y.M(I,I,[0,0,-this.elevation]),this._viewProjMatrix=I,this._invViewProjMatrix=y.aq([],I);const D=[0,0,-1,1];y.aw(D,D,this._invViewProjMatrix),this._cameraPosition=[D[0]/D[3],D[1]/D[3],D[2]/D[3]],this._fogMatrix=new Float64Array(16),y.b4(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-o.x/this.width,this._fogMatrix[9]=2*o.y/this.height,y.N(this._fogMatrix,this._fogMatrix,[1,-1,1]),y.M(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),y.b6(this._fogMatrix,this._fogMatrix,-this.rollInRadians),y.b7(this._fogMatrix,this._fogMatrix,this.pitchInRadians),y.b6(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),y.M(this._fogMatrix,this._fogMatrix,[-f,-_,0]),y.N(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),y.M(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=y.O(new Float64Array(16),this.clipSpaceToPixelsMatrix,I);const N=this._helper._width%2/2,F=this._helper._height%2/2,U=Math.cos(this.bearingInRadians),V=Math.sin(-this.bearingInRadians),H=f-Math.round(f)+U*N+V*F,Y=_-Math.round(_)+U*F+V*N,oe=new Float64Array(I);if(y.M(oe,oe,[H>.5?H-1:H,Y>.5?Y-1:Y,0]),this._alignedProjMatrix=oe,I=y.aq(new Float64Array(16),this._pixelMatrix),!I)throw new Error("failed to invert matrix");this._pixelMatrixInverse=I,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const o=this.screenPointToMercatorCoordinate(new y.P(0,0)),u=[o.x*this.worldSize,o.y*this.worldSize,0,1];return y.aw(u,u,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const o=y.aj(1,this.center.lat)*this.worldSize;return Ne(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/o).toLngLat()}lngLatToCameraDepth(o,u){const f=y.a1.fromLngLat(o),_=[f.x*this.worldSize,f.y*this.worldSize,u,1];return y.aw(_,_,this._viewProjMatrix),_[2]/_[3]}getProjectionData(o){const{overscaledTileID:u,aligned:f,applyTerrainMatrix:_}=o,x=this._helper.getMercatorTileCoordinates(u),S=u?this.calculatePosMatrix(u,f,!0):null;let I;return I=u&&u.terrainRttPosMatrix32f&&_?u.terrainRttPosMatrix32f:S||y.b8(),{mainMatrix:I,tileMercatorCoords:x,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:I}}isLocationOccluded(o){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(o,u,f){return 1}transformLightDirection(o){return y.aT(o)}getRayDirectionFromPixel(o){throw new Error("Not implemented.")}projectTileCoordinates(o,u,f,_){const x=this.calculatePosMatrix(f);let S;_?(S=[o,u,_(o,u),1],y.aw(S,S,x)):(S=[o,u,0,1],Aa(S,S,x));const I=S[3];return{point:new y.P(S[0]/I,S[1]/I),signedDistanceFromCamera:I,isOccluded:!1}}populateCache(o){for(const u of o)this.calculatePosMatrix(u)}getMatrixForModel(o,u){const f=y.a1.fromLngLat(o,u),_=f.meterInMercatorCoordinateUnits(),x=y.b9();return y.M(x,x,[f.x,f.y,f.z]),y.b6(x,x,Math.PI),y.b7(x,x,Math.PI/2),y.N(x,x,[-_,_,_]),x}getProjectionDataForCustomLayer(o=!0){const u=new y.Z(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:u,applyGlobeMatrix:o}),_=we(u,this.worldSize);y.O(_,this._viewProjMatrix,_),f.tileMercatorCoords=[0,0,1,1];const x=[y.$,y.$,this.worldSize/this._helper.pixelsPerMeter],S=y.ba();return y.N(S,_,x),f.fallbackMatrix=S,f.mainMatrix=S,f}getFastPathSimpleProjectionMatrix(o){return this.calculatePosMatrix(o)}}function ad(){y.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function Ur(b){if(b.useSlerp)if(b.k<1){const o=y.bb(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),u=y.bb(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),f=new Float64Array(4);y.bc(f,o,u,b.k);const _=y.bd(f);b.tr.setRoll(_.roll),b.tr.setPitch(_.pitch),b.tr.setBearing(_.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(y.C.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(y.C.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(y.C.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function Jr(b,o,u,f,_){const x=_.padding,S=te(_.worldSize,u.getNorthWest()),I=te(_.worldSize,u.getNorthEast()),D=te(_.worldSize,u.getSouthEast()),N=te(_.worldSize,u.getSouthWest()),F=y.ae(-f),U=S.rotate(F),V=I.rotate(F),H=D.rotate(F),Y=N.rotate(F),oe=new y.P(Math.max(U.x,V.x,Y.x,H.x),Math.max(U.y,V.y,Y.y,H.y)),re=new y.P(Math.min(U.x,V.x,Y.x,H.x),Math.min(U.y,V.y,Y.y,H.y)),ie=oe.sub(re),ue=(_.width-(x.left+x.right+o.left+o.right))/ie.x,pe=(_.height-(x.top+x.bottom+o.top+o.bottom))/ie.y;if(pe<0||ue<0)return void ad();const he=Math.min(y.ak(_.scale*Math.min(ue,pe)),b.maxZoom),me=y.P.convert(b.offset),ve=new y.P((o.left-o.right)/2,(o.top-o.bottom)/2).rotate(y.ae(f)),fe=me.add(ve).mult(_.scale/y.af(he));return{center:de(_.worldSize,S.add(D).div(2).sub(fe)),zoom:he,bearing:f}}class Nn{get useGlobeControls(){return!1}handlePanInertia(o,u){return{easingOffset:o,easingCenter:u.center}}handleMapControlsRollPitchBearingZoom(o,u){o.bearingDelta&&u.setBearing(u.bearing+o.bearingDelta),o.pitchDelta&&u.setPitch(u.pitch+o.pitchDelta),o.rollDelta&&u.setRoll(u.roll+o.rollDelta),o.zoomDelta&&u.setZoom(u.zoom+o.zoomDelta)}handleMapControlsPan(o,u,f){o.around.distSqr(u.centerPoint)<.01||u.setLocationAtPoint(f,o.around)}cameraForBoxAndBearing(o,u,f,_,x){return Jr(o,u,f,_,x)}handleJumpToCenterZoom(o,u){o.zoom!==(void 0!==u.zoom?+u.zoom:o.zoom)&&o.setZoom(+u.zoom),void 0!==u.center&&o.setCenter(y.S.convert(u.center))}handleEaseTo(o,u){const f=o.zoom,_=o.padding,x={roll:o.roll,pitch:o.pitch,bearing:o.bearing},S={roll:void 0===u.roll?o.roll:u.roll,pitch:void 0===u.pitch?o.pitch:u.pitch,bearing:void 0===u.bearing?o.bearing:u.bearing},I=void 0!==u.zoom,D=!o.isPaddingEqual(u.padding);let N=!1;const F=I?+u.zoom:o.zoom;let U=o.centerPoint.add(u.offsetAsPoint);const V=o.screenPointToLocation(U),{center:H,zoom:Y}=o.getConstrained(y.S.convert(u.center||V),F??f);Ra(o,H);const oe=te(o.worldSize,V),re=te(o.worldSize,H).sub(oe),ie=y.af(Y-f);return N=Y!==f,{easeFunc:ue=>{if(N&&o.setZoom(y.C.number(f,Y,ue)),y.be(x,S)||Ur({startEulerAngles:x,endEulerAngles:S,tr:o,k:ue,useSlerp:x.roll!=S.roll}),D&&(o.interpolatePadding(_,u.padding,ue),U=o.centerPoint.add(u.offsetAsPoint)),u.around)o.setLocationAtPoint(u.around,u.aroundPoint);else{const pe=y.af(o.zoom-f),he=Y>f?Math.min(2,ie):Math.max(.5,ie),me=Math.pow(he,1-ue),ve=de(o.worldSize,oe.add(re.mult(ue*me)).mult(pe));o.setLocationAtPoint(o.renderWorldCopies?ve.wrap():ve,U)}},isZooming:N,elevationCenter:H}}handleFlyTo(o,u){const f=void 0!==u.zoom,_=o.zoom,x=o.getConstrained(y.S.convert(u.center||u.locationAtOffset),f?+u.zoom:_),S=x.center,I=x.zoom;Ra(o,S);const D=te(o.worldSize,u.locationAtOffset),N=te(o.worldSize,S).sub(D),F=N.mag(),U=y.af(I-_);let V;if(void 0!==u.minZoom){const H=Math.min(+u.minZoom,_,I),Y=o.getConstrained(S,H).zoom;V=y.af(Y-_)}return{easeFunc:(H,Y,oe,re)=>{o.setZoom(1===H?I:_+y.ak(Y));const ie=1===H?S:de(o.worldSize,D.add(N.mult(oe)).mult(Y));o.setLocationAtPoint(o.renderWorldCopies?ie.wrap():ie,re)},scaleOfZoom:U,targetCenter:S,scaleOfMinZoom:V,pixelPathLength:F}}}class Ln{constructor(o,u,f){this.blendFunction=o,this.blendColor=u,this.mask=f}}Ln.Replace=[1,0],Ln.disabled=new Ln(Ln.Replace,y.bf.transparent,[!1,!1,!1,!1]),Ln.unblended=new Ln(Ln.Replace,y.bf.transparent,[!0,!0,!0,!0]),Ln.alphaBlended=new Ln([1,771],y.bf.transparent,[!0,!0,!0,!0]);class Ot{constructor(o,u,f){this.enable=o,this.mode=u,this.frontFace=f}}Ot.disabled=new Ot(!1,1029,2305),Ot.backCCW=new Ot(!0,1029,2305),Ot.frontCCW=new Ot(!0,1028,2305);class Wt{constructor(o,u,f){this.func=o,this.mask=u,this.range=f}}Wt.ReadOnly=!1,Wt.ReadWrite=!0,Wt.disabled=new Wt(519,Wt.ReadOnly,[0,1]);class ln{constructor(o,u,f,_,x,S){this.test=o,this.ref=u,this.mask=f,this.fail=_,this.depthFail=x,this.pass=S}}ln.disabled=new ln({func:519,mask:0},0,0,7680,7680,7680);const wo=new WeakMap;function eo(b){var o;if(wo.has(b))return wo.get(b);{const u=null===(o=b.getParameter(b.VERSION))||void 0===o?void 0:o.startsWith("WebGL 2.0");return wo.set(b,u),u}}class ei{get awaitingQuery(){return!!this._readbackQueue}constructor(o){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=o;const u=o.context,f=u.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const _=new y.aL;_.emplaceBack(-1,-1),_.emplaceBack(2,-1),_.emplaceBack(-1,2);const x=new y.aN;x.emplaceBack(0,1,2),this._fullscreenTriangle=new ns(u.createVertexBuffer(_,pi.members),u.createIndexBuffer(x),y.aM.simpleSegment(0,0,_.length,x.length)),this._resultBuffer=new Uint8Array(4),u.activeTexture.set(f.TEXTURE1);const S=f.createTexture();f.bindTexture(f.TEXTURE_2D,S),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=u.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),eo(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const o=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),o.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(o,u){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(o,u),this._updateCount++,this._measuredError}_bindFramebuffer(){const o=this._cachedRenderContext.context,u=o.gl;o.activeTexture.set(u.TEXTURE1),u.bindTexture(u.TEXTURE_2D,this._fbo.colorAttachment.get()),o.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(o,u){const f=this._cachedRenderContext.context,_=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:y.bf.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,_.TRIANGLES,Wt.disabled,ln.disabled,Ln.unblended,Ot.disabled,((x,S)=>({u_input:x,u_output_expected:S}))(o,u),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&eo(_)){_.bindBuffer(_.PIXEL_PACK_BUFFER,this._pbo),_.readBuffer(_.COLOR_ATTACHMENT0),_.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),_.bindBuffer(_.PIXEL_PACK_BUFFER,null);const x=_.fenceSync(_.SYNC_GPU_COMMANDS_COMPLETE,0);_.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:x}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const o=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&eo(o)){const u=o.clientWaitSync(this._readbackQueue.sync,0,0);if(u===o.WAIT_FAILED)return y.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(u===o.TIMEOUT_EXPIRED)return;o.bindBuffer(o.PIXEL_PACK_BUFFER,this._pbo),o.getBufferSubData(o.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),o.bindBuffer(o.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),o.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=ei._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(o){let u=0;return u+=o[0]/256,u+=o[1]/65536,u+=o[2]/16777216,o[3]<127&&(u=-u),u/128}}const ua=y.$/128;function Rs(b,o){const u=void 0!==b.granularity?Math.max(b.granularity,1):1,f=u+(b.generateBorders?2:0),_=u+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),x=f+1,S=_+1,I=b.generateBorders?-1:0,D=b.generateBorders||b.extendToNorthPole?-1:0,N=u+(b.generateBorders?1:0),F=u+(b.generateBorders||b.extendToSouthPole?1:0),U=x*S,V=f*_*6,H=x*S>65536;if(H&&"16bit"===o)throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const Y=H||"32bit"===o,oe=new Int16Array(2*U);let re=0;for(let pe=D;pe<=F;pe++)for(let he=I;he<=N;he++){let me=he/u*y.$;-1===he&&(me=-ua),he===u+1&&(me=y.$+ua);let ve=pe/u*y.$;-1===pe&&(ve=b.extendToNorthPole?y.bh:-ua),pe===u+1&&(ve=b.extendToSouthPole?y.bi:y.$+ua),oe[re++]=me,oe[re++]=ve}const ie=Y?new Uint32Array(V):new Uint16Array(V);let ue=0;for(let pe=0;pe<_;pe++)for(let he=0;he<f;he++){const me=he+1+pe*x,ve=he+(pe+1)*x,fe=he+1+(pe+1)*x;ie[ue++]=he+pe*x,ie[ue++]=ve,ie[ue++]=me,ie[ue++]=me,ie[ue++]=ve,ie[ue++]=fe}return{vertices:oe.buffer.slice(0),indices:ie.buffer.slice(0),uses32bitIndices:Y}}const ti=new y.aK({fill:new y.bj(128,2),line:new y.bj(512,0),tile:new y.bj(128,32),stencil:new y.bj(128,1),circle:3});class da{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return co.projectionGlobe}get vertexShaderPreludeCode(){return co.projectionMercator.vertexSource}get subdivisionGranularity(){return ti}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(o){this._errorMeasurement||(this._errorMeasurement=new ei(o));const u=y.U(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-u*Math.PI*2))-.5*Math.PI,_=this._errorMeasurement.updateErrorLoop(u,f),x=mt.now();_!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=_,this._errorMeasurementLastChangeTime=x);const S=Math.min(Math.max((x-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=y.bk(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,y.bl(S))}_getMeshKey(o){return`${o.granularity.toString(36)}_${o.generateBorders?"b":""}${o.extendToNorthPole?"n":""}${o.extendToSouthPole?"s":""}`}getMeshFromTileID(o,u,f,_,x){const S=("stencil"===x?ti.stencil:ti.tile).getGranularityForZoomLevel(u.z);return this._getMesh(o,{granularity:S,generateBorders:f,extendToNorthPole:0===u.y&&_,extendToSouthPole:u.y===(1<<u.z)-1&&_})}_getMesh(o,u){const f=this._getMeshKey(u);if(f in this._tileMeshCache)return this._tileMeshCache[f];const _=function(x,S){const I=Rs(S,"16bit"),D=y.aL.deserialize({arrayBuffer:I.vertices,length:I.vertices.byteLength/2/2}),N=y.aN.deserialize({arrayBuffer:I.indices,length:I.indices.byteLength/2/3});return new ns(x.createVertexBuffer(D,pi.members),x.createIndexBuffer(N),y.aM.simpleSegment(0,0,D.length,N.length))}(o,u);return this._tileMeshCache[f]=_,_}recalculate(o){}hasTransition(){const o=mt.now();let u=!1;return u=u||(o-this._errorMeasurementLastChangeTime)/1e3<.7,u=u||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,u}setErrorQueryLatitudeDegrees(o){this._errorQueryLatitudeDegrees=o}}const Oa=new y.r({type:new y.D(y.v.projection.type)});class hc extends y.E{constructor(o){super(),this._transitionable=new y.t(Oa),this.setProjection(o),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new y.F(0)),this._mercatorProjection=new Qt,this._verticalPerspectiveProjection=new da}get transitionState(){const o=this.properties.get("type");if("string"==typeof o&&"mercator"===o)return 0;if("string"==typeof o&&"vertical-perspective"===o)return 1;if(o instanceof y.bm){if("vertical-perspective"===o.from&&"mercator"===o.to)return 1-o.transition;if("mercator"===o.from&&"vertical-perspective"===o.to)return o.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(o){this._mercatorProjection.updateGPUdependent(o),this._verticalPerspectiveProjection.updateGPUdependent(o)}getMeshFromTileID(o,u,f,_,x){return this.currentProjection.getMeshFromTileID(o,u,f,_,x)}setProjection(o){this._transitionable.setValue("type",o?.type||"mercator")}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}setErrorQueryLatitudeDegrees(o){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(o),this._mercatorProjection.setErrorQueryLatitudeDegrees(o)}}function _l(b){const o=gi(b.worldSize,b.center.lat);return 2*Math.PI*o}function Ro(b,o,u,f,_){const x=1/(1<<_),S=o/y.$*x+f*x,I=y.bo((b/y.$*x+u*x)*Math.PI*2+Math.PI,2*Math.PI),D=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,N=Math.cos(D),F=new Float64Array(3);return F[0]=Math.sin(I)*N,F[1]=Math.sin(D),F[2]=Math.cos(I)*N,F}function dr(b){return function(o,u){const f=Math.cos(u),_=new Float64Array(3);return _[0]=Math.sin(o)*f,_[1]=Math.sin(u),_[2]=Math.cos(o)*f,_}(b.lng*Math.PI/180,b.lat*Math.PI/180)}function gi(b,o){return b/(2*Math.PI)/Math.cos(o*Math.PI/180)}function Gr(b){const o=Math.asin(b[1])/Math.PI*180,u=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(u>1e-6){const f=b[0]/u,_=Math.acos(b[2]/u),x=(f>0?_:-_)/Math.PI*180;return new y.S(y.aO(x,-180,180),o)}return new y.S(0,o)}function os(b){return Math.cos(b*Math.PI/180)}function ar(b,o){const u=os(b),f=os(o);return y.ak(f/u)}function Na(b,o){const u=b.rotate(o.bearingInRadians),f=o.zoom+ar(o.center.lat,0),_=y.bk(1/os(o.center.lat),1/os(Math.min(Math.abs(o.center.lat),60)),y.bn(f,7,3,0,1)),x=360/_l({worldSize:o.worldSize,center:{lat:o.center.lat}});return new y.S(o.center.lng-u.x*x*_,y.ah(o.center.lat+u.y*x,-y.ai,y.ai))}function $r(b){const o=.5*b,u=Math.sin(o),f=Math.cos(o);return Math.log(u+f)-Math.log(f-u)}function Os(b,o,u,f){const _=b.lat+u*f;if(Math.abs(u)>1){const x=(Math.sign(b.lat+u)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,S=Math.abs(b.lat+u)*Math.PI/180,I=$r(x+f*(S-x)),D=$r(x),N=$r(S);return new y.S(b.lng+o*((I-D)/(N-D)),_)}return new y.S(b.lng+o*f,_)}class ld{constructor(o){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._boundingVolumeFactory=o}swapBuffers(){if(!this._hadAnyChanges)return;const o=this._cachePrevious;this._cachePrevious=this._cache,this._cache=o,this._cache.clear(),this._hadAnyChanges=!1}getTileBoundingVolume(o,u,f,_){const x=`${o.z}_${o.x}_${o.y}_${_?.terrain?"t":""}`,S=this._cache.get(x);if(S)return S;const I=this._cachePrevious.get(x);if(I)return this._cache.set(x,I),I;const D=this._boundingVolumeFactory(o,u,f,_);return this._cache.set(x,D),this._hadAnyChanges=!0,D}}class Li{constructor(o,u,f,_){this.min=f,this.max=_,this.points=o,this.planes=u}static fromAabb(o,u){const f=[];for(let _=0;_<8;_++)f.push([1&~_?o[0]:u[0],1==(_>>1&1)?u[1]:o[1],1==(_>>2&1)?u[2]:o[2]]);return new Li(f,[[-1,0,0,u[0]],[1,0,0,-o[0]],[0,-1,0,u[1]],[0,1,0,-o[1]],[0,0,-1,u[2]],[0,0,1,-o[2]]],o,u)}static fromCenterSizeAngles(o,u,f){const _=y.br([],f[0],f[1],f[2]),x=y.bs([],[u[0],0,0],_),S=y.bs([],[0,u[1],0],_),I=y.bs([],[0,0,u[2]],_),D=[...o],N=[...o];for(let U=0;U<8;U++)for(let V=0;V<3;V++){const H=o[V]+x[V]*(1&~U?-1:1)+S[V]*(1==(U>>1&1)?1:-1)+I[V]*(1==(U>>2&1)?1:-1);D[V]=Math.min(D[V],H),N[V]=Math.max(N[V],H)}const F=[];for(let U=0;U<8;U++){const V=[...o];y.aS(V,V,y.aR([],x,1&~U?-1:1)),y.aS(V,V,y.aR([],S,1==(U>>1&1)?1:-1)),y.aS(V,V,y.aR([],I,1==(U>>2&1)?1:-1)),F.push(V)}return new Li(F,[[...x,-y.aX(x,F[0])],[...S,-y.aX(S,F[0])],[...I,-y.aX(I,F[0])],[-x[0],-x[1],-x[2],-y.aX(x,F[7])],[-S[0],-S[1],-S[2],-y.aX(S,F[7])],[-I[0],-I[1],-I[2],-y.aX(I,F[7])]],D,N)}intersectsFrustum(o){let u=!0;const f=this.points.length,_=this.planes.length,x=o.planes.length,S=o.points.length;for(let I=0;I<x;I++){const D=o.planes[I];let N=0;for(let F=0;F<f;F++){const U=this.points[F];D[0]*U[0]+D[1]*U[1]+D[2]*U[2]+D[3]>=0&&N++}if(0===N)return 0;N<f&&(u=!1)}if(u)return 2;for(let I=0;I<_;I++){const D=this.planes[I];let N=0;for(let F=0;F<S;F++){const U=o.points[F];D[0]*U[0]+D[1]*U[1]+D[2]*U[2]+D[3]>=0&&N++}if(0===N)return 0}return 1}intersectsPlane(o){const u=this.points.length;let f=0;for(let _=0;_<u;_++){const x=this.points[_];o[0]*x[0]+o[1]*x[1]+o[2]*x[2]+o[3]>=0&&f++}return f===u?2:0===f?0:1}}function vr(b,o,u){const f=b-o;return f<0?-f:Math.max(0,f-u)}function Hr(b,o,u,f,_){const x=b-u;let S;return S=x<0?Math.min(-x,1+x-_):x>1?Math.min(Math.max(x-_,0),1-x):0,Math.max(S,vr(o,f,_))}class Wo{constructor(){this._boundingVolumeCache=new ld(this._computeTileBoundingVolume)}prepareNextFrame(){this._boundingVolumeCache.swapBuffers()}distanceToTile2d(o,u,f,_){const x=1<<f.z,S=1/x,I=f.x/x,D=f.y/x;let N=2;return N=Math.min(N,Hr(o,u,I,D,S)),N=Math.min(N,Hr(o,u,I+.5,-D-S,S)),N=Math.min(N,Hr(o,u,I+.5,2-D-S,S)),N}getWrap(o,u,f){const _=1<<u.z,x=1/_,S=u.x/_,I=vr(o.x,S,x),D=vr(o.x,S-1,x),N=vr(o.x,S+1,x),F=Math.min(I,D,N);return F===N?1:F===D?-1:0}allowVariableZoom(o,u){return bt(o,u)>4}allowWorldCopies(){return!1}getTileBoundingVolume(o,u,f,_){return this._boundingVolumeCache.getTileBoundingVolume(o,u,f,_)}_computeTileBoundingVolume(o,u,f,_){var x,S;let I=0,D=0;if(_?.terrain){const N=new y.Z(o.z,u,o.z,o.x,o.y),F=_.terrain.getMinMaxElevation(N);I=null!==(x=F.minElevation)&&void 0!==x?x:Math.min(0,f),D=null!==(S=F.maxElevation)&&void 0!==S?S:Math.max(0,f)}if(I/=y.bu,D/=y.bu,I+=1,D+=1,o.z<=0)return Li.fromAabb([-D,-D,-D],[D,D,D]);if(1===o.z)return Li.fromAabb([0===o.x?-D:0,0===o.y?0:-D,-D],[0===o.x?0:D,0===o.y?D:0,D]);{const N=[Ro(0,0,o.x,o.y,o.z),Ro(y.$,0,o.x,o.y,o.z),Ro(y.$,y.$,o.x,o.y,o.z),Ro(0,y.$,o.x,o.y,o.z)],F=[];for(const Oe of N)F.push(y.aR([],Oe,D));if(D!==I)for(const Oe of N)F.push(y.aR([],Oe,I));0===o.y&&F.push([0,1,0]),o.y===(1<<o.z)-1&&F.push([0,-1,0]);const U=[1,1,1],V=[-1,-1,-1];for(const Oe of F)for(let Fe=0;Fe<3;Fe++)U[Fe]=Math.min(U[Fe],Oe[Fe]),V[Fe]=Math.max(V[Fe],Oe[Fe]);const H=Ro(y.$/2,y.$/2,o.x,o.y,o.z),Y=y.aW([],[0,1,0],H);y.aV(Y,Y);const oe=y.aW([],H,Y);y.aV(oe,oe);const re=y.aW([],N[2],N[1]);y.aV(re,re);const ie=y.aW([],N[0],N[3]);y.aV(ie,ie),F.push(y.aR([],H,D)),o.y>=(1<<o.z)/2&&F.push(y.aR([],Ro(y.$/2,0,o.x,o.y,o.z),D)),o.y<(1<<o.z)/2&&F.push(y.aR([],Ro(y.$/2,y.$,o.x,o.y,o.z),D));const ue=La(H,F),pe=La(oe,F),he=[-H[0],-H[1],-H[2],ue.max],me=[H[0],H[1],H[2],-ue.min],ve=[-oe[0],-oe[1],-oe[2],pe.max],fe=[oe[0],oe[1],oe[2],-pe.min],Te=[...re,0],Be=[...ie,0],ke=[];return 0===o.y?ke.push(y.bt(Be,Te,he),y.bt(Be,Te,me)):ke.push(y.bt(ve,Te,he),y.bt(ve,Te,me),y.bt(ve,Be,he),y.bt(ve,Be,me)),o.y===(1<<o.z)-1?ke.push(y.bt(Be,Te,he),y.bt(Be,Te,me)):ke.push(y.bt(fe,Te,he),y.bt(fe,Te,me),y.bt(fe,Be,he),y.bt(fe,Be,me)),new Li(ke,[he,me,ve,fe,Te,Be],U,V)}}}function La(b,o){let u=1/0,f=-1/0;for(const _ of o){const x=y.aX(b,_);u=Math.min(u,x),f=Math.max(f,x)}return{min:u,max:f}}class ha{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,u,f){return this._helper.interpolatePadding(o,u,f)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,u){this._helper.resize(o,u)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}overrideNearFarZ(o,u){this._helper.overrideNearFarZ(o,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(o){}constructor(){this._cachedClippingPlane=y.bv(),this._projectionMatrix=y.b9(),this._globeViewProjMatrix32f=y.b8(),this._globeViewProjMatrixNoCorrection=y.b9(),this._globeViewProjMatrixNoCorrectionInverted=y.b9(),this._globeProjMatrixInverted=y.b9(),this._cameraPosition=y.bp(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new uo({calcMatrices:()=>{this._calcMatrices()},getConstrained:(o,u)=>this.getConstrained(o,u)}),this._coveringTilesDetailsProvider=new Wo}clone(){const o=new ha;return o.apply(this),o}apply(o,u){this._globeLatitudeErrorCorrectionRadians=u||0,this._helper.apply(o)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const o=y.bp();return o[0]=this._cameraPosition[0],o[1]=this._cameraPosition[1],o[2]=this._cameraPosition[2],o}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(o){const{overscaledTileID:u,applyGlobeMatrix:f}=o,_=this._helper.getMercatorTileCoordinates(u);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:_,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(o){const u=this.pitchInRadians,f=this.cameraToCenterDistance/o,_=Math.sin(u)*f,x=Math.cos(u)*f+1,S=1/Math.sqrt(_*_+x*x)*1;let I=-_,D=x;const N=Math.sqrt(I*I+D*D);I/=N,D/=N;const F=[0,I,D];y.bw(F,F,[0,0,0],-this.bearingInRadians),y.bx(F,F,[0,0,0],-1*this.center.lat*Math.PI/180),y.by(F,F,[0,0,0],this.center.lng*Math.PI/180);const U=1/y.aZ(F);return y.aR(F,F,U),[...F,-S*U]}isLocationOccluded(o){return!this.isSurfacePointVisible(dr(o))}transformLightDirection(o){const u=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,_=Math.cos(f),x=[Math.sin(u)*_,Math.sin(f),Math.cos(u)*_],S=[x[2],0,-x[0]],I=[0,0,0];y.aW(I,S,x),y.aV(S,S),y.aV(I,I);const D=[0,0,0];return y.aV(D,[S[0]*o[0]+I[0]*o[1]+x[0]*o[2],S[1]*o[0]+I[1]*o[1]+x[1]*o[2],S[2]*o[0]+I[2]*o[1]+x[2]*o[2]]),D}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(o,u,f){const _=function(I,D,N){const F=1/(1<<N.z);return new y.a1(I/y.$*F+N.x*F,D/y.$*F+N.y*F)}(o,u,f.canonical),x=(S=_.y,[y.bo(_.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(x[1])}projectTileCoordinates(o,u,f,_){const x=f.canonical,S=Ro(o,u,x.x,x.y,x.z),I=1+(_?_(o,u):0)/y.bu,D=[S[0]*I,S[1]*I,S[2]*I,1];y.aw(D,D,this._globeViewProjMatrixNoCorrection);const N=this._cachedClippingPlane,F=N[0]*S[0]+N[1]*S[1]+N[2]*S[2]+N[3]<0;return{point:new y.P(D[0]/D[3],D[1]/D[3]),signedDistanceFromCamera:D[3],isOccluded:F}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const o=gi(this.worldSize,this.center.lat),u=y.ba(),f=y.ba();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*o),y.b4(u,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const _=this.centerOffset;u[8]=2*-_.x/this._helper._width,u[9]=2*_.y/this._helper._height,this._projectionMatrix=y.b5(u),this._globeProjMatrixInverted=y.ba(),y.aq(this._globeProjMatrixInverted,u),y.M(u,u,[0,0,-this.cameraToCenterDistance]),y.b6(u,u,this.rollInRadians),y.b7(u,u,-this.pitchInRadians),y.b6(u,u,this.bearingInRadians),y.M(u,u,[0,0,-o]);const x=y.bp();x[0]=o,x[1]=o,x[2]=o,y.b7(f,u,this.center.lat*Math.PI/180),y.bz(f,f,-this.center.lng*Math.PI/180),y.N(f,f,x),this._globeViewProjMatrixNoCorrection=f,y.b7(u,u,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),y.bz(u,u,-this.center.lng*Math.PI/180),y.N(u,u,x),this._globeViewProjMatrix32f=new Float32Array(u),this._globeViewProjMatrixNoCorrectionInverted=y.ba(),y.aq(this._globeViewProjMatrixNoCorrectionInverted,f);const S=y.bp();this._cameraPosition=y.bp(),this._cameraPosition[2]=this.cameraToCenterDistance/o,y.bw(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),y.bx(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),y.bw(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),y.aS(this._cameraPosition,this._cameraPosition,[0,0,1]),y.bx(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),y.by(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(o);const I=y.b5(this._globeViewProjMatrixNoCorrectionInverted);y.N(I,I,[1,1,-1]),this._cachedFrustum=Tr.fromInvProjectionMatrix(I,1,0,this._cachedClippingPlane,!0)}calculateFogMatrix(o){y.w("calculateFogMatrix is not supported on globe projection.");const u=y.ba();return y.ag(u),u}getVisibleUnwrappedCoordinates(o){return[new y.b2(0,o)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(o){o&&y.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,u){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=dr(o);y.aR(f,f,1+u/y.bu);const _=y.bv();return y.aw(_,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),_[2]/_[3]}populateCache(o){}getBounds(){const o=.5*this.width,u=.5*this.height,f=[new y.P(0,0),new y.P(o,0),new y.P(this.width,0),new y.P(this.width,u),new y.P(this.width,this.height),new y.P(o,this.height),new y.P(0,this.height),new y.P(0,u)],_=[];for(const U of f)_.push(this.unprojectScreenPoint(U));let x=0,S=0,I=0,D=0;const N=this.center;for(const U of _){const V=y.bA(N.lng,U.lng),H=y.bA(N.lat,U.lat);V<S&&(S=V),V>x&&(x=V),H<D&&(D=H),H>I&&(I=H)}const F=[N.lng+S,N.lat+D,N.lng+x,N.lat+I];return this.isSurfacePointOnScreen([0,1,0])&&(F[3]=90,F[0]=-180,F[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(F[1]=-90,F[0]=-180,F[2]=180),new Jn(F)}getConstrained(o,u){const f=y.ah(o.lat,-y.ai,y.ai),_=y.ah(+u,this.minZoom+ar(0,f),this.maxZoom);return{center:new y.S(o.lng,f),zoom:_}}calculateCenterFromCameraLngLatAlt(o,u,f,_){return this._helper.calculateCenterFromCameraLngLatAlt(o,u,f,_)}setLocationAtPoint(o,u){const f=dr(this.unprojectScreenPoint(u)),_=dr(o),x=y.bp();y.bB(x);const S=y.bp();y.by(S,f,x,-this.center.lng*Math.PI/180),y.bx(S,S,x,this.center.lat*Math.PI/180);const I=_[0]*_[0]+_[2]*_[2],D=S[0]*S[0];if(I<D)return;const N=Math.sqrt(I-D),F=-N,U=y.bC(_[0],_[2],S[0],N),V=y.bC(_[0],_[2],S[0],F),H=y.bp();y.by(H,_,x,-U);const Y=y.bC(H[1],H[2],S[1],S[2]),oe=y.bp();y.by(oe,_,x,-V);const re=y.bC(oe[1],oe[2],S[1],S[2]),ie=.5*Math.PI,ue=Y>=-ie&&Y<=ie,pe=re>=-ie&&re<=ie;let he,me;if(ue&&pe){const Be=this.center.lng*Math.PI/180,ke=this.center.lat*Math.PI/180;y.bD(U,Be)+y.bD(Y,ke)<y.bD(V,Be)+y.bD(re,ke)?(he=U,me=Y):(he=V,me=re)}else if(ue)he=U,me=Y;else{if(!pe)return;he=V,me=re}const ve=he/Math.PI*180,fe=me/Math.PI*180,Te=this.center.lat;this.setCenter(new y.S(ve,y.ah(fe,-90,90))),this.setZoom(this.zoom+ar(Te,this.center.lat))}locationToScreenPoint(o,u){const f=dr(o);if(u){const _=u.getElevationForLngLatZoom(o,this._helper._tileZoom);y.aR(f,f,1+_/y.bu)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(o){const u=y.bv();return y.aw(u,[...o,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],new y.P((.5*u[0]+.5)*this.width,(.5*-u[1]+.5)*this.height)}screenPointToMercatorCoordinate(o,u){if(u){const f=u.pointCoordinate(o);if(f)return f}return y.a1.fromLngLat(this.unprojectScreenPoint(o))}screenPointToLocation(o,u){var f;return null===(f=this.screenPointToMercatorCoordinate(o,u))||void 0===f?void 0:f.toLngLat()}isPointOnMapSurface(o,u){const f=this._cameraPosition,_=this.getRayDirectionFromPixel(o);return!!this.rayPlanetIntersection(f,_)}getRayDirectionFromPixel(o){const u=y.bv();u[0]=o.x/this.width*2-1,u[1]=-1*(o.y/this.height*2-1),u[2]=1,u[3]=1,y.aw(u,u,this._globeViewProjMatrixNoCorrectionInverted),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3];const f=y.bp();f[0]=u[0]-this._cameraPosition[0],f[1]=u[1]-this._cameraPosition[1],f[2]=u[2]-this._cameraPosition[2];const _=y.bp();return y.aV(_,f),_}isSurfacePointVisible(o){const u=this._cachedClippingPlane;return u[0]*o[0]+u[1]*o[1]+u[2]*o[2]+u[3]>=0}isSurfacePointOnScreen(o){if(!this.isSurfacePointVisible(o))return!1;const u=y.bv();return y.aw(u,[...o,1],this._globeViewProjMatrixNoCorrection),u[0]/=u[3],u[1]/=u[3],u[2]/=u[3],u[0]>-1&&u[0]<1&&u[1]>-1&&u[1]<1&&u[2]>-1&&u[2]<1}rayPlanetIntersection(o,u){const f=y.aX(o,u),_=y.bp(),x=y.bp();y.aR(x,u,f),y.aU(_,o,x);const S=1-y.aX(_,_);if(S<0)return null;const I=y.aX(o,o)-1,D=-f+(f<0?1:-1)*Math.sqrt(S),N=I/D,F=D;return{tMin:Math.min(N,F),tMax:Math.max(N,F)}}unprojectScreenPoint(o){const u=this._cameraPosition,f=this.getRayDirectionFromPixel(o),_=this.rayPlanetIntersection(u,f);if(_){const F=y.bp();y.aS(F,u,[f[0]*_.tMin,f[1]*_.tMin,f[2]*_.tMin]);const U=y.bp();return y.aV(U,F),Gr(U)}const x=this._cachedClippingPlane,S=x[0]*f[0]+x[1]*f[1]+x[2]*f[2],I=-y.b1(x,u)/S,D=y.bp();if(I>0)y.aS(D,u,[f[0]*I,f[1]*I,f[2]*I]);else{const F=y.bp();y.aS(F,u,[2*f[0],2*f[1],2*f[2]]);const U=y.b1(this._cachedClippingPlane,F);y.aU(D,F,[this._cachedClippingPlane[0]*U,this._cachedClippingPlane[1]*U,this._cachedClippingPlane[2]*U])}const N=function(F){const U=y.bp();return U[0]=F[0]*-F[3],U[1]=F[1]*-F[3],U[2]=F[2]*-F[3],{center:U,radius:Math.sqrt(1-F[3]*F[3])}}(x);return Gr(function(F,U,V){const H=y.bp();y.aU(H,V,F);const Y=y.bp();return y.bq(Y,F,H,U/y.a$(H)),Y}(N.center,N.radius,D))}getMatrixForModel(o,u){const f=y.S.convert(o),_=1/y.bu,x=y.b9();return y.bz(x,x,f.lng/180*Math.PI),y.b7(x,x,-f.lat/180*Math.PI),y.M(x,x,[0,0,1+u/y.bu]),y.b7(x,x,.5*Math.PI),y.N(x,x,[_,_,_]),x}getProjectionDataForCustomLayer(o=!0){const u=this.getProjectionData({overscaledTileID:new y.Z(0,0,0,0,0),applyGlobeMatrix:o});return u.tileMercatorCoords=[0,0,1,1],u}getFastPathSimpleProjectionMatrix(o){}}class Fa{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(o){this._helper.setMinZoom(o)}setMaxZoom(o){this._helper.setMaxZoom(o)}setMinPitch(o){this._helper.setMinPitch(o)}setMaxPitch(o){this._helper.setMaxPitch(o)}setRenderWorldCopies(o){this._helper.setRenderWorldCopies(o)}setBearing(o){this._helper.setBearing(o)}setPitch(o){this._helper.setPitch(o)}setRoll(o){this._helper.setRoll(o)}setFov(o){this._helper.setFov(o)}setZoom(o){this._helper.setZoom(o)}setCenter(o){this._helper.setCenter(o)}setElevation(o){this._helper.setElevation(o)}setMinElevationForCurrentTile(o){this._helper.setMinElevationForCurrentTile(o)}setPadding(o){this._helper.setPadding(o)}interpolatePadding(o,u,f){return this._helper.interpolatePadding(o,u,f)}isPaddingEqual(o){return this._helper.isPaddingEqual(o)}resize(o,u,f=!0){this._helper.resize(o,u,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(o){this._helper.setMaxBounds(o)}overrideNearFarZ(o,u){this._helper.overrideNearFarZ(o,u)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(o){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),o)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(o,u){this._globeness=o,this._globeLatitudeErrorCorrectionRadians=u,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().prepareNextFrame(),this._mercatorTransform.getCoveringTilesDetailsProvider().prepareNextFrame()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new uo({calcMatrices:()=>{this._calcMatrices()},getConstrained:(o,u)=>this.getConstrained(o,u)}),this._globeness=1,this._mercatorTransform=new Dn,this._verticalPerspectiveTransform=new ha}clone(){const o=new Fa;return o._globeness=this._globeness,o._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,o.apply(this),o}apply(o){this._helper.apply(o),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(o){const u=this._mercatorTransform.getProjectionData(o),f=this._verticalPerspectiveTransform.getProjectionData(o);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:u.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:o.applyGlobeMatrix?this._globeness:0,fallbackMatrix:u.fallbackMatrix}}isLocationOccluded(o){return this.currentTransform.isLocationOccluded(o)}transformLightDirection(o){return this.currentTransform.transformLightDirection(o)}getPixelScale(){return y.bk(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return y.bk(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(o,u,f){const _=this._mercatorTransform.getPitchedTextCorrection(o,u,f),x=this._verticalPerspectiveTransform.getPitchedTextCorrection(o,u,f);return y.bk(_,x,this._globeness)}projectTileCoordinates(o,u,f,_){return this.currentTransform.projectTileCoordinates(o,u,f,_)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(o){return this.currentTransform.calculateFogMatrix(o)}getVisibleUnwrappedCoordinates(o){return this.currentTransform.getVisibleUnwrappedCoordinates(o)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(o){this._mercatorTransform.recalculateZoomAndCenter(o),this._verticalPerspectiveTransform.recalculateZoomAndCenter(o)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(o,u){return this.currentTransform.lngLatToCameraDepth(o,u)}populateCache(o){this._mercatorTransform.populateCache(o),this._verticalPerspectiveTransform.populateCache(o)}getBounds(){return this.currentTransform.getBounds()}getConstrained(o,u){return this.currentTransform.getConstrained(o,u)}calculateCenterFromCameraLngLatAlt(o,u,f,_){return this._helper.calculateCenterFromCameraLngLatAlt(o,u,f,_)}setLocationAtPoint(o,u){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(o,u),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(o,u),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(o,u){return this.currentTransform.locationToScreenPoint(o,u)}screenPointToMercatorCoordinate(o,u){return this.currentTransform.screenPointToMercatorCoordinate(o,u)}screenPointToLocation(o,u){return this.currentTransform.screenPointToLocation(o,u)}isPointOnMapSurface(o,u){return this.currentTransform.isPointOnMapSurface(o,u)}getRayDirectionFromPixel(o){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(o)}getMatrixForModel(o,u){return this.currentTransform.getMatrixForModel(o,u)}getProjectionDataForCustomLayer(o=!0){const u=this._mercatorTransform.getProjectionDataForCustomLayer(o);if(!this.isGlobeRendering)return u;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(o);return f.fallbackMatrix=u.mainMatrix,f}getFastPathSimpleProjectionMatrix(o){return this.currentTransform.getFastPathSimpleProjectionMatrix(o)}}class to{get useGlobeControls(){return!0}handlePanInertia(o,u){const f=Na(o,u);return Math.abs(f.lng-u.center.lng)>180&&(f.lng=u.center.lng+179.5*Math.sign(f.lng-u.center.lng)),{easingCenter:f,easingOffset:new y.P(0,0)}}handleMapControlsRollPitchBearingZoom(o,u){const f=o.around,_=u.screenPointToLocation(f);o.bearingDelta&&u.setBearing(u.bearing+o.bearingDelta),o.pitchDelta&&u.setPitch(u.pitch+o.pitchDelta),o.rollDelta&&u.setRoll(u.roll+o.rollDelta);const x=u.zoom;o.zoomDelta&&u.setZoom(u.zoom+o.zoomDelta);const S=u.zoom-x;if(0===S)return;const I=y.bA(u.center.lng,_.lng),D=I/(Math.abs(I/180)+1),N=y.bA(u.center.lat,_.lat),F=u.getRayDirectionFromPixel(f),U=u.cameraPosition,V=-1*y.aX(U,F),H=y.bp();y.aS(H,U,[F[0]*V,F[1]*V,F[2]*V]);const Y=y.aZ(H)-1,oe=Math.exp(.5*-Math.max(Y-.3,0)),re=gi(u.worldSize,u.center.lat)/Math.min(u.width,u.height),ie=y.bn(re,.9,.5,1,.25),ue=(1-y.af(-S))*Math.min(oe,ie),pe=u.center.lat,he=u.zoom,me=new y.S(u.center.lng+D*ue,y.ah(u.center.lat+N*ue,-y.ai,y.ai));u.setLocationAtPoint(_,f);const ve=u.center,fe=y.bn(Math.abs(I),45,85,0,1),Te=y.bn(re,.75,.35,0,1),Be=Math.pow(Math.max(fe,Te),.25),ke=y.bA(ve.lng,me.lng),Oe=y.bA(ve.lat,me.lat);u.setCenter(new y.S(ve.lng+ke*Be,ve.lat+Oe*Be).wrap()),u.setZoom(he+ar(pe,u.center.lat))}handleMapControlsPan(o,u,f){if(!o.panDelta)return;const _=u.center.lat,x=u.zoom;u.setCenter(Na(o.panDelta,u).wrap()),u.setZoom(x+ar(_,u.center.lat))}cameraForBoxAndBearing(o,u,f,_,x){const S=Jr(o,u,f,_,x),I=u.left/x.width*2-1,D=(x.width-u.right)/x.width*2-1,N=u.top/x.height*-2+1,F=(x.height-u.bottom)/x.height*-2+1,U=y.bA(f.getWest(),f.getEast())<0,V=U?f.getEast():f.getWest(),H=U?f.getWest():f.getEast(),Y=Math.max(f.getNorth(),f.getSouth()),oe=Math.min(f.getNorth(),f.getSouth()),re=V+.5*y.bA(V,H),ie=Y+.5*y.bA(Y,oe),ue=x.clone();ue.setCenter(S.center),ue.setBearing(S.bearing),ue.setPitch(0),ue.setRoll(0),ue.setZoom(S.zoom);const pe=ue.modelViewProjectionMatrix,he=[dr(f.getNorthWest()),dr(f.getNorthEast()),dr(f.getSouthWest()),dr(f.getSouthEast()),dr(new y.S(H,ie)),dr(new y.S(V,ie)),dr(new y.S(re,Y)),dr(new y.S(re,oe))],me=dr(S.center);let ve=Number.POSITIVE_INFINITY;for(const fe of he)I<0&&(ve=to.getLesserNonNegativeNonNull(ve,to.solveVectorScale(fe,me,pe,"x",I))),D>0&&(ve=to.getLesserNonNegativeNonNull(ve,to.solveVectorScale(fe,me,pe,"x",D))),N>0&&(ve=to.getLesserNonNegativeNonNull(ve,to.solveVectorScale(fe,me,pe,"y",N))),F<0&&(ve=to.getLesserNonNegativeNonNull(ve,to.solveVectorScale(fe,me,pe,"y",F)));if(Number.isFinite(ve)&&0!==ve)return S.zoom=ue.zoom+y.ak(ve),S;ad()}handleJumpToCenterZoom(o,u){const f=o.center.lat,_=o.getConstrained(u.center?y.S.convert(u.center):o.center,o.zoom).center;o.setCenter(_.wrap());const x=void 0!==u.zoom?+u.zoom:o.zoom+ar(f,_.lat);o.zoom!==x&&o.setZoom(x)}handleEaseTo(o,u){const f=o.zoom,_=o.center,x=o.padding,S={roll:o.roll,pitch:o.pitch,bearing:o.bearing},I={roll:void 0===u.roll?o.roll:u.roll,pitch:void 0===u.pitch?o.pitch:u.pitch,bearing:void 0===u.bearing?o.bearing:u.bearing},D=void 0!==u.zoom,N=!o.isPaddingEqual(u.padding);let F=!1;const U=u.center?y.S.convert(u.center):_,V=o.getConstrained(U,f).center;Ra(o,V);const H=o.clone();H.setCenter(V),H.setZoom(D?+u.zoom:f+ar(_.lat,U.lat)),H.setBearing(u.bearing);const Y=new y.P(y.ah(o.centerPoint.x+u.offsetAsPoint.x,0,o.width),y.ah(o.centerPoint.y+u.offsetAsPoint.y,0,o.height));H.setLocationAtPoint(V,Y);const oe=(u.offset&&u.offsetAsPoint.mag())>0?H.center:V,re=D?+u.zoom:f+ar(_.lat,oe.lat),ie=f+ar(_.lat,0),ue=re+ar(oe.lat,0),pe=y.bA(_.lng,oe.lng),he=y.bA(_.lat,oe.lat),me=y.af(ue-ie);return F=re!==f,{easeFunc:ve=>{if(y.be(S,I)||Ur({startEulerAngles:S,endEulerAngles:I,tr:o,k:ve,useSlerp:S.roll!=I.roll}),N&&o.interpolatePadding(x,u.padding,ve),u.around)y.w("Easing around a point is not supported under globe projection."),o.setLocationAtPoint(u.around,u.aroundPoint);else{const fe=ue>ie?Math.min(2,me):Math.max(.5,me),Te=Math.pow(fe,1-ve),Be=Os(_,pe,he,ve*Te);o.setCenter(Be.wrap())}if(F){const fe=y.C.number(ie,ue,ve)+ar(0,o.center.lat);o.setZoom(fe)}},isZooming:F,elevationCenter:oe}}handleFlyTo(o,u){const f=void 0!==u.zoom,_=o.center,x=o.zoom,S=o.padding,I=!o.isPaddingEqual(u.padding),D=o.getConstrained(y.S.convert(u.center||u.locationAtOffset),x).center,N=f?+u.zoom:o.zoom+ar(o.center.lat,D.lat),F=o.clone();F.setCenter(D),F.setZoom(N),F.setBearing(u.bearing);const U=new y.P(y.ah(o.centerPoint.x+u.offsetAsPoint.x,0,o.width),y.ah(o.centerPoint.y+u.offsetAsPoint.y,0,o.height));F.setLocationAtPoint(D,U);const V=F.center;Ra(o,V);const H=function(he,me,ve){const fe=dr(me),Te=dr(ve),Be=y.aX(fe,Te),ke=Math.acos(Be),Oe=_l(he);return ke/(2*Math.PI)*Oe}(o,_,V),Y=x+ar(_.lat,0),oe=N+ar(V.lat,0),re=y.af(oe-Y);let ie;if("number"==typeof u.minZoom){const he=+u.minZoom+ar(V.lat,0),me=Math.min(he,Y,oe)+ar(0,V.lat),ve=o.getConstrained(V,me).zoom+ar(V.lat,0);ie=y.af(ve-Y)}const ue=y.bA(_.lng,V.lng),pe=y.bA(_.lat,V.lat);return{easeFunc:(he,me,ve,fe)=>{const Te=Os(_,ue,pe,ve);I&&o.interpolatePadding(S,u.padding,he);const Be=1===he?V:Te;o.setCenter(Be.wrap());const ke=Y+y.ak(me);o.setZoom(1===he?N:ke+ar(0,Be.lat))},scaleOfZoom:re,targetCenter:V,scaleOfMinZoom:ie,pixelPathLength:H}}static solveVectorScale(o,u,f,_,x){const S="x"===_?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],I=[f[3],f[7],f[11],f[15]],D=o[0]*S[0]+o[1]*S[1]+o[2]*S[2],N=o[0]*I[0]+o[1]*I[1]+o[2]*I[2],F=u[0]*S[0]+u[1]*S[1]+u[2]*S[2],U=u[0]*I[0]+u[1]*I[1]+u[2]*I[2];return F+x*N===D+x*U||I[3]*(D-F)+S[3]*(U-N)+D*U==F*N?null:(F+S[3]-x*U-x*I[3])/(F-D-x*U+x*N)}static getLesserNonNegativeNonNull(o,u){return null!==u&&u>=0&&u<o?u:o}}class fc{constructor(o){this._globe=o,this._mercatorCameraHelper=new Nn,this._verticalPerspectiveCameraHelper=new to}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(o,u){return this.currentHelper.handlePanInertia(o,u)}handleMapControlsRollPitchBearingZoom(o,u){return this.currentHelper.handleMapControlsRollPitchBearingZoom(o,u)}handleMapControlsPan(o,u,f){this.currentHelper.handleMapControlsPan(o,u,f)}cameraForBoxAndBearing(o,u,f,_,x){return this.currentHelper.cameraForBoxAndBearing(o,u,f,_,x)}handleJumpToCenterZoom(o,u){this.currentHelper.handleJumpToCenterZoom(o,u)}handleEaseTo(o,u){return this.currentHelper.handleEaseTo(o,u)}handleFlyTo(o,u){return this.currentHelper.handleFlyTo(o,u)}}const pc=(b,o)=>y.y(b,o&&o.filter(u=>"source.canvas"!==u.identifier)),su=y.bE();class gc extends y.E{constructor(o,u={}){super(),this._rtlPluginLoaded=()=>{for(const f in this.sourceCaches){const _=this.sourceCaches[f].getSource().type;"vector"!==_&&"geojson"!==_||this.sourceCaches[f].reload()}},this.map=o,this.dispatcher=new Or(Uo(),o._getMapId()),this.dispatcher.registerMessageHandler("GG",(f,_)=>this.getGlyphs(f,_)),this.dispatcher.registerMessageHandler("GI",(f,_)=>this.getImages(f,_)),this.imageManager=new Nt,this.imageManager.setEventedParent(this),this.glyphManager=new gn(o._requestManager,u.localIdeographFontFamily),this.lineAtlas=new an(256,512),this.crossTileSymbolIndex=new ks,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new y.bF,this._loaded=!1,this._availableImages=[],this._globalState={},this._resetUpdates(),this.dispatcher.broadcast("SR",y.bG()),Go().on(ci,this._rtlPluginLoaded),this.on("data",f=>{if("source"!==f.dataType||"metadata"!==f.sourceDataType)return;const _=this.sourceCaches[f.sourceId];if(!_)return;const x=_.getSource();if(x&&x.vectorLayerIds)for(const S in this._layers){const I=this._layers[S];I.source===x.id&&this._validateLayer(I)}})}setGlobalStateProperty(o,u){var f,_,x;this._checkLoaded();const S=null===u?null!==(x=null===(_=null===(f=this.stylesheet.state)||void 0===f?void 0:f[o])||void 0===_?void 0:_.default)&&void 0!==x?x:null:u;if(y.bH(S,this._globalState[o]))return this;this._globalState[o]=S;const I=this._findGlobalStateAffectedSources([o]);for(const D in this.sourceCaches)I.has(D)&&(this._reloadSource(D),this._changed=!0)}getGlobalState(){return this._globalState}setGlobalState(o){this._checkLoaded();const u=[];for(const _ in o)!y.bH(this._globalState[_],o[_].default)&&(u.push(_),this._globalState[_]=o[_].default);const f=this._findGlobalStateAffectedSources(u);for(const _ in this.sourceCaches)f.has(_)&&(this._reloadSource(_),this._changed=!0)}_findGlobalStateAffectedSources(o){if(0===o.length)return new Set;const u=new Set;for(const f in this._layers){const _=this._layers[f],x=_.getLayoutAffectingGlobalStateRefs();for(const S of o)x.has(S)&&u.add(_.source)}return u}loadURL(o,u={},f){this.fire(new y.l("dataloading",{dataType:"style"})),u.validate="boolean"!=typeof u.validate||u.validate;const _=this.map._requestManager.transformRequest(o,"Style");this._loadStyleRequest=new AbortController;const x=this._loadStyleRequest;y.j(_,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,u,f)}).catch(S=>{this._loadStyleRequest=null,S&&!x.signal.aborted&&this.fire(new y.k(S))})}loadJSON(o,u={},f){this.fire(new y.l("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,mt.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,u.validate=!1!==u.validate,this._load(o,u,f)}).catch(()=>{})}loadEmpty(){this.fire(new y.l("dataloading",{dataType:"style"})),this._load(su,{validate:!1})}_load(o,u,f){var _,x,S;const I=u.transformStyle?u.transformStyle(f,o):o;if(!u.validate||!pc(this,y.z(I))){this._loaded=!0,this.stylesheet=I;for(const D in I.sources)this.addSource(D,I.sources[D],{validate:!1});I.sprite?this._loadSprite(I.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(I.glyphs),this._createLayers(),this.light=new Wn(this.stylesheet.light),this._setProjectionInternal((null===(_=this.stylesheet.projection)||void 0===_?void 0:_.type)||"mercator"),this.sky=new Vn(this.stylesheet.sky),this.map.setTerrain(null!==(x=this.stylesheet.terrain)&&void 0!==x?x:null),this.setGlobalState(null!==(S=this.stylesheet.state)&&void 0!==S?S:null),this.fire(new y.l("data",{dataType:"style"})),this.fire(new y.l("style.load"))}}_createLayers(){const o=y.bI(this.stylesheet.layers);this.dispatcher.broadcast("SL",o),this._order=o.map(u=>u.id),this._layers={},this._serializedLayers=null;for(const u of o){const f=y.bJ(u);f.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=f}}_loadSprite(o,u=!1,f=void 0){let _;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(x,S,I,D){return y._(this,void 0,void 0,function*(){const N=zt(x),F=I>1?"@2x":"",U={},V={};for(const{id:H,url:Y}of N){const oe=S.transformRequest(Vo(Y,F,".json"),"SpriteJSON");U[H]=y.j(oe,D);const re=S.transformRequest(Vo(Y,F,".png"),"SpriteImage");V[H]=Mn.getImage(re,D)}return yield Promise.all([...Object.values(U),...Object.values(V)]),function(H,Y){return y._(this,void 0,void 0,function*(){const oe={};for(const re in H){oe[re]={};const ie=mt.getImageCanvasContext((yield Y[re]).data),ue=(yield H[re]).data;for(const pe in ue){const{width:he,height:me,x:ve,y:fe,sdf:Te,pixelRatio:Be,stretchX:ke,stretchY:Oe,content:Fe,textFitWidth:Je,textFitHeight:tt}=ue[pe];oe[re][pe]={data:null,pixelRatio:Be,sdf:Te,stretchX:ke,stretchY:Oe,content:Fe,textFitWidth:Je,textFitHeight:tt,spriteData:{width:he,height:me,x:ve,y:fe,context:ie}}}}return oe})}(U,V)})}(o,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(x=>{if(this._spriteRequest=null,x)for(const S in x){this._spritesImagesIds[S]=[];const I=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(D=>!(D in x)):[];for(const D of I)this.imageManager.removeImage(D),this._changedImages[D]=!0;for(const D in x[S]){const N="default"===S?D:`${S}:${D}`;this._spritesImagesIds[S].push(N),N in this.imageManager.images?this.imageManager.updateImage(N,x[S][D],!1):this.imageManager.addImage(N,x[S][D]),u&&(this._changedImages[N]=!0)}}}).catch(x=>{this._spriteRequest=null,_=x,this.fire(new y.k(_))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),u&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new y.l("data",{dataType:"style"})),f&&f(_)})}_unloadSprite(){for(const o of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(o),this._changedImages[o]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new y.l("data",{dataType:"style"}))}_validateLayer(o){const u=this.sourceCaches[o.source];if(!u)return;const f=o.sourceLayer;if(!f)return;const _=u.getSource();("geojson"===_.type||_.vectorLayerIds&&-1===_.vectorLayerIds.indexOf(f))&&this.fire(new y.k(new Error(`Source layer "${f}" does not exist on source "${_.id}" as specified by style layer "${o.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(o,u=!1){const f=this._serializedAllLayers();if(!o||0===o.length)return Object.values(u?y.bK(f):f);const _=[];for(const x of o)if(f[x]){const S=u?y.bK(f[x]):f[x];_.push(S)}return _}_serializedAllLayers(){let o=this._serializedLayers;if(o)return o;o=this._serializedLayers={};const u=Object.keys(this._layers);for(const f of u){const _=this._layers[f];"custom"!==_.type&&(o[f]=_.serialize())}return o}hasTransitions(){var o,u,f;if(null!==(o=this.light)&&void 0!==o&&o.hasTransition()||null!==(u=this.sky)&&void 0!==u&&u.hasTransition()||null!==(f=this.projection)&&void 0!==f&&f.hasTransition())return!0;for(const _ in this.sourceCaches)if(this.sourceCaches[_].hasTransition())return!0;for(const _ in this._layers)if(this._layers[_].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(o){if(!this._loaded)return;const u=this._changed;if(u){const _=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(_.length||x.length)&&this._updateWorkerLayers(_,x);for(const S in this._updatedSources){const I=this._updatedSources[S];if("reload"===I)this._reloadSource(S);else{if("clear"!==I)throw new Error(`Invalid action ${I}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(o);this.light.updateTransitions(o),this.sky.updateTransitions(o),this._resetUpdates()}const f={};for(const _ in this.sourceCaches){const x=this.sourceCaches[_];f[_]=x.used,x.used=!1}for(const _ of this._order){const x=this._layers[_];x.recalculate(o,this._availableImages),!x.isHidden(o.zoom)&&x.source&&(this.sourceCaches[x.source].used=!0)}for(const _ in f){const x=this.sourceCaches[_];!!f[_]!=!!x.used&&x.fire(new y.l("data",{sourceDataType:"visibility",dataType:"source",sourceId:_}))}this.light.recalculate(o),this.sky.recalculate(o),this.projection.recalculate(o),this.z=o.zoom,u&&this.fire(new y.l("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const u in this.sourceCaches)this.sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(o,u){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(o,!1),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(o,u={}){var f;this._checkLoaded();const _=this.serialize();if(o=u.transformStyle?u.transformStyle(_,o):o,(null===(f=u.validate)||void 0===f||f)&&pc(this,y.z(o)))return!1;(o=y.bK(o)).layers=y.bI(o.layers);const x=y.bL(_,o),S=this._getOperationsToPerform(x);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(0===S.operations.length)return!1;for(const I of S.operations)I();return this.stylesheet=o,this._serializedLayers=null,!0}_getOperationsToPerform(o){const u=[],f=[];for(const _ of o)switch(_.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":u.push(()=>this.addLayer.apply(this,_.args));break;case"removeLayer":u.push(()=>this.removeLayer.apply(this,_.args));break;case"setPaintProperty":u.push(()=>this.setPaintProperty.apply(this,_.args));break;case"setLayoutProperty":u.push(()=>this.setLayoutProperty.apply(this,_.args));break;case"setFilter":u.push(()=>this.setFilter.apply(this,_.args));break;case"addSource":u.push(()=>this.addSource.apply(this,_.args));break;case"removeSource":u.push(()=>this.removeSource.apply(this,_.args));break;case"setLayerZoomRange":u.push(()=>this.setLayerZoomRange.apply(this,_.args));break;case"setLight":u.push(()=>this.setLight.apply(this,_.args));break;case"setGeoJSONSourceData":u.push(()=>this.setGeoJSONSourceData.apply(this,_.args));break;case"setGlyphs":u.push(()=>this.setGlyphs.apply(this,_.args));break;case"setSprite":u.push(()=>this.setSprite.apply(this,_.args));break;case"setTerrain":u.push(()=>this.map.setTerrain.apply(this,_.args));break;case"setSky":u.push(()=>this.setSky.apply(this,_.args));break;case"setProjection":this.setProjection.apply(this,_.args);break;case"setGlobalState":u.push(()=>this.setGlobalState.apply(this,_.args));break;case"setTransition":u.push(()=>{});break;default:f.push(_.command)}return{operations:u,unimplemented:f}}addImage(o,u){if(this.getImage(o))return this.fire(new y.k(new Error(`An image named "${o}" already exists.`)));this.imageManager.addImage(o,u),this._afterImageUpdated(o)}updateImage(o,u){this.imageManager.updateImage(o,u)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){if(!this.getImage(o))return this.fire(new y.k(new Error(`An image named "${o}" does not exist.`)));this.imageManager.removeImage(o),this._afterImageUpdated(o)}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new y.l("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(o,u,f={}){if(this._checkLoaded(),void 0!==this.sourceCaches[o])throw new Error(`Source "${o}" already exists.`);if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(y.z.source,`sources.${o}`,u,null,f))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const _=this.sourceCaches[o]=new Jt(o,u,this.dispatcher);_.style=this,_.setEventedParent(this,()=>({isSourceLoaded:_.loaded(),source:_.serialize(),sourceId:o})),_.onAdd(this.map),this._changed=!0}removeSource(o){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===o)return this.fire(new y.k(new Error(`Source "${o}" cannot be removed while layer "${f}" is using it.`)));const u=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],u.fire(new y.l("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),u.setEventedParent(null),u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(o,u){if(this._checkLoaded(),void 0===this.sourceCaches[o])throw new Error(`There is no source with this ID=${o}`);const f=this.sourceCaches[o].getSource();if("geojson"!==f.type)throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(u),this._changed=!0}getSource(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()}addLayer(o,u,f={}){this._checkLoaded();const _=o.id;if(this.getLayer(_))return void this.fire(new y.k(new Error(`Layer "${_}" already exists on this map.`)));let x;if("custom"===o.type){if(pc(this,y.bM(o)))return;x=y.bJ(o)}else{if("source"in o&&"object"==typeof o.source&&(this.addSource(_,o.source),o=y.bK(o),o=y.e(o,{source:_})),this._validate(y.z.layer,`layers.${_}`,o,{arrayIndex:-1},f))return;x=y.bJ(o),this._validateLayer(x),x.setEventedParent(this,{layer:{id:_}})}const S=u?this._order.indexOf(u):this._order.length;if(u&&-1===S)this.fire(new y.k(new Error(`Cannot add layer "${_}" before non-existing layer "${u}".`)));else{if(this._order.splice(S,0,_),this._layerOrderChanged=!0,this._layers[_]=x,this._removedLayers[_]&&x.source&&"custom"!==x.type){const I=this._removedLayers[_];delete this._removedLayers[_],I.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",this.sourceCaches[x.source].pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map)}}moveLayer(o,u){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new y.k(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===u)return;const f=this._order.indexOf(o);this._order.splice(f,1);const _=u?this._order.indexOf(u):this._order.length;u&&-1===_?this.fire(new y.k(new Error(`Cannot move layer "${o}" before non-existing layer "${u}".`))):(this._order.splice(_,0,o),this._layerOrderChanged=!0)}removeLayer(o){this._checkLoaded();const u=this._layers[o];if(!u)return void this.fire(new y.k(new Error(`Cannot remove non-existing layer "${o}".`)));u.setEventedParent(null);const f=this._order.indexOf(o);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=u,delete this._layers[o],this._serializedLayers&&delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],u.onRemove&&u.onRemove(this.map)}getLayer(o){return this._layers[o]}getLayersOrder(){return[...this._order]}hasLayer(o){return o in this._layers}setLayerZoomRange(o,u,f){this._checkLoaded();const _=this.getLayer(o);_?_.minzoom===u&&_.maxzoom===f||(null!=u&&(_.minzoom=u),null!=f&&(_.maxzoom=f),this._updateLayer(_)):this.fire(new y.k(new Error(`Cannot set the zoom range of non-existing layer "${o}".`)))}setFilter(o,u,f={}){this._checkLoaded();const _=this.getLayer(o);if(_){if(!y.bH(_.filter,u))return null==u?(_.setFilter(void 0),void this._updateLayer(_)):void(this._validate(y.z.filter,`layers.${_.id}.filter`,u,null,f)||(_.setFilter(y.bK(u)),this._updateLayer(_)))}else this.fire(new y.k(new Error(`Cannot filter non-existing layer "${o}".`)))}getFilter(o){return y.bK(this.getLayer(o).filter)}setLayoutProperty(o,u,f,_={}){this._checkLoaded();const x=this.getLayer(o);x?y.bH(x.getLayoutProperty(u),f)||(x.setLayoutProperty(u,f,_),this._updateLayer(x)):this.fire(new y.k(new Error(`Cannot style non-existing layer "${o}".`)))}getLayoutProperty(o,u){const f=this.getLayer(o);if(f)return f.getLayoutProperty(u);this.fire(new y.k(new Error(`Cannot get style of non-existing layer "${o}".`)))}setPaintProperty(o,u,f,_={}){this._checkLoaded();const x=this.getLayer(o);x?y.bH(x.getPaintProperty(u),f)||(x.setPaintProperty(u,f,_)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[o]=!0,this._serializedLayers=null):this.fire(new y.k(new Error(`Cannot style non-existing layer "${o}".`)))}getPaintProperty(o,u){return this.getLayer(o).getPaintProperty(u)}setFeatureState(o,u){this._checkLoaded();const f=o.source,_=o.sourceLayer,x=this.sourceCaches[f];if(void 0===x)return void this.fire(new y.k(new Error(`The source '${f}' does not exist in the map's style.`)));const S=x.getSource().type;"geojson"===S&&_?this.fire(new y.k(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==S||_?(void 0===o.id&&this.fire(new y.k(new Error("The feature id parameter must be provided."))),x.setFeatureState(_,o.id,u)):this.fire(new y.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(o,u){this._checkLoaded();const f=o.source,_=this.sourceCaches[f];if(void 0===_)return void this.fire(new y.k(new Error(`The source '${f}' does not exist in the map's style.`)));const x=_.getSource().type,S="vector"===x?o.sourceLayer:void 0;"vector"!==x||S?u&&"string"!=typeof o.id&&"number"!=typeof o.id?this.fire(new y.k(new Error("A feature id is required to remove its specific state property."))):_.removeFeatureState(S,o.id,u):this.fire(new y.k(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(o){this._checkLoaded();const u=o.source,f=o.sourceLayer,_=this.sourceCaches[u];if(void 0!==_)return"vector"!==_.getSource().type||f?(void 0===o.id&&this.fire(new y.k(new Error("The feature id parameter must be provided."))),_.getFeatureState(f,o.id)):void this.fire(new y.k(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new y.k(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return y.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const o=y.bN(this.sourceCaches,x=>x.serialize()),u=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,_=this.stylesheet;return y.bO({version:_.version,name:_.name,metadata:_.metadata,light:_.light,sky:_.sky,center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch,sprite:_.sprite,glyphs:_.glyphs,transition:_.transition,projection:_.projection,sources:o,layers:u,terrain:f},x=>void 0!==x)}_updateLayer(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&"raster"!==this.sourceCaches[o.source].getSource().type&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(o){const u=S=>"fill-extrusion"===this._layers[S].type,f={},_=[];for(let S=this._order.length-1;S>=0;S--){const I=this._order[S];if(u(I)){f[I]=S;for(const D of o){const N=D[I];if(N)for(const F of N)_.push(F)}}}_.sort((S,I)=>I.intersectionZ-S.intersectionZ);const x=[];for(let S=this._order.length-1;S>=0;S--){const I=this._order[S];if(u(I))for(let D=_.length-1;D>=0;D--){const N=_[D].feature;if(f[N.layer.id]<S)break;x.push(N),_.pop()}else for(const D of o){const N=D[I];if(N)for(const F of N)x.push(F.feature)}}return x}queryRenderedFeatures(o,u,f){u&&u.filter&&this._validate(y.z.filter,"queryRenderedFeatures.filter",u.filter,null,u);const _={};if(u&&u.layers){if(!(Array.isArray(u.layers)||u.layers instanceof Set))return this.fire(new y.k(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const N of u.layers){const F=this._layers[N];if(!F)return this.fire(new y.k(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];_[F.source]=!0}}const x=[];u.availableImages=this._availableImages;const S=this._serializedAllLayers(),I=u.layers instanceof Set?u.layers:Array.isArray(u.layers)?new Set(u.layers):null,D=Object.assign(Object.assign({},u),{layers:I});for(const N in this.sourceCaches)u.layers&&!_[N]||x.push(Lt(this.sourceCaches[N],this._layers,S,o,D,f,this.map.terrain?(F,U,V)=>this.map.terrain.getElevation(F,U,V):void 0));return this.placement&&x.push(function(N,F,U,V,H,Y,oe){const re={},ie=Y.queryRenderedSymbols(V),ue=[];for(const pe of Object.keys(ie).map(Number))ue.push(oe[pe]);ue.sort(li);for(const pe of ue){const he=pe.featureIndex.lookupSymbolFeatures(ie[pe.bucketInstanceId],F,pe.bucketIndex,pe.sourceLayerIndex,H.filter,H.layers,H.availableImages,N);for(const me in he){const ve=re[me]=re[me]||[],fe=he[me];fe.sort((Te,Be)=>{const ke=pe.featureSortOrder;if(ke){const Oe=ke.indexOf(Te.featureIndex);return ke.indexOf(Be.featureIndex)-Oe}return Be.featureIndex-Te.featureIndex});for(const Te of fe)ve.push(Te)}}return function(pe,he,me){for(const ve in pe)for(const fe of pe[ve])oa(fe,me[he[ve].source]);return pe}(re,N,U)}(this._layers,S,this.sourceCaches,o,D,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(o,u){u&&u.filter&&this._validate(y.z.filter,"querySourceFeatures.filter",u.filter,null,u);const f=this.sourceCaches[o];return f?function(_,x){const S=_.getRenderableIds().map(N=>_.getTileByID(N)),I=[],D={};for(let N=0;N<S.length;N++){const F=S[N],U=F.tileID.canonical.key;D[U]||(D[U]=!0,F.querySourceFeatures(I,x))}return I}(f,u):[]}getLight(){return this.light.getLight()}setLight(o,u={}){this._checkLoaded();const f=this.light.getLight();let _=!1;for(const S in o)if(!y.bH(o[S],f[S])){_=!0;break}if(!_)return;const x={now:mt.now(),transition:y.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,u),this.light.updateTransitions(x)}getProjection(){var o;return null===(o=this.stylesheet)||void 0===o?void 0:o.projection}setProjection(o){if(this._checkLoaded(),this.projection){if(this.projection.name===o.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=o,this._setProjectionInternal(o.type)}getSky(){var o;return null===(o=this.stylesheet)||void 0===o?void 0:o.sky}setSky(o,u={}){this._checkLoaded();const f=this.getSky();let _=!1;if(!o&&!f)return;if(o&&!f)_=!0;else if(!o&&f)_=!0;else for(const S in o)if(!y.bH(o[S],f[S])){_=!0;break}if(!_)return;const x={now:mt.now(),transition:y.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=o,this.sky.setSky(o,u),this.sky.updateTransitions(x)}_setProjectionInternal(o){const u=function(f){if(Array.isArray(f)){const _=new hc({type:f});return{projection:_,transform:new Fa,cameraHelper:new fc(_)}}switch(f){case"mercator":return{projection:new Qt,transform:new Dn,cameraHelper:new Nn};case"globe":{const _=new hc({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:_,transform:new Fa,cameraHelper:new fc(_)}}case"vertical-perspective":return{projection:new da,transform:new ha,cameraHelper:new to};default:return y.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new Qt,transform:new Dn,cameraHelper:new Nn}}}(o);this.projection=u.projection,this.map.migrateProjection(u.transform,u.cameraHelper);for(const f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(o,u,f,_,x={}){return(!x||!1!==x.validate)&&pc(this,o.call(y.z,y.e({key:u,style:this.serialize(),value:f,styleSpec:y.v},_)))}_remove(o=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Go().off(ci,this._rtlPluginLoaded);for(const u in this._layers)this._layers[u].setEventedParent(null);for(const u in this.sourceCaches){const f=this.sourceCaches[u];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),o&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(o)}_clearSource(o){this.sourceCaches[o].clearTiles()}_reloadSource(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()}_updateSources(o){for(const u in this.sourceCaches)this.sourceCaches[u].update(o,this.map.terrain)}_generateCollisionBoxes(){for(const o in this.sourceCaches)this._reloadSource(o)}_updatePlacement(o,u,f,_,x=!1){let S=!1,I=!1;const D={};for(const N of this._order){const F=this._layers[N];if("symbol"!==F.type)continue;if(!D[F.source]){const V=this.sourceCaches[F.source];D[F.source]=V.getRenderableIds(!0).map(H=>V.getTileByID(H)).sort((H,Y)=>Y.tileID.overscaledZ-H.tileID.overscaledZ||(H.tileID.isLessThan(Y.tileID)?-1:1))}const U=this.crossTileSymbolIndex.addLayer(F,D[F.source],o.center.lng);S=S||U}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((x=x||this._layerOrderChanged||0===f)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(mt.now(),o.zoom))&&(this.pauseablePlacement=new fi(o,this.map.terrain,this._order,x,u,f,_,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,D),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(mt.now()),I=!0),S&&this.pauseablePlacement.placement.setStale()),I||S)for(const N of this._order){const F=this._layers[N];"symbol"===F.type&&this.placement.updateLayerOpacities(F,D[F.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(mt.now())}_releaseSymbolFadeTiles(){for(const o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,u){return y._(this,void 0,void 0,function*(){const f=yield this.imageManager.getImages(u.icons);this._updateTilesForChangedImages();const _=this.sourceCaches[u.source];return _&&_.setDependencies(u.tileID.key,u.type,u.icons),f})}getGlyphs(o,u){return y._(this,void 0,void 0,function*(){const f=yield this.glyphManager.getGlyphs(u.stacks),_=this.sourceCaches[u.source];return _&&_.setDependencies(u.tileID.key,u.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(o,u={}){this._checkLoaded(),o&&this._validate(y.z.glyphs,"glyphs",o,null,u)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=o,this.glyphManager.entries={},this.glyphManager.setURL(o))}addSprite(o,u,f={},_){this._checkLoaded();const x=[{id:o,url:u}],S=[...zt(this.stylesheet.sprite),...x];this._validate(y.z.sprite,"sprite",S,null,f)||(this.stylesheet.sprite=S,this._loadSprite(x,!0,_))}removeSprite(o){this._checkLoaded();const u=zt(this.stylesheet.sprite);if(u.find(f=>f.id===o)){if(this._spritesImagesIds[o])for(const f of this._spritesImagesIds[o])this.imageManager.removeImage(f),this._changedImages[f]=!0;u.splice(u.findIndex(f=>f.id===o),1),this.stylesheet.sprite=u.length>0?u:void 0,delete this._spritesImagesIds[o],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new y.l("data",{dataType:"style"}))}else this.fire(new y.k(new Error(`Sprite "${o}" doesn't exists on this map.`)))}getSprite(){return zt(this.stylesheet.sprite)}setSprite(o,u={},f){this._checkLoaded(),o&&this._validate(y.z.sprite,"sprite",o,null,u)||(this.stylesheet.sprite=o,o?this._loadSprite(o,!0,f):(this._unloadSprite(),f&&f(null)))}}var cd=y.aJ([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class ud{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(o,u,f,_,x,S,I,D,N){this.context=o;let F=this.boundPaintVertexBuffers.length!==_.length;for(let U=0;!F&&U<_.length;U++)this.boundPaintVertexBuffers[U]!==_[U]&&(F=!0);!this.vao||this.boundProgram!==u||this.boundLayoutVertexBuffer!==f||F||this.boundIndexBuffer!==x||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==I||this.boundDynamicVertexBuffer2!==D||this.boundDynamicVertexBuffer3!==N?this.freshBind(u,f,_,x,S,I,D,N):(o.bindVertexArray.set(this.vao),I&&I.bind(),x&&x.dynamicDraw&&x.bind(),D&&D.bind(),N&&N.bind())}freshBind(o,u,f,_,x,S,I,D){const N=o.numAttributes,F=this.context,U=F.gl;this.vao&&this.destroy(),this.vao=F.createVertexArray(),F.bindVertexArray.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=_,this.boundVertexOffset=x,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=I,this.boundDynamicVertexBuffer3=D,u.enableAttributes(U,o);for(const V of f)V.enableAttributes(U,o);S&&S.enableAttributes(U,o),I&&I.enableAttributes(U,o),D&&D.enableAttributes(U,o),u.bind(),u.setVertexAttribPointers(U,o,x);for(const V of f)V.bind(),V.setVertexAttribPointers(U,o,x);S&&(S.bind(),S.setVertexAttribPointers(U,o,x)),_&&_.bind(),I&&(I.bind(),I.setVertexAttribPointers(U,o,x)),D&&(D.bind(),D.setVertexAttribPointers(U,o,x)),F.currentNumAttributes=N}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const is=(b,o,u,f,_)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:o,u_fog_color:u?u.properties.get("fog-color"):y.bf.white,u_fog_ground_blend:u?u.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:_?0:u?u.calculateFogBlendOpacity(f):0,u_horizon_color:u?u.properties.get("horizon-color"):y.bf.white,u_horizon_fog_blend:u?u.properties.get("horizon-fog-blend"):1,u_is_globe_mode:_?1:0}),Ba={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Ns(b){const o=[];for(let u=0;u<b.length;u++){if(null===b[u])continue;const f=b[u].split(" ");o.push(f.pop())}return o}class yl{constructor(o,u,f,_,x,S,I,D,N=[]){const F=o.gl;this.program=F.createProgram();const U=Ns(u.staticAttributes),V=f?f.getBinderAttributes():[],H=U.concat(V),Y=co.prelude.staticUniforms?Ns(co.prelude.staticUniforms):[],oe=I.staticUniforms?Ns(I.staticUniforms):[],re=u.staticUniforms?Ns(u.staticUniforms):[],ie=f?f.getBinderUniforms():[],ue=Y.concat(oe).concat(re).concat(ie),pe=[];for(const ke of ue)pe.indexOf(ke)<0&&pe.push(ke);const he=f?f.defines():[];eo(F)&&he.unshift("#version 300 es"),x&&he.push("#define OVERDRAW_INSPECTOR;"),S&&he.push("#define TERRAIN3D;"),D&&he.push(D),N&&he.push(...N);let me=he.concat(co.prelude.fragmentSource,I.fragmentSource,u.fragmentSource).join("\n"),ve=he.concat(co.prelude.vertexSource,I.vertexSource,u.vertexSource).join("\n");eo(F)||(me=me.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D("),ve=ve.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D("));const fe=F.createShader(F.FRAGMENT_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(fe,me),F.compileShader(fe),!F.getShaderParameter(fe,F.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${F.getShaderInfoLog(fe)}`);F.attachShader(this.program,fe);const Te=F.createShader(F.VERTEX_SHADER);if(F.isContextLost())return void(this.failedToCreate=!0);if(F.shaderSource(Te,ve),F.compileShader(Te),!F.getShaderParameter(Te,F.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${F.getShaderInfoLog(Te)}`);F.attachShader(this.program,Te),this.attributes={};const Be={};this.numAttributes=H.length;for(let ke=0;ke<this.numAttributes;ke++)H[ke]&&(F.bindAttribLocation(this.program,ke,H[ke]),this.attributes[H[ke]]=ke);if(F.linkProgram(this.program),!F.getProgramParameter(this.program,F.LINK_STATUS))throw new Error(`Program failed to link: ${F.getProgramInfoLog(this.program)}`);F.deleteShader(Te),F.deleteShader(fe);for(let ke=0;ke<pe.length;ke++){const Oe=pe[ke];if(Oe&&!Be[Oe]){const Fe=F.getUniformLocation(this.program,Oe);Fe&&(Be[Oe]=Fe)}}this.fixedUniforms=_(o,Be),this.terrainUniforms=((ke,Oe)=>({u_depth:new y.bP(ke,Oe.u_depth),u_terrain:new y.bP(ke,Oe.u_terrain),u_terrain_dim:new y.bg(ke,Oe.u_terrain_dim),u_terrain_matrix:new y.bR(ke,Oe.u_terrain_matrix),u_terrain_unpack:new y.bS(ke,Oe.u_terrain_unpack),u_terrain_exaggeration:new y.bg(ke,Oe.u_terrain_exaggeration)}))(o,Be),this.projectionUniforms=((ke,Oe)=>({u_projection_matrix:new y.bR(ke,Oe.u_projection_matrix),u_projection_tile_mercator_coords:new y.bS(ke,Oe.u_projection_tile_mercator_coords),u_projection_clipping_plane:new y.bS(ke,Oe.u_projection_clipping_plane),u_projection_transition:new y.bg(ke,Oe.u_projection_transition),u_projection_fallback_matrix:new y.bR(ke,Oe.u_projection_fallback_matrix)}))(o,Be),this.binderUniforms=f?f.getUniforms(o,Be):[]}draw(o,u,f,_,x,S,I,D,N,F,U,V,H,Y,oe,re,ie,ue,pe){const he=o.gl;if(this.failedToCreate)return;if(o.program.set(this.program),o.setDepthMode(f),o.setStencilMode(_),o.setColorMode(x),o.setCullFace(S),D){o.activeTexture.set(he.TEXTURE2),he.bindTexture(he.TEXTURE_2D,D.depthTexture),o.activeTexture.set(he.TEXTURE3),he.bindTexture(he.TEXTURE_2D,D.texture);for(const ve in this.terrainUniforms)this.terrainUniforms[ve].set(D[ve])}if(N)for(const ve in N)this.projectionUniforms[Ba[ve]].set(N[ve]);if(I)for(const ve in this.fixedUniforms)this.fixedUniforms[ve].set(I[ve]);re&&re.setUniforms(o,this.binderUniforms,Y,{zoom:oe});let me=0;switch(u){case he.LINES:me=2;break;case he.TRIANGLES:me=3;break;case he.LINE_STRIP:me=1}for(const ve of H.get()){const fe=ve.vaos||(ve.vaos={});(fe[F]||(fe[F]=new ud)).bind(o,this,U,re?re.getPaintVertexBuffers():[],V,ve.vertexOffset,ie,ue,pe),he.drawElements(u,ve.primitiveLength*me,he.UNSIGNED_SHORT,ve.primitiveOffset*me*2)}}}function vl(b,o,u){const f=1/y.aC(u,1,o.transform.tileZoom),_=Math.pow(2,u.tileID.overscaledZ),x=u.tileSize*Math.pow(2,o.transform.tileZoom)/_,S=x*(u.tileID.canonical.x+u.tileID.wrap*_),I=x*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[f,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[S>>16,I>>16],u_pixel_coord_lower:[65535&S,65535&I]}}const mi=(b,o,u,f)=>{const _=b.style.light,x=_.properties.get("position"),S=[x.x,x.y,x.z],I=y.bV();"viewport"===_.properties.get("anchor")&&y.bW(I,b.transform.bearingInRadians),y.bX(S,S,I);const D=b.transform.transformLightDirection(S),N=_.properties.get("color");return{u_lightpos:S,u_lightpos_globe:D,u_lightintensity:_.properties.get("intensity"),u_lightcolor:[N.r,N.g,N.b],u_vertical_gradient:+o,u_opacity:u,u_fill_translate:f}},Ah=(b,o,u,f,_,x,S)=>y.e(mi(b,o,u,f),vl(x,b,S),{u_height_factor:-Math.pow(2,_.overscaledZ)/S.tileSize/8}),Fi=(b,o,u,f)=>y.e(vl(o,b,u),{u_fill_translate:f}),bl=(b,o)=>({u_world:b,u_fill_translate:o}),xl=(b,o,u,f,_)=>y.e(Fi(b,o,u,_),{u_world:f}),dd=(b,o,u,f,_)=>{const x=b.transform;let S,I,D=0;if("map"===u.paint.get("circle-pitch-alignment")){const N=y.aC(o,1,x.zoom);S=!0,I=[N,N],D=N/(y.$*Math.pow(2,o.tileID.overscaledZ))*2*Math.PI*_}else S=!1,I=x.pixelsToGLUnits;return{u_camera_to_center_distance:x.cameraToCenterDistance,u_scale_with_map:+("map"===u.paint.get("circle-pitch-scale")),u_pitch_with_map:+S,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:I,u_globe_extrude_scale:D,u_translate:f}},mc=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),_c=b=>({u_viewport_size:[b.width,b.height]}),Bi=(b,o=1)=>({u_color:b,u_overlay:0,u_overlay_scale:o}),hd=(b,o,u,f)=>{const _=y.aC(b,1,o)/(y.$*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:y.aC(b,1,o),u_intensity:u,u_globe_extrude_scale:_}},au=(b,o,u,f)=>{const _=y.L();y.bY(_,0,b.width,b.height,0,0,1);const x=b.context.gl;return{u_matrix:_,u_world:[x.drawingBufferWidth,x.drawingBufferHeight],u_image:u,u_color_ramp:f,u_opacity:o.paint.get("heatmap-opacity")}},Ph=(b,o,u)=>{const f=u.paint.get("hillshade-accent-color");let _;switch(u.paint.get("hillshade-method")){case"basic":_=4;break;case"combined":_=1;break;case"igor":_=2;break;case"multidirectional":_=3;break;default:_=0}const x=u.getIlluminationProperties();for(let S=0;S<x.directionRadians.length;S++)"viewport"===u.paint.get("hillshade-illumination-anchor")&&(x.directionRadians[S]+=b.transform.bearingInRadians);return{u_image:0,u_latrange:wl(0,o.tileID),u_exaggeration:u.paint.get("hillshade-exaggeration"),u_altitudes:x.altitudeRadians,u_azimuths:x.directionRadians,u_accent:f,u_method:_,u_highlights:x.highlightColor,u_shadows:x.shadowColor}},lu=(b,o)=>{const u=o.stride,f=y.L();return y.bY(f,0,y.$,-y.$,0,0,1),y.M(f,f,[0,-y.$,0]),{u_matrix:f,u_image:1,u_dimension:[u,u],u_zoom:b.overscaledZ,u_unpack:o.getUnpackVector()}};function wl(b,o){const u=Math.pow(2,o.canonical.z),f=o.canonical.y;return[new y.a1(0,f/u).toLngLat().lat,new y.a1(0,(f+1)/u).toLngLat().lat]}const Cl=(b,o,u=0)=>({u_image:0,u_unpack:o.getUnpackVector(),u_dimension:[o.stride,o.stride],u_elevation_stops:1,u_color_stops:4,u_color_ramp_size:u,u_opacity:b.paint.get("color-relief-opacity")}),Oo=(b,o,u,f)=>{const _=b.transform;return{u_translation:pd(b,o,u),u_ratio:f/y.aC(o,1,_.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/_.pixelsToGLUnits[0],1/_.pixelsToGLUnits[1]]}},za=(b,o,u,f,_)=>y.e(Oo(b,o,u,f),{u_image:0,u_image_height:_}),fd=(b,o,u,f,_)=>{const x=b.transform,S=Fs(o,x);return{u_translation:pd(b,o,u),u_texsize:o.imageAtlasTexture.size,u_ratio:f/y.aC(o,1,x.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[S,_.fromScale,_.toScale],u_fade:_.t,u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]]}},Ls=(b,o,u,f,_,x)=>{const S=b.lineAtlas,I=Fs(o,b.transform),D="round"===u.layout.get("line-cap"),N=S.getDash(_.from,D),F=S.getDash(_.to,D),U=N.width*x.fromScale,V=F.width*x.toScale;return y.e(Oo(b,o,u,f),{u_patternscale_a:[I/U,-N.height/2],u_patternscale_b:[I/V,-F.height/2],u_sdfgamma:S.width/(256*Math.min(U,V)*b.pixelRatio)/2,u_image:0,u_tex_y_a:N.y,u_tex_y_b:F.y,u_mix:x.t})};function Fs(b,o){return 1/y.aC(b,1,o.tileZoom)}function pd(b,o,u){return y.aD(b.transform,o,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const yc=(b,o,u,f,_)=>{return{u_tl_parent:b,u_scale_parent:o,u_buffer_scale:1,u_fade_t:u.mix,u_opacity:u.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(S=f.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(x=f.paint.get("raster-contrast"),x>0?1/(1-x):1+x),u_spin_weights:kh(f.paint.get("raster-hue-rotate")),u_coords_top:[_[0].x,_[0].y,_[1].x,_[1].y],u_coords_bottom:[_[3].x,_[3].y,_[2].x,_[2].y]};var x,S};function kh(b){b*=Math.PI/180;const o=Math.sin(b),u=Math.cos(b);return[(2*u+1)/3,(-Math.sqrt(3)*o-u+1)/3,(Math.sqrt(3)*o-u+1)/3]}const fa=(b,o,u,f,_,x,S,I,D,N,F,U,V)=>{const H=S.transform;return{u_is_size_zoom_constant:+("constant"===b||"source"===b),u_is_size_feature_constant:+("constant"===b||"camera"===b),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:H.cameraToCenterDistance,u_pitch:H.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:H.width/H.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:I,u_coord_matrix:D,u_is_text:+F,u_pitch_with_map:+f,u_is_along_line:_,u_is_variable_anchor:x,u_texsize:U,u_texture:0,u_translation:N,u_pitched_scale:V}},gd=(b,o,u,f,_,x,S,I,D,N,F,U,V,H)=>{const Y=S.transform;return y.e(fa(b,o,u,f,_,x,S,I,D,N,F,U,H),{u_gamma_scale:f?Math.cos(Y.pitch*Math.PI/180)*Y.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},Vf=(b,o,u,f,_,x,S,I,D,N,F,U,V)=>y.e(gd(b,o,u,f,_,x,S,I,D,N,!0,F,0,V),{u_texsize_icon:U,u_texture_icon:1}),cu=(b,o)=>({u_opacity:b,u_color:o}),Bs=(b,o,u,f,_)=>y.e(function(x,S,I,D){const N=I.imageManager.getPattern(x.from.toString()),F=I.imageManager.getPattern(x.to.toString()),{width:U,height:V}=I.imageManager.getPixelSize(),H=Math.pow(2,D.tileID.overscaledZ),Y=D.tileSize*Math.pow(2,I.transform.tileZoom)/H,oe=Y*(D.tileID.canonical.x+D.tileID.wrap*H),re=Y*D.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:N.tl,u_pattern_br_a:N.br,u_pattern_tl_b:F.tl,u_pattern_br_b:F.br,u_texsize:[U,V],u_mix:S.t,u_pattern_size_a:N.displaySize,u_pattern_size_b:F.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/y.aC(D,1,I.transform.tileZoom),u_pixel_coord_upper:[oe>>16,re>>16],u_pixel_coord_lower:[65535&oe,65535&re]}}(u,_,o,f),{u_opacity:b}),vc=(b,o)=>{},Sl={fillExtrusion:(b,o)=>({u_lightpos:new y.bT(b,o.u_lightpos),u_lightpos_globe:new y.bT(b,o.u_lightpos_globe),u_lightintensity:new y.bg(b,o.u_lightintensity),u_lightcolor:new y.bT(b,o.u_lightcolor),u_vertical_gradient:new y.bg(b,o.u_vertical_gradient),u_opacity:new y.bg(b,o.u_opacity),u_fill_translate:new y.bU(b,o.u_fill_translate)}),fillExtrusionPattern:(b,o)=>({u_lightpos:new y.bT(b,o.u_lightpos),u_lightpos_globe:new y.bT(b,o.u_lightpos_globe),u_lightintensity:new y.bg(b,o.u_lightintensity),u_lightcolor:new y.bT(b,o.u_lightcolor),u_vertical_gradient:new y.bg(b,o.u_vertical_gradient),u_height_factor:new y.bg(b,o.u_height_factor),u_opacity:new y.bg(b,o.u_opacity),u_fill_translate:new y.bU(b,o.u_fill_translate),u_image:new y.bP(b,o.u_image),u_texsize:new y.bU(b,o.u_texsize),u_pixel_coord_upper:new y.bU(b,o.u_pixel_coord_upper),u_pixel_coord_lower:new y.bU(b,o.u_pixel_coord_lower),u_scale:new y.bT(b,o.u_scale),u_fade:new y.bg(b,o.u_fade)}),fill:(b,o)=>({u_fill_translate:new y.bU(b,o.u_fill_translate)}),fillPattern:(b,o)=>({u_image:new y.bP(b,o.u_image),u_texsize:new y.bU(b,o.u_texsize),u_pixel_coord_upper:new y.bU(b,o.u_pixel_coord_upper),u_pixel_coord_lower:new y.bU(b,o.u_pixel_coord_lower),u_scale:new y.bT(b,o.u_scale),u_fade:new y.bg(b,o.u_fade),u_fill_translate:new y.bU(b,o.u_fill_translate)}),fillOutline:(b,o)=>({u_world:new y.bU(b,o.u_world),u_fill_translate:new y.bU(b,o.u_fill_translate)}),fillOutlinePattern:(b,o)=>({u_world:new y.bU(b,o.u_world),u_image:new y.bP(b,o.u_image),u_texsize:new y.bU(b,o.u_texsize),u_pixel_coord_upper:new y.bU(b,o.u_pixel_coord_upper),u_pixel_coord_lower:new y.bU(b,o.u_pixel_coord_lower),u_scale:new y.bT(b,o.u_scale),u_fade:new y.bg(b,o.u_fade),u_fill_translate:new y.bU(b,o.u_fill_translate)}),circle:(b,o)=>({u_camera_to_center_distance:new y.bg(b,o.u_camera_to_center_distance),u_scale_with_map:new y.bP(b,o.u_scale_with_map),u_pitch_with_map:new y.bP(b,o.u_pitch_with_map),u_extrude_scale:new y.bU(b,o.u_extrude_scale),u_device_pixel_ratio:new y.bg(b,o.u_device_pixel_ratio),u_globe_extrude_scale:new y.bg(b,o.u_globe_extrude_scale),u_translate:new y.bU(b,o.u_translate)}),collisionBox:(b,o)=>({u_pixel_extrude_scale:new y.bU(b,o.u_pixel_extrude_scale)}),collisionCircle:(b,o)=>({u_viewport_size:new y.bU(b,o.u_viewport_size)}),debug:(b,o)=>({u_color:new y.bQ(b,o.u_color),u_overlay:new y.bP(b,o.u_overlay),u_overlay_scale:new y.bg(b,o.u_overlay_scale)}),depth:vc,clippingMask:vc,heatmap:(b,o)=>({u_extrude_scale:new y.bg(b,o.u_extrude_scale),u_intensity:new y.bg(b,o.u_intensity),u_globe_extrude_scale:new y.bg(b,o.u_globe_extrude_scale)}),heatmapTexture:(b,o)=>({u_matrix:new y.bR(b,o.u_matrix),u_world:new y.bU(b,o.u_world),u_image:new y.bP(b,o.u_image),u_color_ramp:new y.bP(b,o.u_color_ramp),u_opacity:new y.bg(b,o.u_opacity)}),hillshade:(b,o)=>({u_image:new y.bP(b,o.u_image),u_latrange:new y.bU(b,o.u_latrange),u_exaggeration:new y.bg(b,o.u_exaggeration),u_altitudes:new y.b_(b,o.u_altitudes),u_azimuths:new y.b_(b,o.u_azimuths),u_accent:new y.bQ(b,o.u_accent),u_method:new y.bP(b,o.u_method),u_shadows:new y.bZ(b,o.u_shadows),u_highlights:new y.bZ(b,o.u_highlights)}),hillshadePrepare:(b,o)=>({u_matrix:new y.bR(b,o.u_matrix),u_image:new y.bP(b,o.u_image),u_dimension:new y.bU(b,o.u_dimension),u_zoom:new y.bg(b,o.u_zoom),u_unpack:new y.bS(b,o.u_unpack)}),colorRelief:(b,o)=>({u_image:new y.bP(b,o.u_image),u_unpack:new y.bS(b,o.u_unpack),u_dimension:new y.bU(b,o.u_dimension),u_elevation_stops:new y.bP(b,o.u_elevation_stops),u_color_stops:new y.bP(b,o.u_color_stops),u_color_ramp_size:new y.bP(b,o.u_color_ramp_size),u_opacity:new y.bg(b,o.u_opacity)}),line:(b,o)=>({u_translation:new y.bU(b,o.u_translation),u_ratio:new y.bg(b,o.u_ratio),u_device_pixel_ratio:new y.bg(b,o.u_device_pixel_ratio),u_units_to_pixels:new y.bU(b,o.u_units_to_pixels)}),lineGradient:(b,o)=>({u_translation:new y.bU(b,o.u_translation),u_ratio:new y.bg(b,o.u_ratio),u_device_pixel_ratio:new y.bg(b,o.u_device_pixel_ratio),u_units_to_pixels:new y.bU(b,o.u_units_to_pixels),u_image:new y.bP(b,o.u_image),u_image_height:new y.bg(b,o.u_image_height)}),linePattern:(b,o)=>({u_translation:new y.bU(b,o.u_translation),u_texsize:new y.bU(b,o.u_texsize),u_ratio:new y.bg(b,o.u_ratio),u_device_pixel_ratio:new y.bg(b,o.u_device_pixel_ratio),u_image:new y.bP(b,o.u_image),u_units_to_pixels:new y.bU(b,o.u_units_to_pixels),u_scale:new y.bT(b,o.u_scale),u_fade:new y.bg(b,o.u_fade)}),lineSDF:(b,o)=>({u_translation:new y.bU(b,o.u_translation),u_ratio:new y.bg(b,o.u_ratio),u_device_pixel_ratio:new y.bg(b,o.u_device_pixel_ratio),u_units_to_pixels:new y.bU(b,o.u_units_to_pixels),u_patternscale_a:new y.bU(b,o.u_patternscale_a),u_patternscale_b:new y.bU(b,o.u_patternscale_b),u_sdfgamma:new y.bg(b,o.u_sdfgamma),u_image:new y.bP(b,o.u_image),u_tex_y_a:new y.bg(b,o.u_tex_y_a),u_tex_y_b:new y.bg(b,o.u_tex_y_b),u_mix:new y.bg(b,o.u_mix)}),raster:(b,o)=>({u_tl_parent:new y.bU(b,o.u_tl_parent),u_scale_parent:new y.bg(b,o.u_scale_parent),u_buffer_scale:new y.bg(b,o.u_buffer_scale),u_fade_t:new y.bg(b,o.u_fade_t),u_opacity:new y.bg(b,o.u_opacity),u_image0:new y.bP(b,o.u_image0),u_image1:new y.bP(b,o.u_image1),u_brightness_low:new y.bg(b,o.u_brightness_low),u_brightness_high:new y.bg(b,o.u_brightness_high),u_saturation_factor:new y.bg(b,o.u_saturation_factor),u_contrast_factor:new y.bg(b,o.u_contrast_factor),u_spin_weights:new y.bT(b,o.u_spin_weights),u_coords_top:new y.bS(b,o.u_coords_top),u_coords_bottom:new y.bS(b,o.u_coords_bottom)}),symbolIcon:(b,o)=>({u_is_size_zoom_constant:new y.bP(b,o.u_is_size_zoom_constant),u_is_size_feature_constant:new y.bP(b,o.u_is_size_feature_constant),u_size_t:new y.bg(b,o.u_size_t),u_size:new y.bg(b,o.u_size),u_camera_to_center_distance:new y.bg(b,o.u_camera_to_center_distance),u_pitch:new y.bg(b,o.u_pitch),u_rotate_symbol:new y.bP(b,o.u_rotate_symbol),u_aspect_ratio:new y.bg(b,o.u_aspect_ratio),u_fade_change:new y.bg(b,o.u_fade_change),u_label_plane_matrix:new y.bR(b,o.u_label_plane_matrix),u_coord_matrix:new y.bR(b,o.u_coord_matrix),u_is_text:new y.bP(b,o.u_is_text),u_pitch_with_map:new y.bP(b,o.u_pitch_with_map),u_is_along_line:new y.bP(b,o.u_is_along_line),u_is_variable_anchor:new y.bP(b,o.u_is_variable_anchor),u_texsize:new y.bU(b,o.u_texsize),u_texture:new y.bP(b,o.u_texture),u_translation:new y.bU(b,o.u_translation),u_pitched_scale:new y.bg(b,o.u_pitched_scale)}),symbolSDF:(b,o)=>({u_is_size_zoom_constant:new y.bP(b,o.u_is_size_zoom_constant),u_is_size_feature_constant:new y.bP(b,o.u_is_size_feature_constant),u_size_t:new y.bg(b,o.u_size_t),u_size:new y.bg(b,o.u_size),u_camera_to_center_distance:new y.bg(b,o.u_camera_to_center_distance),u_pitch:new y.bg(b,o.u_pitch),u_rotate_symbol:new y.bP(b,o.u_rotate_symbol),u_aspect_ratio:new y.bg(b,o.u_aspect_ratio),u_fade_change:new y.bg(b,o.u_fade_change),u_label_plane_matrix:new y.bR(b,o.u_label_plane_matrix),u_coord_matrix:new y.bR(b,o.u_coord_matrix),u_is_text:new y.bP(b,o.u_is_text),u_pitch_with_map:new y.bP(b,o.u_pitch_with_map),u_is_along_line:new y.bP(b,o.u_is_along_line),u_is_variable_anchor:new y.bP(b,o.u_is_variable_anchor),u_texsize:new y.bU(b,o.u_texsize),u_texture:new y.bP(b,o.u_texture),u_gamma_scale:new y.bg(b,o.u_gamma_scale),u_device_pixel_ratio:new y.bg(b,o.u_device_pixel_ratio),u_is_halo:new y.bP(b,o.u_is_halo),u_translation:new y.bU(b,o.u_translation),u_pitched_scale:new y.bg(b,o.u_pitched_scale)}),symbolTextAndIcon:(b,o)=>({u_is_size_zoom_constant:new y.bP(b,o.u_is_size_zoom_constant),u_is_size_feature_constant:new y.bP(b,o.u_is_size_feature_constant),u_size_t:new y.bg(b,o.u_size_t),u_size:new y.bg(b,o.u_size),u_camera_to_center_distance:new y.bg(b,o.u_camera_to_center_distance),u_pitch:new y.bg(b,o.u_pitch),u_rotate_symbol:new y.bP(b,o.u_rotate_symbol),u_aspect_ratio:new y.bg(b,o.u_aspect_ratio),u_fade_change:new y.bg(b,o.u_fade_change),u_label_plane_matrix:new y.bR(b,o.u_label_plane_matrix),u_coord_matrix:new y.bR(b,o.u_coord_matrix),u_is_text:new y.bP(b,o.u_is_text),u_pitch_with_map:new y.bP(b,o.u_pitch_with_map),u_is_along_line:new y.bP(b,o.u_is_along_line),u_is_variable_anchor:new y.bP(b,o.u_is_variable_anchor),u_texsize:new y.bU(b,o.u_texsize),u_texsize_icon:new y.bU(b,o.u_texsize_icon),u_texture:new y.bP(b,o.u_texture),u_texture_icon:new y.bP(b,o.u_texture_icon),u_gamma_scale:new y.bg(b,o.u_gamma_scale),u_device_pixel_ratio:new y.bg(b,o.u_device_pixel_ratio),u_is_halo:new y.bP(b,o.u_is_halo),u_translation:new y.bU(b,o.u_translation),u_pitched_scale:new y.bg(b,o.u_pitched_scale)}),background:(b,o)=>({u_opacity:new y.bg(b,o.u_opacity),u_color:new y.bQ(b,o.u_color)}),backgroundPattern:(b,o)=>({u_opacity:new y.bg(b,o.u_opacity),u_image:new y.bP(b,o.u_image),u_pattern_tl_a:new y.bU(b,o.u_pattern_tl_a),u_pattern_br_a:new y.bU(b,o.u_pattern_br_a),u_pattern_tl_b:new y.bU(b,o.u_pattern_tl_b),u_pattern_br_b:new y.bU(b,o.u_pattern_br_b),u_texsize:new y.bU(b,o.u_texsize),u_mix:new y.bg(b,o.u_mix),u_pattern_size_a:new y.bU(b,o.u_pattern_size_a),u_pattern_size_b:new y.bU(b,o.u_pattern_size_b),u_scale_a:new y.bg(b,o.u_scale_a),u_scale_b:new y.bg(b,o.u_scale_b),u_pixel_coord_upper:new y.bU(b,o.u_pixel_coord_upper),u_pixel_coord_lower:new y.bU(b,o.u_pixel_coord_lower),u_tile_units_to_pixels:new y.bg(b,o.u_tile_units_to_pixels)}),terrain:(b,o)=>({u_texture:new y.bP(b,o.u_texture),u_ele_delta:new y.bg(b,o.u_ele_delta),u_fog_matrix:new y.bR(b,o.u_fog_matrix),u_fog_color:new y.bQ(b,o.u_fog_color),u_fog_ground_blend:new y.bg(b,o.u_fog_ground_blend),u_fog_ground_blend_opacity:new y.bg(b,o.u_fog_ground_blend_opacity),u_horizon_color:new y.bQ(b,o.u_horizon_color),u_horizon_fog_blend:new y.bg(b,o.u_horizon_fog_blend),u_is_globe_mode:new y.bg(b,o.u_is_globe_mode)}),terrainDepth:(b,o)=>({u_ele_delta:new y.bg(b,o.u_ele_delta)}),terrainCoords:(b,o)=>({u_texture:new y.bP(b,o.u_texture),u_terrain_coords_id:new y.bg(b,o.u_terrain_coords_id),u_ele_delta:new y.bg(b,o.u_ele_delta)}),projectionErrorMeasurement:(b,o)=>({u_input:new y.bg(b,o.u_input),u_output_expected:new y.bg(b,o.u_output_expected)}),atmosphere:(b,o)=>({u_sun_pos:new y.bT(b,o.u_sun_pos),u_atmosphere_blend:new y.bg(b,o.u_atmosphere_blend),u_globe_position:new y.bT(b,o.u_globe_position),u_globe_radius:new y.bg(b,o.u_globe_radius),u_inv_proj_matrix:new y.bR(b,o.u_inv_proj_matrix)}),sky:(b,o)=>({u_sky_color:new y.bQ(b,o.u_sky_color),u_horizon_color:new y.bQ(b,o.u_horizon_color),u_horizon:new y.bU(b,o.u_horizon),u_horizon_normal:new y.bU(b,o.u_horizon_normal),u_sky_horizon_blend:new y.bg(b,o.u_sky_horizon_blend),u_sky_blend:new y.bg(b,o.u_sky_blend)})};class bc{constructor(o,u,f){this.context=o;const _=o.gl;this.buffer=_.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),_.bufferData(_.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?_.DYNAMIC_DRAW:_.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const u=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ja={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class zi{constructor(o,u,f,_){this.length=u.length,this.attributes=f,this.itemSize=u.bytesPerElement,this.dynamicDraw=_,this.context=o;const x=o.gl;this.buffer=x.createBuffer(),o.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){if(o.length!==this.length)throw new Error(`Length of new data is ${o.length}, which doesn't match current length of ${this.length}`);const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,u){for(let f=0;f<this.attributes.length;f++){const _=u.attributes[this.attributes[f].name];void 0!==_&&o.enableVertexAttribArray(_)}}setVertexAttribPointers(o,u,f){for(let _=0;_<this.attributes.length;_++){const x=this.attributes[_],S=u.attributes[x.name];void 0!==S&&o.vertexAttribPointer(S,x.components,o[ja[x.type]],!1,this.itemSize,x.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class xn{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class uu extends xn{getDefault(){return y.bf.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class El extends xn{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class du extends xn{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class zs extends xn{getDefault(){return[!0,!0,!0,!0]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class pa extends xn{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Va extends xn{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class hu extends xn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const u=this.current;(o.func!==u.func||o.ref!==u.ref||o.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Rh extends xn{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class md extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=o,this.dirty=!1}}class _d extends xn{getDefault(){return[0,1]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class fu extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=o,this.dirty=!1}}class pu extends xn{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class xc extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.BLEND):u.disable(u.BLEND),this.current=o,this.dirty=!1}}class Ml extends xn{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class wc extends xn{getDefault(){return y.bf.transparent}set(o){const u=this.current;(o.r!==u.r||o.g!==u.g||o.b!==u.b||o.a!==u.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Cc extends xn{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class yd extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;o?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=o,this.dirty=!1}}class ga extends xn{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Tl extends xn{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}class Ua extends xn{getDefault(){return null}set(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)}}class _i extends xn{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Il extends xn{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const u=this.current;(o[0]!==u[0]||o[1]!==u[1]||o[2]!==u[2]||o[3]!==u[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Ga extends xn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Dl extends xn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class ni extends xn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class ma extends xn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class _a extends xn{getDefault(){return null}set(o){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class yi extends xn{getDefault(){return null}set(o){var u;if(o===this.current&&!this.dirty)return;const f=this.gl;eo(f)?f.bindVertexArray(o):null===(u=f.getExtension("OES_vertex_array_object"))||void 0===u||u.bindVertexArrayOES(o),this.current=o,this.dirty=!1}}class ya extends xn{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class Sc extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class ss extends xn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class ji extends xn{constructor(o,u){super(o),this.context=o,this.parent=u}getDefault(){return null}}class gu extends ji{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Al extends ji{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class en extends ji{set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,o),this.current=o,this.dirty=!1}}const Pl="Framebuffer is not complete";class Uf{constructor(o,u,f,_,x){this.context=o,this.width=u,this.height=f;const S=o.gl,I=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new gu(o,I),_)this.depthAttachment=x?new en(o,I):new Al(o,I);else if(x)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(Pl)}destroy(){const o=this.context.gl,u=this.colorAttachment.get();if(u&&o.deleteTexture(u),this.depthAttachment){const f=this.depthAttachment.get();f&&o.deleteRenderbuffer(f)}o.deleteFramebuffer(this.framebuffer)}}class qt{constructor(o){var u,f;if(this.gl=o,this.clearColor=new uu(this),this.clearDepth=new El(this),this.clearStencil=new du(this),this.colorMask=new zs(this),this.depthMask=new pa(this),this.stencilMask=new Va(this),this.stencilFunc=new hu(this),this.stencilOp=new Rh(this),this.stencilTest=new md(this),this.depthRange=new _d(this),this.depthTest=new fu(this),this.depthFunc=new pu(this),this.blend=new xc(this),this.blendFunc=new Ml(this),this.blendColor=new wc(this),this.blendEquation=new Cc(this),this.cullFace=new yd(this),this.cullFaceSide=new ga(this),this.frontFace=new Tl(this),this.program=new Ua(this),this.activeTexture=new _i(this),this.viewport=new Il(this),this.bindFramebuffer=new Ga(this),this.bindRenderbuffer=new Dl(this),this.bindTexture=new ni(this),this.bindVertexBuffer=new ma(this),this.bindElementBuffer=new _a(this),this.bindVertexArray=new yi(this),this.pixelStoreUnpack=new ya(this),this.pixelStoreUnpackPremultiplyAlpha=new Sc(this),this.pixelStoreUnpackFlipY=new ss(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),eo(o)){this.HALF_FLOAT=o.HALF_FLOAT;const _=o.getExtension("EXT_color_buffer_half_float");this.RGBA16F=null!==(u=o.RGBA16F)&&void 0!==u?u:_?.RGBA16F_EXT,this.RGB16F=null!==(f=o.RGB16F)&&void 0!==f?f:_?.RGB16F_EXT,o.getExtension("EXT_color_buffer_float")}else{o.getExtension("EXT_color_buffer_half_float"),o.getExtension("OES_texture_half_float_linear");const _=o.getExtension("OES_texture_half_float");this.HALF_FLOAT=_?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,u){return new bc(this,o,u)}createVertexBuffer(o,u,f){return new zi(this,o,u,f)}createRenderbuffer(o,u,f){const _=this.gl,x=_.createRenderbuffer();return this.bindRenderbuffer.set(x),_.renderbufferStorage(_.RENDERBUFFER,o,u,f),this.bindRenderbuffer.set(null),x}createFramebuffer(o,u,f,_){return new Uf(this,o,u,f,_)}clear({color:o,depth:u,stencil:f}){const _=this.gl;let x=0;o&&(x|=_.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),void 0!==u&&(x|=_.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),void 0!==f&&(x|=_.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),_.clear(x)}setCullFace(o){!1===o.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){y.bH(o.blendFunction,Ln.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}createVertexArray(){var o;return eo(this.gl)?this.gl.createVertexArray():null===(o=this.gl.getExtension("OES_vertex_array_object"))||void 0===o?void 0:o.createVertexArrayOES()}deleteVertexArray(o){var u;return eo(this.gl)?this.gl.deleteVertexArray(o):null===(u=this.gl.getExtension("OES_vertex_array_object"))||void 0===u?void 0:u.deleteVertexArrayOES(o)}unbindVAO(){this.bindVertexArray.set(null)}}let Vi;function Ec(b,o,u,f,_){const x=b.context,S=b.transform,I=x.gl,D=b.useProgram("collisionBox"),N=[];let F=0,U=0;for(let ie=0;ie<f.length;ie++){const ue=f[ie],pe=o.getTile(ue).getBucket(u);if(!pe)continue;const he=_?pe.textCollisionBox:pe.iconCollisionBox,me=pe.collisionCircleArray;me.length>0&&(N.push({circleArray:me,circleOffset:U,coord:ue}),F+=me.length/4,U=F),he&&D.draw(x,I.LINES,Wt.disabled,ln.disabled,b.colorModeForRenderPass(),Ot.disabled,mc(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(ue),S.getProjectionData({overscaledTileID:ue,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),u.id,he.layoutVertexBuffer,he.indexBuffer,he.segments,null,b.transform.zoom,null,null,he.collisionVertexBuffer)}if(!_||!N.length)return;const V=b.useProgram("collisionCircle"),H=new y.b$;H.resize(4*F),H._trim();let Y=0;for(const ie of N)for(let ue=0;ue<ie.circleArray.length/4;ue++){const pe=4*ue,he=ie.circleArray[pe+0],me=ie.circleArray[pe+1],ve=ie.circleArray[pe+2],fe=ie.circleArray[pe+3];H.emplace(Y++,he,me,ve,fe,0),H.emplace(Y++,he,me,ve,fe,1),H.emplace(Y++,he,me,ve,fe,2),H.emplace(Y++,he,me,ve,fe,3)}(!Vi||Vi.length<2*F)&&(Vi=function(ie){const ue=2*ie,pe=new y.c1;pe.resize(ue),pe._trim();for(let he=0;he<ue;he++){const me=6*he;pe.uint16[me+0]=4*he+0,pe.uint16[me+1]=4*he+1,pe.uint16[me+2]=4*he+2,pe.uint16[me+3]=4*he+2,pe.uint16[me+4]=4*he+3,pe.uint16[me+5]=4*he+0}return pe}(F));const oe=x.createIndexBuffer(Vi,!0),re=x.createVertexBuffer(H,y.c0.members,!0);for(const ie of N){const ue=_c(b.transform);V.draw(x,I.TRIANGLES,Wt.disabled,ln.disabled,b.colorModeForRenderPass(),Ot.disabled,ue,b.style.map.terrain&&b.style.map.terrain.getTerrainData(ie.coord),null,u.id,re,oe,y.aM.simpleSegment(0,2*ie.circleOffset,ie.circleArray.length,ie.circleArray.length/2),null,b.transform.zoom,null,null,null)}re.destroy(),oe.destroy()}const vd=y.ag(new Float32Array(16));function Oh(b,o,u,f,_,x){const{horizontalAlign:S,verticalAlign:I}=y.aH(b);return new y.P((-(S-.5)*o/_+f[0])*x,(-(I-.5)*u/_+f[1])*x)}function mu(b,o,u,f,_,x){const S=o.tileAnchorPoint.add(new y.P(o.translation[0],o.translation[1]));if(o.pitchWithMap){let I=f.mult(x);u||(I=I.rotate(-_));const D=S.add(I);return yr(D.x,D.y,o.pitchedLabelPlaneMatrix,o.getElevation).point}if(u){const I=Er(o.tileAnchorPoint.x+1,o.tileAnchorPoint.y,o).point.sub(b),D=Math.atan(I.y/I.x)+(I.x<0?Math.PI:0);return b.add(f.rotate(D))}return b.add(f)}function bd(b,o,u,f,_,x,S,I,D,N,F,U){const V=b.text.placedSymbolArray,H=b.text.dynamicLayoutVertexArray,Y=b.icon.dynamicLayoutVertexArray,oe={};H.clear();for(let re=0;re<V.length;re++){const ie=V.get(re),ue=ie.hidden||!ie.crossTileID||b.allowVerticalPlacement&&!ie.placedOrientation?null:f[ie.crossTileID];if(ue){const pe=new y.P(ie.anchorX,ie.anchorY),he={getElevation:U,width:_.width,height:_.height,pitchedLabelPlaneMatrix:x,pitchWithMap:u,transform:_,tileAnchorPoint:pe,translation:N,unwrappedTileID:F},me=u?As(pe.x,pe.y,he):Er(pe.x,pe.y,he),ve=Ke(_.cameraToCenterDistance,me.signedDistanceFromCamera);let fe=y.ap(b.textSizeData,I,ie)*ve/y.aB;u&&(fe*=b.tilePixelRatio/S);const{width:Te,height:Be,anchor:ke,textOffset:Oe,textBoxScale:Fe}=ue,Je=Oh(ke,Te,Be,Oe,Fe,fe),tt=_.getPitchedTextCorrection(pe.x+N[0],pe.y+N[1],F),qe=mu(me.point,he,o,Je,-_.bearingInRadians,tt),Mt=b.allowVerticalPlacement&&ie.placedOrientation===y.ao.vertical?Math.PI/2:0;for(let nn=0;nn<ie.numGlyphs;nn++)y.av(H,qe,Mt);D&&ie.associatedIconIndex>=0&&(oe[ie.associatedIconIndex]={shiftedAnchor:qe,angle:Mt})}else di(ie.numGlyphs,H)}if(D){Y.clear();const re=b.icon.placedSymbolArray;for(let ie=0;ie<re.length;ie++){const ue=re.get(ie);if(ue.hidden)di(ue.numGlyphs,Y);else{const pe=oe[ie];if(pe)for(let he=0;he<ue.numGlyphs;he++)y.av(Y,pe.shiftedAnchor,pe.angle);else di(ue.numGlyphs,Y)}}b.icon.dynamicLayoutVertexBuffer.updateData(Y)}b.text.dynamicLayoutVertexBuffer.updateData(H)}function kl(b,o,u){return u.iconsInText&&o?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function $a(b,o,u,f,_,x,S,I,D,N,F,U,V){const H=b.context,Y=H.gl,oe=b.transform,re="map"===I,ie="map"===D,ue="viewport"!==I&&"point"!==u.layout.get("symbol-placement"),pe=re&&!ie&&!ue,he=!u.layout.get("symbol-sort-key").isConstant();let me=!1;const ve=b.getDepthModeForSublayer(0,Wt.ReadOnly),fe=u._unevaluatedLayout.hasValue("text-variable-anchor")||u._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Te=[],Be=oe.getCircleRadiusCorrection();for(const ke of f){const Oe=o.getTile(ke),Fe=Oe.getBucket(u);if(!Fe)continue;const Je=_?Fe.text:Fe.icon;if(!Je||!Je.segments.get().length||!Je.hasVisibleVertices)continue;const tt=Je.programConfigurations.get(u.id),qe=_||Fe.sdfIcons,Mt=_?Fe.textSizeData:Fe.iconSizeData,nn=ie||0!==oe.pitch,Sn=b.useProgram(kl(qe,_,Fe),tt),$n=y.an(Mt,oe.zoom),Bn=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ke);let br,Dr,tn,zn,xr=[0,0],Ar=null;if(_)Dr=Oe.glyphAtlasTexture,tn=Y.LINEAR,br=Oe.glyphAtlasTexture.size,Fe.iconsInText&&(xr=Oe.imageAtlasTexture.size,Ar=Oe.imageAtlasTexture,zn=nn||b.options.rotating||b.options.zooming||"composite"===Mt.kind||"camera"===Mt.kind?Y.LINEAR:Y.NEAREST);else{const Br=1!==u.layout.get("icon-size").constantOr(0)||Fe.iconsNeedLinear;Dr=Oe.imageAtlasTexture,tn=qe||b.options.rotating||b.options.zooming||Br||nn?Y.LINEAR:Y.NEAREST,br=Oe.imageAtlasTexture.size}const no=y.aC(Oe,1,b.transform.zoom),Lo=sr(re,b.transform,no),Hi=y.L();y.aq(Hi,Lo);const Qa=rn(ie,re,b.transform,no),Ja=y.aD(oe,Oe,x,S),Vl=oe.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!V,applyTerrainMatrix:!0}),fs=fe&&Fe.hasTextData(),Fo="none"!==u.layout.get("icon-text-fit")&&fs&&Fe.hasIconData();if(ue){const Br=b.style.map.terrain?(gs,qr)=>b.style.map.terrain.getElevation(ke,gs,qr):null,Wr="map"===u.layout.get("text-rotation-alignment");ur(Fe,b,_,Lo,Hi,ie,N,Wr,ke.toUnwrapped(),oe.width,oe.height,Ja,Br)}const el=_&&fe||Fo,Si=ue||el?vd:ie?Lo:b.transform.clipSpaceToPixelsMatrix,ps=qe&&0!==u.paint.get(_?"text-halo-width":"icon-halo-width").constantOr(1);let oi;oi=qe?Fe.iconsInText?Vf(Mt.kind,$n,pe,ie,ue,el,b,Si,Qa,Ja,br,xr,Be):gd(Mt.kind,$n,pe,ie,ue,el,b,Si,Qa,Ja,_,br,0,Be):fa(Mt.kind,$n,pe,ie,ue,el,b,Si,Qa,Ja,_,br,Be);const Ul={program:Sn,buffers:Je,uniformValues:oi,projectionData:Vl,atlasTexture:Dr,atlasTextureIcon:Ar,atlasInterpolation:tn,atlasInterpolationIcon:zn,isSDF:qe,hasHalo:ps};if(he&&Fe.canOverlap){me=!0;const Br=Je.segments.get();for(const Wr of Br)Te.push({segments:new y.aM([Wr]),sortKey:Wr.sortKey,state:Ul,terrainData:Bn})}else Te.push({segments:Je.segments,sortKey:0,state:Ul,terrainData:Bn})}me&&Te.sort((ke,Oe)=>ke.sortKey-Oe.sortKey);for(const ke of Te){const Oe=ke.state;if(H.activeTexture.set(Y.TEXTURE0),Oe.atlasTexture.bind(Oe.atlasInterpolation,Y.CLAMP_TO_EDGE),Oe.atlasTextureIcon&&(H.activeTexture.set(Y.TEXTURE1),Oe.atlasTextureIcon&&Oe.atlasTextureIcon.bind(Oe.atlasInterpolationIcon,Y.CLAMP_TO_EDGE)),Oe.isSDF){const Fe=Oe.uniformValues;Oe.hasHalo&&(Fe.u_is_halo=1,Rl(Oe.buffers,ke.segments,u,b,Oe.program,ve,F,U,Fe,Oe.projectionData,ke.terrainData)),Fe.u_is_halo=0}Rl(Oe.buffers,ke.segments,u,b,Oe.program,ve,F,U,Oe.uniformValues,Oe.projectionData,ke.terrainData)}}function Rl(b,o,u,f,_,x,S,I,D,N,F){const U=f.context;_.draw(U,U.gl.TRIANGLES,x,S,I,Ot.backCCW,D,F,N,u.id,b.layoutVertexBuffer,b.indexBuffer,o,u.paint,f.transform.zoom,b.programConfigurations.get(u.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function xd(b,o,u,f,_){const x=b.context,S=x.gl,I=ln.disabled,D=new Ln([S.ONE,S.ONE],y.bf.transparent,[!0,!0,!0,!0]),N=o.getBucket(u);if(!N)return;const F=f.key;let U=u.heatmapFbos.get(F);U||(U=Mc(x,o.tileSize,o.tileSize),u.heatmapFbos.set(F,U)),x.bindFramebuffer.set(U.framebuffer),x.viewport.set([0,0,o.tileSize,o.tileSize]),x.clear({color:y.bf.transparent});const V=N.programConfigurations.get(u.id),H=b.useProgram("heatmap",V,!_),Y=b.transform.getProjectionData({overscaledTileID:o.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),oe=b.style.map.terrain.getTerrainData(f);H.draw(x,S.TRIANGLES,Wt.disabled,I,D,Ot.disabled,hd(o,b.transform.zoom,u.paint.get("heatmap-intensity"),1),oe,Y,u.id,N.layoutVertexBuffer,N.indexBuffer,N.segments,u.paint,b.transform.zoom,V)}function js(b,o,u,f,_){const x=b.context,S=x.gl,I=b.transform;x.setColorMode(b.colorModeForRenderPass());const D=Vs(x,o),N=u.key,F=o.heatmapFbos.get(N);if(!F)return;x.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,F.colorAttachment.get()),x.activeTexture.set(S.TEXTURE1),D.bind(S.LINEAR,S.CLAMP_TO_EDGE);const U=I.getProjectionData({overscaledTileID:u,applyTerrainMatrix:_,applyGlobeMatrix:!f});b.useProgram("heatmapTexture").draw(x,S.TRIANGLES,Wt.disabled,ln.disabled,b.colorModeForRenderPass(),Ot.disabled,au(b,o,0,1),null,U,o.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,o.paint,I.zoom),F.destroy(),o.heatmapFbos.delete(N)}function Mc(b,o,u){var f,_;const x=b.gl,S=x.createTexture();x.bindTexture(x.TEXTURE_2D,S),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MIN_FILTER,x.LINEAR),x.texParameteri(x.TEXTURE_2D,x.TEXTURE_MAG_FILTER,x.LINEAR);const I=null!==(f=b.HALF_FLOAT)&&void 0!==f?f:x.UNSIGNED_BYTE,D=null!==(_=b.RGBA16F)&&void 0!==_?_:x.RGBA;x.texImage2D(x.TEXTURE_2D,0,D,o,u,0,x.RGBA,I,null);const N=b.createFramebuffer(o,u,!1,!1);return N.colorAttachment.set(S),N}function Vs(b,o){return o.colorRampTexture||(o.colorRampTexture=new y.T(b,o.colorRamp,b.gl.RGBA)),o.colorRampTexture}function va(b,o,u,f,_){if(!u||!f||!f.imageAtlas)return;const x=f.imageAtlas.patternPositions;let S=x[u.to.toString()],I=x[u.from.toString()];if(!S&&I&&(S=I),!I&&S&&(I=S),!S||!I){const D=_.getPaintProperty(o);S=x[D],I=x[D]}S&&I&&b.setConstantPatternPositions(S,I)}function Tc(b,o,u,f,_,x,S,I){const D=b.context.gl,N="fill-pattern",F=u.paint.get(N),U=F&&F.constantOr(1),V=u.getCrossfadeParameters();let H,Y,oe,re,ie;const ue=b.transform,pe=u.paint.get("fill-translate"),he=u.paint.get("fill-translate-anchor");S?(Y=U&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",H=D.LINES):(Y=U?"fillPattern":"fill",H=D.TRIANGLES);const me=F.constantOr(null);for(const ve of f){const fe=o.getTile(ve);if(U&&!fe.patternsLoaded())continue;const Te=fe.getBucket(u);if(!Te)continue;const Be=Te.programConfigurations.get(u.id),ke=b.useProgram(Y,Be),Oe=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ve);U&&(b.context.activeTexture.set(D.TEXTURE0),fe.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),Be.updatePaintBuffers(V)),va(Be,N,me,fe,u);const Fe=ue.getProjectionData({overscaledTileID:ve,applyGlobeMatrix:!I,applyTerrainMatrix:!0}),Je=y.aD(ue,fe,pe,he);if(S){re=Te.indexBuffer2,ie=Te.segments2;const qe=[D.drawingBufferWidth,D.drawingBufferHeight];oe="fillOutlinePattern"===Y&&U?xl(b,V,fe,qe,Je):bl(qe,Je)}else re=Te.indexBuffer,ie=Te.segments,oe=U?Fi(b,V,fe,Je):{u_fill_translate:Je};const tt=b.stencilModeForClipping(ve);ke.draw(b.context,H,_,tt,x,Ot.backCCW,oe,Oe,Fe,u.id,Te.layoutVertexBuffer,re,ie,u.paint,b.transform.zoom,Be)}}function Ic(b,o,u,f,_,x,S,I){const D=b.context,N=D.gl,F="fill-extrusion-pattern",U=u.paint.get(F),V=U.constantOr(1),H=u.getCrossfadeParameters(),Y=u.paint.get("fill-extrusion-opacity"),oe=U.constantOr(null),re=b.transform;for(const ie of f){const ue=o.getTile(ie),pe=ue.getBucket(u);if(!pe)continue;const he=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ie),me=pe.programConfigurations.get(u.id),ve=b.useProgram(V?"fillExtrusionPattern":"fillExtrusion",me);V&&(b.context.activeTexture.set(N.TEXTURE0),ue.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),me.updatePaintBuffers(H));const fe=re.getProjectionData({overscaledTileID:ie,applyGlobeMatrix:!I,applyTerrainMatrix:!0});va(me,F,oe,ue,u);const Te=y.aD(re,ue,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),Be=u.paint.get("fill-extrusion-vertical-gradient"),ke=V?Ah(b,Be,Y,Te,ie,H,ue):mi(b,Be,Y,Te);ve.draw(D,D.gl.TRIANGLES,_,x,S,Ot.backCCW,ke,he,fe,u.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,u.paint,b.transform.zoom,me,b.style.map.terrain&&pe.centroidVertexBuffer)}}function Ui(b,o,u,f,_,x,S,I,D){var N;const F=b.style.projection,U=b.context,V=b.transform,H=U.gl,Y=[`#define NUM_ILLUMINATION_SOURCES ${u.paint.get("hillshade-highlight-color").values.length}`],oe=b.useProgram("hillshade",null,!1,Y),re=!b.options.moving;for(const ie of f){const ue=o.getTile(ie),pe=ue.fbo;if(!pe)continue;const he=F.getMeshFromTileID(U,ie.canonical,I,!0,"raster"),me=null===(N=b.style.map.terrain)||void 0===N?void 0:N.getTerrainData(ie);U.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,pe.colorAttachment.get());const ve=V.getProjectionData({overscaledTileID:ie,aligned:re,applyGlobeMatrix:!D,applyTerrainMatrix:!0});oe.draw(U,H.TRIANGLES,x,_[ie.overscaledZ],S,Ot.backCCW,Ph(b,ue,u),me,ve,u.id,he.vertexBuffer,he.indexBuffer,he.segments)}}function Dc(b,o,u,f,_,x,S,I,D){var N;const F=b.style.projection,U=b.context,V=b.transform,H=U.gl,Y=b.useProgram("colorRelief"),oe=!b.options.moving;let re=!0,ie=0;for(const ue of f){const pe=o.getTile(ue),he=pe.dem;if(re){const ke=H.getParameter(H.MAX_TEXTURE_SIZE),{elevationTexture:Oe,colorTexture:Fe}=u.getColorRampTextures(U,ke,he.getUnpackVector());U.activeTexture.set(H.TEXTURE1),Oe.bind(H.NEAREST,H.CLAMP_TO_EDGE),U.activeTexture.set(H.TEXTURE4),Fe.bind(H.LINEAR,H.CLAMP_TO_EDGE),re=!1,ie=Oe.size[0]}if(!he||!he.data)continue;const me=he.stride,ve=he.getPixels();if(U.activeTexture.set(H.TEXTURE0),U.pixelStoreUnpackPremultiplyAlpha.set(!1),pe.demTexture=pe.demTexture||b.getTileTexture(me),pe.demTexture){const ke=pe.demTexture;ke.update(ve,{premultiply:!1}),ke.bind(H.LINEAR,H.CLAMP_TO_EDGE)}else pe.demTexture=new y.T(U,ve,H.RGBA,{premultiply:!1}),pe.demTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const fe=F.getMeshFromTileID(U,ue.canonical,I,!0,"raster"),Te=null===(N=b.style.map.terrain)||void 0===N?void 0:N.getTerrainData(ue),Be=V.getProjectionData({overscaledTileID:ue,aligned:oe,applyGlobeMatrix:!D,applyTerrainMatrix:!0});Y.draw(U,H.TRIANGLES,x,_[ue.overscaledZ],S,Ot.backCCW,Cl(u,pe.dem,ie),Te,Be,u.id,fe.vertexBuffer,fe.indexBuffer,fe.segments)}}const ba=[new y.P(0,0),new y.P(y.$,0),new y.P(y.$,y.$),new y.P(0,y.$)];function xa(b,o,u,f,_,x,S,I,D=!1,N=!1){const F=f[f.length-1].overscaledZ,U=b.context,V=U.gl,H=b.useProgram("raster"),Y=b.transform,oe=b.style.projection,re=b.colorModeForRenderPass(),ie=!b.options.moving;for(const ue of f){const pe=b.getDepthModeForSublayer(ue.overscaledZ-F,1===u.paint.get("raster-opacity")?Wt.ReadWrite:Wt.ReadOnly,V.LESS),he=o.getTile(ue);he.registerFadeDuration(u.paint.get("raster-fade-duration"));const me=o.findLoadedParent(ue,0),ve=o.findLoadedSibling(ue),fe=Ac(he,me||ve||null,o,u,b.transform,b.style.map.terrain);let Te,Be;const ke="nearest"===u.paint.get("raster-resampling")?V.NEAREST:V.LINEAR;U.activeTexture.set(V.TEXTURE0),he.texture.bind(ke,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),U.activeTexture.set(V.TEXTURE1),me?(me.texture.bind(ke,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),Te=Math.pow(2,me.tileID.overscaledZ-he.tileID.overscaledZ),Be=[he.tileID.canonical.x*Te%1,he.tileID.canonical.y*Te%1]):he.texture.bind(ke,V.CLAMP_TO_EDGE,V.LINEAR_MIPMAP_NEAREST),he.texture.useMipmap&&U.extTextureFilterAnisotropic&&b.transform.pitch>20&&V.texParameterf(V.TEXTURE_2D,U.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,U.extTextureFilterAnisotropicMax);const Oe=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ue),Fe=Y.getProjectionData({overscaledTileID:ue,aligned:ie,applyGlobeMatrix:!N,applyTerrainMatrix:!0}),Je=yc(Be||[0,0],Te||1,fe,u,I),tt=oe.getMeshFromTileID(U,ue.canonical,x,S,"raster");H.draw(U,V.TRIANGLES,pe,_?_[ue.overscaledZ]:ln.disabled,re,D?Ot.frontCCW:Ot.backCCW,Je,Oe,Fe,u.id,tt.vertexBuffer,tt.indexBuffer,tt.segments)}}function Ac(b,o,u,f,_,x){const S=f.paint.get("raster-fade-duration");if(!x&&S>0){const I=mt.now(),D=(I-b.timeAdded)/S,N=o?(I-o.timeAdded)/S:-1,F=u.getSource(),U=bt(_,{tileSize:F.tileSize,roundZoom:F.roundZoom}),V=!o||Math.abs(o.tileID.overscaledZ-U)>Math.abs(b.tileID.overscaledZ-U),H=V&&b.refreshedUponExpiration?1:y.ah(V?D:1-N,0,1);return b.refreshedUponExpiration&&D>=1&&(b.refreshedUponExpiration=!1),o?{opacity:1,mix:1-H}:{opacity:H,mix:0}}return{opacity:1,mix:0}}const wd=new y.bf(1,0,0,1),Nh=new y.bf(0,1,0,1),Ol=new y.bf(0,0,1,1),_u=new y.bf(1,0,1,1),Lh=new y.bf(0,1,1,1);function yu(b,o,u,f){vi(b,0,o+u/2,b.transform.width,u,f)}function Fn(b,o,u,f){vi(b,o-u/2,0,u,b.transform.height,f)}function vi(b,o,u,f,_,x){const S=b.context,I=S.gl;I.enable(I.SCISSOR_TEST),I.scissor(o*b.pixelRatio,u*b.pixelRatio,f*b.pixelRatio,_*b.pixelRatio),S.clear({color:x}),I.disable(I.SCISSOR_TEST)}function No(b,o,u){const f=b.context,_=f.gl,x=b.useProgram("debug"),S=Wt.disabled,I=ln.disabled,D=b.colorModeForRenderPass(),N="$debug",F=b.style.map.terrain&&b.style.map.terrain.getTerrainData(u);f.activeTexture.set(_.TEXTURE0);const U=o.getTileByID(u.key).latestRawTileData,V=Math.floor((U&&U.byteLength||0)/1024),H=o.getTile(u).tileSize,Y=512/Math.min(H,512)*(u.overscaledZ/b.transform.zoom)*.5;let oe=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(oe+=` => ${u.overscaledZ}`),function(ie,ue){ie.initDebugOverlayCanvas();const pe=ie.debugOverlayCanvas,he=ie.context.gl,me=ie.debugOverlayCanvas.getContext("2d");me.clearRect(0,0,pe.width,pe.height),me.shadowColor="white",me.shadowBlur=2,me.lineWidth=1.5,me.strokeStyle="white",me.textBaseline="top",me.font="bold 36px Open Sans, sans-serif",me.fillText(ue,5,5),me.strokeText(ue,5,5),ie.debugOverlayTexture.update(pe),ie.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)}(b,`${oe} ${V}kB`);const re=b.transform.getProjectionData({overscaledTileID:u,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(f,_.TRIANGLES,S,I,Ln.alphaBlended,Ot.disabled,Bi(y.bf.transparent,Y),null,re,N,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),x.draw(f,_.LINE_STRIP,S,I,D,Ot.disabled,Bi(y.bf.red),F,re,N,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function Pc(b,o,u,f){const{isRenderingGlobe:_}=f,x=b.context,S=x.gl,I=b.transform,D=b.colorModeForRenderPass(),N=b.getDepthModeFor3D(),F=b.useProgram("terrain");x.bindFramebuffer.set(null),x.viewport.set([0,0,b.width,b.height]);for(const U of u){const V=o.getTerrainMesh(U.tileID),H=b.renderToTexture.getTexture(U),Y=o.getTerrainData(U.tileID);x.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,H.texture);const oe=o.getMeshFrameDelta(I.zoom),re=I.calculateFogMatrix(U.tileID.toUnwrapped()),ie=is(oe,re,b.style.sky,I.pitch,_),ue=I.getProjectionData({overscaledTileID:U.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});F.draw(x,S.TRIANGLES,N,ln.disabled,D,Ot.backCCW,ie,Y,ue,"terrain",V.vertexBuffer,V.indexBuffer,V.segments)}}function kc(b,o){if(!o.mesh){const u=new y.aL;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(1,1),u.emplaceBack(-1,1);const f=new y.aN;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),o.mesh=new ns(b.createVertexBuffer(u,pi.members),b.createIndexBuffer(f),y.aM.simpleSegment(0,0,u.length,f.length))}return o.mesh}class Fh{constructor(o,u){this.context=new qt(o),this.transform=u,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:y.ag(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=Jt.maxUnderzooming+Jt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ks}resize(o,u,f){if(this.width=Math.floor(o*f),this.height=Math.floor(u*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style._order)this.style._layers[_].resize()}setup(){const o=this.context,u=new y.aL;u.emplaceBack(0,0),u.emplaceBack(y.$,0),u.emplaceBack(0,y.$),u.emplaceBack(y.$,y.$),this.tileExtentBuffer=o.createVertexBuffer(u,pi.members),this.tileExtentSegments=y.aM.simpleSegment(0,0,4,2);const f=new y.aL;f.emplaceBack(0,0),f.emplaceBack(y.$,0),f.emplaceBack(0,y.$),f.emplaceBack(y.$,y.$),this.debugBuffer=o.createVertexBuffer(f,pi.members),this.debugSegments=y.aM.simpleSegment(0,0,4,5);const _=new y.c6;_.emplaceBack(0,0,0,0),_.emplaceBack(y.$,0,y.$,0),_.emplaceBack(0,y.$,0,y.$),_.emplaceBack(y.$,y.$,y.$,y.$),this.rasterBoundsBuffer=o.createVertexBuffer(_,cd.members),this.rasterBoundsSegments=y.aM.simpleSegment(0,0,4,2);const x=new y.aL;x.emplaceBack(0,0),x.emplaceBack(y.$,0),x.emplaceBack(0,y.$),x.emplaceBack(y.$,y.$),this.rasterBoundsBufferPosOnly=o.createVertexBuffer(x,pi.members),this.rasterBoundsSegmentsPosOnly=y.aM.simpleSegment(0,0,4,5);const S=new y.aL;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(S,pi.members),this.viewportSegments=y.aM.simpleSegment(0,0,4,2);const I=new y.c7;I.emplaceBack(0),I.emplaceBack(1),I.emplaceBack(3),I.emplaceBack(2),I.emplaceBack(0),this.tileBorderIndexBuffer=o.createIndexBuffer(I);const D=new y.aN;D.emplaceBack(1,0,2),D.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(D);const N=this.context.gl;this.stencilClearMode=new ln({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.tileExtentMesh=new ns(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const o=this.context,u=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=y.L();y.bY(f,0,this.width,this.height,0,0,1),y.N(f,f,[u.drawingBufferWidth,u.drawingBufferHeight,0]);const _={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(o,u.TRIANGLES,Wt.disabled,this.stencilClearMode,Ln.disabled,Ot.disabled,null,null,_,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(o,u,f){if(this.currentStencilSource===o.source||!o.isTileClipped()||!u||!u.length)return;this.currentStencilSource=o.source,this.nextStencilID+u.length>256&&this.clearStencil();const _=this.context;_.setColorMode(Ln.disabled),_.setDepthMode(Wt.disabled);const x={};for(const S of u)x[S.key]=this.nextStencilID++;this._renderTileMasks(x,u,f,!0),this._renderTileMasks(x,u,f,!1),this._tileClippingMaskIDs=x}_renderTileMasks(o,u,f,_){const x=this.context,S=x.gl,I=this.style.projection,D=this.transform,N=this.useProgram("clippingMask");for(const F of u){const U=o[F.key],V=this.style.map.terrain&&this.style.map.terrain.getTerrainData(F),H=I.getMeshFromTileID(this.context,F.canonical,_,!0,"stencil"),Y=D.getProjectionData({overscaledTileID:F,applyGlobeMatrix:!f,applyTerrainMatrix:!0});N.draw(x,S.TRIANGLES,Wt.disabled,new ln({func:S.ALWAYS,mask:0},U,255,S.KEEP,S.KEEP,S.REPLACE),Ln.disabled,f?Ot.disabled:Ot.backCCW,null,V,Y,"$clipping",H.vertexBuffer,H.indexBuffer,H.segments)}}_renderTilesDepthBuffer(){const o=this.context,u=o.gl,f=this.style.projection,_=this.transform,x=this.useProgram("depth"),S=this.getDepthModeFor3D(),I=Me(_,{tileSize:_.tileSize});for(const D of I){const N=this.style.map.terrain&&this.style.map.terrain.getTerrainData(D),F=f.getMeshFromTileID(this.context,D.canonical,!0,!0,"raster"),U=_.getProjectionData({overscaledTileID:D,applyGlobeMatrix:!0,applyTerrainMatrix:!0});x.draw(o,u.TRIANGLES,S,ln.disabled,Ln.disabled,Ot.backCCW,null,N,U,"$clipping",F.vertexBuffer,F.indexBuffer,F.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,u=this.context.gl;return new ln({func:u.NOTEQUAL,mask:255},o,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(o){const u=this.context.gl;return new ln({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,u.KEEP,u.KEEP,u.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(o){const u=this.context.gl,f=o.sort((S,I)=>I.overscaledZ-S.overscaledZ),_=f[f.length-1].overscaledZ,x=f[0].overscaledZ-_+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const S={};for(let I=0;I<x;I++)S[I+_]=new ln({func:u.GEQUAL,mask:255},I+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=x,[S,f]}return[{[_]:ln.disabled},f]}stencilConfigForOverlapTwoPass(o){const u=this.context.gl,f=o.sort((S,I)=>I.overscaledZ-S.overscaledZ),_=f[f.length-1].overscaledZ,x=f[0].overscaledZ-_+1;if(this.clearStencil(),x>1){const S={},I={};for(let D=0;D<x;D++)S[D+_]=new ln({func:u.GREATER,mask:255},x+1+D,255,u.KEEP,u.KEEP,u.REPLACE),I[D+_]=new ln({func:u.GREATER,mask:255},1+D,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID=2*x+1,[S,I,f]}return this.nextStencilID=3,[{[_]:new ln({func:u.GREATER,mask:255},2,255,u.KEEP,u.KEEP,u.REPLACE)},{[_]:new ln({func:u.GREATER,mask:255},1,255,u.KEEP,u.KEEP,u.REPLACE)},f]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new Ln([o.CONSTANT_COLOR,o.ONE],new y.bf(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?Ln.unblended:Ln.alphaBlended}getDepthModeForSublayer(o,u,f){if(!this.opaquePassEnabledForLayer())return Wt.disabled;const _=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new Wt(f||this.context.gl.LEQUAL,u,[_,_])}getDepthModeFor3D(){return new Wt(this.context.gl.LEQUAL,Wt.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,u){var f,_;this.style=o,this.options=u,this.lineAtlas=o.lineAtlas,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(mt.now()),this.imageManager.beginFrame();const x=this.style._order,S=this.style.sourceCaches,I={},D={},N={},F={isRenderingToTexture:!1,isRenderingGlobe:(null===(f=o.projection)||void 0===f?void 0:f.transitionState)>0};for(const V in S){const H=S[V];H.used&&H.prepare(this.context),I[V]=H.getVisibleCoordinates(!1),D[V]=I[V].slice().reverse(),N[V]=H.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let V=0;V<x.length;V++)if(this.style._layers[x[V]].is3D()){this.opaquePassCutoff=V;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const V of x){const H=this.style._layers[V];if(!H.hasOffscreenPass()||H.isHidden(this.transform.zoom))continue;const Y=D[H.source];("custom"===H.type||Y.length)&&this.renderLayer(this,S[H.source],H,Y,F)}if(null===(_=this.style.projection)||void 0===_||_.updateGPUdependent({context:this.context,useProgram:V=>this.useProgram(V)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?y.bf.black:y.bf.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(V,H){const Y=V.context,oe=Y.gl,re=((ve,fe,Te)=>{const Be=Math.cos(fe.rollInRadians),ke=Math.sin(fe.rollInRadians),Oe=be(fe),Fe=fe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:ve.properties.get("sky-color"),u_horizon_color:ve.properties.get("horizon-color"),u_horizon:[(fe.width/2-Oe*ke)*Te,(fe.height/2+Oe*Be)*Te],u_horizon_normal:[-ke,Be],u_sky_horizon_blend:ve.properties.get("sky-horizon-blend")*fe.height/2*Te,u_sky_blend:Fe}})(H,V.style.map.transform,V.pixelRatio),ie=new Wt(oe.LEQUAL,Wt.ReadWrite,[0,1]),ue=ln.disabled,pe=V.colorModeForRenderPass(),he=V.useProgram("sky"),me=kc(Y,H);he.draw(Y,oe.TRIANGLES,ie,ue,pe,Ot.disabled,re,null,void 0,"sky",me.vertexBuffer,me.indexBuffer,me.segments)}(this,this.style.sky),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(o._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const V=this.style._layers[x[this.currentLayer]],H=S[V.source],Y=I[V.source];this._renderTileClippingMasks(V,Y,!1),this.renderLayer(this,H,V,Y,F)}this.renderPass="translucent";let U=!1;for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const V=this.style._layers[x[this.currentLayer]],H=S[V.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(V,F))continue;this.opaquePassEnabledForLayer()||U||(U=!0,F.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const Y=("symbol"===V.type?N:D)[V.source];this._renderTileClippingMasks(V,I[V.source],!!this.renderToTexture),this.renderLayer(this,H,V,Y,F)}if(F.isRenderingGlobe&&function(V,H,Y){const oe=V.context,re=oe.gl,ie=V.useProgram("atmosphere"),ue=new Wt(re.LEQUAL,Wt.ReadOnly,[0,1]),pe=V.transform,he=function(Fe,Je){const tt=Fe.properties.get("position"),qe=[-tt.x,-tt.y,-tt.z],Mt=y.ag(new Float64Array(16));return"map"===Fe.properties.get("anchor")&&(y.b6(Mt,Mt,Je.rollInRadians),y.b7(Mt,Mt,-Je.pitchInRadians),y.b6(Mt,Mt,Je.bearingInRadians),y.b7(Mt,Mt,Je.center.lat*Math.PI/180),y.bz(Mt,Mt,-Je.center.lng*Math.PI/180)),y.c5(qe,qe,Mt),qe}(Y,V.transform),me=pe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),ve=H.properties.get("atmosphere-blend")*me.projectionTransition;if(0===ve)return;const fe=gi(pe.worldSize,pe.center.lat),Te=pe.inverseProjectionMatrix,Be=new Float64Array(4);Be[3]=1,y.aw(Be,Be,pe.modelViewProjectionMatrix),Be[0]/=Be[3],Be[1]/=Be[3],Be[2]/=Be[3],Be[3]=1,y.aw(Be,Be,Te),Be[0]/=Be[3],Be[1]/=Be[3],Be[2]/=Be[3],Be[3]=1;const ke=((Fe,Je,tt,qe,Mt)=>({u_sun_pos:Fe,u_atmosphere_blend:Je,u_globe_position:tt,u_globe_radius:qe,u_inv_proj_matrix:Mt}))(he,ve,[Be[0],Be[1],Be[2]],fe,Te),Oe=kc(oe,H);ie.draw(oe,re.TRIANGLES,ue,ln.disabled,Ln.alphaBlended,Ot.disabled,ke,null,null,"atmosphere",Oe.vertexBuffer,Oe.indexBuffer,Oe.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const V=function(H,Y){let oe=null;const re=Object.values(H._layers).flatMap(he=>he.source&&!he.isHidden(Y)?[H.sourceCaches[he.source]]:[]),ie=re.filter(he=>"vector"===he.getSource().type),ue=re.filter(he=>"vector"!==he.getSource().type),pe=he=>{(!oe||oe.getSource().maxzoom<he.getSource().maxzoom)&&(oe=he)};return ie.forEach(he=>pe(he)),oe||ue.forEach(he=>pe(he)),oe}(this.style,this.transform.zoom);V&&function(H,Y,oe){for(let re=0;re<oe.length;re++)No(H,Y,oe[re])}(this,V,V.getVisibleCoordinates())}this.options.showPadding&&function(V){const H=V.transform.padding;yu(V,V.transform.height-(H.top||0),3,wd),yu(V,H.bottom||0,3,Nh),Fn(V,H.left||0,3,Ol),Fn(V,V.transform.width-(H.right||0),3,_u);const Y=V.transform.centerPoint;var oe,re,ie,ue;vi(oe=V,(re=Y.x)-1,(ie=V.transform.height-Y.y)-10,2,20,ue=Lh),vi(oe,re-10,ie-1,20,2,ue)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(o){if(!this.style||!this.style.map||!this.style.map.terrain)return;const u=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let _=this.terrainFacilitator.dirty;_||(_=o?!y.c8(u,f):!y.c9(u,f)),_||(_=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),_&&(y.ca(u,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(x,S){const I=x.context,D=I.gl,N=x.transform,F=Ln.unblended,U=new Wt(D.LEQUAL,Wt.ReadWrite,[0,1]),V=S.sourceCache.getRenderableTiles(),H=x.useProgram("terrainDepth");I.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),I.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),I.clear({color:y.bf.transparent,depth:1});for(const Y of V){const oe=S.getTerrainMesh(Y.tileID),re=S.getTerrainData(Y.tileID),ie=N.getProjectionData({overscaledTileID:Y.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),ue={u_ele_delta:S.getMeshFrameDelta(N.zoom)};H.draw(I,D.TRIANGLES,U,ln.disabled,F,Ot.backCCW,ue,re,ie,"terrain",oe.vertexBuffer,oe.indexBuffer,oe.segments)}I.bindFramebuffer.set(null),I.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain),function(x,S){const I=x.context,D=I.gl,N=x.transform,F=Ln.unblended,U=new Wt(D.LEQUAL,Wt.ReadWrite,[0,1]),V=S.getCoordsTexture(),H=S.sourceCache.getRenderableTiles(),Y=x.useProgram("terrainCoords");I.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),I.viewport.set([0,0,x.width/devicePixelRatio,x.height/devicePixelRatio]),I.clear({color:y.bf.transparent,depth:1}),S.coordsIndex=[];for(const oe of H){const re=S.getTerrainMesh(oe.tileID),ie=S.getTerrainData(oe.tileID);I.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,V.texture);const ue={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(N.zoom)},pe=N.getProjectionData({overscaledTileID:oe.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Y.draw(I,D.TRIANGLES,U,ln.disabled,F,Ot.backCCW,ue,ie,pe,"terrain",re.vertexBuffer,re.indexBuffer,re.segments),S.coordsIndex.push(oe.tileID.key)}I.bindFramebuffer.set(null),I.viewport.set([0,0,x.width,x.height])}(this,this.style.map.terrain))}renderLayer(o,u,f,_,x){f.isHidden(this.transform.zoom)||("background"===f.type||"custom"===f.type||(_||[]).length)&&(this.id=f.id,y.cb(f)?function(S,I,D,N,F,U){if("translucent"!==S.renderPass)return;const{isRenderingToTexture:V}=U,H=ln.disabled,Y=S.colorModeForRenderPass();(D._unevaluatedLayout.hasValue("text-variable-anchor")||D._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(oe,re,ie,ue,pe,he,me,ve,fe){const Te=re.transform,Be=re.style.map.terrain,ke="map"===pe,Oe="map"===he;for(const Fe of oe){const Je=ue.getTile(Fe),tt=Je.getBucket(ie);if(!tt||!tt.text||!tt.text.segments.get().length)continue;const qe=y.an(tt.textSizeData,Te.zoom),Mt=y.aC(Je,1,re.transform.zoom),nn=sr(ke,re.transform,Mt),Sn="none"!==ie.layout.get("icon-text-fit")&&tt.hasIconData();if(qe){const $n=Math.pow(2,Te.zoom-Je.tileID.overscaledZ),Bn=Be?(br,Dr)=>Be.getElevation(Fe,br,Dr):null;bd(tt,ke,Oe,fe,Te,nn,$n,qe,Sn,y.aD(Te,Je,me,ve),Fe.toUnwrapped(),Bn)}}}(N,S,D,I,D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),F),0!==D.paint.get("icon-opacity").constantOr(1)&&$a(S,I,D,N,!1,D.paint.get("icon-translate"),D.paint.get("icon-translate-anchor"),D.layout.get("icon-rotation-alignment"),D.layout.get("icon-pitch-alignment"),D.layout.get("icon-keep-upright"),H,Y,V),0!==D.paint.get("text-opacity").constantOr(1)&&$a(S,I,D,N,!0,D.paint.get("text-translate"),D.paint.get("text-translate-anchor"),D.layout.get("text-rotation-alignment"),D.layout.get("text-pitch-alignment"),D.layout.get("text-keep-upright"),H,Y,V),I.map.showCollisionBoxes&&(Ec(S,I,D,N,!0),Ec(S,I,D,N,!1))}(o,u,f,_,this.style.placement.variableOffsets,x):y.cc(f)?function(S,I,D,N,F){if("translucent"!==S.renderPass)return;const{isRenderingToTexture:U}=F,V=D.paint.get("circle-opacity"),H=D.paint.get("circle-stroke-width"),Y=D.paint.get("circle-stroke-opacity"),oe=!D.layout.get("circle-sort-key").isConstant();if(0===V.constantOr(1)&&(0===H.constantOr(1)||0===Y.constantOr(1)))return;const re=S.context,ie=re.gl,ue=S.transform,pe=S.getDepthModeForSublayer(0,Wt.ReadOnly),he=ln.disabled,me=S.colorModeForRenderPass(),ve=[],fe=ue.getCircleRadiusCorrection();for(let Te=0;Te<N.length;Te++){const Be=N[Te],ke=I.getTile(Be),Oe=ke.getBucket(D);if(!Oe)continue;const Fe=D.paint.get("circle-translate"),Je=D.paint.get("circle-translate-anchor"),tt=y.aD(ue,ke,Fe,Je),qe=Oe.programConfigurations.get(D.id),Mt=S.useProgram("circle",qe),nn=Oe.layoutVertexBuffer,Sn=Oe.indexBuffer,$n=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Be),Bn={programConfiguration:qe,program:Mt,layoutVertexBuffer:nn,indexBuffer:Sn,uniformValues:dd(S,ke,D,tt,fe),terrainData:$n,projectionData:ue.getProjectionData({overscaledTileID:Be,applyGlobeMatrix:!U,applyTerrainMatrix:!0})};if(oe){const br=Oe.segments.get();for(const Dr of br)ve.push({segments:new y.aM([Dr]),sortKey:Dr.sortKey,state:Bn})}else ve.push({segments:Oe.segments,sortKey:0,state:Bn})}oe&&ve.sort((Te,Be)=>Te.sortKey-Be.sortKey);for(const Te of ve){const{programConfiguration:Be,program:ke,layoutVertexBuffer:Oe,indexBuffer:Fe,uniformValues:Je,terrainData:tt,projectionData:qe}=Te.state;ke.draw(re,ie.TRIANGLES,pe,he,me,Ot.backCCW,Je,tt,qe,D.id,Oe,Fe,Te.segments,D.paint,S.transform.zoom,Be)}}(o,u,f,_,x):y.cd(f)?function(S,I,D,N,F){if(0===D.paint.get("heatmap-opacity"))return;const U=S.context,{isRenderingToTexture:V,isRenderingGlobe:H}=F;if(S.style.map.terrain){for(const Y of N){const oe=I.getTile(Y);I.hasRenderableParent(Y)||("offscreen"===S.renderPass?xd(S,oe,D,Y,H):"translucent"===S.renderPass&&js(S,D,Y,V,H))}U.viewport.set([0,0,S.width,S.height])}else"offscreen"===S.renderPass?function(Y,oe,re,ie){const ue=Y.context,pe=ue.gl,he=Y.transform,me=ln.disabled,ve=new Ln([pe.ONE,pe.ONE],y.bf.transparent,[!0,!0,!0,!0]);(function(fe,Te,Be){const ke=fe.gl;fe.activeTexture.set(ke.TEXTURE1),fe.viewport.set([0,0,Te.width/4,Te.height/4]);let Oe=Be.heatmapFbos.get(y.c2);Oe?(ke.bindTexture(ke.TEXTURE_2D,Oe.colorAttachment.get()),fe.bindFramebuffer.set(Oe.framebuffer)):(Oe=Mc(fe,Te.width/4,Te.height/4),Be.heatmapFbos.set(y.c2,Oe))})(ue,Y,re),ue.clear({color:y.bf.transparent});for(let fe=0;fe<ie.length;fe++){const Te=ie[fe];if(oe.hasRenderableParent(Te))continue;const Be=oe.getTile(Te),ke=Be.getBucket(re);if(!ke)continue;const Oe=ke.programConfigurations.get(re.id),Fe=Y.useProgram("heatmap",Oe),Je=he.getProjectionData({overscaledTileID:Te,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),tt=he.getCircleRadiusCorrection();Fe.draw(ue,pe.TRIANGLES,Wt.disabled,me,ve,Ot.backCCW,hd(Be,he.zoom,re.paint.get("heatmap-intensity"),tt),null,Je,re.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,re.paint,he.zoom,Oe)}ue.viewport.set([0,0,Y.width,Y.height])}(S,I,D,N):"translucent"===S.renderPass&&function(Y,oe){const re=Y.context,ie=re.gl;re.setColorMode(Y.colorModeForRenderPass());const ue=oe.heatmapFbos.get(y.c2);ue&&(re.activeTexture.set(ie.TEXTURE0),ie.bindTexture(ie.TEXTURE_2D,ue.colorAttachment.get()),re.activeTexture.set(ie.TEXTURE1),Vs(re,oe).bind(ie.LINEAR,ie.CLAMP_TO_EDGE),Y.useProgram("heatmapTexture").draw(re,ie.TRIANGLES,Wt.disabled,ln.disabled,Y.colorModeForRenderPass(),Ot.disabled,au(Y,oe,0,1),null,null,oe.id,Y.viewportBuffer,Y.quadTriangleIndexBuffer,Y.viewportSegments,oe.paint,Y.transform.zoom))}(S,D)}(o,u,f,_,x):y.ce(f)?function(S,I,D,N,F){if("translucent"!==S.renderPass)return;const{isRenderingToTexture:U}=F,V=D.paint.get("line-opacity"),H=D.paint.get("line-width");if(0===V.constantOr(1)||0===H.constantOr(1))return;const Y=S.getDepthModeForSublayer(0,Wt.ReadOnly),oe=S.colorModeForRenderPass(),re=D.paint.get("line-dasharray"),ie=D.paint.get("line-pattern"),ue=ie.constantOr(1),pe=D.paint.get("line-gradient"),he=D.getCrossfadeParameters(),me=ue?"linePattern":re?"lineSDF":pe?"lineGradient":"line",ve=S.context,fe=ve.gl,Te=S.transform;let Be=!0;for(const ke of N){const Oe=I.getTile(ke);if(ue&&!Oe.patternsLoaded())continue;const Fe=Oe.getBucket(D);if(!Fe)continue;const Je=Fe.programConfigurations.get(D.id),tt=S.context.program.get(),qe=S.useProgram(me,Je),Mt=Be||qe.program!==tt,nn=S.style.map.terrain&&S.style.map.terrain.getTerrainData(ke),Sn=ie.constantOr(null);if(Sn&&Oe.imageAtlas){const tn=Oe.imageAtlas,zn=tn.patternPositions[Sn.to.toString()],xr=tn.patternPositions[Sn.from.toString()];zn&&xr&&Je.setConstantPatternPositions(zn,xr)}const $n=Te.getProjectionData({overscaledTileID:ke,applyGlobeMatrix:!U,applyTerrainMatrix:!0}),Bn=Te.getPixelScale(),br=ue?fd(S,Oe,D,Bn,he):re?Ls(S,Oe,D,Bn,re,he):pe?za(S,Oe,D,Bn,Fe.lineClipsArray.length):Oo(S,Oe,D,Bn);if(ue)ve.activeTexture.set(fe.TEXTURE0),Oe.imageAtlasTexture.bind(fe.LINEAR,fe.CLAMP_TO_EDGE),Je.updatePaintBuffers(he);else if(re&&(Mt||S.lineAtlas.dirty))ve.activeTexture.set(fe.TEXTURE0),S.lineAtlas.bind(ve);else if(pe){const tn=Fe.gradients[D.id];let zn=tn.texture;if(D.gradientVersion!==tn.version){let xr=256;if(D.stepInterpolant){const Ar=I.getSource().maxzoom,no=ke.canonical.z===Ar?Math.ceil(1<<S.transform.maxZoom-ke.canonical.z):1;xr=y.ah(y.c3(Fe.maxLineLength/y.$*1024*no),256,ve.maxTextureSize)}tn.gradient=y.c4({expression:D.gradientExpression(),evaluationKey:"lineProgress",resolution:xr,image:tn.gradient||void 0,clips:Fe.lineClipsArray}),tn.texture?tn.texture.update(tn.gradient):tn.texture=new y.T(ve,tn.gradient,fe.RGBA),tn.version=D.gradientVersion,zn=tn.texture}ve.activeTexture.set(fe.TEXTURE0),zn.bind(D.stepInterpolant?fe.NEAREST:fe.LINEAR,fe.CLAMP_TO_EDGE)}const Dr=S.stencilModeForClipping(ke);qe.draw(ve,fe.TRIANGLES,Y,Dr,oe,Ot.disabled,br,nn,$n,D.id,Fe.layoutVertexBuffer,Fe.indexBuffer,Fe.segments,D.paint,S.transform.zoom,Je,Fe.layoutVertexBuffer2),Be=!1}}(o,u,f,_,x):y.cf(f)?function(S,I,D,N,F){const U=D.paint.get("fill-color"),V=D.paint.get("fill-opacity");if(0===V.constantOr(1))return;const{isRenderingToTexture:H}=F,Y=S.colorModeForRenderPass(),oe=D.paint.get("fill-pattern"),re=S.opaquePassEnabledForLayer()&&!oe.constantOr(1)&&1===U.constantOr(y.bf.transparent).a&&1===V.constantOr(0)?"opaque":"translucent";if(S.renderPass===re){const ie=S.getDepthModeForSublayer(1,"opaque"===S.renderPass?Wt.ReadWrite:Wt.ReadOnly);Tc(S,I,D,N,ie,Y,!1,H)}if("translucent"===S.renderPass&&D.paint.get("fill-antialias")){const ie=S.getDepthModeForSublayer(D.getPaintProperty("fill-outline-color")?2:0,Wt.ReadOnly);Tc(S,I,D,N,ie,Y,!0,H)}}(o,u,f,_,x):y.cg(f)?function(S,I,D,N,F){const U=D.paint.get("fill-extrusion-opacity");if(0===U)return;const{isRenderingToTexture:V}=F;if("translucent"===S.renderPass){const H=new Wt(S.context.gl.LEQUAL,Wt.ReadWrite,S.depthRangeFor3D);if(1!==U||D.paint.get("fill-extrusion-pattern").constantOr(1))Ic(S,I,D,N,H,ln.disabled,Ln.disabled,V),Ic(S,I,D,N,H,S.stencilModeFor3D(),S.colorModeForRenderPass(),V);else{const Y=S.colorModeForRenderPass();Ic(S,I,D,N,H,ln.disabled,Y,V)}}}(o,u,f,_,x):y.ch(f)?function(S,I,D,N,F){if("offscreen"!==S.renderPass&&"translucent"!==S.renderPass)return;const{isRenderingToTexture:U}=F,V=S.context,H=S.style.projection.useSubdivision,Y=S.getDepthModeForSublayer(0,Wt.ReadOnly),oe=S.colorModeForRenderPass();if("offscreen"===S.renderPass)(function(re,ie,ue,pe,he,me,ve){const fe=re.context,Te=fe.gl;for(const Be of ue){const ke=ie.getTile(Be),Oe=ke.dem;if(!Oe||!Oe.data||!ke.needsHillshadePrepare)continue;const Fe=Oe.dim,Je=Oe.stride,tt=Oe.getPixels();if(fe.activeTexture.set(Te.TEXTURE1),fe.pixelStoreUnpackPremultiplyAlpha.set(!1),ke.demTexture=ke.demTexture||re.getTileTexture(Je),ke.demTexture){const Mt=ke.demTexture;Mt.update(tt,{premultiply:!1}),Mt.bind(Te.NEAREST,Te.CLAMP_TO_EDGE)}else ke.demTexture=new y.T(fe,tt,Te.RGBA,{premultiply:!1}),ke.demTexture.bind(Te.NEAREST,Te.CLAMP_TO_EDGE);fe.activeTexture.set(Te.TEXTURE0);let qe=ke.fbo;if(!qe){const Mt=new y.T(fe,{width:Fe,height:Fe,data:null},Te.RGBA);Mt.bind(Te.LINEAR,Te.CLAMP_TO_EDGE),qe=ke.fbo=fe.createFramebuffer(Fe,Fe,!0,!1),qe.colorAttachment.set(Mt.texture)}fe.bindFramebuffer.set(qe.framebuffer),fe.viewport.set([0,0,Fe,Fe]),re.useProgram("hillshadePrepare").draw(fe,Te.TRIANGLES,he,me,ve,Ot.disabled,lu(ke.tileID,Oe),null,null,pe.id,re.rasterBoundsBuffer,re.quadTriangleIndexBuffer,re.rasterBoundsSegments),ke.needsHillshadePrepare=!1}})(S,I,N,D,Y,ln.disabled,oe),V.viewport.set([0,0,S.width,S.height]);else if("translucent"===S.renderPass)if(H){const[re,ie,ue]=S.stencilConfigForOverlapTwoPass(N);Ui(S,I,D,ue,re,Y,oe,!1,U),Ui(S,I,D,ue,ie,Y,oe,!0,U)}else{const[re,ie]=S.getStencilConfigForOverlapAndUpdateStencilID(N);Ui(S,I,D,ie,re,Y,oe,!1,U)}}(o,u,f,_,x):y.ci(f)?function(S,I,D,N,F){if("translucent"!==S.renderPass||!N.length)return;const{isRenderingToTexture:U}=F,V=S.style.projection.useSubdivision,H=S.getDepthModeForSublayer(0,Wt.ReadOnly),Y=S.colorModeForRenderPass();if(V){const[oe,re,ie]=S.stencilConfigForOverlapTwoPass(N);Dc(S,I,D,ie,oe,H,Y,!1,U),Dc(S,I,D,ie,re,H,Y,!0,U)}else{const[oe,re]=S.getStencilConfigForOverlapAndUpdateStencilID(N);Dc(S,I,D,re,oe,H,Y,!1,U)}}(o,u,f,_,x):y.cj(f)?function(S,I,D,N,F){if("translucent"!==S.renderPass||0===D.paint.get("raster-opacity")||!N.length)return;const{isRenderingToTexture:U}=F,V=I.getSource(),H=S.style.projection.useSubdivision;if(V instanceof Lr)xa(S,I,D,N,null,!1,!1,V.tileCoords,V.flippedWindingOrder,U);else if(H){const[Y,oe,re]=S.stencilConfigForOverlapTwoPass(N);xa(S,I,D,re,Y,!1,!0,ba,!1,U),xa(S,I,D,re,oe,!0,!0,ba,!1,U)}else{const[Y,oe]=S.getStencilConfigForOverlapAndUpdateStencilID(N);xa(S,I,D,oe,Y,!1,!0,ba,!1,U)}}(o,u,f,_,x):y.ck(f)?function(S,I,D,N,F){const U=D.paint.get("background-color"),V=D.paint.get("background-opacity");if(0===V)return;const{isRenderingToTexture:H}=F,Y=S.context,oe=Y.gl,re=S.style.projection,ie=S.transform,ue=ie.tileSize,pe=D.paint.get("background-pattern");if(S.isPatternMissing(pe))return;const he=!pe&&1===U.a&&1===V&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==he)return;const me=ln.disabled,ve=S.getDepthModeForSublayer(0,"opaque"===he?Wt.ReadWrite:Wt.ReadOnly),fe=S.colorModeForRenderPass(),Te=S.useProgram(pe?"backgroundPattern":"background"),Be=N||Me(ie,{tileSize:ue,terrain:S.style.map.terrain});pe&&(Y.activeTexture.set(oe.TEXTURE0),S.imageManager.bind(S.context));const ke=D.getCrossfadeParameters();for(const Oe of Be){const Fe=ie.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!H,applyTerrainMatrix:!0}),Je=pe?Bs(V,S,pe,{tileID:Oe,tileSize:ue},ke):cu(V,U),tt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Oe),qe=re.getMeshFromTileID(Y,Oe.canonical,!1,!0,"raster");Te.draw(Y,oe.TRIANGLES,ve,me,fe,Ot.backCCW,Je,tt,Fe,D.id,qe.vertexBuffer,qe.indexBuffer,qe.segments)}}(o,0,f,_,x):y.cl(f)&&function(S,I,D,N){const{isRenderingGlobe:F}=N,U=S.context,V=D.implementation,H=S.style.projection,Y=S.transform,oe=Y.getProjectionDataForCustomLayer(F),re={farZ:Y.farZ,nearZ:Y.nearZ,fov:Y.fov*Math.PI/180,modelViewProjectionMatrix:Y.modelViewProjectionMatrix,projectionMatrix:Y.projectionMatrix,shaderData:{variantName:H.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;\nuniform mat4 u_projection_matrix;\n${H.shaderPreludeCode.vertexSource}`,define:H.shaderDefine},defaultProjectionData:oe},ie=V.renderingMode?V.renderingMode:"2d";if("offscreen"===S.renderPass){const ue=V.prerender;ue&&(S.setCustomLayerDefaults(),U.setColorMode(S.colorModeForRenderPass()),ue.call(V,U.gl,re),U.setDirty(),S.setBaseState())}else if("translucent"===S.renderPass){S.setCustomLayerDefaults(),U.setColorMode(S.colorModeForRenderPass()),U.setStencilMode(ln.disabled);const ue="3d"===ie?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,Wt.ReadOnly);U.setDepthMode(ue),V.render(U.gl,re),U.setDirty(),S.setBaseState(),U.bindFramebuffer.set(null)}}(o,0,f,x))}saveTileTexture(o){const u=this._tileTextures[o.size[0]];u?u.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const u=this._tileTextures[o];return u&&u.length>0?u.pop():null}isPatternMissing(o){if(!o)return!1;if(!o.from||!o.to)return!0;const u=this.imageManager.getPattern(o.from.toString()),f=this.imageManager.getPattern(o.to.toString());return!u||!f}useProgram(o,u,f=!1,_=[]){this.cache=this.cache||{};const x=!!this.style.map.terrain,S=this.style.projection,I=f?co.projectionMercator:S.shaderPreludeCode,D=f?$o:S.shaderDefine,N=o+(u?u.cacheKey:"")+`/${f?Ni:S.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(x?"/terrain":"")+(_?`/${_.join("/")}`:"");return this.cache[N]||(this.cache[N]=new yl(this.context,co[o],u,Sl[o],this._showOverdrawInspector,x,I,D,_)),this.cache[N]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new y.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:o,drawingBufferHeight:u}=this.context.gl;return this.width!==o||this.height!==u}}function Ha(b,o){let u,f=!1,_=null,x=null;const S=()=>{_=null,f&&(b.apply(x,u),_=setTimeout(S,o),f=!1)};return(...I)=>(f=!0,x=this,u=I,_||S(),_)}class Us{constructor(o){this._getCurrentHash=()=>{const u=window.location.hash.replace("#","");if(this._hashName){let f;return u.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(f=_)}),(f&&f[1]||"").split("/")}return u.split("/")},this._onHashChange=()=>{const u=this._getCurrentHash();if(!this._isValidHash(u))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(u[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+u[2],+u[1]],zoom:+u[0],bearing:f,pitch:+(u[4]||0)}),!0},this._updateHashUnthrottled=()=>{const u=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,u)},this._removeHash=()=>{const u=this._getCurrentHash();if(0===u.length)return;const f=u.join("/");let _=f;_.split("&").length>0&&(_=_.split("&")[0]),this._hashName&&(_=`${this._hashName}=${f}`);let x=window.location.hash.replace(_,"");x.startsWith("#&")?x=x.slice(0,1)+x.slice(2):"#"===x&&(x="");let S=window.location.href.replace(/(#.+)?$/,x);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=Ha(this._updateHashUnthrottled,300),this._hashName=o&&encodeURIComponent(o)}addTo(o){return this._map=o,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(o){const u=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,_=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,_),S=Math.round(u.lng*x)/x,I=Math.round(u.lat*x)/x,D=this._map.getBearing(),N=this._map.getPitch();let F="";if(F+=o?`/${S}/${I}/${f}`:`${f}/${I}/${S}`,(D||N)&&(F+="/"+Math.round(10*D)/10),N&&(F+=`/${Math.round(N)}`),this._hashName){const U=this._hashName;let V=!1;const H=window.location.hash.slice(1).split("&").map(Y=>{const oe=Y.split("=")[0];return oe===U?(V=!0,`${oe}=${F}`):Y}).filter(Y=>Y);return V||H.push(`${U}=${F}`),`#${H.join("&")}`}return`#${F}`}_isValidHash(o){if(o.length<3||o.some(isNaN))return!1;try{new y.S(+o[2],+o[1])}catch{return!1}const u=+o[0],f=+(o[3]||0),_=+(o[4]||0);return u>=this._map.getMinZoom()&&u<=this._map.getMaxZoom()&&f>=-180&&f<=180&&_>=this._map.getMinPitch()&&_<=this._map.getMaxPitch()}}const as={linearity:.3,easing:y.cm(0,0,.3,1)},Wa=y.e({deceleration:2500,maxSpeed:1400},as),Rc=y.e({deceleration:20,maxSpeed:1400},as),Oc=y.e({deceleration:1e3,maxSpeed:360},as),Bh=y.e({deceleration:1e3,maxSpeed:90},as),zh=y.e({deceleration:1e3,maxSpeed:360},as);class vu{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:mt.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,u=mt.now();for(;o.length>0&&u-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,roll:0,pan:new y.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)u.zoom+=x.zoomDelta||0,u.bearing+=x.bearingDelta||0,u.pitch+=x.pitchDelta||0,u.roll+=x.rollDelta||0,x.panDelta&&u.pan._add(x.panDelta),x.around&&(u.around=x.around),x.pinchAround&&(u.pinchAround=x.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(u.pan.mag()){const x=wa(u.pan.mag(),f,y.e({},Wa,o||{})),S=u.pan.mult(x.amount/u.pan.mag()),I=this._map.cameraHelper.handlePanInertia(S,this._map.transform);_.center=I.easingCenter,_.offset=I.easingOffset,bi(_,x)}if(u.zoom){const x=wa(u.zoom,f,Rc);_.zoom=this._map.transform.zoom+x.amount,bi(_,x)}if(u.bearing){const x=wa(u.bearing,f,Oc);_.bearing=this._map.transform.bearing+y.ah(x.amount,-179,179),bi(_,x)}if(u.pitch){const x=wa(u.pitch,f,Bh);_.pitch=this._map.transform.pitch+x.amount,bi(_,x)}if(u.roll){const x=wa(u.roll,f,zh);_.roll=this._map.transform.roll+y.ah(x.amount,-179,179),bi(_,x)}if(_.zoom||_.bearing){const x=void 0===u.pinchAround?u.around:u.pinchAround;_.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),y.e(_,{noMoveStart:!0})}}function bi(b,o){(!b.duration||b.duration<o.duration)&&(b.duration=o.duration,b.easing=o.easing)}function wa(b,o,u){const{maxSpeed:f,linearity:_,deceleration:x}=u,S=y.ah(b*_/(o/1e3),-f,f),I=Math.abs(S)/(x*_);return{easing:u.easing,duration:1e3*I,amount:S*(I/2)}}class fo extends y.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,f,_={}){f=f instanceof MouseEvent?f:new MouseEvent(o,f);const x=Ce.mousePos(u.getCanvas(),f),S=u.unproject(x);super(o,y.e({point:x,lngLat:S,originalEvent:f},_)),this._defaultPrevented=!1,this.target=u}}class Gs extends y.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,f){const _="touchend"===o?f.changedTouches:f.touches,x=Ce.touchPos(u.getCanvasContainer(),_),S=x.map(D=>u.unproject(D)),I=x.reduce((D,N,F,U)=>D.add(N.div(U.length)),new y.P(0,0));super(o,{points:x,point:I,lngLats:S,lngLat:u.unproject(I),originalEvent:f}),this._defaultPrevented=!1}}class Ca extends y.l{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,u,f){super(o,{originalEvent:f}),this._defaultPrevented=!1}}class qa{constructor(o,u){this._map=o,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(o){return this._firePreventable(new Ca(o.type,this._map,o))}mousedown(o,u){return this._mousedownPos=u,this._firePreventable(new fo(o.type,this._map,o))}mouseup(o){this._map.fire(new fo(o.type,this._map,o))}click(o,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new fo(o.type,this._map,o))}dblclick(o){return this._firePreventable(new fo(o.type,this._map,o))}mouseover(o){this._map.fire(new fo(o.type,this._map,o))}mouseout(o){this._map.fire(new fo(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Gs(o.type,this._map,o))}touchmove(o){this._map.fire(new Gs(o.type,this._map,o))}touchend(o){this._map.fire(new Gs(o.type,this._map,o))}touchcancel(o){this._map.fire(new Gs(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Cd{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(o){this._map.fire(new fo(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new fo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._ignoreContextMenu||this._map.fire(new fo(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nl{constructor(o){this._map=o}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(o){return this.transform.screenPointToLocation(y.P.convert(o),this._map.terrain)}}class bu{constructor(o,u){this._map=o,this._tr=new Nl(o),this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,u){this.isEnabled()&&o.shiftKey&&0===o.button&&(Ce.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(o,u){if(!this._active)return;const f=u;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const _=this._startPos;this._lastPos=f,this._box||(this._box=Ce.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",o));const x=Math.min(_.x,f.x),S=Math.max(_.x,f.x),I=Math.min(_.y,f.y),D=Math.max(_.y,f.y);Ce.setTransform(this._box,`translate(${x}px,${I}px)`),this._box.style.width=S-x+"px",this._box.style.height=D-I+"px"}mouseupWindow(o,u){if(!this._active||0!==o.button)return;const f=this._startPos,_=u;if(this.reset(),Ce.suppressClick(),f.x!==_.x||f.y!==_.y)return this._map.fire(new y.l("boxzoomend",{originalEvent:o})),{cameraAnimation:x=>x.fitScreenCoordinates(f,_,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",o)}keydown(o){this._active&&27===o.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",o))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(Ce.remove(this._box),this._box=null),Ce.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(o,u){return this._map.fire(new y.l(o,{originalEvent:u}))}}function Za(b,o){if(b.length!==o.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${o.length}`);const u={};for(let f=0;f<b.length;f++)u[b[f].identifier]=o[f];return u}class jh{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(o,u,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=o.timeStamp),f.length===this.numTouches&&(this.centroid=function(_){const x=new y.P(0,0);for(const S of _)x._add(S);return x.div(_.length)}(u),this.touches=Za(f,u)))}touchmove(o,u,f){if(this.aborted||!this.centroid)return;const _=Za(f,u);for(const x in this.touches){const S=_[x];(!S||S.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(o,u,f){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),0===f.length){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class Co{constructor(o){this.singleTap=new jh(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(o,u,f){this.singleTap.touchstart(o,u,f)}touchmove(o,u,f){this.singleTap.touchmove(o,u,f)}touchend(o,u,f){const _=this.singleTap.touchend(o,u,f);if(_){const x=o.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(_)<30;if(x&&S||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class xi{constructor(o){this._tr=new Nl(o),this._zoomIn=new Co({numTouches:1,numTaps:2}),this._zoomOut=new Co({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,u,f){this._zoomIn.touchstart(o,u,f),this._zoomOut.touchstart(o,u,f)}touchmove(o,u,f){this._zoomIn.touchmove(o,u,f),this._zoomOut.touchmove(o,u,f)}touchend(o,u,f){const _=this._zoomIn.touchend(o,u,f),x=this._zoomOut.touchend(o,u,f),S=this._tr;return _?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(_)},{originalEvent:o})}):x?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(x)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ll{constructor(o){this._enabled=!!o.enable,this._moveStateManager=o.moveStateManager,this._clickTolerance=o.clickTolerance||1,this._moveFunction=o.move,this._activateOnStart=!!o.activateOnStart,o.assignEvents(this),this.reset()}reset(o){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(o)}_move(...o){const u=this._moveFunction(...o);if(u.bearingDelta||u.pitchDelta||u.rollDelta||u.around||u.panDelta)return this._active=!0,u}dragStart(o,u){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(o)&&(this._moveStateManager.startMove(o),this._lastPoint=Array.isArray(u)?u[0]:u,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(o,u){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(o.preventDefault(),!this._moveStateManager.isValidMoveEvent(o))return void this.reset(o);const _=Array.isArray(u)?u[0]:u;return!this._moved&&_.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=_,this._move(f,_))}dragEnd(o){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(o)&&(this._moved&&Ce.suppressClick(),this.reset(o))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const wi=0,Ya=2,Vh={[wi]:1,[Ya]:2};class $s{constructor(o){this._correctEvent=o.checkCorrectEvent}startMove(o){const u=Ce.mouseButton(o);this._eventButton=u}endMove(o){delete this._eventButton}isValidStartEvent(o){return this._correctEvent(o)}isValidMoveEvent(o){return!function(u,f){const _=Vh[f];return void 0===u.buttons||(u.buttons&_)!==_}(o,this._eventButton)}isValidEndEvent(o){return Ce.mouseButton(o)===this._eventButton}}class Uh{constructor(){this._firstTouch=void 0}_isOneFingerTouch(o){return 1===o.targetTouches.length}_isSameTouchEvent(o){return o.targetTouches[0].identifier===this._firstTouch}startMove(o){this._firstTouch=o.targetTouches[0].identifier}endMove(o){delete this._firstTouch}isValidStartEvent(o){return this._isOneFingerTouch(o)}isValidMoveEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}isValidEndEvent(o){return this._isOneFingerTouch(o)&&this._isSameTouchEvent(o)}}class Gf{constructor(o=new $s({checkCorrectEvent:()=>!0}),u=new Uh){this.mouseMoveStateManager=o,this.oneFingerTouchMoveStateManager=u}_executeRelevantHandler(o,u,f){return o instanceof MouseEvent?u(o):typeof TouchEvent<"u"&&o instanceof TouchEvent?f(o):void 0}startMove(o){this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.startMove(u),u=>this.oneFingerTouchMoveStateManager.startMove(u))}endMove(o){this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.endMove(u),u=>this.oneFingerTouchMoveStateManager.endMove(u))}isValidStartEvent(o){return this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.isValidStartEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidStartEvent(u))}isValidMoveEvent(o){return this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.isValidMoveEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(u))}isValidEndEvent(o){return this._executeRelevantHandler(o,u=>this.mouseMoveStateManager.isValidEndEvent(u),u=>this.oneFingerTouchMoveStateManager.isValidEndEvent(u))}}const ls=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=o=>{o.preventDefault()}};class Ka{constructor(o,u){this._clickTolerance=o.clickTolerance||1,this._map=u,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new y.P(0,0)}_shouldBePrevented(o){return o<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(o,u,f){return this._calculateTransform(o,u,f)}touchmove(o,u,f){if(this._active){if(!this._shouldBePrevented(f.length))return o.preventDefault(),this._calculateTransform(o,u,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",o)}}touchend(o,u,f){this._calculateTransform(o,u,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,u,f){f.length>0&&(this._active=!0);const _=Za(f,u),x=new y.P(0,0),S=new y.P(0,0);let I=0;for(const N in _){const F=_[N],U=this._touches[N];U&&(x._add(F),S._add(F.sub(U)),I++,_[N]=F)}if(this._touches=_,this._shouldBePrevented(I)||!S.mag())return;const D=S.div(I);return this._sum._add(D),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(I),panDelta:D}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gi{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(o,u,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([u[0],u[1]]))}touchmove(o,u,f){if(!this._firstTwoTouches)return;o.preventDefault();const[_,x]=this._firstTwoTouches,S=ht(f,u,_),I=ht(f,u,x);if(!S||!I)return;const D=this._aroundCenter?null:S.add(I).div(2);return this._move([S,I],D,o)}touchend(o,u,f){if(!this._firstTwoTouches)return;const[_,x]=this._firstTwoTouches,S=ht(f,u,_),I=ht(f,u,x);S&&I||(this._active&&Ce.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function ht(b,o,u){for(let f=0;f<b.length;f++)if(b[f].identifier===u)return o[f]}function Xa(b,o){return Math.log(b/o)/Math.LN2}class Hs extends Gi{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,u){const f=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Xa(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Xa(this._distance,f),pinchAround:u}}}function ri(b,o){return 180*b.angleWith(o)/Math.PI}class Ci extends Gi{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,u,f){const _=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ri(this._vector,_),pinchAround:u}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const u=25/(Math.PI*this._minDiameter)*360,f=ri(o,this._startVector);return Math.abs(f)<u}}function cs(b){return Math.abs(b.y)>Math.abs(b.x)}class us extends Gi{constructor(o){super(),this._currentTouchCount=0,this._map=o}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(o,u,f){super.touchstart(o,u,f),this._currentTouchCount=f.length}_start(o){this._lastPoints=o,cs(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,u,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const _=o[0].sub(this._lastPoints[0]),x=o[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(_,x,f.timeStamp),this._valid?(this._lastPoints=o,this._active=!0,{pitchDelta:(_.y+x.y)/2*-.5}):void 0}gestureBeginsVertically(o,u,f){if(void 0!==this._valid)return this._valid;const _=o.mag()>=2,x=u.mag()>=2;if(!_&&!x)return;if(!_||!x)return void 0===this._firstMove&&(this._firstMove=f),f-this._firstMove<100&&void 0;const S=o.y>0==u.y>0;return cs(o)&&cs(u)&&S}}const on={panStep:100,bearingStep:15,pitchStep:10};class ds{constructor(o){this._tr=new Nl(o);const u=on;this._panStep=u.panStep,this._bearingStep=u.bearingStep,this._pitchStep=u.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let u=0,f=0,_=0,x=0,S=0;switch(o.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:o.shiftKey?f=-1:(o.preventDefault(),x=-1);break;case 39:o.shiftKey?f=1:(o.preventDefault(),x=1);break;case 38:o.shiftKey?_=1:(o.preventDefault(),S=-1);break;case 40:o.shiftKey?_=-1:(o.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(f=0,_=0),{cameraAnimation:I=>{const D=this._tr;I.easeTo({duration:300,easeId:"keyboardHandler",easing:xu,zoom:u?Math.round(D.zoom)+u*(o.shiftKey?2:1):D.zoom,bearing:D.bearing+f*this._bearingStep,pitch:D.pitch+_*this._pitchStep,offset:[-x*this._panStep,-S*this._panStep],center:D.center},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function xu(b){return b*(2-b)}const Fl=4.000244140625,Sd=1/450;class Nc{constructor(o,u){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=o,this._tr=new Nl(o),this._triggerRenderFrame=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Sd}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around)}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(o){return!!this._map.cooperativeGestures.isEnabled()&&!(o.ctrlKey||this._map.cooperativeGestures.isBypassed(o))}wheel(o){if(!this.isEnabled())return;if(this._shouldBePrevented(o))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",o);let u=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const f=mt.now(),_=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,0!==u&&u%Fl==0?this._type="wheel":0!==u&&Math.abs(u)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(_*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),o.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=o,this._delta-=u,this._active||this._start(o)),o.preventDefault()}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=Ce.mousePos(this._map.getCanvas(),o),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(y.S.convert(f.center)):u,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._tr.transform;if("number"==typeof this._lastExpectedZoom){const I=o.zoom-this._lastExpectedZoom;"number"==typeof this._startZoom&&(this._startZoom+=I),"number"==typeof this._targetZoom&&(this._targetZoom+=I)}if(0!==this._delta){const I="wheel"===this._type&&Math.abs(this._delta)>Fl?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&0!==D&&(D=1/D);const N="number"!=typeof this._targetZoom?o.scale:y.af(this._targetZoom);this._targetZoom=o.getConstrained(o.getCameraLngLat(),y.ak(N*D)).zoom,"wheel"===this._type&&(this._startZoom=o.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const u="number"!=typeof this._targetZoom?o.zoom:this._targetZoom,f=this._startZoom,_=this._easing;let x,S=!1;if("wheel"===this._type&&f&&_){const I=mt.now()-this._lastWheelEventTime,D=Math.min((I+5)/200,1),N=_(D);x=y.C.number(f,u,N),D<1?this._frameId||(this._frameId=!0):S=!0}else x=u,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=x,{noInertia:!0,needsRenderFrame:!S,zoomDelta:x-o.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let u=y.co;if(this._prevEase){const f=this._prevEase,_=(mt.now()-f.start)/f.duration,x=f.easing(_+.01)-f.easing(_),S=.27/Math.sqrt(x*x+1e-4)*.01,I=Math.sqrt(.0729-S*S);u=y.cm(S,I,.25,1)}return this._prevEase={start:mt.now(),duration:o,easing:u},u}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class wu{constructor(o,u){this._clickZoom=o,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Cu{constructor(o){this._tr=new Nl(o),this.reset()}reset(){this._active=!1}dblclick(o,u){return o.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(o.shiftKey?-1:1),around:this._tr.unproject(u)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Su{constructor(){this._tap=new Co({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(o,u,f){if(!this._swipePoint)if(this._tapTime){const _=u[0],x=o.timeStamp-this._tapTime<500,S=this._tapPoint.dist(_)<30;x&&S?f.length>0&&(this._swipePoint=_,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(o,u,f)}touchmove(o,u,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const _=u[0],x=_.y-this._swipePoint.y;return this._swipePoint=_,o.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(o,u,f)}touchend(o,u,f){if(this._tapTime)this._swipePoint&&0===f.length&&this.reset();else{const _=this._tap.touchend(o,u,f);_&&(this._tapTime=o.timeStamp,this._tapPoint=_)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ed{constructor(o,u,f){this._el=o,this._mousePan=u,this._touchPan=f}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Lc{constructor(o,u,f,_){this._pitchWithRotate=o.pitchWithRotate,this._rollEnabled=o.rollEnabled,this._mouseRotate=u,this._mousePitch=f,this._mouseRoll=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class Md{constructor(o,u,f,_){this._el=o,this._touchZoom=u,this._touchRotate=f,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class hs{constructor(o,u){this._bypassKey=-1!==navigator.userAgent.indexOf("Mac")?"metaKey":"ctrlKey",this._map=o,this._options=u,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const o=this._map.getCanvasContainer();o.classList.add("maplibregl-cooperative-gestures"),this._container=Ce.create("div","maplibregl-cooperative-gesture-screen",o);let u=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");"metaKey"===this._bypassKey&&(u=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),_=document.createElement("div");_.className="maplibregl-desktop-message",_.textContent=u,this._container.appendChild(_);const x=document.createElement("div");x.className="maplibregl-mobile-message",x.textContent=f,this._container.appendChild(x),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(Ce.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(o){return o[this._bypassKey]}notifyGestureBlocked(o,u){this._enabled&&(this._map.fire(new y.l("cooperativegestureprevented",{gestureType:o,originalEvent:u})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const So=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class Yn extends y.l{}function Bl(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class Eu{constructor(o,u){this.handleWindowEvent=_=>{this.handleEvent(_,`${_.type}Window`)},this.handleEvent=(_,x)=>{if("blur"===_.type)return void this.stop(!0);this._updatingCamera=!0;const S="renderFrame"===_.type?void 0:_,I={needsRenderFrame:!1},D={},N={};for(const{handlerName:V,handler:H,allowed:Y}of this._handlers){if(!H.isEnabled())continue;let oe;if(this._blockedByActive(N,Y,V))H.reset();else if(H[x||_.type]){if(y.cp(_,x||_.type)){const re=Ce.mousePos(this._map.getCanvas(),_);oe=H[x||_.type](_,re)}else if(y.cq(_,x||_.type)){const re=this._getMapTouches(_.touches),ie=Ce.touchPos(this._map.getCanvas(),re);oe=H[x||_.type](_,ie,re)}else y.cr(x||_.type)||(oe=H[x||_.type](_));this.mergeHandlerResult(I,D,oe,V,S),oe&&oe.needsRenderFrame&&this._triggerRenderFrame()}(oe||H.isActive())&&(N[V]=H)}const F={};for(const V in this._previousActiveHandlers)N[V]||(F[V]=S);this._previousActiveHandlers=N,(Object.keys(F).length||Bl(I))&&(this._changes.push([I,D,F]),this._triggerRenderFrame()),(Object.keys(N).length||Bl(I))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:U}=I;U&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],U(this._map))},this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new vu(o),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,x,S]of this._listeners)Ce.addEventListener(_,x,_===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[o,u,f]of this._listeners)Ce.removeEventListener(o,u,o===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(o){const u=this._map,f=u.getCanvasContainer();this._add("mapEvent",new qa(u,o));const _=u.boxZoom=new bu(u,o);this._add("boxZoom",_),o.interactive&&o.boxZoom&&_.enable();const x=u.cooperativeGestures=new hs(u,o.cooperativeGestures);this._add("cooperativeGestures",x),o.cooperativeGestures&&x.enable();const S=new xi(u),I=new Cu(u);u.doubleClickZoom=new wu(I,S),this._add("tapZoom",S),this._add("clickZoom",I),o.interactive&&o.doubleClickZoom&&u.doubleClickZoom.enable();const D=new Su;this._add("tapDragZoom",D);const N=u.touchPitch=new us(u);this._add("touchPitch",N),o.interactive&&o.touchPitch&&u.touchPitch.enable(o.touchPitch);const F=()=>u.project(u.getCenter()),U=function({enable:he,clickTolerance:me,aroundCenter:ve=!0,minPixelCenterThreshold:fe=100,rotateDegreesPerPixelMoved:Te=.8},Be){const ke=new $s({checkCorrectEvent:Oe=>0===Ce.mouseButton(Oe)&&Oe.ctrlKey||2===Ce.mouseButton(Oe)&&!Oe.ctrlKey});return new Ll({clickTolerance:me,move:(Oe,Fe)=>{const Je=Be();if(ve&&Math.abs(Je.y-Oe.y)>fe)return{bearingDelta:y.cn(new y.P(Oe.x,Fe.y),Fe,Je)};let tt=(Fe.x-Oe.x)*Te;return ve&&Fe.y<Je.y&&(tt=-tt),{bearingDelta:tt}},moveStateManager:ke,enable:he,assignEvents:ls})}(o,F),V=function({enable:he,clickTolerance:me,pitchDegreesPerPixelMoved:ve=-.5}){const fe=new $s({checkCorrectEvent:Te=>0===Ce.mouseButton(Te)&&Te.ctrlKey||2===Ce.mouseButton(Te)});return new Ll({clickTolerance:me,move:(Te,Be)=>({pitchDelta:(Be.y-Te.y)*ve}),moveStateManager:fe,enable:he,assignEvents:ls})}(o),H=function({enable:he,clickTolerance:me,rollDegreesPerPixelMoved:ve=.3},fe){const Te=new $s({checkCorrectEvent:Be=>2===Ce.mouseButton(Be)&&Be.ctrlKey});return new Ll({clickTolerance:me,move:(Be,ke)=>{const Oe=fe();let Fe=(ke.x-Be.x)*ve;return ke.y<Oe.y&&(Fe=-Fe),{rollDelta:Fe}},moveStateManager:Te,enable:he,assignEvents:ls})}(o,F);u.dragRotate=new Lc(o,U,V,H),this._add("mouseRotate",U,["mousePitch"]),this._add("mousePitch",V,["mouseRotate","mouseRoll"]),this._add("mouseRoll",H,["mousePitch"]),o.interactive&&o.dragRotate&&u.dragRotate.enable();const Y=function({enable:he,clickTolerance:me}){const ve=new $s({checkCorrectEvent:fe=>0===Ce.mouseButton(fe)&&!fe.ctrlKey});return new Ll({clickTolerance:me,move:(fe,Te)=>({around:Te,panDelta:Te.sub(fe)}),activateOnStart:!0,moveStateManager:ve,enable:he,assignEvents:ls})}(o),oe=new Ka(o,u);u.dragPan=new Ed(f,Y,oe),this._add("mousePan",Y),this._add("touchPan",oe,["touchZoom","touchRotate"]),o.interactive&&o.dragPan&&u.dragPan.enable(o.dragPan);const re=new Ci,ie=new Hs;u.touchZoomRotate=new Md(f,ie,re,D),this._add("touchRotate",re,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),o.interactive&&o.touchZoomRotate&&u.touchZoomRotate.enable(o.touchZoomRotate);const ue=u.scrollZoom=new Nc(u,()=>this._triggerRenderFrame());this._add("scrollZoom",ue,["mousePan"]),o.interactive&&o.scrollZoom&&u.scrollZoom.enable(o.scrollZoom);const pe=u.keyboard=new ds(u);this._add("keyboard",pe),o.interactive&&o.keyboard&&u.keyboard.enable(),this._add("blockableMapEvent",new Cd(u))}_add(o,u,f){this._handlers.push({handlerName:o,handler:u,allowed:f}),this._handlersById[o]=u}stop(o){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!So(this._eventsInProgress)||this.isZooming()}_blockedByActive(o,u,f){for(const _ in o)if(_!==f&&(!u||u.indexOf(_)<0))return!0;return!1}_getMapTouches(o){const u=[];for(const f of o)this._el.contains(f.target)&&u.push(f);return u}mergeHandlerResult(o,u,f,_,x){if(!f)return;y.e(o,f);const S={handlerName:_,originalEvent:f.originalEvent||x};void 0!==f.zoomDelta&&(u.zoom=S),void 0!==f.panDelta&&(u.drag=S),void 0!==f.rollDelta&&(u.roll=S),void 0!==f.pitchDelta&&(u.pitch=S),void 0!==f.bearingDelta&&(u.rotate=S)}_applyChanges(){const o={},u={},f={};for(const[_,x,S]of this._changes)_.panDelta&&(o.panDelta=(o.panDelta||new y.P(0,0))._add(_.panDelta)),_.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+_.pitchDelta),_.rollDelta&&(o.rollDelta=(o.rollDelta||0)+_.rollDelta),void 0!==_.around&&(o.around=_.around),void 0!==_.pinchAround&&(o.pinchAround=_.pinchAround),_.noInertia&&(o.noInertia=_.noInertia),y.e(u,x),y.e(f,S);this._updateMapTransform(o,u,f),this._changes=[]}_updateMapTransform(o,u,f){const _=this._map,x=_._getTransformForUpdate(),S=_.terrain;if(!(Bl(o)||S&&this._terrainMovement))return this._fireEvents(u,f,!0);_._stop(!0);let{panDelta:I,zoomDelta:D,bearingDelta:N,pitchDelta:F,rollDelta:U,around:V,pinchAround:H}=o;void 0!==H&&(V=H),V=V||_.transform.centerPoint,S&&!x.isPointOnMapSurface(V)&&(V=x.centerPoint);const Y={panDelta:I,zoomDelta:D,rollDelta:U,pitchDelta:F,bearingDelta:N,around:V};this._map.cameraHelper.useGlobeControls&&!x.isPointOnMapSurface(V)&&(V=x.centerPoint);const oe=V.distSqr(x.centerPoint)<.01?x.center:x.screenPointToLocation(I?V.sub(I):V);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Y,x),this._terrainMovement||!u.drag&&!u.zoom?u.drag&&this._terrainMovement?x.setCenter(x.screenPointToLocation(x.centerPoint.sub(I))):this._map.cameraHelper.handleMapControlsPan(Y,x,oe):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(Y,x,oe))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(Y,x),this._map.cameraHelper.handleMapControlsPan(Y,x,oe)),_._applyUpdatedTransform(x),this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(u,f,!0)}_fireEvents(o,u,f){const _=So(this._eventsInProgress),x=So(o),S={};for(const U in o){const{originalEvent:V}=o[U];this._eventsInProgress[U]||(S[`${U}start`]=V),this._eventsInProgress[U]=o[U]}!_&&x&&this._fireEvent("movestart",x.originalEvent);for(const U in S)this._fireEvent(U,S[U]);x&&this._fireEvent("move",x.originalEvent);for(const U in o){const{originalEvent:V}=o[U];this._fireEvent(U,V)}const I={};let D;for(const U in this._eventsInProgress){const{handlerName:V,originalEvent:H}=this._eventsInProgress[U];this._handlersById[V].isActive()||(delete this._eventsInProgress[U],D=u[V]||H,I[`${U}end`]=D)}for(const U in I)this._fireEvent(U,I[U]);const N=So(this._eventsInProgress),F=(_||x)&&!N;if(F&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const U=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&U.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(U)}if(f&&F){this._updatingCamera=!0;const U=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=H=>0!==H&&-this._bearingSnap<H&&H<this._bearingSnap;!U||!U.essential&&mt.prefersReducedMotion?(this._map.fire(new y.l("moveend",{originalEvent:D})),V(this._map.getBearing())&&this._map.resetNorth()):(V(U.bearing||this._map.getBearing())&&(U.bearing=0),U.freezeElevation=!0,this._map.easeTo(U,{originalEvent:D})),this._updatingCamera=!1}}_fireEvent(o,u){this._map.fire(new y.l(o,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{delete this._frameId,this.handleEvent(new Yn("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Gh extends y.E{constructor(o,u,f){super(),this._renderFrameCallback=()=>{const _=Math.min((mt.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(_)),_<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=f.bearingSnap,this.cameraHelper=u,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(o,u){o.apply(this.transform),this.transform=o,this.cameraHelper=u}getCenter(){return new y.S(this.transform.center.lng,this.transform.center.lat)}setCenter(o,u){return this.jumpTo({center:o},u)}getCenterElevation(){return this.transform.elevation}setCenterElevation(o,u){return this.jumpTo({elevation:o},u),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(o){this._centerClampedToGround=o}panBy(o,u,f){return o=y.P.convert(o).mult(-1),this.panTo(this.transform.center,y.e({offset:o},u),f)}panTo(o,u,f){return this.easeTo(y.e({center:o},u),f)}getZoom(){return this.transform.zoom}setZoom(o,u){return this.jumpTo({zoom:o},u),this}zoomTo(o,u,f){return this.easeTo(y.e({zoom:o},u),f)}zoomIn(o,u){return this.zoomTo(this.getZoom()+1,o,u),this}zoomOut(o,u){return this.zoomTo(this.getZoom()-1,o,u),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(o,u){return o!=this.transform.fov&&(this.transform.setFov(o),this.fire(new y.l("movestart",u)).fire(new y.l("move",u)).fire(new y.l("moveend",u))),this}getBearing(){return this.transform.bearing}setBearing(o,u){return this.jumpTo({bearing:o},u),this}getPadding(){return this.transform.padding}setPadding(o,u){return this.jumpTo({padding:o},u),this}rotateTo(o,u,f){return this.easeTo(y.e({bearing:o},u),f)}resetNorth(o,u){return this.rotateTo(0,y.e({duration:1e3},o),u),this}resetNorthPitch(o,u){return this.easeTo(y.e({bearing:0,pitch:0,roll:0,duration:1e3},o),u),this}snapToNorth(o,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,u):this}getPitch(){return this.transform.pitch}setPitch(o,u){return this.jumpTo({pitch:o},u),this}getRoll(){return this.transform.roll}setRoll(o,u){return this.jumpTo({roll:o},u),this}cameraForBounds(o,u){o=Jn.convert(o).adjustAntiMeridian();const f=u&&u.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),f,u)}_cameraForBoxAndBearing(o,u,f,_){const x={top:0,bottom:0,right:0,left:0};if("number"==typeof(_=y.e({padding:x,offset:[0,0],maxZoom:this.transform.maxZoom},_)).padding){const N=_.padding;_.padding={top:N,bottom:N,right:N,left:N}}const S=y.e(x,_.padding);_.padding=S;const I=this.transform,D=new Jn(o,u);return this.cameraHelper.cameraForBoxAndBearing(_,S,D,f,I)}fitBounds(o,u,f){return this._fitInternal(this.cameraForBounds(o,u),u,f)}fitScreenCoordinates(o,u,f,_,x){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(y.P.convert(o)),this.transform.screenPointToLocation(y.P.convert(u)),f,_),_,x)}_fitInternal(o,u,f){return o?(delete(u=y.e(o,u)).padding,u.linear?this.easeTo(u,f):this.flyTo(u,f)):this}jumpTo(o,u){this.stop();const f=this._getTransformForUpdate();let _=!1,x=!1,S=!1;const I=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,o);const D=f.zoom!==I;return"elevation"in o&&f.elevation!==+o.elevation&&f.setElevation(+o.elevation),"bearing"in o&&f.bearing!==+o.bearing&&(_=!0,f.setBearing(+o.bearing)),"pitch"in o&&f.pitch!==+o.pitch&&(x=!0,f.setPitch(+o.pitch)),"roll"in o&&f.roll!==+o.roll&&(S=!0,f.setRoll(+o.roll)),null==o.padding||f.isPaddingEqual(o.padding)||f.setPadding(o.padding),this._applyUpdatedTransform(f),this.fire(new y.l("movestart",u)).fire(new y.l("move",u)),D&&this.fire(new y.l("zoomstart",u)).fire(new y.l("zoom",u)).fire(new y.l("zoomend",u)),_&&this.fire(new y.l("rotatestart",u)).fire(new y.l("rotate",u)).fire(new y.l("rotateend",u)),x&&this.fire(new y.l("pitchstart",u)).fire(new y.l("pitch",u)).fire(new y.l("pitchend",u)),S&&this.fire(new y.l("rollstart",u)).fire(new y.l("roll",u)).fire(new y.l("rollend",u)),this.fire(new y.l("moveend",u))}calculateCameraOptionsFromTo(o,u,f,_=0){const x=y.a1.fromLngLat(o,u),S=y.a1.fromLngLat(f,_),I=S.x-x.x,D=S.y-x.y,N=S.z-x.z,F=Math.hypot(I,D,N);if(0===F)throw new Error("Can't calculate camera options with same From and To");const U=Math.hypot(I,D),V=y.ak(this.transform.cameraToCenterDistance/F/this.transform.tileSize),H=180*Math.atan2(I,-D)/Math.PI;let Y=180*Math.acos(U/F)/Math.PI;return Y=N<0?90-Y:90+Y,{center:S.toLngLat(),elevation:_,zoom:V,pitch:Y,bearing:H}}calculateCameraOptionsFromCameraLngLatAltRotation(o,u,f,_,x){const S=this.transform.calculateCenterFromCameraLngLatAlt(o,u,f,_);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:f,pitch:_,roll:x}}easeTo(o,u){this._stop(!1,o.easeId),(!1===(o=y.e({offset:[0,0],duration:500,easing:y.co},o)).animate||!o.essential&&mt.prefersReducedMotion)&&(o.duration=0);const f=this._getTransformForUpdate(),_=this.getBearing(),x=f.pitch,S=f.roll,I="bearing"in o?this._normalizeBearing(o.bearing,_):_,D="pitch"in o?+o.pitch:x,N="roll"in o?this._normalizeBearing(o.roll,S):S,F="padding"in o?o.padding:f.padding,U=y.P.convert(o.offset);let V,H;o.around&&(V=y.S.convert(o.around),H=f.locationToScreenPoint(V));const Y={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},oe=this.cameraHelper.handleEaseTo(f,{bearing:I,pitch:D,roll:N,padding:F,around:V,aroundPoint:H,offsetAsPoint:U,offset:o.offset,zoom:o.zoom,center:o.center});return this._rotating=this._rotating||_!==I,this._pitching=this._pitching||D!==x,this._rolling=this._rolling||N!==S,this._padding=!f.isPaddingEqual(F),this._zooming=this._zooming||oe.isZooming,this._easeId=o.easeId,this._prepareEase(u,o.noMoveStart,Y),this.terrain&&this._prepareElevation(oe.elevationCenter),this._ease(re=>{oe.easeFunc(re),this.terrain&&!o.freezeElevation&&this._updateElevation(re),this._applyUpdatedTransform(f),this._fireMoveEvents(u)},re=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(u,re)},o),this}_prepareEase(o,u,f={}){this._moving=!0,u||f.moving||this.fire(new y.l("movestart",o)),this._zooming&&!f.zooming&&this.fire(new y.l("zoomstart",o)),this._rotating&&!f.rotating&&this.fire(new y.l("rotatestart",o)),this._pitching&&!f.pitching&&this.fire(new y.l("pitchstart",o)),this._rolling&&!f.rolling&&this.fire(new y.l("rollstart",o))}_prepareElevation(o){this._elevationCenter=o,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(o){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const u=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(o<1&&u!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=o*(f-(u-(f*o+this._elevationStart))/(1-o)),this._elevationTarget=u}this.transform.setElevation(y.C.number(this._elevationStart,this._elevationTarget,o))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(o){if(!this.terrain&&o.elevation>=0&&o.pitch<=90)return{};const u=o.getCameraLngLat(),f=o.getCameraAltitude(),_=this.terrain?this.terrain.getElevationForLngLatZoom(u,o.zoom):0;if(f<_){const x=this.calculateCameraOptionsFromTo(u,_,o.center,o.elevation);return{pitch:x.pitch,zoom:x.zoom}}return{}}_applyUpdatedTransform(o){const u=[];if(u.push(_=>this._elevateCameraIfInsideTerrain(_)),this.transformCameraUpdate&&u.push(_=>this.transformCameraUpdate(_)),!u.length)return;const f=o.clone();for(const _ of u){const x=f.clone(),{center:S,zoom:I,roll:D,pitch:N,bearing:F,elevation:U}=_(x);S&&x.setCenter(S),void 0!==U&&x.setElevation(U),void 0!==I&&x.setZoom(I),void 0!==D&&x.setRoll(D),void 0!==N&&x.setPitch(N),void 0!==F&&x.setBearing(F),f.apply(x)}this.transform.apply(f)}_fireMoveEvents(o){this.fire(new y.l("move",o)),this._zooming&&this.fire(new y.l("zoom",o)),this._rotating&&this.fire(new y.l("rotate",o)),this._pitching&&this.fire(new y.l("pitch",o)),this._rolling&&this.fire(new y.l("roll",o))}_afterEase(o,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId;const f=this._zooming,_=this._rotating,x=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new y.l("zoomend",o)),_&&this.fire(new y.l("rotateend",o)),x&&this.fire(new y.l("pitchend",o)),S&&this.fire(new y.l("rollend",o)),this.fire(new y.l("moveend",o))}flyTo(o,u){if(!o.essential&&mt.prefersReducedMotion){const Fe=y.Q(o,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(Fe,u)}this.stop(),o=y.e({offset:[0,0],speed:1.2,curve:1.42,easing:y.co},o);const f=this._getTransformForUpdate(),_=f.bearing,x=f.pitch,S=f.roll,I=f.padding,D="bearing"in o?this._normalizeBearing(o.bearing,_):_,N="pitch"in o?+o.pitch:x,F="roll"in o?this._normalizeBearing(o.roll,S):S,U="padding"in o?o.padding:f.padding,V=y.P.convert(o.offset);let H=f.centerPoint.add(V);const Y=f.screenPointToLocation(H),oe=this.cameraHelper.handleFlyTo(f,{bearing:D,pitch:N,roll:F,padding:U,locationAtOffset:Y,offsetAsPoint:V,center:o.center,minZoom:o.minZoom,zoom:o.zoom});let re=o.curve;const ie=Math.max(f.width,f.height),ue=ie/oe.scaleOfZoom,pe=oe.pixelPathLength;"number"==typeof oe.scaleOfMinZoom&&(re=Math.sqrt(ie/oe.scaleOfMinZoom/pe*2));const he=re*re;function me(Fe){const Je=(ue*ue-ie*ie+(Fe?-1:1)*he*he*pe*pe)/(2*(Fe?ue:ie)*he*pe);return Math.log(Math.sqrt(Je*Je+1)-Je)}function ve(Fe){return(Math.exp(Fe)-Math.exp(-Fe))/2}function fe(Fe){return(Math.exp(Fe)+Math.exp(-Fe))/2}const Te=me(!1);let Be=function(Fe){return fe(Te)/fe(Te+re*Fe)},ke=function(Fe){return ie*((fe(Te)*(ve(Je=Te+re*Fe)/fe(Je))-ve(Te))/he)/pe;var Je},Oe=(me(!0)-Te)/re;if(Math.abs(pe)<2e-6||!isFinite(Oe)){if(Math.abs(ie-ue)<1e-6)return this.easeTo(o,u);const Fe=ue<ie?-1:1;Oe=Math.abs(Math.log(ue/ie))/re,ke=()=>0,Be=Je=>Math.exp(Fe*re*Je)}return o.duration="duration"in o?+o.duration:1e3*Oe/("screenSpeed"in o?+o.screenSpeed/re:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=_!==D,this._pitching=N!==x,this._rolling=F!==S,this._padding=!f.isPaddingEqual(U),this._prepareEase(u,!1),this.terrain&&this._prepareElevation(oe.targetCenter),this._ease(Fe=>{const Je=Fe*Oe,tt=1/Be(Je),qe=ke(Je);this._rotating&&f.setBearing(y.C.number(_,D,Fe)),this._pitching&&f.setPitch(y.C.number(x,N,Fe)),this._rolling&&f.setRoll(y.C.number(S,F,Fe)),this._padding&&(f.interpolatePadding(I,U,Fe),H=f.centerPoint.add(V)),oe.easeFunc(Fe,tt,qe,H),this.terrain&&!o.freezeElevation&&this._updateElevation(Fe),this._applyUpdatedTransform(f),this._fireMoveEvents(u)},()=>{this.terrain&&o.freezeElevation&&this._finalizeElevation(),this._afterEase(u)},o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,u){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,u)}return o||null===(f=this.handlers)||void 0===f||f.stop(!1),this}_ease(o,u,f){!1===f.animate||0===f.duration?(o(1),u()):(this._easeStart=mt.now(),this._easeOptions=f,this._onEaseFrame=o,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(o,u){o=y.aO(o,-180,180);const f=Math.abs(o-u);return Math.abs(o-360-u)<f&&(o-=360),Math.abs(o+360-u)<f&&(o+=360),o}queryTerrainElevation(o){return this.terrain?this.terrain.getElevationForLngLatZoom(y.S.convert(o),this.transform.tileZoom):null}}const Mu={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Td{constructor(o=Mu){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=u=>{!u||"metadata"!==u.sourceDataType&&"visibility"!==u.sourceDataType&&"style"!==u.dataType&&"terrain"!==u.type||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1===this._compact?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=o}getDefaultPosition(){return"bottom-right"}onAdd(o){return this._map=o,this._compact=this.options.compact,this._container=Ce.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=Ce.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Ce.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){Ce.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(o,u){const f=this._map._getUIString(`AttributionControl.${u}`);o.title=f,o.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let o=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=o.concat(this.options.customAttribution.map(_=>"string"!=typeof _?"":_)):"string"==typeof this.options.customAttribution&&o.push(this.options.customAttribution)),this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const u=this._map.style.sourceCaches;for(const _ in u){const x=u[_];if(x.used||x.usedForTerrain){const S=x.getSource();S.attribution&&o.indexOf(S.attribution)<0&&o.push(S.attribution)}}o=o.filter(_=>String(_).trim()),o.sort((_,x)=>_.length-x.length),o=o.filter((_,x)=>{for(let S=x+1;S<o.length;S++)if(o[S].indexOf(_)>=0)return!1;return!0});const f=o.join(" | ");f!==this._attribHTML&&(this._attribHTML=f,o.length?(this._innerContainer.innerHTML=Ce.sanitize(f),this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Tu{constructor(o={}){this._updateCompact=()=>{const u=this._container.children;if(u.length){const f=u[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?!1!==this._compact&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=o}getDefaultPosition(){return"bottom-left"}onAdd(o){this._map=o,this._compact=this.options&&this.options.compact,this._container=Ce.create("div","maplibregl-ctrl");const u=Ce.create("a","maplibregl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://maplibre.org/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){Ce.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class $i{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const u=++this._id;return this._queue.push({callback:o,id:u,cancelled:!1}),u}remove(o){const u=this._currentlyRunning,f=u?this._queue.concat(u):this._queue;for(const _ of f)if(_.id===o)return void(_.cancelled=!0)}run(o=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const u=this._currentlyRunning=this._queue;this._queue=[];for(const f of u)if(!f.cancelled&&(f.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Fc=y.aJ([{name:"a_pos3d",type:"Int16",components:3}]);class k extends y.E{constructor(o){super(),this._lastTilesetChange=mt.now(),this.sourceCache=o,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=o._source.tileSize*2**this.deltaZoom,o.usedForTerrain=!0,o.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(o,u){this.sourceCache.update(o,u),this._renderableTilesKeys=[];const f={};for(const _ of Me(o,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:u,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[_.key]=!0,this._renderableTilesKeys.push(_.key),this._tiles[_.key]||(_.terrainRttPosMatrix32f=new Float64Array(16),y.bY(_.terrainRttPosMatrix32f,0,y.$,y.$,0,0,1),this._tiles[_.key]=new Ao(_,this.tileSize),this._lastTilesetChange=mt.now());for(const _ in this._tiles)f[_]||delete this._tiles[_]}freeRtt(o){for(const u in this._tiles){const f=this._tiles[u];(!o||f.tileID.equals(o)||f.tileID.isChildOf(o)||o.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(o=>this.getTileByID(o))}getTileByID(o){return this._tiles[o]}getTerrainCoords(o,u){return u?this._getTerrainCoordsForTileRanges(o,u):this._getTerrainCoordsForRegularTile(o)}_getTerrainCoordsForRegularTile(o){const u={};for(const f of this._renderableTilesKeys){const _=this._tiles[f].tileID,x=o.clone(),S=y.ba();if(_.canonical.equals(o.canonical))y.bY(S,0,y.$,y.$,0,0,1);else if(_.canonical.isChildOf(o.canonical)){const I=_.canonical.z-o.canonical.z,D=_.canonical.x-(_.canonical.x>>I<<I),N=_.canonical.y-(_.canonical.y>>I<<I),F=y.$>>I;y.bY(S,0,F,F,0,0,1),y.M(S,S,[-D*F,-N*F,0])}else{if(!o.canonical.isChildOf(_.canonical))continue;{const I=o.canonical.z-_.canonical.z,D=o.canonical.x-(o.canonical.x>>I<<I),N=o.canonical.y-(o.canonical.y>>I<<I),F=y.$>>I;y.bY(S,0,y.$,y.$,0,0,1),y.M(S,S,[D*F,N*F,0]),y.N(S,S,[1/2**I,1/2**I,0])}}x.terrainRttPosMatrix32f=new Float32Array(S),u[f]=x}return u}_getTerrainCoordsForTileRanges(o,u){const f={};for(const _ of this._renderableTilesKeys){const x=this._tiles[_].tileID;if(!this._isWithinTileRanges(x,u))continue;const S=o.clone(),I=y.ba();if(x.canonical.z===o.canonical.z){const D=o.canonical.x-x.canonical.x,N=o.canonical.y-x.canonical.y;y.bY(I,0,y.$,y.$,0,0,1),y.M(I,I,[D*y.$,N*y.$,0])}else if(x.canonical.z>o.canonical.z){const D=x.canonical.z-o.canonical.z,N=x.canonical.x-(x.canonical.x>>D<<D),F=x.canonical.y-(x.canonical.y>>D<<D),U=o.canonical.x-(x.canonical.x>>D),V=o.canonical.y-(x.canonical.y>>D),H=y.$>>D;y.bY(I,0,H,H,0,0,1),y.M(I,I,[-N*H+U*y.$,-F*H+V*y.$,0])}else{const D=o.canonical.z-x.canonical.z,N=o.canonical.x-(o.canonical.x>>D<<D),F=o.canonical.y-(o.canonical.y>>D<<D),U=(o.canonical.x>>D)-x.canonical.x,V=(o.canonical.y>>D)-x.canonical.y,H=y.$<<D;y.bY(I,0,H,H,0,0,1),y.M(I,I,[N*y.$+U*H,F*y.$+V*H,0])}S.terrainRttPosMatrix32f=new Float32Array(I),f[_]=S}return f}getSourceTile(o,u){const f=this.sourceCache._source;let _=o.overscaledZ-this.deltaZoom;if(_>f.maxzoom&&(_=f.maxzoom),_<f.minzoom)return null;this._sourceTileCache[o.key]||(this._sourceTileCache[o.key]=o.scaledTo(_).key);let x=this.sourceCache.getTileByID(this._sourceTileCache[o.key]);if((!x||!x.dem)&&u)for(;_>=f.minzoom&&(!x||!x.dem);)x=this.sourceCache.getTileByID(o.scaledTo(_--).key);return x}anyTilesAfterTime(o=Date.now()){return this._lastTilesetChange>=o}_isWithinTileRanges(o,u){return u[o.canonical.z]&&o.canonical.x>=u[o.canonical.z].minTileX&&o.canonical.x<=u[o.canonical.z].maxTileX&&o.canonical.y>=u[o.canonical.z].minTileY&&o.canonical.y<=u[o.canonical.z].maxTileY}}class G{constructor(o,u,f){this._meshCache={},this.painter=o,this.sourceCache=new k(u),this.options=f,this.exaggeration="number"==typeof f.exaggeration?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(o,u,f,_=y.$){var x;if(!(u>=0&&u<_&&f>=0&&f<_))return 0;const S=this.getTerrainData(o),I=null===(x=S.tile)||void 0===x?void 0:x.dem;if(!I)return 0;const D=y.cs([],[u/_*y.$,f/_*y.$],S.u_terrain_matrix),N=[D[0]*I.dim,D[1]*I.dim],F=Math.floor(N[0]),U=Math.floor(N[1]),V=N[0]-F,H=N[1]-U;return I.get(F,U)*(1-V)*(1-H)+I.get(F+1,U)*V*(1-H)+I.get(F,U+1)*(1-V)*H+I.get(F+1,U+1)*V*H}getElevationForLngLatZoom(o,u){if(!y.ct(u,o.wrap()))return 0;const{tileID:f,mercatorX:_,mercatorY:x}=this._getOverscaledTileIDFromLngLatZoom(o,u);return this.getElevation(f,_%y.$,x%y.$,y.$)}getElevation(o,u,f,_=y.$){return this.getDEMElevation(o,u,f,_)*this.exaggeration}getTerrainData(o){if(!this._emptyDemTexture){const _=this.painter.context,x=new y.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new y.T(_,x,_.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new y.T(_,new y.R({width:1,height:1}),_.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=y.ag([])}const u=this.sourceCache.getSourceTile(o,!0);if(u&&u.dem&&(!u.demTexture||u.needsTerrainPrepare)){const _=this.painter.context;u.demTexture=this.painter.getTileTexture(u.dem.stride),u.demTexture?u.demTexture.update(u.dem.getPixels(),{premultiply:!1}):u.demTexture=new y.T(_,u.dem.getPixels(),_.gl.RGBA,{premultiply:!1}),u.demTexture.bind(_.gl.NEAREST,_.gl.CLAMP_TO_EDGE),u.needsTerrainPrepare=!1}const f=u&&u+u.tileID.key+o.key;if(f&&!this._demMatrixCache[f]){const _=this.sourceCache.sourceCache._source.maxzoom;let x=o.canonical.z-u.tileID.canonical.z;o.overscaledZ>o.canonical.z&&(o.canonical.z>=_?x=o.canonical.z-_:y.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=o.canonical.x-(o.canonical.x>>x<<x),I=o.canonical.y-(o.canonical.y>>x<<x),D=y.cu(new Float64Array(16),[1/(y.$<<x),1/(y.$<<x),0]);y.M(D,D,[S*y.$,I*y.$,0]),this._demMatrixCache[o.key]={matrix:D,coord:o}}return{u_depth:2,u_terrain:3,u_terrain_dim:u&&u.dem&&u.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[o.key].matrix:this._emptyDemMatrix,u_terrain_unpack:u&&u.dem&&u.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(u&&u.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:u}}getFramebuffer(o){const u=this.painter,f=u.width/devicePixelRatio,_=u.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===_||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new y.T(u.context,{width:f,height:_,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new y.T(u.context,{width:f,height:_,data:null},u.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(u.context.gl.NEAREST,u.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=u.context.createFramebuffer(f,_,!0,!1),this._fbo.depthAttachment.set(u.context.createRenderbuffer(u.context.gl.DEPTH_COMPONENT16,f,_))),this._fbo.colorAttachment.set("coords"===o?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const o=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const u=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let x=0,S=0;x<this._coordsTextureSize;x++)for(let I=0;I<this._coordsTextureSize;I++,S+=4)u[S+0]=255&I,u[S+1]=255&x,u[S+2]=I>>8<<4|x>>8,u[S+3]=0;const f=new y.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(u.buffer)),_=new y.T(o,f,o.gl.RGBA,{premultiply:!1});return _.bind(o.gl.NEAREST,o.gl.CLAMP_TO_EDGE),this._coordsTexture=_,_}pointCoordinate(o){this.painter.maybeDrawDepthAndCoords(!0);const u=new Uint8Array(4),f=this.painter.context,_=f.gl,x=Math.round(o.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(o.y*this.painter.pixelRatio/devicePixelRatio),I=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),_.readPixels(x,I-S-1,1,1,_.RGBA,_.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null);const D=u[0]+(u[2]>>4<<8),N=u[1]+((15&u[2])<<8),F=this.coordsIndex[255-u[3]],U=F&&this.sourceCache.getTileByID(F);if(!U)return null;const V=this._coordsTextureSize,H=(1<<U.tileID.canonical.z)*V;return new y.a1((U.tileID.canonical.x*V+D)/H+U.tileID.wrap,(U.tileID.canonical.y*V+N)/H,this.getElevation(U.tileID,D,N,V))}depthAtPoint(o){const u=new Uint8Array(4),f=this.painter.context,_=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),_.readPixels(o.x,this.painter.height/devicePixelRatio-o.y-1,1,1,_.RGBA,_.UNSIGNED_BYTE,u),f.bindFramebuffer.set(null),(u[0]/16777216+u[1]/65536+u[2]/256+u[3])/256}getTerrainMesh(o){var u;const f=(null===(u=this.painter.style.projection)||void 0===u?void 0:u.transitionState)>0,_=f&&0===o.canonical.y,x=f&&o.canonical.y===(1<<o.canonical.z)-1,S=`m_${_?"n":""}_${x?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const I=this.painter.context,D=new y.cv,N=new y.aN,F=this.meshSize,U=y.$/F,V=F*F;for(let fe=0;fe<=F;fe++)for(let Te=0;Te<=F;Te++)D.emplaceBack(Te*U,fe*U,0);for(let fe=0;fe<V;fe+=F+1)for(let Te=0;Te<F;Te++)N.emplaceBack(Te+fe,F+Te+fe+1,F+Te+fe+2),N.emplaceBack(Te+fe,F+Te+fe+2,Te+fe+1);const H=D.length,Y=H+(F+1),oe=(F+1)*F,re=_?y.bh:0,ie=_?0:1,ue=x?y.bi:y.$,pe=x?0:1;for(let fe=0;fe<=F;fe++)D.emplaceBack(fe*U,re,ie);for(let fe=0;fe<=F;fe++)D.emplaceBack(fe*U,ue,pe);for(let fe=0;fe<F;fe++)N.emplaceBack(oe+fe,Y+fe,Y+fe+1),N.emplaceBack(oe+fe,Y+fe+1,oe+fe+1),N.emplaceBack(0+fe,H+fe+1,H+fe),N.emplaceBack(0+fe,0+fe+1,H+fe+1);const he=D.length,me=he+2*(F+1);for(const fe of[0,1])for(let Te=0;Te<=F;Te++)for(const Be of[0,1])D.emplaceBack(fe*y.$,Te*U,Be);for(let fe=0;fe<2*F;fe+=2)N.emplaceBack(he+fe,he+fe+1,he+fe+3),N.emplaceBack(he+fe,he+fe+3,he+fe+2),N.emplaceBack(me+fe,me+fe+3,me+fe+1),N.emplaceBack(me+fe,me+fe+2,me+fe+3);const ve=new ns(I.createVertexBuffer(D,Fc.members),I.createIndexBuffer(N),y.aM.simpleSegment(0,0,D.length,N.length));return this._meshCache[S]=ve,ve}getMeshFrameDelta(o){return 2*Math.PI*y.bu/Math.pow(2,Math.max(o,0))/5}getMinTileElevationForLngLatZoom(o,u){var f;const{tileID:_}=this._getOverscaledTileIDFromLngLatZoom(o,u);return null!==(f=this.getMinMaxElevation(_).minElevation)&&void 0!==f?f:0}getMinMaxElevation(o){const u=this.getTerrainData(o).tile,f={minElevation:null,maxElevation:null};return u&&u.dem&&(f.minElevation=u.dem.min*this.exaggeration,f.maxElevation=u.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(o,u){const f=y.a1.fromLngLat(o.wrap()),_=(1<<u)*y.$,x=f.x*_,S=f.y*_,I=Math.floor(x/y.$),D=Math.floor(S/y.$);return{tileID:new y.Z(u,0,u,I,D),mercatorX:x,mercatorY:S}}}class ae{constructor(o,u,f){this._context=o,this._size=u,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const o of this._objects)o.texture.destroy(),o.fbo.destroy()}_createObject(o){const u=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new y.T(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),u.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),u.colorAttachment.set(f.texture),{id:o,fbo:u,texture:f,stamp:-1,inUse:!1}}getObjectForId(o){return this._objects[o]}useObject(o){o.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(u=>o.id!==u),this._recentlyUsed.push(o.id)}stampObject(o){o.stamp=++this._stamp}getOrCreateFreeObject(){for(const u of this._recentlyUsed)if(!this._objects[u].inUse)return this._objects[u];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const o=this._createObject(this._objects.length);return this._objects.push(o),o}freeObject(o){o.inUse=!1}freeAllObjects(){for(const o of this._objects)this.freeObject(o)}isFull(){return!(this._objects.length<this._size)&&!1===this._objects.some(o=>!o.inUse)}}const Ae={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0,"color-relief":!0};class He{constructor(o,u){this.painter=o,this.terrain=u,this.pool=new ae(o.context,30,u.sourceCache.tileSize*u.qualityFactor)}destruct(){this.pool.destruct()}getTexture(o){return this.pool.getObjectForId(o.rtt[this._stacks.length-1].id).texture}prepareForRender(o,u){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=o._order.filter(f=>!o._layers[f].isHidden(u)),this._coordsAscending={};for(const f in o.sourceCaches){this._coordsAscending[f]={};const _=o.sourceCaches[f].getVisibleCoordinates(),x=o.sourceCaches[f].getSource(),S=x instanceof Lr?x.terrainTileRanges:null;for(const I of _){const D=this.terrain.sourceCache.getTerrainCoords(I,S);for(const N in D)this._coordsAscending[f][N]||(this._coordsAscending[f][N]=[]),this._coordsAscending[f][N].push(D[N])}}this._coordsAscendingStr={};for(const f of o._order){const _=o._layers[f],x=_.source;if(Ae[_.type]&&!this._coordsAscendingStr[x]){this._coordsAscendingStr[x]={};for(const S in this._coordsAscending[x])this._coordsAscendingStr[x][S]=this._coordsAscending[x][S].map(I=>I.key).sort().join()}}for(const f of this._renderableTiles)for(const _ in this._coordsAscendingStr){const x=this._coordsAscendingStr[_][f.tileID.key];x&&x!==f.rttCoords[_]&&(f.rtt=[])}}renderLayer(o,u){if(o.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},u),{isRenderingToTexture:!0}),_=o.type,x=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===o.id;if(Ae[_]&&(this._prevType&&Ae[this._prevType]||this._stacks.push([]),this._prevType=_,this._stacks[this._stacks.length-1].push(o.id),!S))return!0;if(Ae[this._prevType]||Ae[_]&&S){this._prevType=_;const I=this._stacks.length-1,D=this._stacks[I]||[];for(const N of this._renderableTiles){if(this.pool.isFull()&&(Pc(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(N),N.rtt[I]){const U=this.pool.getObjectForId(N.rtt[I].id);if(U.stamp===N.rtt[I].stamp){this.pool.useObject(U);continue}}const F=this.pool.getOrCreateFreeObject();this.pool.useObject(F),this.pool.stampObject(F),N.rtt[I]={id:F.id,stamp:F.stamp},x.context.bindFramebuffer.set(F.fbo.framebuffer),x.context.clear({color:y.bf.transparent,stencil:0}),x.currentStencilSource=void 0;for(let U=0;U<D.length;U++){const V=x.style._layers[D[U]],H=V.source?this._coordsAscending[V.source][N.tileID.key]:[N.tileID];x.context.viewport.set([0,0,F.fbo.width,F.fbo.height]),x._renderTileClippingMasks(V,H,!0),x.renderLayer(x,x.style.sourceCaches[V.source],V,H,f),V.source&&(N.rttCoords[V.source]=this._coordsAscendingStr[V.source][N.tileID.key])}}return Pc(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),Ae[_]}return!1}}const ft={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use \u2318 + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},Kn={hash:!1,interactive:!0,bearingSnap:7,attributionControl:Mu,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:y.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},Ir={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Xn{constructor(o,u,f=!1){this.mousedown=x=>{this.startMove(x,Ce.mousePos(this.element,x)),Ce.addEventListener(window,"mousemove",this.mousemove),Ce.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.move(x,Ce.mousePos(this.element,x))},this.mouseup=x=>{this._rotatePitchHandler.dragEnd(x),this.offTemp()},this.touchstart=x=>{1!==x.targetTouches.length?this.reset():(this._startPos=this._lastPos=Ce.touchPos(this.element,x.targetTouches)[0],this.startMove(x,this._startPos),Ce.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),Ce.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{1!==x.targetTouches.length?this.reset():(this._lastPos=Ce.touchPos(this.element,x.targetTouches)[0],this.move(x,this._lastPos))},this.touchend=x=>{0===x.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHandler.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=u;const _=new Gf;this._rotatePitchHandler=new Ll({clickTolerance:3,move:(x,S)=>{const I=u.getBoundingClientRect(),D=new y.P((I.bottom-I.top)/2,(I.right-I.left)/2);return{bearingDelta:y.cn(new y.P(x.x,S.y),S,D),pitchDelta:f?-.5*(S.y-x.y):void 0}},moveStateManager:_,enable:!0,assignEvents:()=>{}}),this.map=o,Ce.addEventListener(u,"mousedown",this.mousedown),Ce.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),Ce.addEventListener(u,"touchcancel",this.reset)}startMove(o,u){this._rotatePitchHandler.dragStart(o,u),Ce.disableDrag()}move(o,u){const f=this.map,{bearingDelta:_,pitchDelta:x}=this._rotatePitchHandler.dragMove(o,u)||{};_&&f.setBearing(f.getBearing()+_),x&&f.setPitch(f.getPitch()+x)}off(){const o=this.element;Ce.removeEventListener(o,"mousedown",this.mousedown),Ce.removeEventListener(o,"touchstart",this.touchstart,{passive:!1}),Ce.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Ce.removeEventListener(window,"touchend",this.touchend),Ce.removeEventListener(o,"touchcancel",this.reset),this.offTemp()}offTemp(){Ce.enableDrag(),Ce.removeEventListener(window,"mousemove",this.mousemove),Ce.removeEventListener(window,"mouseup",this.mouseup),Ce.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),Ce.removeEventListener(window,"touchend",this.touchend)}}let wn;function hr(b,o,u,f=!1){if(f||!u.getCoveringTilesDetailsProvider().allowWorldCopies())return b?.wrap();const _=new y.S(b.lng,b.lat);if(b=new y.S(b.lng,b.lat),o){const x=new y.S(b.lng-360,b.lat),S=new y.S(b.lng+360,b.lat),I=u.locationToScreenPoint(b).distSqr(o);u.locationToScreenPoint(x).distSqr(o)<I?b=x:u.locationToScreenPoint(S).distSqr(o)<I&&(b=S)}for(;Math.abs(b.lng-u.center.lng)>180;){const x=u.locationToScreenPoint(b);if(x.x>=0&&x.y>=0&&x.x<=u.width&&x.y<=u.height)break;b.lng>u.center.lng?b.lng-=360:b.lng+=360}return b.lng!==_.lng&&u.isPointOnMapSurface(u.locationToScreenPoint(b))?b:_}const Bc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Iu(b,o,u){const f=b.classList;for(const _ in Bc)f.remove(`maplibregl-${u}-anchor-${_}`);f.add(`maplibregl-${u}-anchor-${o}`)}class Du extends y.E{constructor(o){if(super(),this._onKeyPress=u=>{const f=u.code,_=u.charCode||u.keyCode;"Space"!==f&&"Enter"!==f&&32!==_&&13!==_||this.togglePopup()},this._onMapClick=u=>{const f=u.originalEvent.target,_=this._element;this._popup&&(f===_||_.contains(f))&&this.togglePopup()},this._update=u=>{if(!this._map)return;const f=this._map.loaded()&&!this._map.isMoving();("terrain"===u?.type||"render"===u?.type&&!f)&&this._map.once("render",this._update),this._lngLat=hr(this._lngLat,this._flatPos,this._map.transform),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let _="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?_=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(_=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let x="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?x="rotateX(0deg)":"map"===this._pitchAlignment&&(x=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||u&&"moveend"!==u.type||(this._pos=this._pos.round()),Ce.setTransform(this._element,`${Bc[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${x} ${_}`),mt.frameAsync(new AbortController).then(()=>{this._updateOpacity(u&&"moveend"===u.type)}).catch(()=>{})},this._onMove=u=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=u.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=u.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new y.l("dragstart"))),this.fire(new y.l("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new y.l("dragend")),this._state="inactive"},this._addDragHandler=u=>{this._element.contains(u.originalEvent.target)&&(u.preventDefault(),this._positionDelta=u.point.sub(this._pos).add(this._offset),this._pointerdownPos=u.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._subpixelPositioning=o&&o.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&"auto"!==o.pitchAlignment?o.pitchAlignment:this._rotationAlignment,this.setOpacity(o?.opacity,o?.opacityWhenCovered),o&&o.element)this._element=o.element,this._offset=y.P.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ce.create("div");const u=Ce.createNS("http://www.w3.org/2000/svg","svg"),f=41,_=27;u.setAttributeNS(null,"display","block"),u.setAttributeNS(null,"height",`${f}px`),u.setAttributeNS(null,"width",`${_}px`),u.setAttributeNS(null,"viewBox",`0 0 ${_} ${f}`);const x=Ce.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const S=Ce.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const I=Ce.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");const D=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ie of D){const ue=Ce.createNS("http://www.w3.org/2000/svg","ellipse");ue.setAttributeNS(null,"opacity","0.04"),ue.setAttributeNS(null,"cx","10.5"),ue.setAttributeNS(null,"cy","5.80029008"),ue.setAttributeNS(null,"rx",ie.rx),ue.setAttributeNS(null,"ry",ie.ry),I.appendChild(ue)}const N=Ce.createNS("http://www.w3.org/2000/svg","g");N.setAttributeNS(null,"fill",this._color);const F=Ce.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),N.appendChild(F);const U=Ce.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"opacity","0.25"),U.setAttributeNS(null,"fill","#000000");const V=Ce.createNS("http://www.w3.org/2000/svg","path");V.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),U.appendChild(V);const H=Ce.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(6.0, 7.0)"),H.setAttributeNS(null,"fill","#FFFFFF");const Y=Ce.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"transform","translate(8.0, 8.0)");const oe=Ce.createNS("http://www.w3.org/2000/svg","circle");oe.setAttributeNS(null,"fill","#000000"),oe.setAttributeNS(null,"opacity","0.25"),oe.setAttributeNS(null,"cx","5.5"),oe.setAttributeNS(null,"cy","5.5"),oe.setAttributeNS(null,"r","5.4999962");const re=Ce.createNS("http://www.w3.org/2000/svg","circle");re.setAttributeNS(null,"fill","#FFFFFF"),re.setAttributeNS(null,"cx","5.5"),re.setAttributeNS(null,"cy","5.5"),re.setAttributeNS(null,"r","5.4999962"),Y.appendChild(oe),Y.appendChild(re),S.appendChild(I),S.appendChild(N),S.appendChild(U),S.appendChild(H),S.appendChild(Y),u.appendChild(S),u.setAttributeNS(null,"height",f*this._scale+"px"),u.setAttributeNS(null,"width",_*this._scale+"px"),this._element.appendChild(u),this._offset=y.P.convert(o&&o.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()}),Iu(this._element,this._anchor,"marker"),o&&o.className)for(const u of o.className.split(" "))this._element.classList.add(u);this._popup=null}addTo(o){return this.remove(),this._map=o,this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label",o._getUIString("Marker.Title")),o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),o.on("terrain",this._update),o.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Ce.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=y.S.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const _=Math.abs(13.5)/Math.SQRT2;o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(24.6+_)],"bottom-right":[-_,-1*(24.6+_)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(o){return this._subpixelPositioning=o,this}getPopup(){return this._popup}togglePopup(){const o=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:o?(o.isOpen()?o.remove():(o.setLngLat(this._lngLat),o.addTo(this._map)),this):this}_updateOpacity(o=!1){var u,f;const _=null===(u=this._map)||void 0===u?void 0:u.terrain,x=this._map.transform.isLocationOccluded(this._lngLat);if(!_||x){const H=x?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==H&&(this._element.style.opacity=H))}if(o)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const S=this._map,I=S.terrain.depthAtPoint(this._pos),D=S.terrain.getElevationForLngLatZoom(this._lngLat,S.transform.tileZoom);if(S.transform.lngLatToCameraDepth(this._lngLat,D)-I<.006)return void(this._element.style.opacity=this._opacity);const N=-this._offset.y/S.transform.pixelsPerMeter,F=Math.sin(S.getPitch()*Math.PI/180)*N,U=S.terrain.depthAtPoint(new y.P(this._pos.x,this._pos.y-this._offset.y)),V=S.transform.lngLatToCameraDepth(this._lngLat,D+F)-U>.006;!(null===(f=this._popup)||void 0===f)&&f.isOpen()&&V&&this._popup.remove(),this._element.style.opacity=V?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(o){return this._offset=y.P.convert(o),this._update(),this}addClassName(o){this._element.classList.add(o)}removeClassName(o){this._element.classList.remove(o)}toggleClassName(o){return this._element.classList.toggle(o)}setDraggable(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o&&"auto"!==o?o:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(o,u){return(void 0===this._opacity||void 0===o&&void 0===u)&&(this._opacity="1",this._opacityWhenCovered="0.2"),void 0!==o&&(this._opacity=o),void 0!==u&&(this._opacityWhenCovered=u),this._map&&this._updateOpacity(!0),this}}const Id={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let zc=0,zl=!1;const Au={maxWidth:100,unit:"metric"};function Dd(b,o,u){const f=u&&u.maxWidth||100,_=b._container.clientHeight/2,x=b._container.clientWidth/2,S=b.unproject([x-f/2,_]),I=b.unproject([x+f/2,_]),D=Math.round(b.project(I).x-b.project(S).x),N=Math.min(f,D,b._container.clientWidth),F=S.distanceTo(I);if(u&&"imperial"===u.unit){const U=3.2808*F;U>5280?jl(o,N,U/5280,b._getUIString("ScaleControl.Miles")):jl(o,N,U,b._getUIString("ScaleControl.Feet"))}else u&&"nautical"===u.unit?jl(o,N,F/1852,b._getUIString("ScaleControl.NauticalMiles")):F>=1e3?jl(o,N,F/1e3,b._getUIString("ScaleControl.Kilometers")):jl(o,N,F,b._getUIString("ScaleControl.Meters"))}function jl(b,o,u,f){const _=function(x){const S=Math.pow(10,`${Math.floor(x)}`.length-1);let I=x/S;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(D){const N=Math.pow(10,Math.ceil(-Math.log(D)/Math.LN10));return Math.round(D*N)/N}(I),S*I}(u);b.style.width=o*(_/u)+"px",b.innerHTML=`${_}&nbsp;${f}`}const Ad={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1,locationOccludedOpacity:void 0},Pd=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function kd(b){if(b){if("number"==typeof b){const o=Math.round(Math.abs(b)/Math.SQRT2);return{center:new y.P(0,0),top:new y.P(0,b),"top-left":new y.P(o,o),"top-right":new y.P(-o,o),bottom:new y.P(0,-b),"bottom-left":new y.P(o,-o),"bottom-right":new y.P(-o,-o),left:new y.P(b,0),right:new y.P(-b,0)}}if(b instanceof y.P||Array.isArray(b)){const o=y.P.convert(b);return{center:o,top:o,"top-left":o,"top-right":o,bottom:o,"bottom-left":o,"bottom-right":o,left:o,right:o}}return{center:y.P.convert(b.center||[0,0]),top:y.P.convert(b.top||[0,0]),"top-left":y.P.convert(b["top-left"]||[0,0]),"top-right":y.P.convert(b["top-right"]||[0,0]),bottom:y.P.convert(b.bottom||[0,0]),"bottom-left":y.P.convert(b["bottom-left"]||[0,0]),"bottom-right":y.P.convert(b["bottom-right"]||[0,0]),left:y.P.convert(b.left||[0,0]),right:y.P.convert(b.right||[0,0])}}return kd(new y.P(0,0))}W.AJAXError=y.cz,W.Event=y.l,W.Evented=y.E,W.LngLat=y.S,W.MercatorCoordinate=y.a1,W.Point=y.P,W.addProtocol=y.cA,W.config=y.a,W.removeProtocol=y.cB,W.AttributionControl=Td,W.BoxZoomHandler=bu,W.CanvasSource=Ds,W.CooperativeGesturesHandler=hs,W.DoubleClickZoomHandler=wu,W.DragPanHandler=Ed,W.DragRotateHandler=Lc,W.EdgeInsets=ca,W.FullscreenControl=class extends y.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var o;let u=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;null!==(o=u?.shadowRoot)&&void 0!==o&&o.fullscreenElement;)u=u.shadowRoot.fullscreenElement;u===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:y.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){Ce.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=Ce.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);Ce.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new y.l("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new y.l("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},W.GeoJSONSource=bn,W.GeolocateControl=class extends y.E{constructor(b){super(),this._onSuccess=o=>{if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new y.l("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(o),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new y.l("geolocate",o)),this._finish()}},this._updateCamera=o=>{const u=new y.S(o.coords.longitude,o.coords.latitude),f=o.coords.accuracy,_=this._map.getBearing(),x=y.e({bearing:_},this.options.fitBoundsOptions),S=Jn.fromLngLat(u,f);this._map.fitBounds(S,x,{geolocateSource:!0})},this._updateMarker=o=>{if(o){const u=new y.S(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(u).addTo(this._map),this._userLocationDotMarker.setLngLat(u).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=o=>{if(this._map){if(1===o.code){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===o.code&&zl)return;this.options.trackUserLocation&&this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new y.l("error",o)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=Ce.create("button","maplibregl-ctrl-geolocate",this._container),Ce.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=o=>{if(this._map){if(!1===o){y.w("Geolocation support is not available so the GeolocateControl will be disabled.");const u=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}else{const u=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=u,this._geolocateButton.setAttribute("aria-label",u)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ce.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Du({element:this._dotElement}),this._circleElement=Ce.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Du({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",u=>{const f=u?.[0]instanceof ResizeObserverEntry;u.geolocateSource||"ACTIVE_LOCK"!==this._watchState||f||this._map.isZooming()||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new y.l("trackuserlocationend")),this.fire(new y.l("userlocationlostfocus")))})}},this.options=y.e({},Id,b)}onAdd(b){return this._map=b,this._container=Ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return y._(this,arguments,void 0,function*(o=!1){if(void 0!==wn&&!o)return wn;if(void 0===window.navigator.permissions)return wn=!!window.navigator.geolocation,wn;try{wn="denied"!==(yield window.navigator.permissions.query({name:"geolocation"})).state}catch{wn=!!window.navigator.geolocation}return wn})}().then(o=>this._finishSetupUI(o)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Ce.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,zc=0,zl=!1}_isOutOfMapMaxBounds(b){const o=this._map.getMaxBounds(),u=b.coords;return o&&(u.longitude<o.getWest()||u.longitude>o.getEast()||u.latitude<o.getSouth()||u.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const b=this._map.getBounds(),o=b.getSouthEast(),u=b.getNorthEast(),f=o.distanceTo(u),_=Math.ceil(this._accuracy/(f/this._map._container.clientHeight)*2);this._circleElement.style.width=`${_}px`,this._circleElement.style.height=`${_}px`}trigger(){if(!this._setup)return y.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new y.l("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":zc--,zl=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new y.l("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new y.l("trackuserlocationstart")),this.fire(new y.l("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),zc++,zc>1?(b={maximumAge:6e5,timeout:0},zl=!0):(b=this.options.positionOptions,zl=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},W.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const o=null===(b=this._map.getProjection())||void 0===b?void 0:b.type;this._map.setProjection("mercator"!==o&&o?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),"globe"===(null===(b=this._map.getProjection())||void 0===b?void 0:b.type)?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=Ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=Ce.create("button","maplibregl-ctrl-globe",this._container),Ce.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){Ce.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},W.Hash=Us,W.ImageSource=Lr,W.KeyboardHandler=ds,W.LngLatBounds=Jn,W.LogoControl=Tu,W.Map=class extends Gh{constructor(b){var o,u;y.cw.mark(y.cx.create);const f=Object.assign(Object.assign(Object.assign({},Kn),b),{canvasContextAttributes:Object.assign(Object.assign({},Kn.canvasContextAttributes),b.canvasContextAttributes)});if(null!=f.minZoom&&null!=f.maxZoom&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=f.minPitch&&null!=f.maxPitch&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=f.minPitch&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=f.maxPitch&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const _=new Dn,x=new Nn;if(void 0!==f.minZoom&&_.setMinZoom(f.minZoom),void 0!==f.maxZoom&&_.setMaxZoom(f.maxZoom),void 0!==f.minPitch&&_.setMinPitch(f.minPitch),void 0!==f.maxPitch&&_.setMaxPitch(f.maxPitch),void 0!==f.renderWorldCopies&&_.setRenderWorldCopies(f.renderWorldCopies),super(_,x,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new $i,this._controls=[],this._mapId=y.a7(),this._contextLost=I=>{I.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new y.l("webglcontextlost",{originalEvent:I}))},this._contextRestored=I=>{this._setupPainter(),this.resize(),this._update(),this.fire(new y.l("webglcontextrestored",{originalEvent:I}))},this._onMapScroll=I=>{if(I.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=!0===f.trackResize,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=!0===f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=!0===f.crossSourceCollisions,this._collectResourceTiming=!0===f.collectResourceTiming,this._locale=Object.assign(Object.assign({},ft),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=!0===f.cancelPendingTileRequestsWhileZooming,this._imageQueueHandle=Mn.addThrottleControl(()=>this.isMoving()),this._requestManager=new _r(f.transformRequest),"string"==typeof f.container){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let I=!1;const D=Ha(N=>{this._trackResize&&!this._removed&&(this.resize(N),this.redraw())},50);this._resizeObserver=new ResizeObserver(N=>{I?D(N):I=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Eu(this,f),this._hash=f.hash&&new Us("string"==typeof f.hash&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,y.e({},f.fitBoundsOptions,{duration:0}))));const S="string"==typeof f.style||"globe"!==(null===(u=null===(o=f.style)||void 0===o?void 0:o.projection)||void 0===u?void 0:u.type);this.resize(null,S),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Td("boolean"==typeof f.attributionControl?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new Tu,f.logoPosition),this.on("style.load",()=>{if(S||this._resizeTransform(),this.transform.unmodified){const I=y.Q(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(I)}}),this.on("data",I=>{this._update("style"===I.dataType),this.fire(new y.l(`${I.dataType}data`,I))}),this.on("dataloading",I=>{this.fire(new y.l(`${I.dataType}dataloading`,I))}),this.on("dataabort",I=>{this.fire(new y.l("sourcedataabort",I))})}_getMapId(){return this._mapId}setGlobalStateProperty(b,o){return this.style.setGlobalStateProperty(b,o),this._update(!0)}getGlobalState(){return this.style.getGlobalState()}addControl(b,o){if(void 0===o&&(o=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new y.k(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=b.onAdd(this);this._controls.push(b);const f=this._controlPositions[o];return-1!==o.indexOf("bottom")?f.insertBefore(u,f.firstChild):f.appendChild(u),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new y.k(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(b);return o>-1&&this._controls.splice(o,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}calculateCameraOptionsFromTo(b,o,u,f){return null==f&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(u,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,o,u,f)}resize(b,o=!0){const[u,f]=this._containerDimensions(),_=this._getClampedPixelRatio(u,f);if(this._resizeCanvas(u,f,_),this.painter.resize(u,f,_),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const I=this._getClampedPixelRatio(u,f);this._resizeCanvas(u,f,I),this.painter.resize(u,f,I)}this._resizeTransform(o);const x=!this._moving;return x&&(this.stop(),this.fire(new y.l("movestart",b)).fire(new y.l("move",b))),this.fire(new y.l("resize",b)),x&&this.fire(new y.l("moveend",b)),this}_resizeTransform(b=!0){var o;const[u,f]=this._containerDimensions();this.transform.resize(u,f,b),null===(o=this._requestedCameraState)||void 0===o||o.resize(u,f,b)}_getClampedPixelRatio(b,o){const{0:u,1:f}=this._maxCanvasSize,_=this.getPixelRatio(),x=b*_,S=o*_;return Math.min(x>u?u/x:1,S>f?f/S:1)*_}getPixelRatio(){var b;return null!==(b=this._overridePixelRatio)&&void 0!==b?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(Jn.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}project(b){return this.transform.locationToScreenPoint(y.S.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(y.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||(null===(b=this.handlers)||void 0===b?void 0:b.isMoving())}isZooming(){var b;return this._zooming||(null===(b=this.handlers)||void 0===b?void 0:b.isZooming())}isRotating(){var b;return this._rotating||(null===(b=this.handlers)||void 0===b?void 0:b.isRotating())}_createDelegatedListener(b,o,u){if("mouseenter"===b||"mouseover"===b){let f=!1;return{layers:o,listener:u,delegates:{mousemove:x=>{const S=o.filter(D=>this.getLayer(D)),I=0!==S.length?this.queryRenderedFeatures(x.point,{layers:S}):[];I.length?f||(f=!0,u.call(this,new fo(b,this,x.originalEvent,{features:I}))):f=!1},mouseout:()=>{f=!1}}}}if("mouseleave"===b||"mouseout"===b){let f=!1;return{layers:o,listener:u,delegates:{mousemove:S=>{const I=o.filter(D=>this.getLayer(D));(0!==I.length?this.queryRenderedFeatures(S.point,{layers:I}):[]).length?f=!0:f&&(f=!1,u.call(this,new fo(b,this,S.originalEvent)))},mouseout:S=>{f&&(f=!1,u.call(this,new fo(b,this,S.originalEvent)))}}}}{const f=_=>{const x=o.filter(I=>this.getLayer(I)),S=0!==x.length?this.queryRenderedFeatures(_.point,{layers:x}):[];S.length&&(_.features=S,u.call(this,_),delete _.features)};return{layers:o,listener:u,delegates:{[b]:f}}}}_saveDelegatedListener(b,o){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(o)}_removeDelegatedListener(b,o,u){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const f=this._delegatedListeners[b];for(let _=0;_<f.length;_++){const x=f[_];if(x.listener===u&&x.layers.length===o.length&&x.layers.every(S=>o.includes(S))){for(const S in x.delegates)this.off(S,x.delegates[S]);return void f.splice(_,1)}}}on(b,o,u){if(void 0===u)return super.on(b,o);const f="string"==typeof o?[o]:o,_=this._createDelegatedListener(b,f,u);this._saveDelegatedListener(b,_);for(const x in _.delegates)this.on(x,_.delegates[x]);return{unsubscribe:()=>{this._removeDelegatedListener(b,f,u)}}}once(b,o,u){if(void 0===u)return super.once(b,o);const f="string"==typeof o?[o]:o,_=this._createDelegatedListener(b,f,u);for(const x in _.delegates){const S=_.delegates[x];_.delegates[x]=(...I)=>{this._removeDelegatedListener(b,f,u),S(...I)}}this._saveDelegatedListener(b,_);for(const x in _.delegates)this.once(x,_.delegates[x]);return this}off(b,o,u){return void 0===u?super.off(b,o):(this._removeDelegatedListener(b,"string"==typeof o?[o]:o,u),this)}queryRenderedFeatures(b,o){if(!this.style)return[];let u;const f=b instanceof y.P||Array.isArray(b),_=f?b:[[0,0],[this.transform.width,this.transform.height]];if(o=o||(f?{}:b)||{},_ instanceof y.P||"number"==typeof _[0])u=[y.P.convert(_)];else{const x=y.P.convert(_[0]),S=y.P.convert(_[1]);u=[x,new y.P(S.x,x.y),S,new y.P(x.x,S.y),x]}return this.style.queryRenderedFeatures(u,o,this.transform)}querySourceFeatures(b,o){return this.style.querySourceFeatures(b,o)}setStyle(b,o){return!1!==(o=y.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},o)).diff&&o.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._updateStyle(b,o))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const o=this._locale[b];if(null==o)throw new Error(`Missing UI string '${b}'`);return o}_updateStyle(b,o){var u,f;if(o.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,o));const _=this.style&&o.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new gc(this,o||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof b?this.style.loadURL(b,o,_):this.style.loadJSON(b,o,_),this):(null===(f=null===(u=this.style)||void 0===u?void 0:u.projection)||void 0===f||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new gc(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,o){if("string"==typeof b){const u=this._requestManager.transformRequest(b,"Style");y.j(u,new AbortController).then(f=>{this._updateDiff(f.data,o)}).catch(f=>{f&&this.fire(new y.k(f))})}else"object"==typeof b&&this._updateDiff(b,o)}_updateDiff(b,o){try{this.style.setState(b,o)&&this._update(!0)}catch(u){y.w(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(b,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():y.w("There is no style added to the map.")}addSource(b,o){return this._lazyInitEmptyStyle(),this.style.addSource(b,o),this._update(!0)}isSourceLoaded(b){const o=this.style&&this.style.sourceCaches[b];if(void 0!==o)return o.loaded();this.fire(new y.k(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const o=this.style.sourceCaches[b.source];if(!o)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);null===this.terrain&&o.reload();for(const u in this.style._layers){const f=this.style._layers[u];"hillshade"===f.type&&f.source===b.source&&y.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality."),"color-relief"===f.type&&f.source===b.source&&y.w("You are using the same source for a color-relief layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new G(this.painter,o,b),this.painter.renderToTexture=new He(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=u=>{var f;"style"===u.dataType?this.terrain.sourceCache.freeRtt():"source"===u.dataType&&u.tile&&(u.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),"image"===(null===(f=u.source)||void 0===f?void 0:f.type)?this.terrain.sourceCache.freeRtt():this.terrain.sourceCache.freeRtt(u.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new y.l("terrain",{terrain:b})),this}getTerrain(){var b,o;return null!==(o=null===(b=this.terrain)||void 0===b?void 0:b.options)&&void 0!==o?o:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const o in b){const u=b[o]._tiles;for(const f in u){const _=u[f];if("loaded"!==_.state&&"errored"!==_.state)return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}setSourceTileLodParams(b,o,u){if(u){const f=this.getSource(u);if(!f)throw new Error(`There is no source with ID "${u}", cannot set LOD parameters`);f.calculateTileZoom=Ue(Math.max(1,b),Math.max(1,o))}else for(const f in this.style.sourceCaches)this.style.sourceCaches[f].getSource().calculateTileZoom=Ue(Math.max(1,b),Math.max(1,o));return this._update(!0),this}refreshTiles(b,o){const u=this.style.sourceCaches[b];if(!u)throw new Error(`There is no source cache with ID "${b}", cannot refresh tile`);void 0===o?u.reload(!0):u.refreshTiles(o.map(f=>new y.a4(f.z,f.x,f.y)))}addImage(b,o,u={}){const{pixelRatio:f=1,sdf:_=!1,stretchX:x,stretchY:S,content:I,textFitWidth:D,textFitHeight:N}=u;if(this._lazyInitEmptyStyle(),!(o instanceof HTMLImageElement||y.b(o))){if(void 0===o.width||void 0===o.height)return this.fire(new y.k(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:F,height:U,data:V}=o,H=o;return this.style.addImage(b,{data:new y.R({width:F,height:U},new Uint8Array(V)),pixelRatio:f,stretchX:x,stretchY:S,content:I,textFitWidth:D,textFitHeight:N,sdf:_,version:0,userImage:H}),H.onAdd&&H.onAdd(this,b),this}}{const{width:F,height:U,data:V}=mt.getImageData(o);this.style.addImage(b,{data:new y.R({width:F,height:U},V),pixelRatio:f,stretchX:x,stretchY:S,content:I,textFitWidth:D,textFitHeight:N,sdf:_,version:0})}}updateImage(b,o){const u=this.style.getImage(b);if(!u)return this.fire(new y.k(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=o instanceof HTMLImageElement||y.b(o)?mt.getImageData(o):o,{width:_,height:x,data:S}=f;if(void 0===_||void 0===x)return this.fire(new y.k(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==u.data.width||x!==u.data.height)return this.fire(new y.k(new Error("The width and height of the updated image must be that same as the previous version of the image")));const I=!(o instanceof HTMLImageElement||y.b(o));return u.data.replace(S,I),this.style.updateImage(b,u),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new y.k(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return Mn.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,o){return this._lazyInitEmptyStyle(),this.style.addLayer(b,o),this._update(!0)}moveLayer(b,o){return this.style.moveLayer(b,o),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,o,u){return this.style.setLayerZoomRange(b,o,u),this._update(!0)}setFilter(b,o,u={}){return this.style.setFilter(b,o,u),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,o,u,f={}){return this.style.setPaintProperty(b,o,u,f),this._update(!0)}getPaintProperty(b,o){return this.style.getPaintProperty(b,o)}setLayoutProperty(b,o,u,f={}){return this.style.setLayoutProperty(b,o,u,f),this._update(!0)}getLayoutProperty(b,o){return this.style.getLayoutProperty(b,o)}setGlyphs(b,o={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,o),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,o,u={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,o,u,f=>{f||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,o={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,o,u=>{u||this._update(!0)}),this}setLight(b,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,o),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,o={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,o),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,o){return this.style.setFeatureState(b,o),this._update()}removeFeatureState(b,o){return this.style.removeFeatureState(b,o),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,o=0;return this._container&&(b=this._container.clientWidth||400,o=this._container.clientHeight||300),[b,o]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const o=this._canvasContainer=Ce.create("div","maplibregl-canvas-container",b);this._interactive&&o.classList.add("maplibregl-interactive"),this._canvas=Ce.create("canvas","maplibregl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const u=this._containerDimensions(),f=this._getClampedPixelRatio(u[0],u[1]);this._resizeCanvas(u[0],u[1],f);const _=this._controlContainer=Ce.create("div","maplibregl-control-container",b),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{x[S]=Ce.create("div",`maplibregl-ctrl-${S} `,_)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,o,u){this._canvas.width=Math.floor(u*b),this._canvas.height=Math.floor(u*o),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${o}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let o=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{o={requestedAttributes:b},f&&(o.statusMessage=f.statusMessage,o.type=f.type)},{once:!0});let u=null;if(u=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!u){const f="Failed to initialize WebGL";throw o?(o.message=f,new Error(JSON.stringify(o))):new Error(f)}this.painter=new Fh(u,this.transform),Qe.testSupport(u)}migrateProjection(b,o){super.migrateProjection(b,o),this.painter.transform=b,this.fire(new y.l("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var o,u,f,_,x;const S=this._idleTriggered?this._fadeDuration:0,I=(null===(o=this.style.projection)||void 0===o?void 0:o.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let D=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const U=this.transform.zoom,V=mt.now();this.style.zoomHistory.update(U,V);const H=new y.F(U,{now:V,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition(),globalState:this.style.getGlobalState()}),Y=H.crossFadingFactor();1===Y&&Y===this._crossFadingFactor||(D=!0,this._crossFadingFactor=Y),this.style.update(H)}const N=(null===(u=this.style.projection)||void 0===u?void 0:u.transitionState)>0!==I;null===(f=this.style.projection)||void 0===f||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState(null===(_=this.style.projection)||void 0===_?void 0:_.transitionState,null===(x=this.style.projection)||void 0===x?void 0:x.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||N)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,N),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new y.l("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,y.cw.mark(y.cx.load),this.fire(new y.l("load"))),this.style&&(this.style.hasTransitions()||D)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const F=this._sourcesDirty||this._styleDirty||this._placementDirty;return F||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new y.l("idle")),!this._loaded||this._fullyLoaded||F||(this._fullyLoaded=!0,y.cw.mark(y.cx.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const u of this._controls)u.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Mn.removeThrottleControl(this._imageQueueHandle),null===(b=this._resizeObserver)||void 0===b||b.disconnect();const o=this.painter.context.gl.getExtension("WEBGL_lose_context");o?.loseContext&&o.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),Ce.remove(this._canvasContainer),Ce.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),y.cw.clearMetrics(),this._removed=!0,this.fire(new y.l("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,mt.frame(this._frameRequest,b=>{y.cw.frame(b),this._frameRequest=null;try{this._render(b)}catch(o){if(!y.cy(o)&&o.message!==Pl)throw o}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return"5.6.2"}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},W.MapMouseEvent=fo,W.MapTouchEvent=Gs,W.MapWheelEvent=Ca,W.Marker=Du,W.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const o=this._map.getZoom(),u=o===this._map.getMaxZoom(),f=o===this._map.getMinZoom();this._zoomInButton.disabled=u,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",u.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(o,u)=>{const f=this._map._getUIString(`NavigationControl.${u}`);o.title=f,o.setAttribute("aria-label",f)},this.options=y.e({},Ir,b),this._container=Ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",o=>this._map.zoomIn({},{originalEvent:o})),Ce.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",o=>this._map.zoomOut({},{originalEvent:o})),Ce.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",o=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:o}):this._map.resetNorth({},{originalEvent:o})}),this._compassIcon=Ce.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Xn(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){Ce.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,o){const u=Ce.create("button",b,this._container);return u.type="button",u.addEventListener("click",o),u}},W.Popup=class extends y.E{constructor(b){super(),this._updateOpacity=()=>{void 0!==this.options.locationOccludedOpacity&&(this._container.style.opacity=this._map.transform.isLocationOccluded(this.getLngLat())?`${this.options.locationOccludedOpacity}`:"")},this.remove=()=>(this._content&&Ce.remove(this._content),this._container&&(Ce.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new y.l("close"))),this),this._onMouseUp=o=>{this._update(o.point)},this._onMouseMove=o=>{this._update(o.point)},this._onDrag=o=>{this._update(o.point)},this._update=o=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=Ce.create("div","maplibregl-popup",this._map.getContainer()),this._tip=Ce.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const S of this.options.className.split(" "))this._container.classList.add(S);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=hr(this._lngLat,this._flatPos,this._map.transform,this._trackPointer),this._trackPointer&&!o)return;const u=this._flatPos=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&o?o:this._map.transform.locationToScreenPoint(this._lngLat));let f=this.options.anchor;const _=kd(this.options.offset);if(!f){const S=this._container.offsetWidth,I=this._container.offsetHeight;let D;D=u.y+_.bottom.y<I?["top"]:u.y>this._map.transform.height-I?["bottom"]:[],u.x<S/2?D.push("left"):u.x>this._map.transform.width-S/2&&D.push("right"),f=0===D.length?"bottom":D.join("-")}let x=u.add(_[f]);this.options.subpixelPositioning||(x=x.round()),Ce.setTransform(this._container,`${Bc[f]} translate(${x.x}px,${x.y}px)`),Iu(this._container,f,"popup"),this._updateOpacity()},this._onClose=()=>{this.remove()},this.options=y.e(Object.create(Ad),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new y.l("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=y.S.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const o=document.createDocumentFragment(),u=document.createElement("body");let f;for(u.innerHTML=b;f=u.firstChild,f;)o.appendChild(f);return this.setDOMContent(o)}getMaxWidth(){var b;return null===(b=this._container)||void 0===b?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Ce.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=Ce.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Pd);b&&b.focus()}},W.RasterDEMTileSource=Vt,W.RasterTileSource=At,W.ScaleControl=class{constructor(b){this._onMove=()=>{Dd(this._map,this._container,this.options)},this.setUnit=o=>{this.options.unit=o,Dd(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Au),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=Ce.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){Ce.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},W.ScrollZoomHandler=Nc,W.Style=gc,W.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=Ce.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=Ce.create("button","maplibregl-ctrl-terrain",this._container),Ce.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){Ce.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},W.TwoFingersTouchPitchHandler=us,W.TwoFingersTouchRotateHandler=Ci,W.TwoFingersTouchZoomHandler=Hs,W.TwoFingersTouchZoomRotateHandler=Md,W.VectorTileSource=gt,W.VideoSource=ao,W.addSourceType=(b,o)=>y._(void 0,void 0,void 0,function*(){if(ki(b))throw new Error(`A source type called "${b}" already exists.`);Pi[b]=o}),W.clearPrewarmedResources=function(){const b=Rr;b&&(b.isPreloaded()&&1===b.numActive()?(b.release(fn),Rr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},W.createTileMesh=Rs,W.getMaxParallelImageRequests=function(){return y.a.MAX_PARALLEL_IMAGE_REQUESTS},W.getRTLTextPluginStatus=function(){return Go().getRTLTextPluginStatus()},W.getVersion=function(){return"5.6.2"},W.getWorkerCount=function(){return Un.workerCount},W.getWorkerUrl=function(){return y.a.WORKER_URL},W.importScriptInWorkers=function(b){return ai().broadcast("IS",b)},W.prewarm=function(){Uo().acquire(fn)},W.setMaxParallelImageRequests=function(b){y.a.MAX_PARALLEL_IMAGE_REQUESTS=b},W.setRTLTextPlugin=function(b,o){return Go().setRTLTextPlugin(b,o)},W.setWorkerCount=function(b){Un.workerCount=b},W.setWorkerUrl=function(b){y.a.WORKER_URL=b}}),cn}()},71:(Xr,cn,dt)=>{"use strict";function p(St){return"function"==typeof St}dt.d(cn,{T:()=>p})},203:(Xr,cn,dt)=>{"use strict";dt.d(cn,{F:()=>St,m:()=>W});var p=dt(669);function St(...y){return W(y)}function W(y){return 0===y.length?p.D:1===y.length?y[0]:function(En){return y.reduce((yn,vn)=>vn(yn),En)}}},270:(Xr,cn,dt)=>{"use strict";dt.d(cn,{f:()=>p});const p={setTimeout(St,W,...y){const{delegate:Ye}=p;return Ye?.setTimeout?Ye.setTimeout(St,W,...y):setTimeout(St,W,...y)},clearTimeout(St){const{delegate:W}=p;return(W?.clearTimeout||clearTimeout)(St)},delegate:void 0}},334:(Xr,cn,dt)=>{"use strict";dt.d(cn,{m:()=>W});var p=dt(26),St=dt(270);function W(y){St.f.setTimeout(()=>{const{onUnhandledError:Ye}=p.$;if(!Ye)throw y;Ye(y)})}},343:(Xr,cn,dt)=>{"use strict";function p(){}dt.d(cn,{l:()=>p})},359:(Xr,cn,dt)=>{"use strict";dt.d(cn,{Kn:()=>En,yU:()=>Ye,Uv:()=>yn});var p=dt(71);const W=(0,dt(853).L)(mt=>function(Qe){mt(this),this.message=Qe?`${Qe.length} errors occurred during unsubscription:\n${Qe.map((_t,Ht)=>`${Ht+1}) ${_t.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Qe});var y=dt(908);class Ye{constructor(Ce){this.initialTeardown=Ce,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Ce;if(!this.closed){this.closed=!0;const{_parentage:Qe}=this;if(Qe)if(this._parentage=null,Array.isArray(Qe))for(const Ut of Qe)Ut.remove(this);else Qe.remove(this);const{initialTeardown:_t}=this;if((0,p.T)(_t))try{_t()}catch(Ut){Ce=Ut instanceof W?Ut.errors:[Ut]}const{_finalizers:Ht}=this;if(Ht){this._finalizers=null;for(const Ut of Ht)try{vn(Ut)}catch(Gt){Ce=Ce??[],Gt instanceof W?Ce=[...Ce,...Gt.errors]:Ce.push(Gt)}}if(Ce)throw new W(Ce)}}add(Ce){var Qe;if(Ce&&Ce!==this)if(this.closed)vn(Ce);else{if(Ce instanceof Ye){if(Ce.closed||Ce._hasParent(this))return;Ce._addParent(this)}(this._finalizers=null!==(Qe=this._finalizers)&&void 0!==Qe?Qe:[]).push(Ce)}}_hasParent(Ce){const{_parentage:Qe}=this;return Qe===Ce||Array.isArray(Qe)&&Qe.includes(Ce)}_addParent(Ce){const{_parentage:Qe}=this;this._parentage=Array.isArray(Qe)?(Qe.push(Ce),Qe):Qe?[Qe,Ce]:Ce}_removeParent(Ce){const{_parentage:Qe}=this;Qe===Ce?this._parentage=null:Array.isArray(Qe)&&(0,y.o)(Qe,Ce)}remove(Ce){const{_finalizers:Qe}=this;Qe&&(0,y.o)(Qe,Ce),Ce instanceof Ye&&Ce._removeParent(this)}}Ye.EMPTY=(()=>{const mt=new Ye;return mt.closed=!0,mt})();const En=Ye.EMPTY;function yn(mt){return mt instanceof Ye||mt&&"closed"in mt&&(0,p.T)(mt.remove)&&(0,p.T)(mt.add)&&(0,p.T)(mt.unsubscribe)}function vn(mt){(0,p.T)(mt)?mt():mt.unsubscribe()}},412:(Xr,cn,dt)=>{"use strict";dt.d(cn,{t:()=>St});var p=dt(413);class St extends p.B{constructor(y){super(),this._value=y}get value(){return this.getValue()}_subscribe(y){const Ye=super._subscribe(y);return!Ye.closed&&y.next(this._value),Ye}getValue(){const{hasError:y,thrownError:Ye,_value:En}=this;if(y)throw Ye;return this._throwIfClosed(),En}next(y){super.next(this._value=y)}}},413:(Xr,cn,dt)=>{"use strict";dt.d(cn,{B:()=>yn});var p=dt(985),St=dt(359);const y=(0,dt(853).L)(mt=>function(){mt(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Ye=dt(908),En=dt(786);let yn=(()=>{class mt extends p.c{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(Qe){const _t=new vn(this,this);return _t.operator=Qe,_t}_throwIfClosed(){if(this.closed)throw new y}next(Qe){(0,En.Y)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const _t of this.currentObservers)_t.next(Qe)}})}error(Qe){(0,En.Y)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=Qe;const{observers:_t}=this;for(;_t.length;)_t.shift().error(Qe)}})}complete(){(0,En.Y)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:Qe}=this;for(;Qe.length;)Qe.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var Qe;return(null===(Qe=this.observers)||void 0===Qe?void 0:Qe.length)>0}_trySubscribe(Qe){return this._throwIfClosed(),super._trySubscribe(Qe)}_subscribe(Qe){return this._throwIfClosed(),this._checkFinalizedStatuses(Qe),this._innerSubscribe(Qe)}_innerSubscribe(Qe){const{hasError:_t,isStopped:Ht,observers:Ut}=this;return _t||Ht?St.Kn:(this.currentObservers=null,Ut.push(Qe),new St.yU(()=>{this.currentObservers=null,(0,Ye.o)(Ut,Qe)}))}_checkFinalizedStatuses(Qe){const{hasError:_t,thrownError:Ht,isStopped:Ut}=this;_t?Qe.error(Ht):Ut&&Qe.complete()}asObservable(){const Qe=new p.c;return Qe.source=this,Qe}}return mt.create=(Ce,Qe)=>new vn(Ce,Qe),mt})();class vn extends yn{constructor(Ce,Qe){super(),this.destination=Ce,this.source=Qe}next(Ce){var Qe,_t;null===(_t=null===(Qe=this.destination)||void 0===Qe?void 0:Qe.next)||void 0===_t||_t.call(Qe,Ce)}error(Ce){var Qe,_t;null===(_t=null===(Qe=this.destination)||void 0===Qe?void 0:Qe.error)||void 0===_t||_t.call(Qe,Ce)}complete(){var Ce,Qe;null===(Qe=null===(Ce=this.destination)||void 0===Ce?void 0:Ce.complete)||void 0===Qe||Qe.call(Ce)}_subscribe(Ce){var Qe,_t;return null!==(_t=null===(Qe=this.source)||void 0===Qe?void 0:Qe.subscribe(Ce))&&void 0!==_t?_t:St.Kn}}},436:(Xr,cn,dt)=>{"use strict";var p=dt(615),St=dt(413);let W=null;function y(){return W}class En{}let yn=(()=>{class e{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:()=>(0,p.WQX)(mt),providedIn:"platform"})}return e})(),mt=(()=>{class e extends yn{_location;_history;_doc=(0,p.WQX)(p.qQL);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return y().getBaseHref(this._doc)}onPopState(n){const r=y().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",n,!1),()=>r.removeEventListener("popstate",n)}onHashChange(n){const r=y().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",n,!1),()=>r.removeEventListener("hashchange",n)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(n){this._location.pathname=n}pushState(n,r,s){this._history.pushState(n,r,s)}replaceState(n,r,s){this._history.replaceState(n,r,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(n=0){this._history.go(n)}getState(){return this._history.state}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:()=>new e,providedIn:"platform"})}return e})();function Ce(e,t){return e?t?e.endsWith("/")?t.startsWith("/")?e+t.slice(1):e+t:t.startsWith("/")?e+t:`${e}/${t}`:e:t}function Qe(e){const t=e.search(/#|\?|$/);return"/"===e[t-1]?e.slice(0,t-1)+e.slice(t):e}function _t(e){return e&&"?"!==e[0]?`?${e}`:e}let Ht=(()=>{class e{historyGo(n){throw new Error("")}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:()=>(0,p.WQX)(Gt),providedIn:"root"})}return e})();const Ut=new p.nKC("");let Gt=(()=>{class e extends Ht{_platformLocation;_baseHref;_removeListenerFns=[];constructor(n,r){super(),this._platformLocation=n,this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??(0,p.WQX)(p.qQL).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(n){this._removeListenerFns.push(this._platformLocation.onPopState(n),this._platformLocation.onHashChange(n))}getBaseHref(){return this._baseHref}prepareExternalUrl(n){return Ce(this._baseHref,n)}path(n=!1){const r=this._platformLocation.pathname+_t(this._platformLocation.search),s=this._platformLocation.hash;return s&&n?`${r}${s}`:r}pushState(n,r,s,l){const d=this.prepareExternalUrl(s+_t(l));this._platformLocation.pushState(n,r,d)}replaceState(n,r,s,l){const d=this.prepareExternalUrl(s+_t(l));this._platformLocation.replaceState(n,r,d)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(n=0){this._platformLocation.historyGo?.(n)}static \u0275fac=function(r){return new(r||e)(p.KVO(yn),p.KVO(Ut,8))};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),sn=(()=>{class e{_subject=new St.B;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(n){this._locationStrategy=n;const r=this._locationStrategy.getBaseHref();this._basePath=function Vo(e){if(new RegExp("^(https?:)?//").test(e)){const[,n]=e.split(/\/\/[^\/]+/);return n}return e}(Qe(zt(r))),this._locationStrategy.onPopState(s=>{this._subject.next({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(n=!1){return this.normalize(this._locationStrategy.path(n))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(n,r=""){return this.path()==this.normalize(n+_t(r))}normalize(n){return e.stripTrailingSlash(function _r(e,t){if(!e||!t.startsWith(e))return t;const n=t.substring(e.length);return""===n||["/",";","?","#"].includes(n[0])?n:t}(this._basePath,zt(n)))}prepareExternalUrl(n){return n&&"/"!==n[0]&&(n="/"+n),this._locationStrategy.prepareExternalUrl(n)}go(n,r="",s=null){this._locationStrategy.pushState(s,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+_t(r)),s)}replaceState(n,r="",s=null){this._locationStrategy.replaceState(s,"",n,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(n+_t(r)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(n=0){this._locationStrategy.historyGo?.(n)}onUrlChange(n){return this._urlChangeListeners.push(n),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{const r=this._urlChangeListeners.indexOf(n);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(n="",r){this._urlChangeListeners.forEach(s=>s(n,r))}subscribe(n,r,s){return this._subject.subscribe({next:n,error:r??void 0,complete:s??void 0})}static normalizeQueryParams=_t;static joinWithSlash=Ce;static stripTrailingSlash=Qe;static \u0275fac=function(r){return new(r||e)(p.KVO(Ht))};static \u0275prov=p.jDH({token:e,factory:()=>function Mn(){return new sn((0,p.KVO)(Ht))}(),providedIn:"root"})}return e})();function zt(e){return e.replace(/\/index.html$/,"")}var Ge=dt(440);function ir(e,t,n,r,s,l,d){try{var g=e[l](d),v=g.value}catch(M){return void n(M)}g.done?t(v):Promise.resolve(v).then(r,s)}function Tn(e){return function(){var t=this,n=arguments;return new Promise(function(r,s){var l=e.apply(t,n);function d(v){ir(l,r,s,d,g,"next",v)}function g(v){ir(l,r,s,d,g,"throw",v)}d(void 0)})}}var gn=dt(359),cr=dt(71);function Sr(e){return(0,cr.T)(e?.lift)}function Wn(e){return t=>{if(Sr(t))return t.lift(function(n){try{return e(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}var Qo=dt(707);function Vn(e,t,n,r,s){return new an(e,t,n,r,s)}class an extends Qo.vU{constructor(t,n,r,s,l,d){super(t),this.onFinalize=l,this.shouldUnsubscribe=d,this._next=n?function(g){try{n(g)}catch(v){t.error(v)}}:super._next,this._error=s?function(g){try{s(g)}catch(v){t.error(v)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(g){t.error(g)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:n}=this;super.unsubscribe(),!n&&(null===(t=this.onFinalize)||void 0===t||t.call(this))}}}function fn(e,t){return Wn((n,r)=>{let s=0;n.subscribe(Vn(r,l=>{r.next(e.call(t,l,s++))}))})}function Un(e){return{toString:e}.toString()}const Rr="__parameters__";function ai(e,t,n){return Un(()=>{const r=function Or(e){return function(...n){if(e){const r=e(...n);for(const s in r)this[s]=r[s]}}}(t);function s(...l){if(this instanceof s)return r.apply(this,l),this;const d=new s(...l);return g.annotation=d,g;function g(v,M,A){const O=v.hasOwnProperty(Rr)?v[Rr]:Object.defineProperty(v,Rr,{value:[]})[Rr];for(;O.length<=A;)O.push(null);return(O[A]=O[A]||[]).push(d),v}}return s.prototype.ngMetadataName=e,s.annotationCls=s,s})}const li=(0,p.z6V)(ai("Optional"),8),Nr=(0,p.z6V)(ai("SkipSelf"),4);class Ri{previousValue;currentValue;firstChange;constructor(t,n,r){this.previousValue=t,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}}function Go(e,t,n,r){null!==t?t.applyValueToInputSignal(t,r):e[n]=r}const Ao=(()=>{const e=()=>xe;return e.ngInherit=!0,e})();function xe(e){return e.type.prototype.ngOnChanges&&(e.setInput=ee),K}function K(){const e=de(this),t=e?.current;if(t){const n=e.previous;if(n===p.MZA)e.previous=t;else for(let r in t)n[r]=t[r];e.current=null,this.ngOnChanges(t)}}function ee(e,t,n,r,s){const l=this.declaredInputs[r],d=de(e)||function be(e,t){return e[te]=t}(e,{previous:p.MZA,current:null}),g=d.current||(d.current={}),v=d.previous,M=v[l];g[l]=new Ri(M&&M.currentValue,n,v===p.MZA),Go(e,t,s,n)}const te="__ngSimpleChanges__";function de(e){return e[te]||null}const we=[],Ue=function(e,t=null,n){for(let r=0;r<we.length;r++)(0,we[r])(e,t,n)};function bt(e,t){for(let n=t.directiveStart,r=t.directiveEnd;n<r;n++){const l=e.data[n].type.prototype,{ngAfterContentInit:d,ngAfterContentChecked:g,ngAfterViewInit:v,ngAfterViewChecked:M,ngOnDestroy:A}=l;d&&(e.contentHooks??=[]).push(-n,d),g&&((e.contentHooks??=[]).push(n,g),(e.contentCheckHooks??=[]).push(n,g)),v&&(e.viewHooks??=[]).push(-n,v),M&&((e.viewHooks??=[]).push(n,M),(e.viewCheckHooks??=[]).push(n,M)),null!=A&&(e.destroyHooks??=[]).push(n,A)}}function Me(e,t,n){Et(e,t,3,n)}function Ft(e,t,n,r){(3&e[p.Wg1])===n&&Et(e,t,n,r)}function Jt(e,t){let n=e[p.Wg1];(3&n)===t&&(n&=16383,n+=1,e[p.Wg1]=n)}function Et(e,t,n,r){const l=r??-1,d=t.length-1;let g=0;for(let v=void 0!==r?65535&e[p.wVl]:0;v<d;v++)if("number"==typeof t[v+1]){if(g=t[v],null!=r&&g>=r)break}else t[v]<0&&(e[p.wVl]+=65536),(g<l||-1==l)&&(kn(e,n,t,v),e[p.wVl]=(4294901760&e[p.wVl])+v+2),v++}function Zt(e,t){Ue(4,e,t);const n=(0,Ge.Ht)(null);try{t.call(e)}finally{(0,Ge.Ht)(n),Ue(5,e,t)}}function kn(e,t,n,r){const s=n[r]<0,l=n[r+1],g=e[s?-n[r]:n[r]];s?e[p.Wg1]>>14<e[p.wVl]>>16&&(3&e[p.Wg1])===t&&(e[p.Wg1]+=16384,Zt(g,l)):Zt(g,l)}class Gn{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(t,n,r,s){this.factory=t,this.name=s,this.canSeeViewProviders=n,this.injectImpl=r}}function sa(e){return 3===e||4===e||6===e}function at(e){return 64===e.charCodeAt(0)}function Yt(e,t){if(null!==t&&0!==t.length)if(null===e||0===e.length)e=t.slice();else{let n=-1;for(let r=0;r<t.length;r++){const s=t[r];"number"==typeof s?n=s:0===n||Kt(e,n,s,0,-1===n||2===n?t[++r]:null)}}return e}function Kt(e,t,n,r,s){let l=0,d=e.length;if(-1===t)d=-1;else for(;l<e.length;){const g=e[l++];if("number"==typeof g){if(g===t){d=-1;break}if(g>t){d=l-1;break}}}for(;l<e.length;){const g=e[l];if("number"==typeof g)break;if(g===n)return void(null!==s&&(e[l+1]=s));l++,null!==s&&l++}-1!==d&&(e.splice(d,0,t),l=d+1),e.splice(l++,0,n),null!==s&&e.splice(l++,0,s)}function Er(e){return-1!==e}function ui(e){return 32767&e}function jt(e,t){let n=function As(e){return e>>16}(e),r=t;for(;n>0;)r=r[p.X5O],n--;return r}let aa=!0;function Fr(e){const t=aa;return aa=e,t}let Rn=0;const bo={};function In(e,t){const n=Pa(e,t);if(-1!==n)return n;const r=t[p.eDl];r.firstCreatePass&&(e.injectorIndex=t.length,Oi(r.data,e),Oi(t,null),Oi(r.blueprint,null));const s=xo(e,t),l=e.injectorIndex;if(Er(s)){const d=ui(s),g=jt(s,t),v=g[p.eDl].data;for(let M=0;M<8;M++)t[l+M]=g[d+M]|v[d+M]}return t[l+8]=s,l}function Oi(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Pa(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function xo(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let n=0,r=null,s=t;for(;null!==s;){if(r=co(s),null===r)return-1;if(n++,s=s[p.X5O],-1!==r.injectorIndex)return r.injectorIndex|n<<16}return-1}function ko(e,t,n){!function Po(e,t,n){let r;"string"==typeof n?r=n.charCodeAt(0)||0:n.hasOwnProperty(p.p9y)&&(r=n[p.p9y]),null==r&&(r=n[p.p9y]=Rn++);const s=255&r;t.data[e+(s>>5)]|=1<<s}(e,t,n)}function ka(e,t,n){if(8&n||void 0!==e)return e;(0,p.$Hz)(t,"NodeInjector")}function nu(e,t,n,r){if(8&n&&void 0===r&&(r=null),!(3&n)){const s=e[p.YEL],l=(0,p.a2B)(void 0);try{return s?s.get(t,r,8&n):(0,p.MzJ)(t,r,8&n)}finally{(0,p.a2B)(l)}}return ka(r,t,n)}function ru(e,t,n,r=0,s){if(null!==e){if(2048&t[p.Wg1]&&!(2&r)){const d=function ts(e,t,n,r,s){let l=e,d=t;for(;null!==l&&null!==d&&2048&d[p.Wg1]&&!(0,p.EFk)(d);){const g=hi(l,d,n,2|r,bo);if(g!==bo)return g;let v=l.parent;if(!v){const M=d[p.oMQ];if(M){const A=M.get(n,bo,r);if(A!==bo)return A}v=co(d),d=d[p.X5O]}l=v}return s}(e,t,n,r,bo);if(d!==bo)return d}const l=hi(e,t,n,r,bo);if(l!==bo)return l}return nu(t,n,r,s)}function hi(e,t,n,r,s){const l=function iu(e){if("string"==typeof e)return e.charCodeAt(0)||0;const t=e.hasOwnProperty(p.p9y)?e[p.p9y]:void 0;return"number"==typeof t?t>=0?255&t:gl:t}(n);if("function"==typeof l){if(!(0,p.ihb)(t,e,r))return 1&r?ka(s,n,r):nu(t,n,r,s);try{let d;if(d=l(r),null!=d||8&r)return d;(0,p.$Hz)(n)}finally{(0,p.niQ)()}}else if("number"==typeof l){let d=null,g=Pa(e,t),v=-1,M=1&r?t[p.b5C][p.qlT]:null;for((-1===g||4&r)&&(v=-1===g?xo(e,t):t[g+8],-1!==v&&dc(r,!1)?(d=t[p.eDl],g=ui(v),t=jt(v,t)):g=-1);-1!==g;){const A=t[p.eDl];if(la(l,g,A.data)){const O=sd(g,t,n,d,r,M);if(O!==bo)return O}v=t[g+8],-1!==v&&dc(r,t[p.eDl].data[g+8]===M)&&la(l,g,t)?(d=A,g=ui(v),t=jt(v,t)):g=-1}}return s}function sd(e,t,n,r,s,l){const d=t[p.eDl],g=d.data[e+8],A=uc(g,d,n,null==r?(0,p.Qs1)(g)&&aa:r!=d&&!!(3&g.type),1&s&&l===g);return null!==A?pl(t,d,A,g,s):bo}function uc(e,t,n,r,s){const l=e.providerIndexes,d=t.data,g=1048575&l,v=e.directiveStart,A=l>>20,j=s?g+A:e.directiveEnd;for(let B=r?g:g+A;B<j;B++){const X=d[B];if(B<v&&n===X||B>=v&&X.type===n)return B}if(s){const B=d[v];if(B&&(0,p.JlV)(B)&&B.type===n)return v}return null}function pl(e,t,n,r,s){let l=e[n];const d=t.data;if(l instanceof Gn){const g=l;if(g.resolving){const B=(0,p.PP7)(d[n]);throw(0,p.PQT)(B)}const v=Fr(g.canSeeViewProviders);g.resolving=!0;const O=g.injectImpl?(0,p.a2B)(g.injectImpl):null;(0,p.ihb)(e,r,0);try{l=e[n]=g.factory(void 0,s,d,e,r),t.firstCreatePass&&n>=r.directiveStart&&function We(e,t,n){const{ngOnChanges:r,ngOnInit:s,ngDoCheck:l}=t.type.prototype;if(r){const d=xe(t);(n.preOrderHooks??=[]).push(e,d),(n.preOrderCheckHooks??=[]).push(e,d)}s&&(n.preOrderHooks??=[]).push(0-e,s),l&&((n.preOrderHooks??=[]).push(e,l),(n.preOrderCheckHooks??=[]).push(e,l))}(n,d[n],t)}finally{null!==O&&(0,p.a2B)(O),Fr(v),g.resolving=!1,(0,p.niQ)()}}return l}function la(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function dc(e,t){return!(2&e||1&e&&t)}class er{_tNode;_lView;constructor(t,n){this._tNode=t,this._lView=n}get(t,n,r){return ru(this._tNode,this._lView,t,(0,p.hjC)(r),n)}}function gl(){return new er((0,p.Mx4)(),(0,p.OAn)())}function lo(e){return Un(()=>{const t=e.prototype.constructor,n=t[p.zSs]||ks(t),r=Object.prototype;let s=Object.getPrototypeOf(e.prototype).constructor;for(;s&&s!==r;){const l=s[p.zSs]||ks(s);if(l&&l!==n)return l;s=Object.getPrototypeOf(s)}return l=>new l})}function ks(e){return(0,p.Jzi)(e)?()=>{const t=ks((0,p.nl4)(e));return t&&t()}:(0,p.wGu)(e)}function co(e){const t=e[p.eDl],n=t.type;return 2===n?t.declTNode:1===n?e[p.qlT]:null}function Ur(){return Jr((0,p.Mx4)(),(0,p.OAn)())}function Jr(e,t){return new Nn((0,p.d31)(e,t))}let Nn=(()=>class e{nativeElement;constructor(n){this.nativeElement=n}static __NG_ELEMENT_ID__=Ur})();function Ln(e){return e instanceof Nn?e.nativeElement:e}function rs(){return this._results[Symbol.iterator]()}class Ot{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new St.B}constructor(t=!1){this._emitDistinctChangesOnly=t}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,n){return this._results.reduce(t,n)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,n){this.dirty=!1;const r=(0,p.Bqz)(t);(this._changesDetected=!(0,p.ng7)(this._results,r,n))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(t){this._onDirty=t}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=rs}function eo(e){return!(128&~e.flags)}var Rs=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(Rs||{});const ti=new Map;let da=0;function Ro(e){ti.delete(e[p.ID])}const Na="__ngContext__";function $r(e,t){(0,p.q$2)(t)?(e[Na]=t[p.ID],function hc(e){ti.set(e[p.ID],e)}(t)):e[Na]=t}function gc(e){return ud(e[p.EJG])}function cd(e){return ud(e[p.K29])}function ud(e){for(;null!==e&&!(0,p.A0l)(e);)e=e[p.K29];return e}let wl;const za=new p.nKC("",{providedIn:"root",factory:()=>fd}),fd="ng",Ls=new p.nKC(""),Fs=new p.nKC("",{providedIn:"platform",factory:()=>"unknown"}),yc=new p.nKC(""),kh=new p.nKC("",{providedIn:"root",factory:()=>function Oo(){if(void 0!==wl)return wl;if(typeof document<"u")return document;throw new p.buA(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null}),wc=new p.nKC("",{providedIn:"root",factory:()=>!1});function Vs(e){return!(32&~e.flags)}function ht(e,t){const n=e.contentQueries;if(null!==n){const r=(0,Ge.Ht)(null);try{for(let s=0;s<n.length;s+=2){const d=n[s+1];if(-1!==d){const g=e.data[d];(0,p.GA0)(n[s]),g.contentQueries(2,t[d],d)}}}finally{(0,Ge.Ht)(r)}}}function Xa(e,t,n){(0,p.GA0)(0);const r=(0,Ge.Ht)(null);try{t(e,n)}finally{(0,Ge.Ht)(r)}}function Hs(e,t,n){if((0,p.srX)(t)){const r=(0,Ge.Ht)(null);try{const l=t.directiveEnd;for(let d=t.directiveStart;d<l;d++){const g=e.data[d];g.contentQueries&&g.contentQueries(1,n[d],d)}}finally{(0,Ge.Ht)(r)}}}var ri=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(ri||{});class wu{changingThisBreaksApplicationSecurity;constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${p.ok8})`}}function hs(e){return e instanceof wu?e.changingThisBreaksApplicationSecurity:e}const ue=/^>|^->|<!--|-->|--!>|<!-$/g,pe=/(<|>)/g;function Fo(e){return e instanceof Function?e():e}function qr(e,t,n){let r=e.length;for(;;){const s=e.indexOf(t,n);if(-1===s)return s;if(0===s||e.charCodeAt(s-1)<=32){const l=t.length;if(s+l===r||e.charCodeAt(s+l)<=32)return s}n=s+1}}const jc="ng-template";function Vc(e,t,n,r){let s=0;if(r){for(;s<t.length&&"string"==typeof t[s];s+=2)if("class"===t[s]&&-1!==qr(t[s+1].toLowerCase(),n,0))return!0}else if(ms(e))return!1;if(s=t.indexOf(1,s),s>-1){let l;for(;++s<t.length&&"string"==typeof(l=t[s]);)if(l.toLowerCase()===n)return!0}return!1}function ms(e){return 4===e.type&&e.value!==jc}function _s(e,t,n){return t===(4!==e.type||n?e.value:jc)}function tl(e,t,n){let r=4;const s=e.attrs,l=null!==s?function Rd(e){for(let t=0;t<e.length;t++)if(sa(e[t]))return t;return e.length}(s):0;let d=!1;for(let g=0;g<t.length;g++){const v=t[g];if("number"!=typeof v){if(!d)if(4&r){if(r=2|1&r,""!==v&&!_s(e,v,n)||""===v&&1===t.length){if(Wi(r))return!1;d=!0}}else if(8&r){if(null===s||!Vc(e,s,v,n)){if(Wi(r))return!1;d=!0}}else{const M=t[++g],A=Ei(v,s,ms(e),n);if(-1===A){if(Wi(r))return!1;d=!0;continue}if(""!==M){let O;if(O=A>l?"":s[A+1].toLowerCase(),2&r&&M!==O){if(Wi(r))return!1;d=!0}}}}else{if(!d&&!Wi(r)&&!Wi(v))return!1;if(d&&Wi(v))continue;d=!1,r=v|1&r}}return Wi(r)||d}function Wi(e){return!(1&e)}function Ei(e,t,n,r){if(null===t)return-1;let s=0;if(r||!n){let l=!1;for(;s<t.length;){const d=t[s];if(d===e)return s;if(3===d||6===d)l=!0;else{if(1===d||2===d){let g=t[++s];for(;"string"==typeof g;)g=t[++s];continue}if(4===d)break;if(0===d){s+=4;continue}}s+=l?1:2}return-1}return function Od(e,t){let n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){const r=e[n];if("number"==typeof r)return-1;if(r===t)return n;n++}return-1}(t,e)}function Hh(e,t,n=!1){for(let r=0;r<t.length;r++)if(tl(e,t[r],n))return!0;return!1}function nl(e,t){e:for(let n=0;n<t.length;n++){const r=t[n];if(e.length===r.length){for(let s=0;s<e.length;s++)if(e[s]!==r[s])continue e;return!0}}return!1}function Ws(e,t){return e?":not("+t.trim()+")":t}function O0(e){let t=e[0],n=1,r=2,s="",l=!1;for(;n<e.length;){let d=e[n];if("string"==typeof d)if(2&r){const g=e[++n];s+="["+d+(g.length>0?'="'+g+'"':"")+"]"}else 8&r?s+="."+d:4&r&&(s+=" "+d);else""!==s&&!Wi(d)&&(t+=Ws(l,s),s=""),r=d,l=l||!Wi(r);n++}return""!==s&&(t+=Ws(l,s)),t}const Hn={};function Pg(e,t){return e.createComment(function me(e){return e.replace(ue,t=>t.replace(pe,"\u200b$1\u200b"))}(t))}function Nd(e,t,n){return e.createElement(t,n)}function Pu(e,t,n,r,s){e.insertBefore(t,n,r,s)}function $f(e,t,n){e.appendChild(t,n)}function kg(e,t,n,r,s){null!==r?Pu(e,t,n,r,s):$f(e,t,n)}function Zh(e,t,n){const{mergedAttrs:r,classes:s,styles:l}=n;null!==r&&function ia(e,t,n){let r=0;for(;r<n.length;){const s=n[r];if("number"==typeof s){if(0!==s)break;r++;const l=n[r++],d=n[r++],g=n[r++];e.setAttribute(t,d,g,l)}else{const l=s,d=n[++r];at(l)?e.setProperty(t,l,d):e.setAttribute(t,l,d),r++}}}(e,t,r),null!==s&&function qh(e,t,n){""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n)}(e,t,s),null!==l&&function Tv(e,t,n){e.setAttribute(t,"style",n)}(e,t,l)}function Fd(e,t,n,r,s,l,d,g,v,M,A){const O=p.Yw1+r,j=O+s,B=function N0(e,t){const n=[];for(let r=0;r<t;r++)n.push(r<e?null:Hn);return n}(O,j),X="function"==typeof M?M():M;return B[p.eDl]={type:e,blueprint:B,template:n,queries:null,viewQuery:g,declTNode:t,data:B.slice().fill(null,O),bindingStartIndex:O,expandoStartIndex:j,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof l?l():l,pipeRegistry:"function"==typeof d?d():d,firstChild:null,schemas:v,consts:X,incompleteFirstPass:!1,ssrId:A}}function Hf(e,t,n,r,s,l,d,g,v,M,A){const O=t.blueprint.slice();return O[p.jgP]=s,O[p.Wg1]=1228|r,(null!==M||e&&2048&e[p.Wg1])&&(O[p.Wg1]|=2048),(0,p.HUe)(O),O[p.f7T]=O[p.X5O]=e,O[p.SKP]=n,O[p.M0L]=d||e&&e[p.M0L],O[p.GpT]=g||e&&e[p.GpT],O[p.YEL]=v||e&&e[p.YEL]||null,O[p.qlT]=l,O[p.ID]=function Oa(){return da++}(),O[p.tcA]=A,O[p.oMQ]=M,O[p.b5C]=2==t.type?e[p.b5C]:O,O}function Wf(e){let t=16;return e.signals?t=4096:e.onPush&&(t=64),t}function Bd(e,t,n,r){if(0===n)return-1;const s=t.length;for(let l=0;l<n;l++)t.push(r),e.blueprint.push(r),e.data.push(null);return s}function qf(e,t){return e[p.EJG]?e[p.Yrj][p.K29]=t:e[p.EJG]=t,e[p.Yrj]=t,t}function qi(e=1){Zf((0,p.klJ)(),(0,p.OAn)(),(0,p._px)()+e,!1)}function Zf(e,t,n,r){if(!r)if(3&~t[p.Wg1]){const l=e.preOrderHooks;null!==l&&Ft(t,l,0,n)}else{const l=e.preOrderCheckHooks;null!==l&&Me(t,l,n)}(0,p.ypq)(n)}var Yh=function(e){return e[e.None=0]="None",e[e.SignalBased=1]="SignalBased",e[e.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",e}(Yh||{});function Ru(e,t,n,r){const s=(0,Ge.Ht)(null);try{const[l,d,g]=e.inputs[n];let v=null;0!==(d&Yh.SignalBased)&&(v=t[l][Ge.bh]),null!==v&&void 0!==v.transformFn?r=v.transformFn(r):null!==g&&(r=g.call(t,r)),null!==e.setInput?e.setInput(t,v,r,n,l):Go(t,v,l,r)}finally{(0,Ge.Ht)(s)}}var qs=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(qs||{});function Yf(e,t){return undefined(e,t)}function zd(e,t,n,r,s){if(null!=r){let l,d=!1;(0,p.A0l)(r)?l=r:(0,p.q$2)(r)&&(d=!0,r=r[p.jgP]);const g=(0,p.IvY)(r);0===e&&null!==n?null==s?$f(t,n,g):Pu(t,n,g,s||null,!0):1===e&&null!==n?Pu(t,n,g,s||null,!0):2===e?function Ld(e,t,n){e.removeChild(null,t,n)}(t,g,d):3===e&&t.destroyNode(g),null!=l&&function kv(e,t,n,r,s){const l=n[p.s6P];l!==(0,p.IvY)(n)&&zd(t,e,r,l,s);for(let g=p.Y20;g<n.length;g++){const v=n[g];Jf(v[p.eDl],v,e,t,r,l)}}(t,e,l,n,s)}}function L0(e,t){t[p.M0L].changeDetectionScheduler?.notify(9),Jf(e,t,t[p.GpT],2,null,null)}function Lg(e,t){const n=e[p.nfM],r=n.indexOf(t);n.splice(r,1)}function Ou(e,t){if((0,p.EPY)(t))return;const n=t[p.GpT];n.destroyNode&&Jf(e,t,n,3,null,null),function F0(e){let t=e[p.EJG];if(!t)return Kf(e[p.eDl],e);for(;t;){let n=null;if((0,p.q$2)(t))n=t[p.EJG];else{const r=t[p.Y20];r&&(n=r)}if(!n){for(;t&&!t[p.K29]&&t!==e;)(0,p.q$2)(t)&&Kf(t[p.eDl],t),t=t[p.f7T];null===t&&(t=e),(0,p.q$2)(t)&&Kf(t[p.eDl],t),n=t&&t[p.K29]}t=n}}(t)}function Kf(e,t){if((0,p.EPY)(t))return;const n=(0,Ge.Ht)(null);try{t[p.Wg1]&=-129,t[p.Wg1]|=256,t[p.Iaj]&&(0,Ge.XR)(t[p.Iaj]),function Av(e,t){let n;if(null!=e&&null!=(n=e.destroyHooks))for(let r=0;r<n.length;r+=2){const s=t[n[r]];if(!(s instanceof Gn)){const l=n[r+1];if(Array.isArray(l))for(let d=0;d<l.length;d+=2){const g=s[l[d]],v=l[d+1];Ue(4,g,v);try{v.call(g)}finally{Ue(5,g,v)}}else{Ue(4,s,l);try{l.call(s)}finally{Ue(5,s,l)}}}}}(e,t),function B0(e,t){const n=e.cleanup,r=t[p.VVG];if(null!==n)for(let d=0;d<n.length-1;d+=2)if("string"==typeof n[d]){const g=n[d+3];g>=0?r[g]():r[-g].unsubscribe(),d+=2}else n[d].call(r[n[d+1]]);null!==r&&(t[p.VVG]=null);const s=t[p.Czx];if(null!==s){t[p.Czx]=null;for(let d=0;d<s.length;d++)(0,s[d])()}const l=t[p.tQN];if(null!==l){t[p.tQN]=null;for(const d of l)d.destroy()}}(e,t),1===t[p.eDl].type&&t[p.GpT].destroy();const r=t[p.rQE];if(null!==r&&(0,p.A0l)(t[p.f7T])){r!==t[p.f7T]&&Lg(r,t);const s=t[p.Ds7];null!==s&&s.detachView(e)}Ro(t)}finally{(0,Ge.Ht)(n)}}function Fg(e,t,n){return function z0(e,t,n){let r=t;for(;null!==r&&168&r.type;)r=(t=r).parent;if(null===r)return n[p.jgP];if((0,p.Qs1)(r)){const{encapsulation:s}=e.data[r.directiveStart+r.componentOffset];if(s===ri.None||s===ri.Emulated)return null}return(0,p.d31)(r,n)}(e,t.parent,n)}function Xf(e,t,n){return Bg(e,t,n)}let Bg=function Qf(e,t,n){return 40&e.type?(0,p.d31)(e,n):null};function zg(e,t,n,r){const s=Fg(e,r,t),l=t[p.GpT],g=Xf(r.parent||t[p.qlT],r,t);if(null!=s)if(Array.isArray(n))for(let v=0;v<n.length;v++)kg(l,s,n[v],g,!1);else kg(l,s,n,g,!1)}function Nu(e,t){if(null!==t){const n=t.type;if(3&n)return(0,p.d31)(t,e);if(4&n)return jg(-1,e[t.index]);if(8&n){const r=t.child;if(null!==r)return Nu(e,r);{const s=e[t.index];return(0,p.A0l)(s)?jg(-1,s):(0,p.IvY)(s)}}if(128&n)return Nu(e,t.next);if(32&n)return Yf(t,e)()||(0,p.IvY)(e[t.index]);{const r=j0(e,t);return null!==r?Array.isArray(r)?r[0]:Nu((0,p._0$)(e[p.b5C]),r):Nu(e,t.next)}}return null}function j0(e,t){return null!==t?e[p.b5C][p.qlT].projection[t.projection]:null}function jg(e,t){const n=p.Y20+e+1;if(n<t.length){const r=t[n],s=r[p.eDl].firstChild;if(null!==s)return Nu(r,s)}return t[p.s6P]}function Vg(e,t,n,r,s,l,d){for(;null!=n;){if(128===n.type){n=n.next;continue}const g=r[n.index],v=n.type;if(d&&0===t&&(g&&$r((0,p.IvY)(g),r),n.flags|=2),!Vs(n))if(8&v)Vg(e,t,n.child,r,s,l,!1),zd(t,e,s,g,l);else if(32&v){const M=Yf(n,r);let A;for(;A=M();)zd(t,e,s,A,l);zd(t,e,s,g,l)}else 16&v?ep(e,t,r,n,s,l):zd(t,e,s,g,l);n=d?n.projectionNext:n.next}}function Jf(e,t,n,r,s,l){Vg(n,r,e.firstChild,t,s,l,!1)}function ep(e,t,n,r,s,l){const d=n[p.b5C],v=d[p.qlT].projection[r.projection];if(Array.isArray(v))for(let M=0;M<v.length;M++)zd(t,e,s,v[M],l);else{let M=v;const A=d[p.f7T];eo(r)&&(M.flags|=128),Vg(e,t,M,A,s,l,!0)}}function Vd(e,t,n,r,s){const l=(0,p._px)(),d=2&r;try{(0,p.ypq)(-1),d&&t.length>p.Yw1&&Zf(e,t,p.Yw1,!1),Ue(d?2:0,s,n),n(r,s)}finally{(0,p.ypq)(l),Ue(d?3:1,s,n)}}function tp(e,t,n){(function Gd(e,t,n){const r=n.directiveStart,s=n.directiveEnd;(0,p.Qs1)(n)&&function Iv(e,t,n){const r=(0,p.d31)(t,e),s=function Rg(e){const t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Fd(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):t}(n),l=e[p.M0L].rendererFactory,d=qf(e,Hf(e,s,null,Wf(n),r,t,null,l.createRenderer(r,n),null,null,null));e[t.index]=d}(t,n,e.data[r+n.componentOffset]),e.firstCreatePass||In(n,t);const l=n.initialInputs;for(let d=r;d<s;d++){const g=e.data[d],v=pl(t,e,d,n);$r(v,t),null!==l&&$0(0,d-r,v,g,0,l),(0,p.JlV)(g)&&((0,p.KdJ)(n.index,t)[p.SKP]=pl(t,e,d,n))}})(e,t,n),!(64&~n.flags)&&function Xh(e,t,n){const r=n.directiveStart,s=n.directiveEnd,l=n.index,d=(0,p.Z9v)();try{(0,p.ypq)(l);for(let g=r;g<s;g++){const v=e.data[g],M=t[g];(0,p.RZ9)(g),(null!==v.hostBindings||0!==v.hostVars||null!==v.hostAttrs)&&Rv(v,M)}}finally{(0,p.ypq)(-1),(0,p.RZ9)(d)}}(e,t,n)}function tr(e,t,n=p.d31){const r=t.localNames;if(null!==r){let s=t.index+1;for(let l=0;l<r.length;l+=2){const d=r[l+1],g=-1===d?n(t,e):e[d];e[s++]=g}}}let Kh=()=>null;function op(e,t,n,r,s,l){lp(e,t[p.eDl],t,n,r)?(0,p.Qs1)(e)&&function ip(e,t){const n=(0,p.KdJ)(t,e);16&n[p.Wg1]||(n[p.Wg1]|=64)}(t,e.index):(3&e.type&&(n=function G0(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(n)),Lu(e,t,n,r,s,l))}function Lu(e,t,n,r,s,l){if(3&e.type){const d=(0,p.d31)(e,t);r=null!=l?l(r,e.value||"",n):r,s.setProperty(d,n,r)}}function Rv(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function sp(e,t){const n=e.directiveRegistry;let r=null;if(n)for(let s=0;s<n.length;s++){const l=n[s];Hh(t,l.selectors,!1)&&(r??=[],(0,p.JlV)(l)?r.unshift(l):r.push(l))}return r}function $0(e,t,n,r,s,l){const d=l[t];if(null!==d)for(let g=0;g<d.length;g+=2)Ru(r,n,d[g],d[g+1])}function Uc(e,t,n,r,s){const l=p.Yw1+n,d=t[p.eDl],g=s(d,t,e,r,n);t[l]=g,(0,p.iMd)(e,!0);const v=2===e.type;return v?(Zh(t[p.GpT],g,e),(0===(0,p.znI)()||(0,p.yoD)(e))&&$r(g,t),(0,p.Fje)()):$r(g,t),(0,p.SX7)()&&(!v||!Vs(e))&&zg(d,t,g,e),e}function $d(e){let t=e;return(0,p.YWB)()?(0,p.Pfq)():(t=t.parent,(0,p.iMd)(t,!1)),t}function lp(e,t,n,r,s){const l=e.inputs?.[r],d=e.hostDirectiveInputs?.[r];let g=!1;if(d)for(let v=0;v<d.length;v+=2){const M=d[v];Ru(t.data[M],n[M],d[v+1],s),g=!0}if(l)for(const v of l)Ru(t.data[v],n[v],r,s),g=!0;return g}function Lv(e,t){const n=(0,p.KdJ)(t,e),r=n[p.eDl];!function Fv(e,t){for(let n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(r,n);const s=n[p.jgP];null!==s&&null===n[p.tcA]&&(n[p.tcA]=null),Ue(18),$l(r,n,n[p.SKP]),Ue(19,n[p.SKP])}function $l(e,t,n){(0,p.ID8)(t);try{const r=e.viewQuery;null!==r&&Xa(1,r,n);const s=e.template;null!==s&&Vd(e,t,s,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),t[p.Ds7]?.finishViewCreation(e),e.staticContentQueries&&ht(e,t),e.staticViewQueries&&Xa(2,e.viewQuery,n);const l=e.components;null!==l&&function Bv(e,t){for(let n=0;n<t.length;n++)Lv(e,t[n])}(t,l)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{t[p.Wg1]&=-5,(0,p.bll)()}}function Hd(e,t,n,r){const s=(0,Ge.Ht)(null);try{const l=t.tView,v=Hf(e,l,n,4096&e[p.Wg1]?4096:16,null,t,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null);v[p.rQE]=e[t.index];const A=e[p.Ds7];return null!==A&&(v[p.Ds7]=A.createEmbeddedView(l)),$l(l,v,n),v}finally{(0,Ge.Ht)(s)}}function Gc(e,t){return!t||null===t.firstChild||eo(e)}function Qh(e,t,n,r,s=!1){for(;null!==n;){if(128===n.type){n=s?n.projectionNext:n.next;continue}const l=t[n.index];null!==l&&r.push((0,p.IvY)(l)),(0,p.A0l)(l)&&Hg(l,r);const d=n.type;if(8&d)Qh(e,t,n.child,r);else if(32&d){const g=Yf(n,t);let v;for(;v=g();)r.push(v)}else if(16&d){const g=j0(t,n);if(Array.isArray(g))r.push(...g);else{const v=(0,p._0$)(t[p.b5C]);Qh(v[p.eDl],v,g,r,!0)}}n=s?n.projectionNext:n.next}return r}function Hg(e,t){for(let n=p.Y20;n<e.length;n++){const r=e[n],s=r[p.eDl].firstChild;null!==s&&Qh(r[p.eDl],r,s,t)}e[p.s6P]!==e[p.jgP]&&t.push(e[p.s6P])}function Wd(e){if(null!==e[p.JEi]){for(const t of e[p.JEi])t.impl.addSequence(t);e[p.JEi].length=0}}let cp=[];const Z0={...Ge.pL,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:e=>{(0,p.blu)(e.lView)},consumerOnSignalRead(){this.lView[p.Iaj]=this}},Uv={...Ge.pL,consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:e=>{let t=(0,p._0$)(e.lView);for(;t&&!qd(t[p.eDl]);)t=(0,p._0$)(t);t&&(0,p.HAh)(t)},consumerOnSignalRead(){this.lView[p.Iaj]=this}};function qd(e){return 2!==e.type}function Y0(e){if(null===e[p.tQN])return;let t=!0;for(;t;){let n=!1;for(const r of e[p.tQN])r.dirty&&(n=!0,null===r.zone||Zone.current===r.zone?r.run():r.zone.run(()=>r.run()));t=n&&!!(8192&e[p.Wg1])}}function up(e,t=0){const r=e[p.M0L].rendererFactory;r.begin?.();try{!function Hv(e,t){const n=(0,p.yP_)();try{(0,p.cBl)(!0),Zg(e,t);let r=0;for(;(0,p.dMS)(e);){if(100===r)throw new p.buA(103,!1);r++,Zg(e,1)}}finally{(0,p.cBl)(n)}}(e,t)}finally{r.end?.()}}function Wg(e,t,n,r){if((0,p.EPY)(t))return;const s=t[p.Wg1];(0,p.ID8)(t);let g=!0,v=null,M=null;qd(e)?(M=function zv(e){return e[p.Iaj]??function jv(e){const t=cp.pop()??Object.create(Z0);return t.lView=e,t}(e)}(t),v=(0,Ge.Bg)(M)):null===(0,Ge.nR)()?(g=!1,M=function Vv(e){const t=e[p.Iaj]??Object.create(Uv);return t.lView=e,t}(t),v=(0,Ge.Bg)(M)):t[p.Iaj]&&((0,Ge.XR)(t[p.Iaj]),t[p.Iaj]=null);try{(0,p.HUe)(t),(0,p.Kw3)(e.bindingStartIndex),null!==n&&Vd(e,t,n,2,r);const A=!(3&~s);if(A){const B=e.preOrderCheckHooks;null!==B&&Me(t,B,null)}else{const B=e.preOrderHooks;null!==B&&Ft(t,B,0,null),Jt(t,0)}if(function K0(e){for(let t=gc(e);null!==t;t=cd(t)){if(!(2&t[p.Wg1]))continue;const n=t[p.nfM];for(let r=0;r<n.length;r++)(0,p.HAh)(n[r])}}(t),Y0(t),dp(t,0),null!==e.contentQueries&&ht(e,t),A){const B=e.contentCheckHooks;null!==B&&Me(t,B)}else{const B=e.contentHooks;null!==B&&Ft(t,B,1),Jt(t,1)}!function qv(e,t){const n=e.hostBindingOpCodes;if(null!==n)try{for(let r=0;r<n.length;r++){const s=n[r];if(s<0)(0,p.ypq)(~s);else{const l=s,d=n[++r],g=n[++r];(0,p.vQI)(d,l);const v=t[l];Ue(24,v),g(2,v),Ue(25,v)}}}finally{(0,p.ypq)(-1)}}(e,t);const O=e.components;null!==O&&Jh(t,O,0);const j=e.viewQuery;if(null!==j&&Xa(2,j,r),A){const B=e.viewCheckHooks;null!==B&&Me(t,B)}else{const B=e.viewHooks;null!==B&&Ft(t,B,2),Jt(t,2)}if(!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),t[p.pcR]){for(const B of t[p.pcR])B();t[p.pcR]=null}Wd(t),t[p.Wg1]&=-73}catch(A){throw(0,p.blu)(t),A}finally{null!==M&&((0,Ge.Wu)(M,v),g&&function q0(e){e.lView[p.Iaj]!==e&&(e.lView=null,cp.push(e))}(M)),(0,p.bll)()}}function dp(e,t){for(let n=gc(e);null!==n;n=cd(n))for(let r=p.Y20;r<n.length;r++)qg(n[r],t)}function X0(e,t,n){Ue(18);const r=(0,p.KdJ)(t,e);qg(r,n),Ue(19,r[p.SKP])}function qg(e,t){(0,p.F1c)(e)&&Zg(e,t)}function Zg(e,t){const r=e[p.eDl],s=e[p.Wg1],l=e[p.Iaj];let d=!!(0===t&&16&s);if(d||=!!(64&s&&0===t),d||=!!(1024&s),d||=!(!l?.dirty||!(0,Ge.si)(l)),d||=!1,l&&(l.dirty=!1),e[p.Wg1]&=-9217,d)Wg(r,e,r.template,e[p.SKP]);else if(8192&s){const g=(0,Ge.Ht)(null);try{Y0(e),dp(e,1);const v=r.components;null!==v&&Jh(e,v,1),Wd(e)}finally{(0,Ge.Ht)(g)}}}function Jh(e,t,n){for(let r=0;r<t.length;r++)X0(e,t[r],n)}function zu(e,t){const n=(0,p.yP_)()?64:1088;for(e[p.M0L].changeDetectionScheduler?.notify(t);e;){e[p.Wg1]|=n;const r=(0,p._0$)(e);if((0,p.EFk)(e)&&!r)return e;e=r}return null}function Q0(e,t,n,r){return[e,!0,0,t,null,r,null,n,null,null]}function Zd(e,t,n,r=!0){const s=t[p.eDl];if(function Zv(e,t,n,r){const s=p.Y20+r,l=n.length;r>0&&(n[s-1][p.K29]=t),r<l-p.Y20?(t[p.K29]=n[s],(0,p.EYC)(n,p.Y20+r,t)):(n.push(t),t[p.K29]=null),t[p.f7T]=n;const d=t[p.rQE];null!==d&&n!==d&&Yd(d,t);const g=t[p.Ds7];null!==g&&g.insertView(e),(0,p._gW)(t),t[p.Wg1]|=128}(s,t,e,n),r){const d=jg(n,e),g=t[p.GpT],v=g.parentNode(e[p.s6P]);null!==v&&function Dv(e,t,n,r,s,l){r[p.jgP]=s,r[p.qlT]=t,Jf(e,r,n,1,s,l)}(s,e[p.qlT],g,t,v,d)}const l=t[p.tcA];null!==l&&null!==l.firstChild&&(l.firstChild=null)}function ef(e,t){if(e.length<=p.Y20)return;const n=p.Y20+t,r=e[n];if(r){const s=r[p.rQE];null!==s&&s!==e&&Lg(s,r),t>0&&(e[n-1][p.K29]=r[p.K29]);const l=(0,p.E6O)(e,p.Y20+t);!function Ng(e,t){L0(e,t),t[p.jgP]=null,t[p.qlT]=null}(r[p.eDl],r);const d=l[p.Ds7];null!==d&&d.detachView(l[p.eDl]),r[p.f7T]=null,r[p.K29]=null,r[p.Wg1]&=-129}return r}function Yd(e,t){const n=e[p.nfM],r=t[p.f7T];((0,p.q$2)(r)||t[p.b5C]!==r[p.f7T][p.b5C])&&(e[p.Wg1]|=2),null===n?e[p.nfM]=[t]:n.push(t)}class Pr{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){const t=this._lView,n=t[p.eDl];return Qh(n,t,n.firstChild,[])}constructor(t,n){this._lView=t,this._cdRefInjectingView=n}get context(){return this._lView[p.SKP]}set context(t){this._lView[p.SKP]=t}get destroyed(){return(0,p.EPY)(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const t=this._lView[p.f7T];if((0,p.A0l)(t)){const n=t[p.bm_],r=n?n.indexOf(this):-1;r>-1&&(ef(t,r),(0,p.E6O)(n,r))}this._attachedToViewContainer=!1}Ou(this._lView[p.eDl],this._lView)}onDestroy(t){(0,p.ik5)(this._lView,t)}markForCheck(){zu(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[p.Wg1]&=-129}reattach(){(0,p._gW)(this._lView),this._lView[p.Wg1]|=128}detectChanges(){this._lView[p.Wg1]|=1024,up(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new p.buA(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;const t=(0,p.EFk)(this._lView),n=this._lView[p.rQE];null!==n&&!t&&Lg(n,this._lView),L0(this._lView[p.eDl],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new p.buA(902,!1);this._appRef=t;const n=(0,p.EFk)(this._lView),r=this._lView[p.rQE];null!==r&&!n&&Yd(r,this._lView),(0,p._gW)(this._lView)}}let Sa=(()=>class e{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=Yg;constructor(n,r,s){this._declarationLView=n,this._declarationTContainer=r,this.elementRef=s}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,r){return this.createEmbeddedViewImpl(n,r)}createEmbeddedViewImpl(n,r,s){const l=Hd(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:r,dehydratedView:s});return new Pr(l)}})();function Yg(){return Hl((0,p.Mx4)(),(0,p.OAn)())}function Hl(e,t){return 4&e.type?new Sa(t,e,Jr(e,t)):null}function Hc(e,t,n,r,s){let l=e.data[t];if(null===l)l=function gp(e,t,n,r,s){const l=(0,p.veI)(),d=(0,p.YWB)(),v=e.data[t]=function r_(e,t,n,r,s,l){let d=t?t.injectorIndex:-1,g=0;return(0,p.KtD)()&&(g|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:d,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:g,providerIndexes:0,value:s,attrs:l,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,d?l:l&&l.parent,n,t,r,s);return function nb(e,t,n,r){null===e.firstChild&&(e.firstChild=t),null!==n&&(r?null==n.child&&null!==t.parent&&(n.child=t):null===n.next&&(n.next=t,t.prev=n))}(e,v,l,d),v}(e,t,n,r,s),(0,p.JjR)()&&(l.flags|=32);else if(64&l.type){l.type=n,l.value=r,l.attrs=s;const d=(0,p.Ab)();l.injectorIndex=null===d?-1:d.injectorIndex}return(0,p.iMd)(l,!0),l}let pb=class{},fm=class{};class x_{resolveComponentFactory(t){throw new p.buA(917,!1)}}let Rp=class{static NULL=new x_};class uf{}let Uu=(()=>class e{destroyNode=null;static __NG_ELEMENT_ID__=()=>function pm(){const e=(0,p.OAn)(),t=(0,p.Mx4)(),n=(0,p.KdJ)(t.index,e);return((0,p.q$2)(n)?n:e)[p.GpT]}()})(),w_=(()=>{class e{static \u0275prov=(0,p.jDH)({token:e,providedIn:"root",factory:()=>null})}return e})();const c={};class i{injector;parentInjector;constructor(t,n){this.injector=t,this.parentInjector=n}get(t,n,r){const s=this.injector.get(t,c,r);return s!==c||n===c?s:this.parentInjector.get(t,n,r)}}function a(e,t,n){let r=n?e.styles:null,s=n?e.classes:null,l=0;if(null!==t)for(let d=0;d<t.length;d++){const g=t[d];if("number"==typeof g)l=g;else if(1==l)s=(0,p.n$e)(s,g);else if(2==l){const M=t[++d];r=(0,p.n$e)(r,g+": "+M+";")}}n?e.styles=r:e.stylesWithoutHost=r,n?e.classes=s:e.classesWithoutHost=s}function h(e,t=0){const n=(0,p.OAn)();return null===n?(0,p.KVO)(e,t):ru((0,p.Mx4)(),n,(0,p.nl4)(e),t)}function w(e,t,n,r,s){const l=null===r?null:{"":-1},d=s(e,n);if(null!==d){let g=d,v=null,M=null;for(const A of d)if(null!==A.resolveHostDirectives){[g,v,M]=A.resolveHostDirectives(d);break}!function T(e,t,n,r,s,l,d){const g=r.length;let v=!1;for(let j=0;j<g;j++){const B=r[j];!v&&(0,p.JlV)(B)&&(v=!0,E(e,n,j)),ko(In(n,t),e,B.type)}!function Se(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}(n,e.data.length,g);for(let j=0;j<g;j++){const B=r[j];B.providersResolver&&B.providersResolver(B)}let M=!1,A=!1,O=Bd(e,t,g,null);g>0&&(n.directiveToIndex=new Map);for(let j=0;j<g;j++){const B=r[j];if(n.mergedAttrs=Yt(n.mergedAttrs,B.hostAttrs),Z(e,n,t,O,B),ce(O,B,s),null!==d&&d.has(B)){const[le,_e]=d.get(B);n.directiveToIndex.set(B.type,[O,le+n.directiveStart,_e+n.directiveStart])}else(null===l||!l.has(B))&&n.directiveToIndex.set(B.type,O);null!==B.contentQueries&&(n.flags|=4),(null!==B.hostBindings||null!==B.hostAttrs||0!==B.hostVars)&&(n.flags|=64);const X=B.type.prototype;!M&&(X.ngOnChanges||X.ngOnInit||X.ngDoCheck)&&((e.preOrderHooks??=[]).push(n.index),M=!0),!A&&(X.ngOnChanges||X.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(n.index),A=!0),O++}!function R(e,t,n){for(let r=t.directiveStart;r<t.directiveEnd;r++){const s=e.data[r];if(null!==n&&n.has(s)){const l=n.get(s);z(0,t,l,r),z(1,t,l,r),q(t,r,!0)}else L(0,t,s,r),L(1,t,s,r),q(t,r,!1)}}(e,n,l)}(e,t,n,g,l,v,M)}null!==l&&null!==r&&function C(e,t,n){const r=e.localNames=[];for(let s=0;s<t.length;s+=2){const l=n[t[s+1]];if(null==l)throw new p.buA(-301,!1);r.push(t[s],l)}}(n,r,l)}function E(e,t,n){t.componentOffset=n,(e.components??=[]).push(t.index)}function L(e,t,n,r){const s=0===e?n.inputs:n.outputs;for(const l in s)if(s.hasOwnProperty(l)){let d;d=0===e?t.inputs??={}:t.outputs??={},d[l]??=[],d[l].push(r),$(t,l)}}function z(e,t,n,r){const s=0===e?n.inputs:n.outputs;for(const l in s)if(s.hasOwnProperty(l)){const d=s[l];let g;g=0===e?t.hostDirectiveInputs??={}:t.hostDirectiveOutputs??={},g[d]??=[],g[d].push(r,l),$(t,d)}}function $(e,t){"class"===t?e.flags|=8:"style"===t&&(e.flags|=16)}function q(e,t,n){const{attrs:r,inputs:s,hostDirectiveInputs:l}=e;if(null===r||!n&&null===s||n&&null===l||ms(e))return e.initialInputs??=[],void e.initialInputs.push(null);let d=null,g=0;for(;g<r.length;){const v=r[g];if(0!==v)if(5!==v){if("number"==typeof v)break;if(!n&&s.hasOwnProperty(v)){const M=s[v];for(const A of M)if(A===t){d??=[],d.push(v,r[g+1]);break}}else if(n&&l.hasOwnProperty(v)){const M=l[v];for(let A=0;A<M.length;A+=2)if(M[A]===t){d??=[],d.push(M[A+1],r[g+1]);break}}g+=2}else g+=2;else g+=4}e.initialInputs??=[],e.initialInputs.push(d)}function Z(e,t,n,r,s){e.data[r]=s;const l=s.factory||(s.factory=(0,p.wGu)(s.type,!0)),d=new Gn(l,(0,p.JlV)(s),h,null);e.blueprint[r]=d,n[r]=d,function Q(e,t,n,r,s){const l=s.hostBindings;if(l){let d=e.hostBindingOpCodes;null===d&&(d=e.hostBindingOpCodes=[]);const g=~t.index;(function ne(e){let t=e.length;for(;t>0;){const n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(d)!=g&&d.push(g),d.push(n,r,l)}}(e,t,r,Bd(e,n,s.hostVars,Hn),s)}function ce(e,t,n){if(n){if(t.exportAs)for(let r=0;r<t.exportAs.length;r++)n[t.exportAs[r]]=e;(0,p.JlV)(t)&&(n[""]=e)}}function ye(e,t,n,r,s,l,d,g){const v=t[p.eDl],M=v.consts,O=Hc(v,e,n,r,(0,p.db4)(M,d));return l&&w(v,t,O,(0,p.db4)(M,g),s),O.mergedAttrs=Yt(O.mergedAttrs,O.attrs),null!==O.attrs&&a(O,O.attrs,!1),null!==O.mergedAttrs&&a(O,O.mergedAttrs,!0),null!==v.queries&&v.queries.elementStart(v,O),O}function Re(e,t){bt(e,t),(0,p.srX)(t)&&e.queries.elementEnd(t)}function st(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function ze(e,t,n){return n!==Hn&&(!Object.is(e[t],n)&&(e[t]=n,!0))}function xt(e,t,n){return function r(s){zu((0,p.Qs1)(e)?(0,p.KdJ)(e.index,t):t,5);const d=t[p.SKP];let g=dn(t,d,n,s),v=r.__ngNextListenerFn__;for(;v;)g=dn(t,d,v,s)&&g,v=v.__ngNextListenerFn__;return g}}function dn(e,t,n,r){const s=(0,Ge.Ht)(null);try{return Ue(6,t,n),!1!==n(r)}catch(l){return function $g(e,t){const n=e[p.YEL];n&&n.get(p.ZTf,null)?.(t)}(e,l),!1}finally{Ue(7,t,n),(0,Ge.Ht)(s)}}function Eo(e,t,n,r,s,l,d){const g=t.firstCreatePass?(0,p.vNG)(t):null,v=(0,p.d_l)(n),M=v.length;v.push(s,l),g&&g.push(r,e,M,(M+1)*(d?-1:1))}function Zr(e,t,n,r,s,l){const g=t[p.eDl],O=t[n][g.data[n].outputs[r]].subscribe(l);Eo(e.index,g,t,s,l,O,!0)}const lr=Symbol("BINDING");class Yr extends Rp{ngModule;constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){const n=(0,p.xUg)(t);return new _m(n,this.ngModule)}}class _m extends fm{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=function go(e){return Object.keys(e).map(t=>{const[n,r,s]=e[t],l={propName:n,templateName:t,isSignal:0!==(r&Yh.SignalBased)};return s&&(l.transform=s),l})}(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=function mo(e){return Object.keys(e).map(t=>({propName:e[t],templateName:t}))}(this.componentDef.outputs),this.cachedOutputs}constructor(t,n){super(),this.componentDef=t,this.ngModule=n,this.componentType=t.type,this.selector=function Mv(e){return e.map(O0).join(",")}(t.selectors),this.ngContentSelectors=t.ngContentSelectors??[],this.isBoundToModule=!!n}create(t,n,r,s,l,d){Ue(22);const g=(0,Ge.Ht)(null);try{const v=this.componentDef,M=function rh(e,t,n,r){const s=e?["ng-version","20.2.1"]:function Ig(e){const t=[],n=[];let r=1,s=2;for(;r<e.length;){let l=e[r];if("string"==typeof l)2===s?""!==l&&t.push(l,e[++r]):8===s&&n.push(l);else{if(!Wi(s))break;s=l}r++}return n.length&&t.push(1,...n),t}(t.selectors[0]);let l=null,d=null,g=0;if(n)for(const A of n)g+=A[lr].requiredVars,A.create&&(A.targetIdx=0,(l??=[]).push(A)),A.update&&(A.targetIdx=0,(d??=[]).push(A));if(r)for(let A=0;A<r.length;A++){const O=r[A];if("function"!=typeof O)for(const j of O.bindings){g+=j[lr].requiredVars;const B=A+1;j.create&&(j.targetIdx=B,(l??=[]).push(j)),j.update&&(j.targetIdx=B,(d??=[]).push(j))}}const v=[t];if(r)for(const A of r){const j=(0,p.HaV)("function"==typeof A?A:A.type);v.push(j)}return Fd(0,null,function $u(e,t){return e||t?n=>{if(1&n&&e)for(const r of e)r.create();if(2&n&&t)for(const r of t)r.update()}:null}(l,d),1,g,v,null,null,null,[s],null)}(r,v,d,l),A=function nr(e,t,n){let r=t instanceof p.uvJ?t:t?.injector;return r&&null!==e.getStandaloneInjector&&(r=e.getStandaloneInjector(r)||r),r?new i(n,r):n}(v,s||this.ngModule,t),O=function Ea(e){const t=e.get(uf,null);if(null===t)throw new p.buA(407,!1);return{rendererFactory:t,sanitizer:e.get(w_,null),changeDetectionScheduler:e.get(p.hk6,null),ngReflect:!1}}(A),j=O.rendererFactory.createRenderer(null,v),B=r?function Ud(e,t,n,r){const l=r.get(wc,!1)||n===ri.ShadowDom,d=e.selectRootElement(t,l);return function U0(e){Kh(e)}(d),d}(j,r,v.encapsulation,A):function nh(e,t){const n=function Ma(e){return(e.selectors[0][0]||"div").toLowerCase()}(e);return Nd(t,n,"svg"===n?p.jNX:"math"===n?p.rJ1:null)}(v,j),X=d?.some(Hu)||l?.some(Ie=>"function"!=typeof Ie&&Ie.bindings.some(Hu)),le=Hf(null,M,null,512|Wf(v),null,null,O,j,A,null,null);le[p.Yw1]=B,(0,p.ID8)(le);let _e=null;try{const Ie=ye(p.Yw1,le,2,"#host",()=>M.directiveRegistry,!0,0);B&&(Zh(j,B,Ie),$r(B,le)),tp(M,le,Ie),Hs(M,Ie,le),Re(M,Ie),void 0!==n&&function ih(e,t,n){const r=e.projection=[];for(let s=0;s<t.length;s++){const l=n[s];r.push(null!=l&&l.length?Array.from(l):null)}}(Ie,this.ngContentSelectors,n),_e=(0,p.KdJ)(Ie.index,le),le[p.SKP]=_e[p.SKP],$l(M,le,null)}catch(Ie){throw null!==_e&&Ro(_e),Ro(le),Ie}finally{Ue(23),(0,p.bll)()}return new oh(this.componentType,le,!!X)}finally{(0,Ge.Ht)(g)}}}function Hu(e){const t=e[lr].kind;return"input"===t||"twoWay"===t}class oh extends pb{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(t,n,r){super(),this._rootLView=n,this._hasInputBindings=r,this._tNode=(0,p.XRZ)(n[p.eDl],p.Yw1),this.location=Jr(this._tNode,n),this.instance=(0,p.KdJ)(this._tNode.index,n)[p.SKP],this.hostView=this.changeDetectorRef=new Pr(n,void 0),this.componentType=t}setInput(t,n){const r=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),n))return;const s=this._rootLView;lp(r,s[p.eDl],s,t,n),this.previousInputValues.set(t,n),zu((0,p.KdJ)(r.index,s),1)}get injector(){return new er(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}}let Zs=(()=>class e{static __NG_ELEMENT_ID__=C_})();function C_(){return sl((0,p.Mx4)(),(0,p.OAn)())}const S_=Zs,ym=class extends S_{_lContainer;_hostTNode;_hostLView;constructor(t,n,r){super(),this._lContainer=t,this._hostTNode=n,this._hostLView=r}get element(){return Jr(this._hostTNode,this._hostLView)}get injector(){return new er(this._hostTNode,this._hostLView)}get parentInjector(){const t=xo(this._hostTNode,this._hostLView);if(Er(t)){const n=jt(t,this._hostLView),r=ui(t);return new er(n[p.eDl].data[r+8],n)}return new er(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){const n=Np(this._lContainer);return null!==n&&n[t]||null}get length(){return this._lContainer.length-p.Y20}createEmbeddedView(t,n,r){let s,l;"number"==typeof r?s=r:null!=r&&(s=r.index,l=r.injector);const g=t.createEmbeddedViewImpl(n||{},l,null);return this.insertImpl(g,s,Gc(this._hostTNode,null)),g}createComponent(t,n,r,s,l,d,g){const v=t&&!function Vt(e){return"function"==typeof e}(t);let M;if(v)M=n;else{const _e=n||{};M=_e.index,r=_e.injector,s=_e.projectableNodes,l=_e.environmentInjector||_e.ngModuleRef,d=_e.directives,g=_e.bindings}const A=v?t:new _m((0,p.xUg)(t)),O=r||this.parentInjector;if(!l&&null==A.ngModule){const Ie=(v?O:this.parentInjector).get(p.uvJ,null);Ie&&(l=Ie)}(0,p.xUg)(A.componentType??{});const le=A.create(O,s,null,l,d,g);return this.insertImpl(le.hostView,M,Gc(this._hostTNode,null)),le}insert(t,n){return this.insertImpl(t,n,!0)}insertImpl(t,n,r){const s=t._lView;if((0,p.ITl)(s)){const g=this.indexOf(t);if(-1!==g)this.detach(g);else{const v=s[p.f7T],M=new ym(v,v[p.qlT],v[p.f7T]);M.detach(M.indexOf(t))}}const l=this._adjustIndex(n),d=this._lContainer;return Zd(d,s,l,r),t.attachToViewContainerRef(),(0,p.EYC)(pf(d),l,t),t}move(t,n){return this.insert(t,n)}indexOf(t){const n=Np(this._lContainer);return null!==n?n.indexOf(t):-1}remove(t){const n=this._adjustIndex(t,-1),r=ef(this._lContainer,n);r&&((0,p.E6O)(pf(this._lContainer),n),Ou(r[p.eDl],r))}detach(t){const n=this._adjustIndex(t,-1),r=ef(this._lContainer,n);return r&&null!=(0,p.E6O)(pf(this._lContainer),n)?new Pr(r):null}_adjustIndex(t,n=0){return t??this.length+n}};function Np(e){return e[p.bm_]}function pf(e){return e[p.bm_]||(e[p.bm_]=[])}function sl(e,t){let n;const r=t[e.index];return(0,p.A0l)(r)?n=r:(n=Q0(r,t,null,e),t[e.index]=n,qf(t,n)),vm(n,t,e,r),new ym(n,e,t)}let vm=function T_(e,t,n,r){if(e[p.s6P])return;let s;s=8&n.type?(0,p.IvY)(r):function E_(e,t){const n=e[p.GpT],r=n.createComment(""),s=(0,p.d31)(t,e),l=n.parentNode(s);return Pu(n,l,r,n.nextSibling(s),!1),r}(t,n),e[p.s6P]=s};class xm{queryList;matches=null;constructor(t){this.queryList=t}clone(){return new xm(this.queryList)}setDirty(){this.queryList.setDirty()}}class wm{queries;constructor(t=[]){this.queries=t}createEmbeddedView(t){const n=t.queries;if(null!==n){const r=null!==t.contentQueries?t.contentQueries[0]:n.length,s=[];for(let l=0;l<r;l++){const d=n.getByIndex(l);s.push(this.queries[d.indexInDeclarationView].clone())}return new wm(s)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}finishViewCreation(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let n=0;n<this.queries.length;n++)null!==bb(t,n).matches&&this.queries[n].setDirty()}}class Ys{flags;read;predicate;constructor(t,n,r=null){this.flags=n,this.read=r,this.predicate="string"==typeof t?function zD(e){return e.split(",").map(t=>t.trim())}(t):t}}class sh{queries;constructor(t=[]){this.queries=t}elementStart(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(t,n)}elementEnd(t){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(t)}embeddedTView(t){let n=null;for(let r=0;r<this.length;r++){const s=null!==n?n.length:0,l=this.getByIndex(r).embeddedTView(t,s);l&&(l.indexInDeclarationView=r,null!==n?n.push(l):n=[l])}return null!==n?new sh(n):null}template(t,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(t,n)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}}class Lp{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(t,n=-1){this.metadata=t,this._declarationNodeIndex=n}elementStart(t,n){this.isApplyingToNode(n)&&this.matchTNode(t,n)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,n){this.elementStart(t,n)}embeddedTView(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new Lp(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&1&~this.metadata.flags){const n=this._declarationNodeIndex;let r=t.parent;for(;null!==r&&8&r.type&&r.index!==n;)r=r.parent;return n===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(t,n){const r=this.metadata.predicate;if(Array.isArray(r))for(let s=0;s<r.length;s++){const l=r[s];this.matchTNodeWithReadOption(t,n,_b(n,l)),this.matchTNodeWithReadOption(t,n,uc(n,t,l,!1,!1))}else r===Sa?4&n.type&&this.matchTNodeWithReadOption(t,n,-1):this.matchTNodeWithReadOption(t,n,uc(n,t,r,!1,!1))}matchTNodeWithReadOption(t,n,r){if(null!==r){const s=this.metadata.read;if(null!==s)if(s===Nn||s===Zs||s===Sa&&4&n.type)this.addMatch(n.index,-2);else{const l=uc(n,t,s,!1,!1);null!==l&&this.addMatch(n.index,l)}else this.addMatch(n.index,r)}}addMatch(t,n){null===this.matches?this.matches=[t,n]:this.matches.push(t,n)}}function _b(e,t){const n=e.localNames;if(null!==n)for(let r=0;r<n.length;r+=2)if(n[r]===t)return n[r+1];return null}function vb(e,t,n,r){return-1===n?function yb(e,t){return 11&e.type?Jr(e,t):4&e.type?Hl(e,t):null}(t,e):-2===n?function Zo(e,t,n){return n===Nn?Jr(t,e):n===Sa?Hl(t,e):n===Zs?sl(t,e):void 0}(e,t,r):pl(e,e[p.eDl],n,t)}function Yi(e,t,n,r){const s=t[p.Ds7].queries[r];if(null===s.matches){const l=e.data,d=n.matches,g=[];for(let v=0;null!==d&&v<d.length;v+=2){const M=d[v];g.push(M<0?null:vb(t,l[M],d[v+1],n.metadata.read))}s.matches=g}return s.matches}function Yl(e,t,n,r){const s=e.queries.getByIndex(n),l=s.matches;if(null!==l){const d=Yi(e,t,s,n);for(let g=0;g<l.length;g+=2){const v=l[g];if(v>0)r.push(d[g/2]);else{const M=l[g+1],A=t[-v];for(let O=p.Y20;O<A.length;O++){const j=A[O];j[p.rQE]===j[p.f7T]&&Yl(j[p.eDl],j,M,r)}if(null!==A[p.nfM]){const O=A[p.nfM];for(let j=0;j<O.length;j++){const B=O[j];Yl(B[p.eDl],B,M,r)}}}}}return r}function Kc(e,t,n){const r=new Ot(!(4&~n));return(0,p.B22)(e,t,r,r.destroy),(t[p.Ds7]??=new wm).queries.push(new xm(r))-1}function Vw(e,t,n){null===e.queries&&(e.queries=new sh),e.queries.track(new Lp(t,n))}function bb(e,t){return e.queries.getByIndex(t)}function Uw(e,t){const n=e[p.eDl],r=bb(n,t);return r.crossesNgTemplate?Yl(n,e,t,[]):Yi(n,e,r,t)}const qw=new Set;function Ti(e){qw.has(e)||(qw.add(e),performance?.mark?.("mark_feature_usage",{detail:{feature:e}}))}let gf=class{},Zw=class{};class Cb extends gf{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Yr(this);constructor(t,n,r,s=!0){super(),this.ngModuleType=t,this._parent=n;const l=(0,p.phH)(t);this._bootstrapComponents=Fo(l.bootstrap),this._r3Injector=(0,p.Pz9)(t,n,[{provide:gf,useValue:this},{provide:Rp,useValue:this.componentFactoryResolver},...r],(0,p.AsM)(t),new Set(["environment"])),s&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){const t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}}class Yw extends Zw{moduleType;constructor(t){super(),this.moduleType=t}create(t){return new Cb(this.moduleType,t,[])}}class Kw extends gf{injector;componentFactoryResolver=new Yr(this);instance=null;constructor(t){super();const n=new p.e5P([...t.providers,{provide:gf,useValue:this},{provide:Rp,useValue:this.componentFactoryResolver}],t.parent||(0,p.WB9)(),t.debugName,new Set(["environment"]));this.injector=n,t.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}}function Sb(e,t,n=null){return new Kw({providers:e,parent:t,debugName:n,runEnvironmentInitializers:!0}).injector}let QD=(()=>{class e{_injector;cachedInjectors=new Map;constructor(n){this._injector=n}getOrCreateStandaloneInjector(n){if(!n.standalone)return null;if(!this.cachedInjectors.has(n)){const r=(0,p.jXY)(!1,n.type),s=r.length>0?Sb([r],this._injector,`Standalone[${n.type.name}]`):null;this.cachedInjectors.set(n,s)}return this.cachedInjectors.get(n)}ngOnDestroy(){try{for(const n of this.cachedInjectors.values())null!==n&&n.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=(0,p.jDH)({token:e,providedIn:"environment",factory:()=>new e((0,p.KVO)(p.uvJ))})}return e})();function Wu(e){return Un(()=>{const t=Qw(e),n={...t,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Rs.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&e.dependencies||null,getStandaloneInjector:t.standalone?s=>s.get(QD).getOrCreateStandaloneInjector(n):null,getExternalStyles:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||ri.Emulated,styles:e.styles||p.Mlv,_:null,schemas:e.schemas||null,tView:null,id:""};t.standalone&&Ti("NgStandalone"),Jw(n);const r=e.dependencies;return n.directiveDefs=I_(r,Xw),n.pipeDefs=I_(r,p.oyA),n.id=function nA(e){let t=0;const r=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,"function"==typeof e.consts?"":e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery];for(const l of r.join("|"))t=Math.imul(31,t)+l.charCodeAt(0)|0;return t+=2147483648,"c"+t}(n),n})}function Xw(e){return(0,p.xUg)(e)||(0,p.HaV)(e)}function Bp(e){return Un(()=>({type:e.type,bootstrap:e.bootstrap||p.Mlv,declarations:e.declarations||p.Mlv,imports:e.imports||p.Mlv,exports:e.exports||p.Mlv,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function JD(e,t){if(null==e)return p.MZA;const n={};for(const r in e)if(e.hasOwnProperty(r)){const s=e[r];let l,d,g,v;Array.isArray(s)?(g=s[0],l=s[1],d=s[2]??l,v=s[3]||null):(l=s,d=s,g=Yh.None,v=null),n[l]=[r,g,v],t[l]=d}return n}function eA(e){if(null==e)return p.MZA;const t={};for(const n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}function Yo(e){return Un(()=>{const t=Qw(e);return Jw(t),t})}function Qw(e){const t={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputConfig:e.inputs||p.MZA,exportAs:e.exportAs||null,standalone:e.standalone??!0,signals:!0===e.signals,selectors:e.selectors||p.Mlv,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:JD(e.inputs,t),outputs:eA(e.outputs),debugInfo:null}}function Jw(e){e.features?.forEach(t=>t(e))}function I_(e,t){return e?()=>{const n="function"==typeof e?e():e,r=[];for(const s of n){const l=t(s);null!==l&&r.push(l)}return r}:null}function qu(e){let t=function eC(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),n=!0;const r=[e];for(;t;){let s;if((0,p.JlV)(e))s=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new p.buA(903,!1);s=t.\u0275dir}if(s){if(n){r.push(s);const d=e;d.inputs=Eb(e.inputs),d.declaredInputs=Eb(e.declaredInputs),d.outputs=Eb(e.outputs);const g=s.hostBindings;g&&aA(e,g);const v=s.viewQuery,M=s.contentQueries;if(v&&iA(e,v),M&&sA(e,M),rA(e,s),(0,p.dwj)(e.outputs,s.outputs),(0,p.JlV)(s)&&s.data.animation){const A=e.data;A.animation=(A.animation||[]).concat(s.data.animation)}}const l=s.features;if(l)for(let d=0;d<l.length;d++){const g=l[d];g&&g.ngInherit&&g(e),g===qu&&(n=!1)}}t=Object.getPrototypeOf(t)}!function oA(e){let t=0,n=null;for(let r=e.length-1;r>=0;r--){const s=e[r];s.hostVars=t+=s.hostVars,s.hostAttrs=Yt(s.hostAttrs,n=Yt(n,s.hostAttrs))}}(r)}function rA(e,t){for(const n in t.inputs){if(!t.inputs.hasOwnProperty(n)||e.inputs.hasOwnProperty(n))continue;const r=t.inputs[n];void 0!==r&&(e.inputs[n]=r,e.declaredInputs[n]=t.declaredInputs[n])}}function Eb(e){return e===p.MZA?{}:e===p.Mlv?[]:e}function iA(e,t){const n=e.viewQuery;e.viewQuery=n?(r,s)=>{t(r,s),n(r,s)}:t}function sA(e,t){const n=e.contentQueries;e.contentQueries=n?(r,s,l)=>{t(r,s,l),n(r,s,l)}:t}function aA(e,t){const n=e.hostBindings;e.hostBindings=n?(r,s)=>{t(r,s),n(r,s)}:t}function iC(e,t,n,r,s,l,d,g){if(n.firstCreatePass){e.mergedAttrs=Yt(e.mergedAttrs,e.attrs);const A=e.tView=Fd(2,e,s,l,d,n.directiveRegistry,n.pipeRegistry,null,n.schemas,n.consts,null);null!==n.queries&&(n.queries.template(n,e),A.queries=n.queries.embeddedTView(e))}g&&(e.flags|=g),(0,p.iMd)(e,!1);const v=aC(n,t,e,r);(0,p.SX7)()&&zg(n,t,v,e),$r(v,t);const M=Q0(v,t,v,e);t[r+p.Yw1]=M,qf(t,M)}function ah(e,t,n,r,s,l,d,g){const v=(0,p.OAn)(),M=(0,p.klJ)();return function pA(e,t,n,r,s,l,d,g,v,M,A){const O=n+p.Yw1;let j;t.firstCreatePass?(j=Hc(t,O,4,d||null,g||null),(0,p.ckz)()&&w(t,e,j,(0,p.db4)(t.consts,M),sp),bt(t,j)):j=t.data[O],iC(j,e,t,n,r,s,l,v),(0,p.yoD)(j)&&tp(t,e,j),null!=M&&tr(e,j,A)}(v,M,e,t,n,r,s,(0,p.db4)(M.consts,l),void 0,d,g),ah}let aC=function lC(e,t,n,r){return(0,p.m7n)(!0),t[p.GpT].createComment("")};var Tb=function(e){return e[e.CHANGE_DETECTION=0]="CHANGE_DETECTION",e[e.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",e}(Tb||{});const Mm=new p.nKC(""),fC=!1,Ki=class bA extends St.B{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(t=!1){super(),this.__isAsync=t,(0,p.M6u)()&&(this.destroyRef=(0,p.WQX)(p.abz,{optional:!0})??void 0,this.pendingTasks=(0,p.WQX)(p.rev,{optional:!0})??void 0)}emit(t){const n=(0,Ge.Ht)(null);try{super.next(t)}finally{(0,Ge.Ht)(n)}}subscribe(t,n,r){let s=t,l=n||(()=>null),d=r;if(t&&"object"==typeof t){const v=t;s=v.next?.bind(v),l=v.error?.bind(v),d=v.complete?.bind(v)}this.__isAsync&&(l=this.wrapInTimeout(l),s&&(s=this.wrapInTimeout(s)),d&&(d=this.wrapInTimeout(d)));const g=super.subscribe({next:s,error:l,complete:d});return t instanceof gn.yU&&t.add(g),g}wrapInTimeout(t){return n=>{const r=this.pendingTasks?.add();setTimeout(()=>{try{t(n)}finally{void 0!==r&&this.pendingTasks?.remove(r)}})}}};function pC(e){let t,n;function r(){e=p.lQ1;try{void 0!==n&&"function"==typeof cancelAnimationFrame&&cancelAnimationFrame(n),void 0!==t&&clearTimeout(t)}catch{}}return t=setTimeout(()=>{e(),r()}),"function"==typeof requestAnimationFrame&&(n=requestAnimationFrame(()=>{e(),r()})),()=>r()}function gC(e){return queueMicrotask(()=>e()),()=>{e=p.lQ1}}const Ib="isAngularZone",k_=Ib+"_ID";let xA=0;class jn{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Ki(!1);onMicrotaskEmpty=new Ki(!1);onStable=new Ki(!1);onError=new Ki(!1);constructor(t){const{enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:s=!1,scheduleInRootZone:l=fC}=t;if(typeof Zone>"u")throw new p.buA(908,!1);Zone.assertZonePatched();const d=this;d._nesting=0,d._outer=d._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(d._inner=d._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(d._inner=d._inner.fork(Zone.longStackTraceZoneSpec)),d.shouldCoalesceEventChangeDetection=!s&&r,d.shouldCoalesceRunChangeDetection=s,d.callbackScheduled=!1,d.scheduleInRootZone=l,function SA(e){const t=()=>{!function CA(e){function t(){pC(()=>{e.callbackScheduled=!1,Ab(e),e.isCheckStableRunning=!0,Db(e),e.isCheckStableRunning=!1})}e.isCheckStableRunning||e.callbackScheduled||(e.callbackScheduled=!0,e.scheduleInRootZone?Zone.root.run(()=>{t()}):e._outer.run(()=>{t()}),Ab(e))}(e)},n=xA++;e._inner=e._inner.fork({name:"angular",properties:{[Ib]:!0,[k_]:n,[k_+n]:!0},onInvokeTask:(r,s,l,d,g,v)=>{if(function EA(e){return yC(e,"__ignore_ng_zone__")}(v))return r.invokeTask(l,d,g,v);try{return mC(e),r.invokeTask(l,d,g,v)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===d.type||e.shouldCoalesceRunChangeDetection)&&t(),_C(e)}},onInvoke:(r,s,l,d,g,v,M)=>{try{return mC(e),r.invoke(l,d,g,v,M)}finally{e.shouldCoalesceRunChangeDetection&&!e.callbackScheduled&&!function MA(e){return yC(e,"__scheduler_tick__")}(v)&&t(),_C(e)}},onHasTask:(r,s,l,d)=>{r.hasTask(l,d),s===l&&("microTask"==d.change?(e._hasPendingMicrotasks=d.microTask,Ab(e),Db(e)):"macroTask"==d.change&&(e.hasPendingMacrotasks=d.macroTask))},onHandleError:(r,s,l,d)=>(r.handleError(l,d),e.runOutsideAngular(()=>e.onError.emit(d)),!1)})}(d)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get(Ib)}static assertInAngularZone(){if(!jn.isInAngularZone())throw new p.buA(909,!1)}static assertNotInAngularZone(){if(jn.isInAngularZone())throw new p.buA(909,!1)}run(t,n,r){return this._inner.run(t,n,r)}runTask(t,n,r,s){const l=this._inner,d=l.scheduleEventTask("NgZoneEvent: "+s,t,wA,p.lQ1,p.lQ1);try{return l.runTask(d,n,r)}finally{l.cancelTask(d)}}runGuarded(t,n,r){return this._inner.runGuarded(t,n,r)}runOutsideAngular(t){return this._outer.run(t)}}const wA={};function Db(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Ab(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&!0===e.callbackScheduled)}function mC(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function _C(e){e._nesting--,Db(e)}class Pb{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Ki;onMicrotaskEmpty=new Ki;onStable=new Ki;onError=new Ki;run(t,n,r){return t.apply(n,r)}runGuarded(t,n,r){return t.apply(n,r)}runOutsideAngular(t){return t()}runTask(t,n,r,s){return t.apply(n,r)}}function yC(e,t){return!(!Array.isArray(e)||1!==e.length)&&!0===e[0]?.data?.[t]}let vC=(()=>{class e{impl=null;execute(){this.impl?.execute()}static \u0275prov=(0,p.jDH)({token:e,providedIn:"root",factory:()=>new e})}return e})(),PC=(()=>{class e{log(n){console.log(n)}warn(n){console.warn(n)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=(0,p.jDH)({token:e,factory:e.\u0275fac,providedIn:"platform"})}return e})();const WC=new p.nKC("");function B_(e){return!!e&&"function"==typeof e.then}function qC(e){return!!e&&"function"==typeof e.subscribe}const ZC=new p.nKC("");let YC=(()=>{class e{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((n,r)=>{this.resolve=n,this.reject=r});appInits=(0,p.WQX)(ZC,{optional:!0})??[];injector=(0,p.WQX)(p.zZn);constructor(){}runInitializers(){if(this.initialized)return;const n=[];for(const s of this.appInits){const l=(0,p.N4e)(this.injector,s);if(B_(l))n.push(l);else if(qC(l)){const d=new Promise((g,v)=>{l.subscribe({complete:g,error:v})});n.push(d)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(n).then(()=>{r()}).catch(s=>{this.reject(s)}),0===n.length&&r(),this.initialized=!0}static \u0275fac=function(r){return new(r||e)};static \u0275prov=(0,p.jDH)({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const KC=new p.nKC("");let ch=(()=>{class e{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=(0,p.WQX)(p.ZTf);afterRenderManager=(0,p.WQX)(vC);zonelessEnabled=(0,p.WQX)(p.Evm);rootEffectScheduler=(0,p.WQX)(p.VML);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new St.B;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=(0,p.WQX)(p.rev);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(fn(n=>!n))}constructor(){(0,p.WQX)(Mm,{optional:!0})}whenStable(){let n;return new Promise(r=>{n=this.isStable.subscribe({next:s=>{s&&r()}})}).finally(()=>{n.unsubscribe()})}_injector=(0,p.WQX)(p.uvJ);_rendererFactory=null;get injector(){return this._injector}bootstrap(n,r){return this.bootstrapImpl(n,r)}bootstrapImpl(n,r,s=p.zZn.NULL){return this._injector.get(jn).run(()=>{Ue(10);const d=n instanceof fm;if(!this._injector.get(YC).done)throw new p.buA(405,"");let v;v=d?n:this._injector.get(Rp).resolveComponentFactory(n),this.componentTypes.push(v.componentType);const M=function FP(e){return e.isBoundToModule}(v)?void 0:this._injector.get(gf),O=v.create(s,[],r||v.selector,M),j=O.location.nativeElement,B=O.injector.get(WC,null);return B?.registerApplication(j),O.onDestroy(()=>{this.detachView(O.hostView),z_(this.components,O),B?.unregisterApplication(j)}),this._loadComponent(O),Ue(11,O),O})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Ue(12),null!==this.tracingSnapshot?this.tracingSnapshot.run(Tb.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new p.buA(101,!1);const n=(0,Ge.Ht)(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,(0,Ge.Ht)(n),this.afterTick.next(),Ue(13)}};synchronize(){null===this._rendererFactory&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(uf,null,{optional:!0}));let n=0;for(;0!==this.dirtyFlags&&n++<10;)Ue(14),this.synchronizeOnce(),Ue(15)}synchronizeOnce(){16&this.dirtyFlags&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let n=!1;if(7&this.dirtyFlags){const r=!!(1&this.dirtyFlags);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:s}of this.allViews)(r||(0,p.dMS)(s))&&(up(s,r&&!this.zonelessEnabled?0:1),n=!0);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),23&this.dirtyFlags)return}n||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),8&this.dirtyFlags&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){this.allViews.some(({_lView:n})=>(0,p.dMS)(n))?this.dirtyFlags|=2:this.dirtyFlags&=-8}attachView(n){const r=n;this._views.push(r),r.attachToAppRef(this)}detachView(n){const r=n;z_(this._views,r),r.detachFromAppRef()}_loadComponent(n){this.attachView(n.hostView);try{this.tick()}catch(s){this.internalErrorHandler(s)}this.components.push(n),this._injector.get(KC,[]).forEach(s=>s(n))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(n=>n()),this._views.slice().forEach(n=>n.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(n){return this._destroyListeners.push(n),()=>z_(this._destroyListeners,n)}destroy(){if(this._destroyed)throw new p.buA(406,!1);const n=this._injector;n.destroy&&!n.destroyed&&n.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(r){return new(r||e)};static \u0275prov=(0,p.jDH)({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function z_(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}function Zu(e,t,n,r){const s=(0,p.OAn)();return ze(s,(0,p.xbp)(),t)&&((0,p.klJ)(),function Bu(e,t,n,r,s,l){const d=(0,p.d31)(e,t);!function ap(e,t,n,r,s,l,d){if(null==l)e.removeAttribute(t,s,n);else{const g=null==d?(0,p.eFE)(l):d(l,r||"",s);e.setAttribute(t,s,g,n)}}(t[p.GpT],d,l,e.value,n,r,s)}((0,p.CpD)(),s,e,t,n,r)),Zu}const aS=new p.nKC("",{providedIn:"root",factory:()=>!1}),bk=new p.nKC("",{providedIn:"root",factory:()=>xk}),xk=4e3;function si(e,t,n){const r=(0,p.OAn)();return ze(r,(0,p.xbp)(),t)&&((0,p.klJ)(),op((0,p.CpD)(),r,e,t,r[p.GpT],n)),si}function Qb(e,t,n,r,s){lp(t,e,n,s?"class":"style",r)}function Am(e,t,n,r){const s=(0,p.OAn)(),l=s[p.eDl],d=e+p.Yw1,g=l.firstCreatePass?ye(d,s,2,t,sp,(0,p.ckz)(),n,r):l.data[d];if(Uc(g,s,e,t,Jb),(0,p.yoD)(g)){const v=s[p.eDl];tp(v,s,g),Hs(v,g,s)}return null!=r&&tr(s,g),Am}function Pm(){const e=(0,p.klJ)(),n=$d((0,p.Mx4)());return e.firstCreatePass&&Re(e,n),(0,p.UhH)(n)&&(0,p.krE)(),(0,p.N79)(),null!=n.classesWithoutHost&&function yr(e){return!!(8&e.flags)}(n)&&Qb(e,n,(0,p.OAn)(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function Ke(e){return!!(16&e.flags)}(n)&&Qb(e,n,(0,p.OAn)(),n.stylesWithoutHost,!1),Pm}function fh(e,t,n,r){return Am(e,t,n,r),Pm(),fh}function km(e,t,n,r){const s=(0,p.OAn)(),l=s[p.eDl],d=e+p.Yw1,g=l.firstCreatePass?function je(e,t,n,r,s,l){const d=t.consts,v=Hc(t,e,n,r,(0,p.db4)(d,s));if(v.mergedAttrs=Yt(v.mergedAttrs,v.attrs),null!=l){const M=(0,p.db4)(d,l);v.localNames=[];for(let A=0;A<M.length;A+=2)v.localNames.push(M[A],-1)}return null!==v.attrs&&a(v,v.attrs,!1),null!==v.mergedAttrs&&a(v,v.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,v),v}(d,l,2,t,n,r):l.data[d];return Uc(g,s,e,t,Jb),null!=r&&tr(s,g),km}function Rm(){const t=$d((0,p.Mx4)());return(0,p.UhH)(t)&&(0,p.krE)(),(0,p.N79)(),Rm}function Om(e,t,n,r){return km(e,t,n,r),Rm(),Om}typeof document<"u"&&document;let Jb=(e,t,n,r,s)=>((0,p.m7n)(!0),Nd(t[p.GpT],r,(0,p.UaU)()));function Wp(e,t,n){const r=(0,p.OAn)(),s=r[p.eDl],l=e+p.Yw1,d=s.firstCreatePass?ye(l,r,8,"ng-container",sp,(0,p.ckz)(),t,n):s.data[l];if(Uc(d,r,e,"ng-container",n1),(0,p.yoD)(d)){const g=r[p.eDl];tp(g,r,d),Hs(g,d,r)}return null!=n&&tr(r,d),Wp}function Cf(){const e=(0,p.klJ)(),n=$d((0,p.Mx4)());return e.firstCreatePass&&Re(e,n),Cf}function e1(e,t,n){return Wp(e,t,n),Cf(),e1}let n1=(e,t,n,r,s)=>((0,p.m7n)(!0),Pg(t[p.GpT],""));function r1(e,t,n){const r=(0,p.OAn)();return ze(r,(0,p.xbp)(),t)&&((0,p.klJ)(),Lu((0,p.CpD)(),r,e,t,r[p.GpT],n)),r1}const q_="en-US";let CS=q_;function X_(e,t,n){const r=(0,p.OAn)(),s=(0,p.klJ)(),l=(0,p.Mx4)();return function s1(e,t,n,r,s,l,d){let g=!0,v=null;if((3&r.type||d)&&(v??=xt(r,t,l),function fr(e,t,n,r,s,l,d,g){const v=(0,p.yoD)(e);let M=!1,A=null;if(!r&&v&&(A=function ro(e,t,n,r){const s=e.cleanup;if(null!=s)for(let l=0;l<s.length-1;l+=2){const d=s[l];if(d===n&&s[l+1]===r){const g=t[p.VVG],v=s[l+2];return g&&g.length>v?g[v]:null}"string"==typeof d&&(l+=2)}return null}(t,n,l,e.index)),null!==A)(A.__ngLastListenerFn__||A).__ngNextListenerFn__=d,A.__ngLastListenerFn__=d,M=!0;else{const O=(0,p.d31)(e,n),j=r?r(O):O,B=s.listen(j,l,g);Eo(r?le=>r((0,p.IvY)(le[e.index])):e.index,t,n,l,g,B,!1)}return M}(r,e,t,d,n,s,l,v)&&(g=!1)),g){const M=r.outputs?.[s],A=r.hostDirectiveOutputs?.[s];if(A&&A.length)for(let O=0;O<A.length;O+=2){const j=A[O],B=A[O+1];v??=xt(r,t,l),Zr(r,t,j,B,s,v)}if(M&&M.length)for(const O of M)v??=xt(r,t,l),Zr(r,t,O,s,s,v)}}(s,r,r[p.GpT],l,e,t,n),X_}function Kl(e=1){return(0,p.jvu)(e)}function VR(e,t){let n=null;const r=function Wh(e){const t=e.attrs;if(null!=t){const n=t.indexOf(5);if(!(1&n))return t[n+1]}return null}(e);for(let s=0;s<t.length;s++){const l=t[s];if("*"!==l){if(null===r?Hh(e,l,!0):nl(r,l))return s}else n=s}return n}function Q_(e){const t=(0,p.OAn)()[p.b5C][p.qlT];if(!t.projection){const r=t.projection=(0,p.WfI)(e?e.length:1,null),s=r.slice();let l=t.child;for(;null!==l;){if(128!==l.type){const d=e?VR(l,e):0;null!==d&&(s[d]?s[d].projectionNext=l:r[d]=l,s[d]=l)}l=l.next}}}function J_(e,t=0,n,r,s,l){const d=(0,p.OAn)(),g=(0,p.klJ)(),v=r?e+1:null;null!==v&&function mf(e,t,n,r,s,l,d,g,v,M,A){const O=n+p.Yw1;let j;if(t.firstCreatePass){if(j=Hc(t,O,4,d||null,g||null),null!=M){const B=(0,p.db4)(t.consts,M);j.localNames=[];for(let X=0;X<B.length;X+=2)j.localNames.push(B[X],-1)}}else j=t.data[O];return iC(j,e,t,n,r,s,l,v),null!=M&&tr(e,j,A),j}(d,g,v,r,s,l,null,n);const M=Hc(g,p.Yw1+e,16,null,n||null);null===M.projection&&(M.projection=t),(0,p.Pfq)();const O=!d[p.tcA]||(0,p.KtD)();null===d[p.b5C][p.qlT].projection[M.projection]&&null!==v?function UR(e,t,n){const r=p.Yw1+n,s=t.data[r],l=e[r];Zd(l,Hd(e,s,void 0,{dehydratedView:null}),0,Gc(s,null))}(d,g,v):O&&!Vs(M)&&function Pv(e,t,n){ep(t[p.GpT],0,t,n,Fg(e,n,t),Xf(n.parent||t[p.qlT],n,t))}(g,d,M)}function Zp(e,t,n,r){!function jw(e,t,n,r){const s=(0,p.klJ)();if(s.firstCreatePass){const l=(0,p.Mx4)();Vw(s,new Ys(t,n,r),l.index),function jD(e,t){const n=e.contentQueries||(e.contentQueries=[]);t!==(n.length?n[n.length-1]:-1)&&n.push(e.queries.length-1,t)}(s,e),!(2&~n)&&(s.staticContentQueries=!0)}return Kc(s,(0,p.OAn)(),n)}(e,t,n,r)}function GS(e,t,n){!function Ta(e,t,n){const r=(0,p.klJ)();return r.firstCreatePass&&(Vw(r,new Ys(e,t,n),-1),!(2&~t)&&(r.staticViewQueries=!0)),Kc(r,(0,p.OAn)(),t)}(e,t,n)}function Ef(e){const t=(0,p.OAn)(),n=(0,p.klJ)(),r=(0,p.w7Z)();(0,p.GA0)(r+1);const s=bb(n,r);if(e.dirty&&(0,p.vOT)(t)===!(2&~s.metadata.flags)){if(null===s.matches)e.reset([]);else{const l=Uw(t,r);e.reset(l,Ln),e.notifyOnChanges()}return!0}return!1}function Mf(){return function ws(e,t){return e[p.Ds7].queries[t].queryList}((0,p.OAn)(),(0,p.w7Z)())}function ey(e,t){return e<<17|t<<2}function Tf(e){return e>>17&32767}function a1(e){return 2|e}function Yp(e){return(131068&e)>>2}function l1(e,t){return-131069&e|t<<2}function c1(e){return 1|e}function $S(e,t,n,r){const s=e[n+1],l=null===t;let d=r?Tf(s):Yp(s),g=!1;for(;0!==d&&(!1===g||l);){const M=e[d+1];QR(e[d],t)&&(g=!0,e[d+1]=r?c1(M):a1(M)),d=r?Tf(M):Yp(M)}g&&(e[n+1]=r?a1(s):c1(s))}function QR(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&(0,p.FRF)(e,t)>=0}const Ko={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function HS(e){return e.substring(Ko.key,Ko.keyEnd)}function WS(e,t){const n=Ko.textEnd;return n===t?-1:(t=Ko.keyEnd=function nO(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,Ko.key=t,n),Kp(e,t,n))}function Kp(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function u1(e,t,n){return function QS(e,t,n,r){const s=(0,p.OAn)(),l=(0,p.klJ)(),d=(0,p.b$O)(2);l.firstUpdatePass&&tE(l,e,d,r),t!==Hn&&ze(s,d,t)&&rE(l,l.data[(0,p._px)()],s,s[p.GpT],e,s[d+1]=function gO(e,t){return null==e||""===e||("string"==typeof t?e+=t:"object"==typeof e&&(e=(0,p.AsM)(hs(e)))),e}(t,n),r,d)}(e,t,n,!1),u1}function Yu(e){!function JS(e,t,n,r){const s=(0,p.klJ)(),l=(0,p.b$O)(2);s.firstUpdatePass&&tE(s,null,l,r);const d=(0,p.OAn)();if(n!==Hn&&ze(d,l,n)){const g=s.data[(0,p._px)()];if(iE(g,r)&&!eE(s,l)){let v=r?g.classesWithoutHost:g.stylesWithoutHost;null!==v&&(n=(0,p.n$e)(v,n||"")),Qb(s,g,d,n,r)}else!function pO(e,t,n,r,s,l,d,g){s===Hn&&(s=p.Mlv);let v=0,M=0,A=0<s.length?s[0]:null,O=0<l.length?l[0]:null;for(;null!==A||null!==O;){const j=v<s.length?s[v+1]:void 0,B=M<l.length?l[M+1]:void 0;let le,X=null;A===O?(v+=2,M+=2,j!==B&&(X=O,le=B)):null===O||null!==A&&A<O?(v+=2,X=A):(M+=2,X=O,le=B),null!==X&&rE(e,t,n,r,X,le,d,g),A=v<s.length?s[v]:null,O=M<l.length?l[M]:null}}(s,g,d,d[p.GpT],d[l+1],d[l+1]=function hO(e,t,n){if(null==n||""===n)return p.Mlv;const r=[],s=hs(n);if(Array.isArray(s))for(let l=0;l<s.length;l++)e(r,s[l],!0);else if("object"==typeof s)for(const l in s)s.hasOwnProperty(l)&&e(r,l,s[l]);else"string"==typeof s&&t(r,s);return r}(e,t,n),r,l)}}(fO,aO,e,!0)}function aO(e,t){for(let n=function eO(e){return function ZS(e){Ko.key=0,Ko.keyEnd=0,Ko.value=0,Ko.valueEnd=0,Ko.textEnd=e.length}(e),WS(e,Kp(e,0,Ko.textEnd))}(t);n>=0;n=WS(t,n))(0,p.ezK)(e,HS(t),!0)}function eE(e,t){return t>=e.expandoStartIndex}function tE(e,t,n,r){const s=e.data;if(null===s[n+1]){const l=s[(0,p._px)()],d=eE(e,n);iE(l,r)&&null===t&&!d&&(t=!1),t=function lO(e,t,n,r){const s=(0,p.MT)(e);let l=r?t.residualClasses:t.residualStyles;if(null===s)0===(r?t.classBindings:t.styleBindings)&&(n=jm(n=d1(null,e,t,n,r),t.attrs,r),l=null);else{const d=t.directiveStylingLast;if(-1===d||e[d]!==s)if(n=d1(s,e,t,n,r),null===l){let v=function cO(e,t,n){const r=n?t.classBindings:t.styleBindings;if(0!==Yp(r))return e[Tf(r)]}(e,t,r);void 0!==v&&Array.isArray(v)&&(v=d1(null,e,t,v[1],r),v=jm(v,t.attrs,r),function uO(e,t,n,r){e[Tf(n?t.classBindings:t.styleBindings)]=r}(e,t,r,v))}else l=function dO(e,t,n){let r;const s=t.directiveEnd;for(let l=1+t.directiveStylingLast;l<s;l++)r=jm(r,e[l].hostAttrs,n);return jm(r,t.attrs,n)}(e,t,r)}return void 0!==l&&(r?t.residualClasses=l:t.residualStyles=l),n}(s,l,t,r),function KR(e,t,n,r,s,l){let d=l?t.classBindings:t.styleBindings,g=Tf(d),v=Yp(d);e[r]=n;let A,M=!1;if(Array.isArray(n)?(A=n[1],(null===A||(0,p.FRF)(n,A)>0)&&(M=!0)):A=n,s)if(0!==v){const j=Tf(e[g+1]);e[r+1]=ey(j,g),0!==j&&(e[j+1]=l1(e[j+1],r)),e[g+1]=function ZR(e,t){return 131071&e|t<<17}(e[g+1],r)}else e[r+1]=ey(g,0),0!==g&&(e[g+1]=l1(e[g+1],r)),g=r;else e[r+1]=ey(v,0),0===g?g=r:e[v+1]=l1(e[v+1],r),v=r;M&&(e[r+1]=a1(e[r+1])),$S(e,A,r,!0),$S(e,A,r,!1),function XR(e,t,n,r,s){const l=s?e.residualClasses:e.residualStyles;null!=l&&"string"==typeof t&&(0,p.FRF)(l,t)>=0&&(n[r+1]=c1(n[r+1]))}(t,A,e,r,l),d=ey(g,v),l?t.classBindings=d:t.styleBindings=d}(s,l,t,n,d,r)}}function d1(e,t,n,r,s){let l=null;const d=n.directiveEnd;let g=n.directiveStylingLast;for(-1===g?g=n.directiveStart:g++;g<d&&(l=t[g],r=jm(r,l.hostAttrs,s),l!==e);)g++;return null!==e&&(n.directiveStylingLast=g),r}function jm(e,t,n){const r=n?1:2;let s=-1;if(null!==t)for(let l=0;l<t.length;l++){const d=t[l];"number"==typeof d?s=d:s===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),(0,p.ezK)(e,d,!!n||t[++l]))}return void 0===e?null:e}function fO(e,t,n){const r=String(t);""!==r&&!r.includes(" ")&&(0,p.ezK)(e,r,n)}function rE(e,t,n,r,s,l,d,g){if(!(3&t.type))return;const v=e.data,M=v[g+1],A=function YR(e){return!(1&~e)}(M)?oE(v,t,n,s,Yp(M),d):void 0;ty(A)||(ty(l)||function qR(e){return!(2&~e)}(M)&&(l=oE(v,null,n,s,g,d)),function V0(e,t,n,r,s){if(t)s?e.addClass(n,r):e.removeClass(n,r);else{let l=-1===r.indexOf("-")?void 0:qs.DashCase;null==s?e.removeStyle(n,r,l):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),l|=qs.Important),e.setStyle(n,r,s,l))}}(r,d,(0,p.vaC)((0,p._px)(),n),s,l))}function oE(e,t,n,r,s,l){const d=null===t;let g;for(;s>0;){const v=e[s],M=Array.isArray(v),A=M?v[1]:v,O=null===A;let j=n[s+1];j===Hn&&(j=O?p.Mlv:void 0);let B=O?(0,p.K7h)(j,r):A===r?j:void 0;if(M&&!ty(B)&&(B=(0,p.K7h)(v,r)),ty(B)&&(g=B,d))return g;const X=e[s+1];s=d?Tf(X):Yp(X)}if(null!==t){let v=l?t.residualClasses:t.residualStyles;null!=v&&(g=(0,p.K7h)(v,r))}return g}function ty(e){return void 0!==e}function iE(e,t){return!!(e.flags&(t?8:16))}function h1(e,t=""){const n=(0,p.OAn)(),r=(0,p.klJ)(),s=e+p.Yw1,l=r.firstCreatePass?Hc(r,s,1,t,null):r.data[s],d=sE(r,n,l,t,e);n[s]=d,(0,p.SX7)()&&zg(r,n,d,l),(0,p.iMd)(l,!1)}let sE=(e,t,n,r,s)=>((0,p.m7n)(!0),function Dg(e,t){return e.createText(t)}(t[p.GpT],r));function ny(e){return f1("",e),ny}function f1(e,t,n){const r=(0,p.OAn)(),s=function lE(e,t,n,r=""){return ze(e,(0,p.xbp)(),n)?t+(0,p.eFE)(n)+r:Hn}(r,e,t,n);return s!==Hn&&function Ku(e,t,n){const r=(0,p.vaC)(t,e);!function Ag(e,t,n){e.setValue(t,n)}(e[p.GpT],r,n)}(r,(0,p._px)(),s),f1}function p1(e,t,n,r,s){if(e=(0,p.nl4)(e),Array.isArray(e))for(let l=0;l<e.length;l++)p1(e[l],t,n,r,s);else{const l=(0,p.klJ)(),d=(0,p.OAn)(),g=(0,p.Mx4)();let v=(0,p.Y3W)(e)?e:(0,p.nl4)(e.provide);const M=(0,p.Rc9)(e),A=1048575&g.providerIndexes,O=g.directiveStart,j=g.providerIndexes>>20;if((0,p.Y3W)(e)||!e.multi){const B=new Gn(M,s,h,null),X=m1(v,t,s?A:A+j,O);-1===X?(ko(In(g,d),l,v),g1(l,e,t.length),t.push(v),g.directiveStart++,g.directiveEnd++,s&&(g.providerIndexes+=1048576),n.push(B),d.push(B)):(n[X]=B,d[X]=B)}else{const B=m1(v,t,A+j,O),X=m1(v,t,A,A+j),_e=X>=0&&n[X];if(s&&!_e||!s&&!(B>=0&&n[B])){ko(In(g,d),l,v);const Ie=function OO(e,t,n,r,s){const d=new Gn(e,n,h,null);return d.multi=[],d.index=t,d.componentProviders=0,IE(d,s,r&&!n),d}(s?RO:kO,n.length,s,r,M);!s&&_e&&(n[X].providerFactory=Ie),g1(l,e,t.length,0),t.push(v),g.directiveStart++,g.directiveEnd++,s&&(g.providerIndexes+=1048576),n.push(Ie),d.push(Ie)}else g1(l,e,B>-1?B:X,IE(n[s?X:B],M,!s&&r));!s&&r&&_e&&n[X].componentProviders++}}}function g1(e,t,n,r){const s=(0,p.Y3W)(t),l=(0,p.MME)(t);if(s||l){const v=(l?(0,p.nl4)(t.useClass):t).prototype.ngOnDestroy;if(v){const M=e.destroyHooks||(e.destroyHooks=[]);if(!s&&t.multi){const A=M.indexOf(n);-1===A?M.push(n,[r,v]):M[A+1].push(r,v)}else M.push(n,v)}}}function IE(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function m1(e,t,n,r){for(let s=n;s<r;s++)if(t[s]===e)return s;return-1}function kO(e,t,n,r,s){return _1(this.multi,[])}function RO(e,t,n,r,s){const l=this.multi;let d;if(this.providerFactory){const g=this.providerFactory.componentProviders,v=pl(r,r[p.eDl],this.providerFactory.index,s);d=v.slice(0,g),_1(l,d);for(let M=g;M<v.length;M++)d.push(v[M])}else d=[],_1(l,d);return d}function _1(e,t){for(let n=0;n<e.length;n++)t.push((0,e[n])());return t}function If(e,t=[]){return n=>{n.providersResolver=(r,s)=>function PO(e,t,n){const r=(0,p.klJ)();if(r.firstCreatePass){const s=(0,p.JlV)(e);p1(n,r.data,r.blueprint,s,!0),p1(t,r.data,r.blueprint,s,!1)}}(r,s?s(e):e,t)}}function y1(e,t,n,r){return function AE(e,t,n,r,s,l){const d=t+n;return ze(e,d,s)?function Xe(e,t,n){return e[t]=n}(e,d+1,l?r.call(l,s):r(s)):function Vm(e,t){const n=e[t];return n===Hn?void 0:n}(e,d+1)}((0,p.OAn)(),(0,p.gxQ)(),e,t,n,r)}class DN{ngModuleFactory;componentFactories;constructor(t,n){this.ngModuleFactory=t,this.componentFactories=n}}let AN=(()=>{class e{compileModuleSync(n){return new Yw(n)}compileModuleAsync(n){return Promise.resolve(this.compileModuleSync(n))}compileModuleAndAllComponentsSync(n){const r=this.compileModuleSync(n),l=Fo((0,p.phH)(n).declarations).reduce((d,g)=>{const v=(0,p.xUg)(g);return v&&d.push(new _m(v)),d},[]);return new DN(r,l)}compileModuleAndAllComponentsAsync(n){return Promise.resolve(this.compileModuleAndAllComponentsSync(n))}clearCache(){}clearCacheFor(n){}getModuleId(n){}static \u0275fac=function(r){return new(r||e)};static \u0275prov=(0,p.jDH)({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),kN=(()=>{class e{zone=(0,p.WQX)(jn);changeDetectionScheduler=(0,p.WQX)(p.hk6);applicationRef=(0,p.WQX)(ch);applicationErrorHandler=(0,p.WQX)(p.ZTf);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(n){this.applicationErrorHandler(n)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=(0,p.jDH)({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function C1({ngZoneFactory:e,ignoreChangesOutsideZone:t,scheduleInRootZone:n}){return e??=()=>new jn({...S1(),scheduleInRootZone:n}),[{provide:jn,useFactory:e},{provide:p.Z63,multi:!0,useFactory:()=>{const r=(0,p.WQX)(kN,{optional:!0});return()=>r.initialize()}},{provide:p.Z63,multi:!0,useFactory:()=>{const r=(0,p.WQX)(ON);return()=>{r.initialize()}}},!0===t?{provide:p.Jy$,useValue:!0}:[],{provide:p.AQb,useValue:n??fC},{provide:p.ZTf,useFactory:()=>{const r=(0,p.WQX)(jn),s=(0,p.WQX)(p.uvJ);let l;return d=>{r.runOutsideAngular(()=>{s.destroyed&&!l?setTimeout(()=>{throw d}):(l??=s.get(p.zcH),l.handleError(d))})}}}]}function S1(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}let ON=(()=>{class e{subscription=new gn.yU;initialized=!1;zone=(0,p.WQX)(jn);pendingTasks=(0,p.WQX)(p.rev);initialize(){if(this.initialized)return;this.initialized=!0;let n=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(n=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{jn.assertNotInAngularZone(),queueMicrotask(()=>{null!==n&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(n),n=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{jn.assertInAngularZone(),n??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(r){return new(r||e)};static \u0275prov=(0,p.jDH)({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),M1=(()=>{class e{applicationErrorHandler=(0,p.WQX)(p.ZTf);appRef=(0,p.WQX)(ch);taskService=(0,p.WQX)(p.rev);ngZone=(0,p.WQX)(jn);zonelessEnabled=(0,p.WQX)(p.Evm);tracing=(0,p.WQX)(Mm,{optional:!0});disableScheduling=(0,p.WQX)(p.Jy$,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new gn.yU;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(k_):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&((0,p.WQX)(p.AQb,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Pb||!this.zoneIsDefined)}notify(n){if(!this.zonelessEnabled&&5===n)return;let r=!1;switch(n){case 0:this.appRef.dirtyFlags|=2;break;case 3:case 2:case 4:case 5:case 1:this.appRef.dirtyFlags|=4;break;case 6:case 13:this.appRef.dirtyFlags|=2,r=!0;break;case 12:this.appRef.dirtyFlags|=16,r=!0;break;case 11:r=!0;break;default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(r))return;const s=this.useMicrotaskScheduler?gC:pC;this.pendingRenderTaskId=this.taskService.add(),this.cancelScheduledCallback=this.scheduleInRootZone?Zone.root.run(()=>s(()=>this.tick())):this.ngZone.runOutsideAngular(()=>s(()=>this.tick()))}shouldScheduleTick(n){return!(this.disableScheduling&&!n||this.appRef.destroyed||null!==this.pendingRenderTaskId||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(k_+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(0===this.appRef.dirtyFlags)return void this.cleanup();!this.zonelessEnabled&&7&this.appRef.dirtyFlags&&(this.appRef.dirtyFlags|=1);const n=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){this.taskService.remove(n),this.applicationErrorHandler(r)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,gC(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(n)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,null!==this.pendingRenderTaskId){const n=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(n)}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=(0,p.jDH)({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const gh=new p.nKC("",{providedIn:"root",factory:()=>(0,p.WQX)(gh,{optional:!0,skipSelf:!0})||function LN(){return typeof $localize<"u"&&$localize.locale||q_}()}),ly=Symbol("InputSignalNode#UNSET"),rM={...Ge.s0,transformFn:void 0,applyValueToInputSignal(e,t){(0,Ge.j2)(e,t)}};function oM(e,t){const n=Object.create(rM);function r(){if((0,Ge.mK)(n),n.value===ly)throw new p.buA(-950,null);return n.value}return n.value=e,n.transformFn=t?.transform,r[Ge.bh]=n,r}function iM(e,t){return oM(e,t)}new p.nKC("").__NG_ELEMENT_ID__=e=>{const t=(0,p.Mx4)();if(null===t)throw new p.buA(204,!1);if(2&t.type)return t.value;if(8&e)return null;throw new p.buA(204,!1)};const mh=(iM.required=function WN(e){return oM(ly,e)},iM),cy=new p.nKC(""),XN=new p.nKC("");function $m(e){return!e.moduleRef}let dM,_h=null;function n4(e=[]){if(_h)return _h;const t=function gM(e=[],t){return p.zZn.create({name:t,providers:[{provide:p.GBX,useValue:"platform"},{provide:cy,useValue:new Set([()=>_h=null])},...e]})}(e);return _h=t,function LP(){(0,Ge.KO)(()=>{throw new p.buA(600,"")})}(),function mM(e){const t=e.get(Ls,null);(0,p.N4e)(e,()=>{t?.forEach(n=>n())})}(t),t}let uy=(()=>class e{static __NG_ELEMENT_ID__=r4})();function r4(e){return function o4(e,t,n){if((0,p.Qs1)(e)&&!n){const r=(0,p.KdJ)(e.index,t);return new Pr(r,r)}return 175&e.type?new Pr(t[p.b5C],t):null}((0,p.Mx4)(),(0,p.OAn)(),!(16&~e))}class xM{constructor(){}supports(t){return t instanceof Map||st(t)}create(){return new c4}}class c4{_records=new Map;_mapHead=null;_appendAfter=null;_previousMapHead=null;_changesHead=null;_changesTail=null;_additionsHead=null;_additionsTail=null;_removalsHead=null;_removalsTail=null;get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(t){let n;for(n=this._mapHead;null!==n;n=n._next)t(n)}forEachPreviousItem(t){let n;for(n=this._previousMapHead;null!==n;n=n._nextPrevious)t(n)}forEachChangedItem(t){let n;for(n=this._changesHead;null!==n;n=n._nextChanged)t(n)}forEachAddedItem(t){let n;for(n=this._additionsHead;null!==n;n=n._nextAdded)t(n)}forEachRemovedItem(t){let n;for(n=this._removalsHead;null!==n;n=n._nextRemoved)t(n)}diff(t){if(t){if(!(t instanceof Map||st(t)))throw new p.buA(900,!1)}else t=new Map;return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let n=this._mapHead;if(this._appendAfter=null,this._forEach(t,(r,s)=>{if(n&&n.key===s)this._maybeAddToChanges(n,r),this._appendAfter=n,n=n._next;else{const l=this._getOrCreateRecordForKey(s,r);n=this._insertBeforeOrAppend(n,l)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(let r=n;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,n){if(t){const r=t._prev;return n._next=t,n._prev=r,t._prev=n,r&&(r._next=n),t===this._mapHead&&(this._mapHead=n),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=n,n._prev=this._appendAfter):this._mapHead=n,this._appendAfter=n,null}_getOrCreateRecordForKey(t,n){if(this._records.has(t)){const s=this._records.get(t);this._maybeAddToChanges(s,n);const l=s._prev,d=s._next;return l&&(l._next=d),d&&(d._prev=l),s._next=null,s._prev=null,s}const r=new u4(t);return this._records.set(t,r),r.currentValue=n,this._addToAdditions(r),r}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;null!==t;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;null!==t;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;null!=t;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,n){Object.is(n,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=n,this._addToChanges(t))}_addToAdditions(t){null===this._additionsHead?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){null===this._changesHead?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,n){t instanceof Map?t.forEach(n):Object.keys(t).forEach(r=>n(t[r],r))}}class u4{key;previousValue=null;currentValue=null;_nextPrevious=null;_next=null;_prev=null;_nextAdded=null;_nextRemoved=null;_nextChanged=null;constructor(t){this.key=t}}function CM(){return new dy([new xM])}let dy=(()=>{class e{static \u0275prov=(0,p.jDH)({token:e,providedIn:"root",factory:CM});factories;constructor(n){this.factories=n}static create(n,r){if(r){const s=r.factories.slice();n=n.concat(s)}return new e(n)}static extend(n){return{provide:e,useFactory:r=>e.create(n,r||CM()),deps:[[e,new Nr,new li]]}}find(n){const r=this.factories.find(s=>s.supports(n));if(r)return r;throw new p.buA(901,!1)}}return e})();function Ss(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}function N4(e,t=NaN){return isNaN(parseFloat(e))||isNaN(Number(e))?t:Number(e)}const BM="browser";function zM(e){return e===BM}const B1=new p.nKC("");let KM=(()=>{class e{_zone;_plugins;_eventNameToPlugin=new Map;constructor(n,r){this._zone=r,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,r,s,l){return this._findPluginFor(r).addEventListener(n,r,s,l)}getZone(){return this._zone}_findPluginFor(n){let r=this._eventNameToPlugin.get(n);if(r)return r;if(r=this._plugins.find(l=>l.supports(n)),!r)throw new p.buA(5101,!1);return this._eventNameToPlugin.set(n,r),r}static \u0275fac=function(r){return new(r||e)(p.KVO(B1),p.KVO(jn))};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac})}return e})();class XM{_doc;constructor(t){this._doc=t}manager}const z1="ng-app-id";function QM(e){for(const t of e)t.remove()}function JM(e,t){const n=t.createElement("style");return n.textContent=e,n}function j1(e,t){const n=t.createElement("link");return n.setAttribute("rel","stylesheet"),n.setAttribute("href",e),n}let e2=(()=>{class e{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(n,r,s,l={}){this.doc=n,this.appId=r,this.nonce=s,function _L(e,t,n,r){const s=e.head?.querySelectorAll(`style[${z1}="${t}"],link[${z1}="${t}"]`);if(s)for(const l of s)l.removeAttribute(z1),l instanceof HTMLLinkElement?r.set(l.href.slice(l.href.lastIndexOf("/")+1),{usage:0,elements:[l]}):l.textContent&&n.set(l.textContent,{usage:0,elements:[l]})}(n,r,this.inline,this.external),this.hosts.add(n.head)}addStyles(n,r){for(const s of n)this.addUsage(s,this.inline,JM);r?.forEach(s=>this.addUsage(s,this.external,j1))}removeStyles(n,r){for(const s of n)this.removeUsage(s,this.inline);r?.forEach(s=>this.removeUsage(s,this.external))}addUsage(n,r,s){const l=r.get(n);l?l.usage++:r.set(n,{usage:1,elements:[...this.hosts].map(d=>this.addElement(d,s(n,this.doc)))})}removeUsage(n,r){const s=r.get(n);s&&(s.usage--,s.usage<=0&&(QM(s.elements),r.delete(n)))}ngOnDestroy(){for(const[,{elements:n}]of[...this.inline,...this.external])QM(n);this.hosts.clear()}addHost(n){this.hosts.add(n);for(const[r,{elements:s}]of this.inline)s.push(this.addElement(n,JM(r,this.doc)));for(const[r,{elements:s}]of this.external)s.push(this.addElement(n,j1(r,this.doc)))}removeHost(n){this.hosts.delete(n)}addElement(n,r){return this.nonce&&r.setAttribute("nonce",this.nonce),n.appendChild(r)}static \u0275fac=function(r){return new(r||e)(p.KVO(p.qQL),p.KVO(za),p.KVO(kh,8),p.KVO(Fs))};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac})}return e})();const V1={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},U1=/%COMP%/g,CL=new p.nKC("",{providedIn:"root",factory:()=>!0});function n2(e,t){return t.map(n=>n.replace(U1,e))}let G1=(()=>{class e{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;animationDisabled;maxAnimationTimeout;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;registry;constructor(n,r,s,l,d,g,v,M=null,A,O,j=null){this.eventManager=n,this.sharedStylesHost=r,this.appId=s,this.removeStylesOnCompDestroy=l,this.doc=d,this.platformId=g,this.ngZone=v,this.nonce=M,this.animationDisabled=A,this.maxAnimationTimeout=O,this.tracingService=j,this.platformIsServer=!1,this.defaultRenderer=new $1(n,d,v,this.platformIsServer,this.tracingService,this.registry=(0,p.kRk)(),this.maxAnimationTimeout)}createRenderer(n,r){if(!n||!r)return this.defaultRenderer;const s=this.getOrCreateRenderer(n,r);return s instanceof o2?s.applyToHost(n):s instanceof H1&&s.applyStyles(),s}getOrCreateRenderer(n,r){const s=this.rendererByCompId;let l=s.get(r.id);if(!l){const d=this.doc,g=this.ngZone,v=this.eventManager,M=this.sharedStylesHost,A=this.removeStylesOnCompDestroy,O=this.platformIsServer,j=this.tracingService;switch(r.encapsulation){case ri.Emulated:l=new o2(v,M,r,this.appId,A,d,g,O,j,this.registry,this.animationDisabled,this.maxAnimationTimeout);break;case ri.ShadowDom:return new TL(v,M,n,r,d,g,this.nonce,O,j,this.registry,this.maxAnimationTimeout);default:l=new H1(v,M,r,A,d,g,O,j,this.registry,this.animationDisabled,this.maxAnimationTimeout)}s.set(r.id,l)}return l}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(n){this.rendererByCompId.delete(n)}static \u0275fac=function(r){return new(r||e)(p.KVO(KM),p.KVO(e2),p.KVO(za),p.KVO(CL),p.KVO(p.qQL),p.KVO(Fs),p.KVO(jn),p.KVO(kh),p.KVO(aS),p.KVO(bk),p.KVO(Mm,8))};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac})}return e})();class $1{eventManager;doc;ngZone;platformIsServer;tracingService;registry;maxAnimationTimeout;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,n,r,s,l,d,g){this.eventManager=t,this.doc=n,this.ngZone=r,this.platformIsServer=s,this.tracingService=l,this.registry=d,this.maxAnimationTimeout=g}destroy(){}destroyNode=null;createElement(t,n){return n?this.doc.createElementNS(V1[n]||n,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,n){(r2(t)?t.content:t).appendChild(n)}insertBefore(t,n,r){t&&(r2(t)?t.content:t).insertBefore(n,r)}removeChild(t,n){const{elements:r}=this.registry;r?r.animate(n,()=>n.remove(),this.maxAnimationTimeout):n.remove()}selectRootElement(t,n){let r="string"==typeof t?this.doc.querySelector(t):t;if(!r)throw new p.buA(-5104,!1);return n||(r.textContent=""),r}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,n,r,s){if(s){n=s+":"+n;const l=V1[s];l?t.setAttributeNS(l,n,r):t.setAttribute(n,r)}else t.setAttribute(n,r)}removeAttribute(t,n,r){if(r){const s=V1[r];s?t.removeAttributeNS(s,n):t.removeAttribute(`${r}:${n}`)}else t.removeAttribute(n)}addClass(t,n){t.classList.add(n)}removeClass(t,n){t.classList.remove(n)}setStyle(t,n,r,s){s&(qs.DashCase|qs.Important)?t.style.setProperty(n,r,s&qs.Important?"important":""):t.style[n]=r}removeStyle(t,n,r){r&qs.DashCase?t.style.removeProperty(n):t.style[n]=""}setProperty(t,n,r){null!=t&&(t[n]=r)}setValue(t,n){t.nodeValue=n}listen(t,n,r,s){if("string"==typeof t&&!(t=y().getGlobalEventTarget(this.doc,t)))throw new p.buA(5102,!1);let l=this.decoratePreventDefault(r);return this.tracingService?.wrapEventListener&&(l=this.tracingService.wrapEventListener(t,n,l)),this.eventManager.addEventListener(t,n,l,s)}decoratePreventDefault(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&n.preventDefault()}}}function r2(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class TL extends $1{sharedStylesHost;hostEl;shadowRoot;constructor(t,n,r,s,l,d,g,v,M,A,O){super(t,l,d,v,M,A,O),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let j=s.styles;j=n2(s.id,j);for(const X of j){const le=document.createElement("style");g&&le.setAttribute("nonce",g),le.textContent=X,this.shadowRoot.appendChild(le)}const B=s.getExternalStyles?.();if(B)for(const X of B){const le=j1(X,l);g&&le.setAttribute("nonce",g),this.shadowRoot.appendChild(le)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,n){return super.appendChild(this.nodeOrShadowRoot(t),n)}insertBefore(t,n,r){return super.insertBefore(this.nodeOrShadowRoot(t),n,r)}removeChild(t,n){return super.removeChild(null,n)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class H1 extends $1{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;_animationDisabled;constructor(t,n,r,s,l,d,g,v,M,A,O,j){super(t,l,d,g,v,M,O),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=s,this._animationDisabled=A;let B=r.styles;this.styles=j?n2(j,B):B,this.styleUrls=r.getExternalStyles?.(j)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){if(this.removeStylesOnCompDestroy){if(!this._animationDisabled&&this.registry.elements)return void this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)},this.maxAnimationTimeout)});this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}}}class o2 extends H1{contentAttr;hostAttr;constructor(t,n,r,s,l,d,g,v,M,A,O,j){const B=s+"-"+r.id;super(t,n,r,l,d,g,v,M,A,O,j,B),this.contentAttr=function SL(e){return"_ngcontent-%COMP%".replace(U1,e)}(B),this.hostAttr=function EL(e){return"_nghost-%COMP%".replace(U1,e)}(B)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,n){const r=super.createElement(t,n);return super.setAttribute(r,this.contentAttr,""),r}}class W1 extends En{supportsDOMEvents=!0;static makeCurrent(){!function Ye(e){W??=e}(new W1)}onAndCancel(t,n,r,s){return t.addEventListener(n,r,s),()=>{t.removeEventListener(n,r,s)}}dispatchEvent(t,n){t.dispatchEvent(n)}remove(t){t.remove()}createElement(t,n){return(n=n||this.getDefaultDocument()).createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,n){return"window"===n?window:"document"===n?t:"body"===n?t.body:null}getBaseHref(t){const n=function IL(){return Ym=Ym||document.head.querySelector("base"),Ym?Ym.getAttribute("href"):null}();return null==n?null:function DL(e){return new URL(e,document.baseURI).pathname}(n)}resetBaseElement(){Ym=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return function Cn(e,t){t=encodeURIComponent(t);for(const n of e.split(";")){const r=n.indexOf("="),[s,l]=-1==r?[n,""]:[n.slice(0,r),n.slice(r+1)];if(s.trim()===t)return decodeURIComponent(l)}return null}(document.cookie,t)}}let Ym=null,PL=(()=>{class e{build(){return new XMLHttpRequest}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac})}return e})(),kL=(()=>{class e extends XM{constructor(n){super(n)}supports(n){return!0}addEventListener(n,r,s,l){return n.addEventListener(r,s,l),()=>this.removeEventListener(n,r,s,l)}removeEventListener(n,r,s,l){return n.removeEventListener(r,s,l)}static \u0275fac=function(r){return new(r||e)(p.KVO(p.qQL))};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac})}return e})();const i2=["alt","control","meta","shift"],RL={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},OL={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let NL=(()=>{class e extends XM{constructor(n){super(n)}supports(n){return null!=e.parseEventName(n)}addEventListener(n,r,s,l){const d=e.parseEventName(r),g=e.eventCallback(d.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>y().onAndCancel(n,d.domEventName,g,l))}static parseEventName(n){const r=n.toLowerCase().split("."),s=r.shift();if(0===r.length||"keydown"!==s&&"keyup"!==s)return null;const l=e._normalizeKey(r.pop());let d="",g=r.indexOf("code");if(g>-1&&(r.splice(g,1),d="code."),i2.forEach(M=>{const A=r.indexOf(M);A>-1&&(r.splice(A,1),d+=M+".")}),d+=l,0!=r.length||0===l.length)return null;const v={};return v.domEventName=s,v.fullKey=d,v}static matchEventFullKeyCode(n,r){let s=RL[n.key]||n.key,l="";return r.indexOf("code.")>-1&&(s=n.code,l="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),i2.forEach(d=>{d!==s&&(0,OL[d])(n)&&(l+=d+".")}),l+=s,l===r)}static eventCallback(n,r,s){return l=>{e.matchEventFullKeyCode(l,n)&&s.runGuarded(()=>r(l))}}static _normalizeKey(n){return"esc"===n?"escape":n}static \u0275fac=function(r){return new(r||e)(p.KVO(p.qQL))};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac})}return e})();function s2(e){return{appProviders:[...UL,...e?.providers??[]],platformProviders:jL}}const jL=[{provide:Fs,useValue:BM},{provide:Ls,useValue:function FL(){W1.makeCurrent()},multi:!0},{provide:p.qQL,useFactory:function zL(){return function Cl(e){wl=e}(document),document}}],UL=[{provide:p.GBX,useValue:"root"},{provide:p.zcH,useFactory:function BL(){return new p.zcH}},{provide:B1,useClass:kL,multi:!0,deps:[p.qQL]},{provide:B1,useClass:NL,multi:!0,deps:[p.qQL]},G1,e2,KM,{provide:uf,useExisting:G1},{provide:class Nt{},useClass:PL},[]];function Xo(e){return function WL(e){const t=(0,Ge.Ht)(null);try{return e()}finally{(0,Ge.Ht)(t)}}(e)}class qL{[Ge.bh];constructor(t){this[Ge.bh]=t}destroy(){this[Ge.bh].destroy()}}function vy(e,t){const n=t?.injector??(0,p.WQX)(p.zZn);let s,r=!0!==t?.manualCleanup?n.get(p.abz):null;const l=n.get(p.r4V,null,{optional:!0}),d=n.get(p.hk6);return null!==l?(s=function KL(e,t,n){const r=Object.create(YL);return r.view=e,r.zone=typeof Zone<"u"?Zone.current:null,r.notifier=t,r.fn=n,e[p.tQN]??=new Set,e[p.tQN].add(r),r.consumerMarkedDirty(r),r}(l.view,d,e),r instanceof p.KXn&&r._lView===l.view&&(r=null)):s=function XL(e,t,n){const r=Object.create(ZL);return r.fn=e,r.scheduler=t,r.notifier=n,r.zone=typeof Zone<"u"?Zone.current:null,r.scheduler.add(r),r.notifier.notify(12),r}(e,n.get(p.VML),d),s.injector=n,null!==r&&(s.onDestroyFn=r.onDestroy(()=>s.destroy())),new qL(s)}const l2={...Ge.pL,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!0,dirty:!0,hasRun:!1,cleanupFns:void 0,zone:null,kind:"effect",onDestroyFn:p.lQ1,run(){if(this.dirty=!1,this.hasRun&&!(0,Ge.si)(this))return;this.hasRun=!0;const e=r=>(this.cleanupFns??=[]).push(r),t=(0,Ge.Bg)(this),n=(0,p.cBl)(!1);try{this.maybeCleanup(),this.fn(e)}finally{(0,p.cBl)(n),(0,Ge.Wu)(this,t)}},maybeCleanup(){if(!this.cleanupFns?.length)return;const e=(0,Ge.Ht)(null);try{for(;this.cleanupFns.length;)this.cleanupFns.pop()()}finally{this.cleanupFns=[],(0,Ge.Ht)(e)}}},ZL={...l2,consumerMarkedDirty(){this.scheduler.schedule(this),this.notifier.notify(12)},destroy(){(0,Ge.XR)(this),this.onDestroyFn(),this.maybeCleanup(),this.scheduler.remove(this)}},YL={...l2,consumerMarkedDirty(){this.view[p.Wg1]|=8192,(0,p.blu)(this.view),this.notifier.notify(13)},destroy(){(0,Ge.XR)(this),this.onDestroyFn(),this.maybeCleanup(),this.view[p.tQN]?.delete(this)}};Error,Error;var Xi=dt(985);function yh(e){return this instanceof yh?(this.v=e,this):new yh(e)}function _2(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,t=e[Symbol.asyncIterator];return t?t.call(e):(e=function X1(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(l){n[l]=e[l]&&function(d){return new Promise(function(g,v){!function s(l,d,g,v){Promise.resolve(v).then(function(M){l({value:M,done:g})},d)}(g,v,(d=e[l](d)).done,d.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const y2=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function v2(e){return(0,cr.T)(e?.then)}var b2=dt(494);function x2(e){return(0,cr.T)(e[b2.s])}function w2(e){return Symbol.asyncIterator&&(0,cr.T)(e?.[Symbol.asyncIterator])}function C2(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const S2=function R5(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function E2(e){return(0,cr.T)(e?.[S2])}function M2(e){return function m2(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,r=n.apply(e,t||[]),l=[];return s=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),g("next"),g("throw"),g("return",function d(B){return function(X){return Promise.resolve(X).then(B,O)}}),s[Symbol.asyncIterator]=function(){return this},s;function g(B,X){r[B]&&(s[B]=function(le){return new Promise(function(_e,Ie){l.push([B,le,_e,Ie])>1||v(B,le)})},X&&(s[B]=X(s[B])))}function v(B,X){try{!function M(B){B.value instanceof yh?Promise.resolve(B.value.v).then(A,O):j(l[0][2],B)}(r[B](X))}catch(le){j(l[0][3],le)}}function A(B){v("next",B)}function O(B){v("throw",B)}function j(B,X){B(X),l.shift(),l.length&&v(l[0][0],l[0][1])}}(this,arguments,function*(){const n=e.getReader();try{for(;;){const{value:r,done:s}=yield yh(n.read());if(s)return yield yh(void 0);yield yield yh(r)}}finally{n.releaseLock()}})}function T2(e){return(0,cr.T)(e?.getReader)}var O5=dt(334);function Xu(e){if(e instanceof Xi.c)return e;if(null!=e){if(x2(e))return function N5(e){return new Xi.c(t=>{const n=e[b2.s]();if((0,cr.T)(n.subscribe))return n.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(y2(e))return function L5(e){return new Xi.c(t=>{for(let n=0;n<e.length&&!t.closed;n++)t.next(e[n]);t.complete()})}(e);if(v2(e))return function F5(e){return new Xi.c(t=>{e.then(n=>{t.closed||(t.next(n),t.complete())},n=>t.error(n)).then(null,O5.m)})}(e);if(w2(e))return I2(e);if(E2(e))return function B5(e){return new Xi.c(t=>{for(const n of e)if(t.next(n),t.closed)return;t.complete()})}(e);if(T2(e))return function z5(e){return I2(M2(e))}(e)}throw C2(e)}function I2(e){return new Xi.c(t=>{(function j5(e,t){var n,r,s,l;return function p2(e,t,n,r){return new(n||(n=Promise))(function(l,d){function g(A){try{M(r.next(A))}catch(O){d(O)}}function v(A){try{M(r.throw(A))}catch(O){d(O)}}function M(A){A.done?l(A.value):function s(l){return l instanceof n?l:new n(function(d){d(l)})}(A.value).then(g,v)}M((r=r.apply(e,t||[])).next())})}(this,void 0,void 0,function*(){try{for(n=_2(e);!(r=yield n.next()).done;)if(t.next(r.value),t.closed)return}catch(d){s={error:d}}finally{try{r&&!r.done&&(l=n.return)&&(yield l.call(n))}finally{if(s)throw s.error}}t.complete()})})(e,t).catch(n=>t.error(n))})}function Qu(e,t,n,r=0,s=!1){const l=t.schedule(function(){n(),s?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(l),!s)return l}function D2(e,t=0){return Wn((n,r)=>{n.subscribe(Vn(r,s=>Qu(r,e,()=>r.next(s),t),()=>Qu(r,e,()=>r.complete(),t),s=>Qu(r,e,()=>r.error(s),t)))})}function A2(e,t=0){return Wn((n,r)=>{r.add(e.schedule(()=>n.subscribe(r),t))})}function P2(e,t){if(!e)throw new Error("Iterable cannot be null");return new Xi.c(n=>{Qu(n,t,()=>{const r=e[Symbol.asyncIterator]();Qu(n,t,()=>{r.next().then(s=>{s.done?n.complete():n.next(s.value)})},0,!0)})})}function Es(e,t){return t?function W5(e,t){if(null!=e){if(x2(e))return function V5(e,t){return Xu(e).pipe(A2(t),D2(t))}(e,t);if(y2(e))return function G5(e,t){return new Xi.c(n=>{let r=0;return t.schedule(function(){r===e.length?n.complete():(n.next(e[r++]),n.closed||this.schedule())})})}(e,t);if(v2(e))return function U5(e,t){return Xu(e).pipe(A2(t),D2(t))}(e,t);if(w2(e))return P2(e,t);if(E2(e))return function $5(e,t){return new Xi.c(n=>{let r;return Qu(n,t,()=>{r=e[S2](),Qu(n,t,()=>{let s,l;try{({value:s,done:l}=r.next())}catch(d){return void n.error(d)}l?n.complete():n.next(s)},0,!0)}),()=>(0,cr.T)(r?.return)&&r.return()})}(e,t);if(T2(e))return function H5(e,t){return P2(M2(e),t)}(e,t)}throw C2(e)}(e,t):Xu(e)}function J1(e){return e[e.length-1]}function by(e){return function q5(e){return e&&(0,cr.T)(e.schedule)}(J1(e))?e.pop():void 0}function hn(...e){return Es(e,by(e))}var Xl=dt(412);const xy=(0,dt(853).L)(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:K5}=Array,{getPrototypeOf:X5,prototype:Q5,keys:J5}=Object;var eg=dt(669);const{isArray:nF}=Array;function k2(...e){const t=by(e),n=function Z5(e){return(0,cr.T)(J1(e))?e.pop():void 0}(e),{args:r,keys:s}=function eF(e){if(1===e.length){const t=e[0];if(K5(t))return{args:t,keys:null};if(function tF(e){return e&&"object"==typeof e&&X5(e)===Q5}(t)){const n=J5(t);return{args:n.map(r=>t[r]),keys:n}}}return{args:e,keys:null}}(e);if(0===r.length)return Es([],t);const l=new Xi.c(function sF(e,t,n=eg.D){return r=>{R2(t,()=>{const{length:s}=e,l=new Array(s);let d=s,g=s;for(let v=0;v<s;v++)R2(t,()=>{const M=Es(e[v],t);let A=!1;M.subscribe(Vn(r,O=>{l[v]=O,A||(A=!0,g--),g||r.next(n(l.slice()))},()=>{--d||r.complete()}))},r)},r)}}(r,t,s?d=>function iF(e,t){return e.reduce((n,r,s)=>(n[r]=t[s],n),{})}(s,d):eg.D));return n?l.pipe(function oF(e){return fn(t=>function rF(e,t){return nF(t)?e(...t):e(t)}(e,t))}(n)):l}function R2(e,t,n){e?Qu(n,e,t):t()}function Ms(e,t,n=1/0){return(0,cr.T)(t)?Ms((r,s)=>fn((l,d)=>t(r,l,s,d))(Xu(e(r,s))),n):("number"==typeof t&&(n=t),Wn((r,s)=>function aF(e,t,n,r,s,l,d,g){const v=[];let M=0,A=0,O=!1;const j=()=>{O&&!v.length&&!M&&t.complete()},B=le=>M<r?X(le):v.push(le),X=le=>{l&&t.next(le),M++;let _e=!1;Xu(n(le,A++)).subscribe(Vn(t,Ie=>{s?.(Ie),l?B(Ie):t.next(Ie)},()=>{_e=!0},void 0,()=>{if(_e)try{for(M--;v.length&&M<r;){const Ie=v.shift();d?Qu(t,d,()=>X(Ie)):X(Ie)}j()}catch(Ie){t.error(Ie)}}))};return e.subscribe(Vn(t,B,()=>{O=!0,j()})),()=>{g?.()}}(r,s,e,n)))}function tx(...e){return function lF(){return function ex(e=1/0){return Ms(eg.D,e)}(1)}()(Es(e,by(e)))}function nx(e){return new Xi.c(t=>{Xu(e()).subscribe(t)})}var cF=dt(203);function wy(e,t){const n=(0,cr.T)(e)?e:()=>e,r=s=>s.error(n());return new Xi.c(t?s=>t.schedule(r,0,s):r)}const Ql=new Xi.c(e=>e.complete());function rx(){return Wn((e,t)=>{let n=null;e._refCount++;const r=Vn(t,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(n=null);const s=e._connection,l=n;n=null,s&&(!l||s===l)&&s.unsubscribe(),t.unsubscribe()});e.subscribe(r),r.closed||(n=e.connect())})}class O2 extends Xi.c{constructor(t,n){super(),this.source=t,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Sr(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){const t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new gn.yU;const n=this.getSubject();t.add(this.source.subscribe(Vn(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),t.closed&&(this._connection=null,t=gn.yU.EMPTY)}return t}refCount(){return rx()(this)}}function al(e,t){return Wn((n,r)=>{let s=null,l=0,d=!1;const g=()=>d&&!s&&r.complete();n.subscribe(Vn(r,v=>{s?.unsubscribe();let M=0;const A=l++;Xu(e(v,A)).subscribe(s=Vn(r,O=>r.next(t?t(v,O,A,M++):O),()=>{s=null,g()}))},()=>{d=!0,g()}))})}function tg(e){return e<=0?()=>Ql:Wn((t,n)=>{let r=0;t.subscribe(Vn(n,s=>{++r<=e&&(n.next(s),e<=r&&n.complete())}))})}function vh(e,t){return Wn((n,r)=>{let s=0;n.subscribe(Vn(r,l=>e.call(t,l,s++)&&r.next(l)))})}function Cy(e){return Wn((t,n)=>{let r=!1;t.subscribe(Vn(n,s=>{r=!0,n.next(s)},()=>{r||n.next(e),n.complete()}))})}function N2(e=hF){return Wn((t,n)=>{let r=!1;t.subscribe(Vn(n,s=>{r=!0,n.next(s)},()=>r?n.complete():n.error(e())))})}function hF(){return new xy}function Af(e,t){const n=arguments.length>=2;return r=>r.pipe(e?vh((s,l)=>e(s,l,r)):eg.D,tg(1),n?Cy(t):N2(()=>new xy))}function Sy(e,t){return(0,cr.T)(t)?Ms(e,t,1):Ms(e,1)}function Qi(e,t,n){const r=(0,cr.T)(e)||t||n?{next:e,error:t,complete:n}:e;return r?Wn((s,l)=>{var d;null===(d=r.subscribe)||void 0===d||d.call(r);let g=!0;s.subscribe(Vn(l,v=>{var M;null===(M=r.next)||void 0===M||M.call(r,v),l.next(v)},()=>{var v;g=!1,null===(v=r.complete)||void 0===v||v.call(r),l.complete()},v=>{var M;g=!1,null===(M=r.error)||void 0===M||M.call(r,v),l.error(v)},()=>{var v,M;g&&(null===(v=r.unsubscribe)||void 0===v||v.call(r)),null===(M=r.finalize)||void 0===M||M.call(r)}))}):eg.D}function ng(e){return Wn((t,n)=>{let l,r=null,s=!1;r=t.subscribe(Vn(n,void 0,void 0,d=>{l=Xu(e(d,ng(e)(t))),r?(r.unsubscribe(),r=null,l.subscribe(n)):s=!0})),s&&(r.unsubscribe(),r=null,l.subscribe(n))})}function ox(e){return e<=0?()=>Ql:Wn((t,n)=>{let r=[];t.subscribe(Vn(n,s=>{r.push(s),e<r.length&&r.shift()},()=>{for(const s of r)n.next(s);n.complete()},void 0,()=>{r=null}))})}function ix(e){return Wn((t,n)=>{try{t.subscribe(n)}finally{n.add(e)}})}var mF=dt(343);function L2(e){return Wn((t,n)=>{Xu(e).subscribe(Vn(n,()=>n.complete(),mF.l)),!n.closed&&t.subscribe(n)})}let _F=(()=>{class e{_doc;constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static \u0275fac=function(r){return new(r||e)(p.KVO(p.qQL))};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const mn="primary",Xm=Symbol("RouteTitle");class xF{params;constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n[0]:n}return null}getAll(t){if(this.has(t)){const n=this.params[t];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function rg(e){return new xF(e)}function wF(e,t,n){const r=n.path.split("/");if(r.length>e.length||"full"===n.pathMatch&&(t.hasChildren()||r.length<e.length))return null;const s={};for(let l=0;l<r.length;l++){const d=r[l],g=e[l];if(":"===d[0])s[d.substring(1)]=g;else if(d!==g.path)return null}return{consumed:e.slice(0,r.length),posParams:s}}function Xc(e,t){const n=e?sx(e):void 0,r=t?sx(t):void 0;if(!n||!r||n.length!=r.length)return!1;let s;for(let l=0;l<n.length;l++)if(s=n[l],!z2(e[s],t[s]))return!1;return!0}function sx(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function z2(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;const n=[...e].sort(),r=[...t].sort();return n.every((s,l)=>r[l]===s)}return e===t}function j2(e){return e.length>0?e[e.length-1]:null}function Ju(e){return function s5(e){return!!e&&(e instanceof Xi.c||(0,cr.T)(e.lift)&&(0,cr.T)(e.subscribe))}(e)?e:B_(e)?Es(Promise.resolve(e)):hn(e)}const SF={exact:function G2(e,t,n){if(!kf(e.segments,t.segments)||!Ey(e.segments,t.segments,n)||e.numberOfChildren!==t.numberOfChildren)return!1;for(const r in t.children)if(!e.children[r]||!G2(e.children[r],t.children[r],n))return!1;return!0},subset:$2},V2={exact:function EF(e,t){return Xc(e,t)},subset:function MF(e,t){return Object.keys(t).length<=Object.keys(e).length&&Object.keys(t).every(n=>z2(e[n],t[n]))},ignored:()=>!0};function U2(e,t,n){return SF[n.paths](e.root,t.root,n.matrixParams)&&V2[n.queryParams](e.queryParams,t.queryParams)&&!("exact"===n.fragment&&e.fragment!==t.fragment)}function $2(e,t,n){return H2(e,t,t.segments,n)}function H2(e,t,n,r){if(e.segments.length>n.length){const s=e.segments.slice(0,n.length);return!(!kf(s,n)||t.hasChildren()||!Ey(s,n,r))}if(e.segments.length===n.length){if(!kf(e.segments,n)||!Ey(e.segments,n,r))return!1;for(const s in t.children)if(!e.children[s]||!$2(e.children[s],t.children[s],r))return!1;return!0}{const s=n.slice(0,e.segments.length),l=n.slice(e.segments.length);return!!(kf(e.segments,s)&&Ey(e.segments,s,r)&&e.children[mn])&&H2(e.children[mn],t,l,r)}}function Ey(e,t,n){return t.every((r,s)=>V2[n](e[s].parameters,r.parameters))}class Pf{root;queryParams;fragment;_queryParamMap;constructor(t=new mr([],{}),n={},r=null){this.root=t,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=rg(this.queryParams),this._queryParamMap}toString(){return DF.serialize(this)}}class mr{segments;children;parent=null;constructor(t,n){this.segments=t,this.children=n,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Iy(this)}}class Qm{path;parameters;_parameterMap;constructor(t,n){this.path=t,this.parameters=n}get parameterMap(){return this._parameterMap??=rg(this.parameters),this._parameterMap}toString(){return Z2(this)}}function kf(e,t){return e.length===t.length&&e.every((n,r)=>n.path===t[r].path)}let My=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:()=>new Ty,providedIn:"root"})}return e})();class Ty{parse(t){const n=new jF(t);return new Pf(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(t){const n=`/${Jm(t.root,!0)}`,r=function kF(e){const t=Object.entries(e).map(([n,r])=>Array.isArray(r)?r.map(s=>`${Dy(n)}=${Dy(s)}`).join("&"):`${Dy(n)}=${Dy(r)}`).filter(n=>n);return t.length?`?${t.join("&")}`:""}(t.queryParams);return`${n}${r}${"string"==typeof t.fragment?`#${function AF(e){return encodeURI(e)}(t.fragment)}`:""}`}}const DF=new Ty;function Iy(e){return e.segments.map(t=>Z2(t)).join("/")}function Jm(e,t){if(!e.hasChildren())return Iy(e);if(t){const n=e.children[mn]?Jm(e.children[mn],!1):"",r=[];return Object.entries(e.children).forEach(([s,l])=>{s!==mn&&r.push(`${s}:${Jm(l,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}{const n=function IF(e,t){let n=[];return Object.entries(e.children).forEach(([r,s])=>{r===mn&&(n=n.concat(t(s,r)))}),Object.entries(e.children).forEach(([r,s])=>{r!==mn&&(n=n.concat(t(s,r)))}),n}(e,(r,s)=>s===mn?[Jm(e.children[mn],!1)]:[`${s}:${Jm(r,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[mn]?`${Iy(e)}/${n[0]}`:`${Iy(e)}/(${n.join("//")})`}}function W2(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Dy(e){return W2(e).replace(/%3B/gi,";")}function ax(e){return W2(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Ay(e){return decodeURIComponent(e)}function q2(e){return Ay(e.replace(/\+/g,"%20"))}function Z2(e){return`${ax(e.path)}${function PF(e){return Object.entries(e).map(([t,n])=>`;${ax(t)}=${ax(n)}`).join("")}(e.parameters)}`}const RF=/^[^\/()?;#]+/;function lx(e){const t=e.match(RF);return t?t[0]:""}const OF=/^[^\/()?;=#]+/,LF=/^[^=?&#]+/,BF=/^[^&#]+/;class jF{url;remaining;constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new mr([],{}):new mr([],this.parseChildren())}parseQueryParams(){const t={};if(this.consumeOptional("?"))do{this.parseQueryParam(t)}while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(t.length>0||Object.keys(n).length>0)&&(r[mn]=new mr(t,n)),r}parseSegment(){const t=lx(this.remaining);if(""===t&&this.peekStartsWith(";"))throw new p.buA(4009,!1);return this.capture(t),new Qm(Ay(t),this.parseMatrixParams())}parseMatrixParams(){const t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){const n=function NF(e){const t=e.match(OF);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const s=lx(this.remaining);s&&(r=s,this.capture(r))}t[Ay(n)]=Ay(r)}parseQueryParam(t){const n=function FF(e){const t=e.match(LF);return t?t[0]:""}(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){const d=function zF(e){const t=e.match(BF);return t?t[0]:""}(this.remaining);d&&(r=d,this.capture(r))}const s=q2(n),l=q2(r);if(t.hasOwnProperty(s)){let d=t[s];Array.isArray(d)||(d=[d],t[s]=d),d.push(l)}else t[s]=l}parseParens(t){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=lx(this.remaining),s=this.remaining[r.length];if("/"!==s&&")"!==s&&";"!==s)throw new p.buA(4010,!1);let l;r.indexOf(":")>-1?(l=r.slice(0,r.indexOf(":")),this.capture(l),this.capture(":")):t&&(l=mn);const d=this.parseChildren();n[l]=1===Object.keys(d).length?d[mn]:new mr([],d),this.consumeOptional("//")}return n}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return!!this.peekStartsWith(t)&&(this.remaining=this.remaining.substring(t.length),!0)}capture(t){if(!this.consumeOptional(t))throw new p.buA(4011,!1)}}function Y2(e){return e.segments.length>0?new mr([],{[mn]:e}):e}function K2(e){const t={};for(const[r,s]of Object.entries(e.children)){const l=K2(s);if(r===mn&&0===l.segments.length&&l.hasChildren())for(const[d,g]of Object.entries(l.children))t[d]=g;else(l.segments.length>0||l.hasChildren())&&(t[r]=l)}return function VF(e){if(1===e.numberOfChildren&&e.children[mn]){const t=e.children[mn];return new mr(e.segments.concat(t.segments),t.children)}return e}(new mr(e.segments,t))}function Rf(e){return e instanceof Pf}function X2(e){let t;const s=Y2(function n(l){const d={};for(const v of l.children){const M=n(v);d[v.outlet]=M}const g=new mr(l.url,d);return l===e&&(t=g),g}(e.root));return t??s}function Q2(e,t,n,r){let s=e;for(;s.parent;)s=s.parent;if(0===t.length)return cx(s,s,s,n,r);const l=function GF(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new eT(!0,0,e);let t=0,n=!1;const r=e.reduce((s,l,d)=>{if("object"==typeof l&&null!=l){if(l.outlets){const g={};return Object.entries(l.outlets).forEach(([v,M])=>{g[v]="string"==typeof M?M.split("/"):M}),[...s,{outlets:g}]}if(l.segmentPath)return[...s,l.segmentPath]}return"string"!=typeof l?[...s,l]:0===d?(l.split("/").forEach((g,v)=>{0==v&&"."===g||(0==v&&""===g?n=!0:".."===g?t++:""!=g&&s.push(g))}),s):[...s,l]},[]);return new eT(n,t,r)}(t);if(l.toRoot())return cx(s,s,new mr([],{}),n,r);const d=function $F(e,t,n){if(e.isAbsolute)return new ky(t,!0,0);if(!n)return new ky(t,!1,NaN);if(null===n.parent)return new ky(n,!0,0);const r=Py(e.commands[0])?0:1;return function HF(e,t,n){let r=e,s=t,l=n;for(;l>s;){if(l-=s,r=r.parent,!r)throw new p.buA(4005,!1);s=r.segments.length}return new ky(r,!1,s-l)}(n,n.segments.length-1+r,e.numberOfDoubleDots)}(l,s,e),g=d.processChildren?t0(d.segmentGroup,d.index,l.commands):tT(d.segmentGroup,d.index,l.commands);return cx(s,d.segmentGroup,g,n,r)}function Py(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function e0(e){return"object"==typeof e&&null!=e&&e.outlets}function cx(e,t,n,r,s){let d,l={};r&&Object.entries(r).forEach(([v,M])=>{l[v]=Array.isArray(M)?M.map(A=>`${A}`):`${M}`}),d=e===t?n:J2(e,t,n);const g=Y2(K2(d));return new Pf(g,l,s)}function J2(e,t,n){const r={};return Object.entries(e.children).forEach(([s,l])=>{r[s]=l===t?n:J2(l,t,n)}),new mr(e.segments,r)}class eT{isAbsolute;numberOfDoubleDots;commands;constructor(t,n,r){if(this.isAbsolute=t,this.numberOfDoubleDots=n,this.commands=r,t&&r.length>0&&Py(r[0]))throw new p.buA(4003,!1);const s=r.find(e0);if(s&&s!==j2(r))throw new p.buA(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ky{segmentGroup;processChildren;index;constructor(t,n,r){this.segmentGroup=t,this.processChildren=n,this.index=r}}function tT(e,t,n){if(e??=new mr([],{}),0===e.segments.length&&e.hasChildren())return t0(e,t,n);const r=function qF(e,t,n){let r=0,s=t;const l={match:!1,pathIndex:0,commandIndex:0};for(;s<e.segments.length;){if(r>=n.length)return l;const d=e.segments[s],g=n[r];if(e0(g))break;const v=`${g}`,M=r<n.length-1?n[r+1]:null;if(s>0&&void 0===v)break;if(v&&M&&"object"==typeof M&&void 0===M.outlets){if(!rT(v,M,d))return l;r+=2}else{if(!rT(v,{},d))return l;r++}s++}return{match:!0,pathIndex:s,commandIndex:r}}(e,t,n),s=n.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){const l=new mr(e.segments.slice(0,r.pathIndex),{});return l.children[mn]=new mr(e.segments.slice(r.pathIndex),e.children),t0(l,0,s)}return r.match&&0===s.length?new mr(e.segments,{}):r.match&&!e.hasChildren()?ux(e,t,n):r.match?t0(e,0,s):ux(e,t,n)}function t0(e,t,n){if(0===n.length)return new mr(e.segments,{});{const r=function WF(e){return e0(e[0])?e[0].outlets:{[mn]:e}}(n),s={};if(Object.keys(r).some(l=>l!==mn)&&e.children[mn]&&1===e.numberOfChildren&&0===e.children[mn].segments.length){const l=t0(e.children[mn],t,n);return new mr(e.segments,l.children)}return Object.entries(r).forEach(([l,d])=>{"string"==typeof d&&(d=[d]),null!==d&&(s[l]=tT(e.children[l],t,d))}),Object.entries(e.children).forEach(([l,d])=>{void 0===r[l]&&(s[l]=d)}),new mr(e.segments,s)}}function ux(e,t,n){const r=e.segments.slice(0,t);let s=0;for(;s<n.length;){const l=n[s];if(e0(l)){const v=ZF(l.outlets);return new mr(r,v)}if(0===s&&Py(n[0])){r.push(new Qm(e.segments[t].path,nT(n[0]))),s++;continue}const d=e0(l)?l.outlets[mn]:`${l}`,g=s<n.length-1?n[s+1]:null;d&&g&&Py(g)?(r.push(new Qm(d,nT(g))),s+=2):(r.push(new Qm(d,{})),s++)}return new mr(r,{})}function ZF(e){const t={};return Object.entries(e).forEach(([n,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(t[n]=ux(new mr([],{}),0,r))}),t}function nT(e){const t={};return Object.entries(e).forEach(([n,r])=>t[n]=`${r}`),t}function rT(e,t,n){return e==n.path&&Xc(t,n.parameters)}const Ry="imperative";var Pn=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(Pn||{});class Qc{id;url;constructor(t,n){this.id=t,this.url=n}}class dx extends Qc{type=Pn.NavigationStart;navigationTrigger;restoredState;constructor(t,n,r="imperative",s=null){super(t,n),this.navigationTrigger=r,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Of extends Qc{urlAfterRedirects;type=Pn.NavigationEnd;constructor(t,n,r){super(t,n),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var ea=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e[e.Aborted=4]="Aborted",e}(ea||{}),hx=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(hx||{});class Nf extends Qc{reason;code;type=Pn.NavigationCancel;constructor(t,n,r,s){super(t,n),this.reason=r,this.code=s}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class n0 extends Qc{reason;code;type=Pn.NavigationSkipped;constructor(t,n,r,s){super(t,n),this.reason=r,this.code=s}}class fx extends Qc{error;target;type=Pn.NavigationError;constructor(t,n,r,s){super(t,n),this.error=r,this.target=s}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class oT extends Qc{urlAfterRedirects;state;type=Pn.RoutesRecognized;constructor(t,n,r,s){super(t,n),this.urlAfterRedirects=r,this.state=s}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class YF extends Qc{urlAfterRedirects;state;type=Pn.GuardsCheckStart;constructor(t,n,r,s){super(t,n),this.urlAfterRedirects=r,this.state=s}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class KF extends Qc{urlAfterRedirects;state;shouldActivate;type=Pn.GuardsCheckEnd;constructor(t,n,r,s,l){super(t,n),this.urlAfterRedirects=r,this.state=s,this.shouldActivate=l}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class XF extends Qc{urlAfterRedirects;state;type=Pn.ResolveStart;constructor(t,n,r,s){super(t,n),this.urlAfterRedirects=r,this.state=s}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class QF extends Qc{urlAfterRedirects;state;type=Pn.ResolveEnd;constructor(t,n,r,s){super(t,n),this.urlAfterRedirects=r,this.state=s}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class JF{route;type=Pn.RouteConfigLoadStart;constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class e3{route;type=Pn.RouteConfigLoadEnd;constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class t3{snapshot;type=Pn.ChildActivationStart;constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class n3{snapshot;type=Pn.ChildActivationEnd;constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class r3{snapshot;type=Pn.ActivationStart;constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class o3{snapshot;type=Pn.ActivationEnd;constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class px{}class Oy{url;navigationBehaviorOptions;constructor(t,n){this.url=t,this.navigationBehaviorOptions=n}}function Jl(e){return e.outlet||mn}function og(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let t=e.parent;t;t=t.parent){const n=t.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class d3{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return og(this.route?.snapshot)??this.rootInjector}constructor(t){this.rootInjector=t,this.children=new r0(this.rootInjector)}}let r0=(()=>{class e{rootInjector;contexts=new Map;constructor(n){this.rootInjector=n}onChildOutletCreated(n,r){const s=this.getOrCreateContext(n);s.outlet=r,this.contexts.set(n,s)}onChildOutletDestroyed(n){const r=this.getContext(n);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let r=this.getContext(n);return r||(r=new d3(this.rootInjector),this.contexts.set(n,r)),r}getContext(n){return this.contexts.get(n)||null}static \u0275fac=function(r){return new(r||e)(p.KVO(p.uvJ))};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();class iT{_root;constructor(t){this._root=t}get root(){return this._root.value}parent(t){const n=this.pathFromRoot(t);return n.length>1?n[n.length-2]:null}children(t){const n=gx(t,this._root);return n?n.children.map(r=>r.value):[]}firstChild(t){const n=gx(t,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(t){const n=mx(t,this._root);return n.length<2?[]:n[n.length-2].children.map(s=>s.value).filter(s=>s!==t)}pathFromRoot(t){return mx(t,this._root).map(n=>n.value)}}function gx(e,t){if(e===t.value)return t;for(const n of t.children){const r=gx(e,n);if(r)return r}return null}function mx(e,t){if(e===t.value)return[t];for(const n of t.children){const r=mx(e,n);if(r.length)return r.unshift(t),r}return[]}class ec{value;children;constructor(t,n){this.value=t,this.children=n}toString(){return`TreeNode(${this.value})`}}function ig(e){const t={};return e&&e.children.forEach(n=>t[n.value.outlet]=n),t}class sT extends iT{snapshot;constructor(t,n){super(t),this.snapshot=n,_x(this,t)}toString(){return this.snapshot.toString()}}function aT(e){const t=function h3(e){const l=new Ly([],{},{},"",{},mn,e,null,{});return new lT("",new ec(l,[]))}(e),n=new Xl.t([new Qm("",{})]),r=new Xl.t({}),s=new Xl.t({}),l=new Xl.t({}),d=new Xl.t(""),g=new sg(n,r,l,d,s,mn,e,t.root);return g.snapshot=t.root,new sT(new ec(g,[]),t)}class sg{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(t,n,r,s,l,d,g,v){this.urlSubject=t,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=s,this.dataSubject=l,this.outlet=d,this.component=g,this._futureSnapshot=v,this.title=this.dataSubject?.pipe(fn(M=>M[Xm]))??hn(void 0),this.url=t,this.params=n,this.queryParams=r,this.fragment=s,this.data=l}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(fn(t=>rg(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(fn(t=>rg(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ny(e,t,n="emptyOnly"){let r;const{routeConfig:s}=e;return r=null===t||"always"!==n&&""!==s?.path&&(t.component||t.routeConfig?.loadComponent)?{params:{...e.params},data:{...e.data},resolve:{...e.data,...e._resolvedData??{}}}:{params:{...t.params,...e.params},data:{...t.data,...e.data},resolve:{...e.data,...t.data,...s?.data,...e._resolvedData}},s&&uT(s)&&(r.resolve[Xm]=s.title),r}class Ly{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Xm]}constructor(t,n,r,s,l,d,g,v,M){this.url=t,this.params=n,this.queryParams=r,this.fragment=s,this.data=l,this.outlet=d,this.component=g,this.routeConfig=v,this._resolve=M}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=rg(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=rg(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class lT extends iT{url;constructor(t,n){super(n),this.url=t,_x(this,n)}toString(){return cT(this._root)}}function _x(e,t){t.value._routerState=e,t.children.forEach(n=>_x(e,n))}function cT(e){const t=e.children.length>0?` { ${e.children.map(cT).join(", ")} } `:"";return`${e.value}${t}`}function yx(e){if(e.snapshot){const t=e.snapshot,n=e._futureSnapshot;e.snapshot=n,Xc(t.queryParams,n.queryParams)||e.queryParamsSubject.next(n.queryParams),t.fragment!==n.fragment&&e.fragmentSubject.next(n.fragment),Xc(t.params,n.params)||e.paramsSubject.next(n.params),function CF(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!Xc(e[n],t[n]))return!1;return!0}(t.url,n.url)||e.urlSubject.next(n.url),Xc(t.data,n.data)||e.dataSubject.next(n.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function vx(e,t){const n=Xc(e.params,t.params)&&function TF(e,t){return kf(e,t)&&e.every((n,r)=>Xc(n.parameters,t[r].parameters))}(e.url,t.url);return n&&!(!e.parent!=!t.parent)&&(!e.parent||vx(e.parent,t.parent))}function uT(e){return"string"==typeof e.title||null===e.title}const f3=new p.nKC("");let dT=(()=>{class e{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=mn;activateEvents=new Ki;deactivateEvents=new Ki;attachEvents=new Ki;detachEvents=new Ki;routerOutletData=mh(void 0);parentContexts=(0,p.WQX)(r0);location=(0,p.WQX)(Zs);changeDetector=(0,p.WQX)(uy);inputBinder=(0,p.WQX)(bx,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(n){if(n.name){const{firstChange:r,previousValue:s}=n.name;if(r)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new p.buA(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new p.buA(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new p.buA(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,r){this.activated=n,this._activatedRoute=r,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,r){if(this.isActivated)throw new p.buA(4013,!1);this._activatedRoute=n;const s=this.location,d=n.snapshot.component,g=this.parentContexts.getOrCreateContext(this.name).children,v=new p3(n,g,s.injector,this.routerOutletData);this.activated=s.createComponent(d,{index:s.length,injector:v,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(r){return new(r||e)};static \u0275dir=Yo({type:e,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[Ao]})}return e})();class p3{route;childContexts;parent;outletData;constructor(t,n,r,s){this.route=t,this.childContexts=n,this.parent=r,this.outletData=s}get(t,n){return t===sg?this.route:t===r0?this.childContexts:t===f3?this.outletData:this.parent.get(t,n)}}const bx=new p.nKC("");let hT=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Wu({type:e,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(r,s){1&r&&fh(0,"router-outlet")},dependencies:[dT],encapsulation:2})}return e})();function xx(e){const t=e.children&&e.children.map(xx),n=t?{...e,children:t}:{...e};return!n.component&&!n.loadComponent&&(t||n.loadChildren)&&n.outlet&&n.outlet!==mn&&(n.component=hT),n}function o0(e,t,n){if(n&&e.shouldReuseRoute(t.value,n.value.snapshot)){const r=n.value;r._futureSnapshot=t.value;const s=function m3(e,t,n){return t.children.map(r=>{for(const s of n.children)if(e.shouldReuseRoute(r.value,s.value.snapshot))return o0(e,r,s);return o0(e,r)})}(e,t,n);return new ec(r,s)}{if(e.shouldAttach(t.value)){const l=e.retrieve(t.value);if(null!==l){const d=l.route;return d.value._futureSnapshot=t.value,d.children=t.children.map(g=>o0(e,g)),d}}const r=function _3(e){return new sg(new Xl.t(e.url),new Xl.t(e.params),new Xl.t(e.queryParams),new Xl.t(e.fragment),new Xl.t(e.data),e.outlet,e.component,e)}(t.value),s=t.children.map(l=>o0(e,l));return new ec(r,s)}}class wx{redirectTo;navigationBehaviorOptions;constructor(t,n){this.redirectTo=t,this.navigationBehaviorOptions=n}}const fT="ngNavigationCancelingError";function Fy(e,t){const{redirectTo:n,navigationBehaviorOptions:r}=Rf(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,s=pT(!1,ea.Redirect);return s.url=n,s.navigationBehaviorOptions=r,s}function pT(e,t){const n=new Error(`NavigationCancelingError: ${e||""}`);return n[fT]=!0,n.cancellationCode=t,n}function gT(e){return!!e&&e[fT]}class b3{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(t,n,r,s,l){this.routeReuseStrategy=t,this.futureState=n,this.currState=r,this.forwardEvent=s,this.inputBindingEnabled=l}activate(t){const n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,t),yx(this.futureState.root),this.activateChildRoutes(n,r,t)}deactivateChildRoutes(t,n,r){const s=ig(n);t.children.forEach(l=>{const d=l.value.outlet;this.deactivateRoutes(l,s[d],r),delete s[d]}),Object.values(s).forEach(l=>{this.deactivateRouteAndItsChildren(l,r)})}deactivateRoutes(t,n,r){const s=t.value,l=n?n.value:null;if(s===l)if(s.component){const d=r.getContext(s.outlet);d&&this.deactivateChildRoutes(t,n,d.children)}else this.deactivateChildRoutes(t,n,r);else l&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(t,n){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,n):this.deactivateRouteAndOutlet(t,n)}detachAndStoreRouteSubtree(t,n){const r=n.getContext(t.value.outlet),s=r&&t.value.component?r.children:n,l=ig(t);for(const d of Object.values(l))this.deactivateRouteAndItsChildren(d,s);if(r&&r.outlet){const d=r.outlet.detach(),g=r.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:d,route:t,contexts:g})}}deactivateRouteAndOutlet(t,n){const r=n.getContext(t.value.outlet),s=r&&t.value.component?r.children:n,l=ig(t);for(const d of Object.values(l))this.deactivateRouteAndItsChildren(d,s);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(t,n,r){const s=ig(n);t.children.forEach(l=>{this.activateRoutes(l,s[l.value.outlet],r),this.forwardEvent(new o3(l.value.snapshot))}),t.children.length&&this.forwardEvent(new n3(t.value.snapshot))}activateRoutes(t,n,r){const s=t.value,l=n?n.value:null;if(yx(s),s===l)if(s.component){const d=r.getOrCreateContext(s.outlet);this.activateChildRoutes(t,n,d.children)}else this.activateChildRoutes(t,n,r);else if(s.component){const d=r.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const g=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),d.children.onOutletReAttached(g.contexts),d.attachRef=g.componentRef,d.route=g.route.value,d.outlet&&d.outlet.attach(g.componentRef,g.route.value),yx(g.route.value),this.activateChildRoutes(t,null,d.children)}else d.attachRef=null,d.route=s,d.outlet&&d.outlet.activateWith(s,d.injector),this.activateChildRoutes(t,null,d.children)}else this.activateChildRoutes(t,null,r)}}class mT{path;route;constructor(t){this.path=t,this.route=this.path[this.path.length-1]}}class By{component;route;constructor(t,n){this.component=t,this.route=n}}function x3(e,t,n){const r=e._root;return s0(r,t?t._root:null,n,[r.value])}function ag(e,t){const n=Symbol(),r=t.get(e,n);return r===n?"function"!=typeof e||(0,p.muV)(e)?t.get(e):e:r}function s0(e,t,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const l=ig(t);return e.children.forEach(d=>{(function C3(e,t,n,r,s={canDeactivateChecks:[],canActivateChecks:[]}){const l=e.value,d=t?t.value:null,g=n?n.getContext(e.value.outlet):null;if(d&&l.routeConfig===d.routeConfig){const v=function S3(e,t,n){if("function"==typeof n)return n(e,t);switch(n){case"pathParamsChange":return!kf(e.url,t.url);case"pathParamsOrQueryParamsChange":return!kf(e.url,t.url)||!Xc(e.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!vx(e,t)||!Xc(e.queryParams,t.queryParams);default:return!vx(e,t)}}(d,l,l.routeConfig.runGuardsAndResolvers);v?s.canActivateChecks.push(new mT(r)):(l.data=d.data,l._resolvedData=d._resolvedData),s0(e,t,l.component?g?g.children:null:n,r,s),v&&g&&g.outlet&&g.outlet.isActivated&&s.canDeactivateChecks.push(new By(g.outlet.component,d))}else d&&a0(t,g,s),s.canActivateChecks.push(new mT(r)),s0(e,null,l.component?g?g.children:null:n,r,s)})(d,l[d.value.outlet],n,r.concat([d.value]),s),delete l[d.value.outlet]}),Object.entries(l).forEach(([d,g])=>a0(g,n.getContext(d),s)),s}function a0(e,t,n){const r=ig(e),s=e.value;Object.entries(r).forEach(([l,d])=>{a0(d,s.component?t?t.children.getContext(l):null:t,n)}),n.canDeactivateChecks.push(new By(s.component&&t&&t.outlet&&t.outlet.isActivated?t.outlet.component:null,s))}function l0(e){return"function"==typeof e}function _T(e){return e instanceof xy||"EmptyError"===e?.name}const zy=Symbol("INITIAL_VALUE");function lg(){return al(e=>k2(e.map(t=>t.pipe(tg(1),function dF(...e){const t=by(e);return Wn((n,r)=>{(t?tx(e,n,t):tx(e,n)).subscribe(r)})}(zy)))).pipe(fn(t=>{for(const n of t)if(!0!==n){if(n===zy)return zy;if(!1===n||P3(n))return n}return!0}),vh(t=>t!==zy),tg(1)))}function P3(e){return Rf(e)||e instanceof wx}function yT(e){return(0,cF.F)(Qi(t=>{if("boolean"!=typeof t)throw Fy(0,t)}),fn(t=>!0===t))}class Cx{segmentGroup;constructor(t){this.segmentGroup=t||null}}class Sx extends Error{urlTree;constructor(t){super(),this.urlTree=t}}function cg(e){return wy(new Cx(e))}function U3(e){return wy(new p.buA(4e3,!1))}class $3{urlSerializer;urlTree;constructor(t,n){this.urlSerializer=t,this.urlTree=n}lineralizeSegments(t,n){let r=[],s=n.root;for(;;){if(r=r.concat(s.segments),0===s.numberOfChildren)return hn(r);if(s.numberOfChildren>1||!s.children[mn])return U3();s=s.children[mn]}}applyRedirectCommands(t,n,r,s,l){return function H3(e,t,n){if("string"==typeof e)return hn(e);const r=e,{queryParams:s,fragment:l,routeConfig:d,url:g,outlet:v,params:M,data:A,title:O}=t;return Ju((0,p.N4e)(n,()=>r({params:M,data:A,queryParams:s,fragment:l,routeConfig:d,url:g,outlet:v,title:O})))}(n,s,l).pipe(fn(d=>{if(d instanceof Pf)throw new Sx(d);const g=this.applyRedirectCreateUrlTree(d,this.urlSerializer.parse(d),t,r);if("/"===d[0])throw new Sx(g);return g}))}applyRedirectCreateUrlTree(t,n,r,s){const l=this.createSegmentGroup(t,n.root,r,s);return new Pf(l,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(t,n){const r={};return Object.entries(t).forEach(([s,l])=>{if("string"==typeof l&&":"===l[0]){const g=l.substring(1);r[s]=n[g]}else r[s]=l}),r}createSegmentGroup(t,n,r,s){const l=this.createSegments(t,n.segments,r,s);let d={};return Object.entries(n.children).forEach(([g,v])=>{d[g]=this.createSegmentGroup(t,v,r,s)}),new mr(l,d)}createSegments(t,n,r,s){return n.map(l=>":"===l.path[0]?this.findPosParam(t,l,s):this.findOrReturn(l,r))}findPosParam(t,n,r){const s=r[n.path.substring(1)];if(!s)throw new p.buA(4001,!1);return s}findOrReturn(t,n){let r=0;for(const s of n){if(s.path===t.path)return n.splice(r),s;r++}return t}}const Ex={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function W3(e,t,n,r,s){const l=vT(e,t,n);return l.matched?(r=function s3(e,t){return e.providers&&!e._injector&&(e._injector=Sb(e.providers,t,`Route: ${e.path}`)),e._injector??t}(t,r),function V3(e,t,n,r){const s=t.canMatch;return s&&0!==s.length?hn(s.map(d=>{const g=ag(d,e);return Ju(function A3(e){return e&&l0(e.canMatch)}(g)?g.canMatch(t,n):(0,p.N4e)(e,()=>g(t,n)))})).pipe(lg(),yT()):hn(!0)}(r,t,n).pipe(fn(d=>!0===d?l:{...Ex}))):hn(l)}function vT(e,t,n){if("**"===t.path)return function q3(e){return{matched:!0,parameters:e.length>0?j2(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}(n);if(""===t.path)return"full"===t.pathMatch&&(e.hasChildren()||n.length>0)?{...Ex}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const s=(t.matcher||wF)(n,e,t);if(!s)return{...Ex};const l={};Object.entries(s.posParams??{}).forEach(([g,v])=>{l[g]=v.path});const d=s.consumed.length>0?{...l,...s.consumed[s.consumed.length-1].parameters}:l;return{matched:!0,consumedSegments:s.consumed,remainingSegments:n.slice(s.consumed.length),parameters:d,positionalParamSegments:s.posParams??{}}}function bT(e,t,n,r){return n.length>0&&function K3(e,t,n){return n.some(r=>jy(e,t,r)&&Jl(r)!==mn)}(e,n,r)?{segmentGroup:new mr(t,Y3(r,new mr(n,e.children))),slicedSegments:[]}:0===n.length&&function X3(e,t,n){return n.some(r=>jy(e,t,r))}(e,n,r)?{segmentGroup:new mr(e.segments,Z3(e,n,r,e.children)),slicedSegments:n}:{segmentGroup:new mr(e.segments,e.children),slicedSegments:n}}function Z3(e,t,n,r){const s={};for(const l of n)if(jy(e,t,l)&&!r[Jl(l)]){const d=new mr([],{});s[Jl(l)]=d}return{...r,...s}}function Y3(e,t){const n={};n[mn]=t;for(const r of e)if(""===r.path&&Jl(r)!==mn){const s=new mr([],{});n[Jl(r)]=s}return n}function jy(e,t,n){return(!(e.hasChildren()||t.length>0)||"full"!==n.pathMatch)&&""===n.path}class J3{}class nB{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(t,n,r,s,l,d,g){this.injector=t,this.configLoader=n,this.rootComponentType=r,this.config=s,this.urlTree=l,this.paramsInheritanceStrategy=d,this.urlSerializer=g,this.applyRedirects=new $3(this.urlSerializer,this.urlTree)}noMatchError(t){return new p.buA(4002,`'${t.segmentGroup}'`)}recognize(){const t=bT(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(fn(({children:n,rootSnapshot:r})=>{const s=new ec(r,n),l=new lT("",s),d=function UF(e,t,n=null,r=null){return Q2(X2(e),t,n,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return d.queryParams=this.urlTree.queryParams,l.url=this.urlSerializer.serialize(d),{state:l,tree:d}}))}match(t){const n=new Ly([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Object.freeze({}),mn,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,t,mn,n).pipe(fn(r=>({children:r,rootSnapshot:n})),ng(r=>{if(r instanceof Sx)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Cx?this.noMatchError(r):r}))}processSegmentGroup(t,n,r,s,l){return 0===r.segments.length&&r.hasChildren()?this.processChildren(t,n,r,l):this.processSegment(t,n,r,r.segments,s,!0,l).pipe(fn(d=>d instanceof ec?[d]:[]))}processChildren(t,n,r,s){const l=[];for(const d of Object.keys(r.children))"primary"===d?l.unshift(d):l.push(d);return Es(l).pipe(Sy(d=>{const g=r.children[d],v=function u3(e,t){const n=e.filter(r=>Jl(r)===t);return n.push(...e.filter(r=>Jl(r)!==t)),n}(n,d);return this.processSegmentGroup(t,v,g,d,s)}),function pF(e,t){return Wn(function fF(e,t,n,r,s){return(l,d)=>{let g=n,v=t,M=0;l.subscribe(Vn(d,A=>{const O=M++;v=g?e(v,A,O):(g=!0,A),r&&d.next(v)},s&&(()=>{g&&d.next(v),d.complete()})))}}(e,t,arguments.length>=2,!0))}((d,g)=>(d.push(...g),d)),Cy(null),function gF(e,t){const n=arguments.length>=2;return r=>r.pipe(e?vh((s,l)=>e(s,l,r)):eg.D,ox(1),n?Cy(t):N2(()=>new xy))}(),Ms(d=>{if(null===d)return cg(r);const g=xT(d);return function rB(e){e.sort((t,n)=>t.value.outlet===mn?-1:n.value.outlet===mn?1:t.value.outlet.localeCompare(n.value.outlet))}(g),hn(g)}))}processSegment(t,n,r,s,l,d,g){return Es(n).pipe(Sy(v=>this.processSegmentAgainstRoute(v._injector??t,n,v,r,s,l,d,g).pipe(ng(M=>{if(M instanceof Cx)return hn(null);throw M}))),Af(v=>!!v),ng(v=>{if(_T(v))return function Q3(e,t,n){return 0===t.length&&!e.children[n]}(r,s,l)?hn(new J3):cg(r);throw v}))}processSegmentAgainstRoute(t,n,r,s,l,d,g,v){return Jl(r)===d||d!==mn&&jy(s,l,r)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(t,s,r,l,d,v):this.allowRedirects&&g?this.expandSegmentAgainstRouteUsingRedirect(t,s,n,r,l,d,v):cg(s):cg(s)}expandSegmentAgainstRouteUsingRedirect(t,n,r,s,l,d,g){const{matched:v,parameters:M,consumedSegments:A,positionalParamSegments:O,remainingSegments:j}=vT(n,s,l);if(!v)return cg(n);"string"==typeof s.redirectTo&&"/"===s.redirectTo[0]&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const B=new Ly(l,M,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,wT(s),Jl(s),s.component??s._loadedComponent??null,s,CT(s)),X=Ny(B,g,this.paramsInheritanceStrategy);return B.params=Object.freeze(X.params),B.data=Object.freeze(X.data),this.applyRedirects.applyRedirectCommands(A,s.redirectTo,O,B,t).pipe(al(_e=>this.applyRedirects.lineralizeSegments(s,_e)),Ms(_e=>this.processSegment(t,r,n,_e.concat(j),d,!1,g)))}matchSegmentAgainstRoute(t,n,r,s,l,d){const g=W3(n,r,s,t);return"**"===r.path&&(n.children={}),g.pipe(al(v=>v.matched?this.getChildConfig(t=r._injector??t,r,s).pipe(al(({routes:M})=>{const A=r._loadedInjector??t,{parameters:O,consumedSegments:j,remainingSegments:B}=v,X=new Ly(j,O,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,wT(r),Jl(r),r.component??r._loadedComponent??null,r,CT(r)),le=Ny(X,d,this.paramsInheritanceStrategy);X.params=Object.freeze(le.params),X.data=Object.freeze(le.data);const{segmentGroup:_e,slicedSegments:Ie}=bT(n,j,B,M);if(0===Ie.length&&_e.hasChildren())return this.processChildren(A,M,_e,X).pipe(fn(nt=>new ec(X,nt)));if(0===M.length&&0===Ie.length)return hn(new ec(X,[]));const De=Jl(r)===l;return this.processSegment(A,M,_e,Ie,De?mn:l,!0,X).pipe(fn(nt=>new ec(X,nt instanceof ec?[nt]:[])))})):cg(n)))}getChildConfig(t,n,r){return n.children?hn({routes:n.children,injector:t}):n.loadChildren?void 0!==n._loadedRoutes?hn({routes:n._loadedRoutes,injector:n._loadedInjector}):function j3(e,t,n,r){const s=t.canLoad;return void 0===s||0===s.length?hn(!0):hn(s.map(d=>{const g=ag(d,e);return Ju(function M3(e){return e&&l0(e.canLoad)}(g)?g.canLoad(t,n):(0,p.N4e)(e,()=>g(t,n)))})).pipe(lg(),yT())}(t,n,r).pipe(Ms(s=>s?this.configLoader.loadChildren(t,n).pipe(Qi(l=>{n._loadedRoutes=l.routes,n._loadedInjector=l.injector})):function G3(){return wy(pT(!1,ea.GuardRejected))}())):hn({routes:[],injector:t})}}function oB(e){const t=e.value.routeConfig;return t&&""===t.path}function xT(e){const t=[],n=new Set;for(const r of e){if(!oB(r)){t.push(r);continue}const s=t.find(l=>r.value.routeConfig===l.value.routeConfig);void 0!==s?(s.children.push(...r.children),n.add(s)):t.push(r)}for(const r of n){const s=xT(r.children);t.push(new ec(r.value,s))}return t.filter(r=>!n.has(r))}function wT(e){return e.data||{}}function CT(e){return e.resolve||{}}function ST(e){const t=e.children.map(n=>ST(n)).flat();return[e,...t]}function Mx(e){return al(t=>{const n=e(t);return n?Es(n).pipe(fn(()=>t)):hn(t)})}let ET=(()=>{class e{buildTitle(n){let r,s=n.root;for(;void 0!==s;)r=this.getResolvedTitleForRoute(s)??r,s=s.children.find(l=>l.outlet===mn);return r}getResolvedTitleForRoute(n){return n.data[Xm]}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:()=>(0,p.WQX)(uB),providedIn:"root"})}return e})(),uB=(()=>{class e extends ET{title;constructor(n){super(),this.title=n}updateTitle(n){const r=this.buildTitle(n);void 0!==r&&this.title.setTitle(r)}static \u0275fac=function(r){return new(r||e)(p.KVO(_F))};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Vy=new p.nKC("",{providedIn:"root",factory:()=>({})}),Tx=new p.nKC("");let MT=(()=>{class e{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=(0,p.WQX)(AN);loadComponent(n,r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return hn(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);const s=Ju((0,p.N4e)(n,()=>r.loadComponent())).pipe(fn(TT),al(IT),Qi(d=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=d}),ix(()=>{this.componentLoaders.delete(r)})),l=new O2(s,()=>new St.B).pipe(rx());return this.componentLoaders.set(r,l),l}loadChildren(n,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return hn({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const l=function dB(e,t,n,r){return Ju((0,p.N4e)(n,()=>e.loadChildren())).pipe(fn(TT),al(IT),Ms(s=>s instanceof Zw||Array.isArray(s)?hn(s):Es(t.compileModuleAsync(s))),fn(s=>{r&&r(e);let l,d,g=!1;return Array.isArray(s)?(d=s,!0):(l=s.create(n).injector,d=l.get(Tx,[],{optional:!0,self:!0}).flat()),{routes:d.map(xx),injector:l}}))}(r,this.compiler,n,this.onLoadEndListener).pipe(ix(()=>{this.childrenLoaders.delete(r)})),d=new O2(l,()=>new St.B).pipe(rx());return this.childrenLoaders.set(r,d),d}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function TT(e){return function hB(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}function IT(e){return hn(e)}let Ix=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:()=>(0,p.WQX)(fB),providedIn:"root"})}return e})(),fB=(()=>{class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,r){return n}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const pB=new p.nKC(""),_B=new p.nKC("");let yB=(()=>{class e{currentNavigation=(0,p.vPA)(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=null;events=new St.B;transitionAbortWithErrorSubject=new St.B;configLoader=(0,p.WQX)(MT);environmentInjector=(0,p.WQX)(p.uvJ);destroyRef=(0,p.WQX)(p.abz);urlSerializer=(0,p.WQX)(My);rootContexts=(0,p.WQX)(r0);location=(0,p.WQX)(sn);inputBindingEnabled=null!==(0,p.WQX)(bx,{optional:!0});titleStrategy=(0,p.WQX)(ET);options=(0,p.WQX)(Vy,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=(0,p.WQX)(Ix);createViewTransition=(0,p.WQX)(pB,{optional:!0});navigationErrorHandler=(0,p.WQX)(_B,{optional:!0});navigationId=0;get hasRequestedNavigation(){return 0!==this.navigationId}transitions;afterPreactivation=()=>hn(void 0);rootComponentType=null;destroyed=!1;constructor(){this.configLoader.onLoadEndListener=s=>this.events.next(new e3(s)),this.configLoader.onLoadStartListener=s=>this.events.next(new JF(s)),this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(n){const r=++this.navigationId;Xo(()=>{this.transitions?.next({...n,extractedUrl:this.urlHandlingStrategy.extract(n.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:r})})}setupNavigations(n){return this.transitions=new Xl.t(null),this.transitions.pipe(vh(r=>null!==r),al(r=>{let s=!1;return hn(r).pipe(al(l=>{if(this.navigationId>r.id)return this.cancelNavigationTransition(r,"",ea.SupersededByNewNavigation),Ql;this.currentTransition=r,this.currentNavigation.set({id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:"string"==typeof l.extras.browserUrl?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null,abort:()=>l.abortController.abort()});const d=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!d&&"reload"!==(l.extras.onSameUrlNavigation??n.onSameUrlNavigation))return this.events.next(new n0(l.id,this.urlSerializer.serialize(l.rawUrl),"",hx.IgnoredSameUrlNavigation)),l.resolve(!1),Ql;if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return hn(l).pipe(al(v=>(this.events.next(new dx(v.id,this.urlSerializer.serialize(v.extractedUrl),v.source,v.restoredState)),v.id!==this.navigationId?Ql:Promise.resolve(v))),function iB(e,t,n,r,s,l){return Ms(d=>function eB(e,t,n,r,s,l,d="emptyOnly"){return new nB(e,t,n,r,s,d,l).recognize()}(e,t,n,r,d.extractedUrl,s,l).pipe(fn(({state:g,tree:v})=>({...d,targetSnapshot:g,urlAfterRedirects:v}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),Qi(v=>{r.targetSnapshot=v.targetSnapshot,r.urlAfterRedirects=v.urlAfterRedirects,this.currentNavigation.update(A=>(A.finalUrl=v.urlAfterRedirects,A));const M=new oT(v.id,this.urlSerializer.serialize(v.extractedUrl),this.urlSerializer.serialize(v.urlAfterRedirects),v.targetSnapshot);this.events.next(M)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:v,extractedUrl:M,source:A,restoredState:O,extras:j}=l,B=new dx(v,this.urlSerializer.serialize(M),A,O);this.events.next(B);const X=aT(this.rootComponentType).snapshot;return this.currentTransition=r={...l,targetSnapshot:X,urlAfterRedirects:M,extras:{...j,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.update(le=>(le.finalUrl=M,le)),hn(r)}return this.events.next(new n0(l.id,this.urlSerializer.serialize(l.extractedUrl),"",hx.IgnoredByUrlHandlingStrategy)),l.resolve(!1),Ql}),Qi(l=>{const d=new YF(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),fn(l=>(this.currentTransition=r={...l,guards:x3(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},r)),function k3(e,t){return Ms(n=>{const{targetSnapshot:r,currentSnapshot:s,guards:{canActivateChecks:l,canDeactivateChecks:d}}=n;return 0===d.length&&0===l.length?hn({...n,guardsResult:!0}):function R3(e,t,n,r){return Es(e).pipe(Ms(s=>function z3(e,t,n,r,s){const l=t&&t.routeConfig?t.routeConfig.canDeactivate:null;return l&&0!==l.length?hn(l.map(g=>{const v=og(t)??s,M=ag(g,v);return Ju(function D3(e){return e&&l0(e.canDeactivate)}(M)?M.canDeactivate(e,t,n,r):(0,p.N4e)(v,()=>M(e,t,n,r))).pipe(Af())})).pipe(lg()):hn(!0)}(s.component,s.route,n,t,r)),Af(s=>!0!==s,!0))}(d,r,s,e).pipe(Ms(g=>g&&function E3(e){return"boolean"==typeof e}(g)?function O3(e,t,n,r){return Es(t).pipe(Sy(s=>tx(function L3(e,t){return null!==e&&t&&t(new t3(e)),hn(!0)}(s.route.parent,r),function N3(e,t){return null!==e&&t&&t(new r3(e)),hn(!0)}(s.route,r),function B3(e,t,n){const r=t[t.length-1],l=t.slice(0,t.length-1).reverse().map(d=>function w3(e){const t=e.routeConfig?e.routeConfig.canActivateChild:null;return t&&0!==t.length?{node:e,guards:t}:null}(d)).filter(d=>null!==d).map(d=>nx(()=>hn(d.guards.map(v=>{const M=og(d.node)??n,A=ag(v,M);return Ju(function I3(e){return e&&l0(e.canActivateChild)}(A)?A.canActivateChild(r,e):(0,p.N4e)(M,()=>A(r,e))).pipe(Af())})).pipe(lg())));return hn(l).pipe(lg())}(e,s.path,n),function F3(e,t,n){const r=t.routeConfig?t.routeConfig.canActivate:null;if(!r||0===r.length)return hn(!0);const s=r.map(l=>nx(()=>{const d=og(t)??n,g=ag(l,d);return Ju(function T3(e){return e&&l0(e.canActivate)}(g)?g.canActivate(t,e):(0,p.N4e)(d,()=>g(t,e))).pipe(Af())}));return hn(s).pipe(lg())}(e,s.route,n))),Af(s=>!0!==s,!0))}(r,l,e,t):hn(g)),fn(g=>({...n,guardsResult:g})))})}(this.environmentInjector,l=>this.events.next(l)),Qi(l=>{if(r.guardsResult=l.guardsResult,l.guardsResult&&"boolean"!=typeof l.guardsResult)throw Fy(0,l.guardsResult);const d=new KF(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),vh(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",ea.GuardRejected),!1)),Mx(l=>{if(0!==l.guards.canActivateChecks.length)return hn(l).pipe(Qi(d=>{const g=new XF(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(g)}),al(d=>{let g=!1;return hn(d).pipe(function sB(e,t){return Ms(n=>{const{targetSnapshot:r,guards:{canActivateChecks:s}}=n;if(!s.length)return hn(n);const l=new Set(s.map(v=>v.route)),d=new Set;for(const v of l)if(!d.has(v))for(const M of ST(v))d.add(M);let g=0;return Es(d).pipe(Sy(v=>l.has(v)?function aB(e,t,n,r){const s=e.routeConfig,l=e._resolve;return void 0!==s?.title&&!uT(s)&&(l[Xm]=s.title),nx(()=>(e.data=Ny(e,e.parent,n).resolve,function lB(e,t,n,r){const s=sx(e);if(0===s.length)return hn({});const l={};return Es(s).pipe(Ms(d=>function cB(e,t,n,r){const s=og(t)??r,l=ag(e,s);return Ju(l.resolve?l.resolve(t,n):(0,p.N4e)(s,()=>l(t,n)))}(e[d],t,n,r).pipe(Af(),Qi(g=>{if(g instanceof wx)throw Fy(new Ty,g);l[d]=g}))),ox(1),fn(()=>l),ng(d=>_T(d)?Ql:wy(d)))}(l,e,t,r).pipe(fn(d=>(e._resolvedData=d,e.data={...e.data,...d},null)))))}(v,r,e,t):(v.data=Ny(v,v.parent,e).resolve,hn(void 0))),Qi(()=>g++),ox(1),Ms(v=>g===d.size?hn(n):Ql))})}(this.paramsInheritanceStrategy,this.environmentInjector),Qi({next:()=>g=!0,complete:()=>{g||this.cancelNavigationTransition(d,"",ea.NoDataFromResolver)}}))}),Qi(d=>{const g=new QF(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(g)}))}),Mx(l=>{const d=g=>{const v=[];if(g.routeConfig?.loadComponent){const M=og(g)??this.environmentInjector;v.push(this.configLoader.loadComponent(M,g.routeConfig).pipe(Qi(A=>{g.component=A}),fn(()=>{})))}for(const M of g.children)v.push(...d(M));return v};return k2(d(l.targetSnapshot.root)).pipe(Cy(null),tg(1))}),Mx(()=>this.afterPreactivation()),al(()=>{const{currentSnapshot:l,targetSnapshot:d}=r,g=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return g?Es(g).pipe(fn(()=>r)):hn(r)}),fn(l=>{const d=function g3(e,t,n){const r=o0(e,t._root,n?n._root:void 0);return new sT(r,t)}(n.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=r={...l,targetRouterState:d},this.currentNavigation.update(g=>(g.targetRouterState=d,g)),r}),Qi(()=>{this.events.next(new px)}),((e,t,n,r)=>fn(s=>(new b3(t,s.targetRouterState,s.currentRouterState,n,r).activate(e),s)))(this.rootContexts,n.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),tg(1),L2(new Xi.c(l=>{const d=r.abortController.signal,g=()=>l.next();return d.addEventListener("abort",g),()=>d.removeEventListener("abort",g)}).pipe(vh(()=>!s&&!r.targetRouterState),Qi(()=>{this.cancelNavigationTransition(r,r.abortController.signal.reason+"",ea.Aborted)}))),Qi({next:l=>{s=!0,this.lastSuccessfulNavigation=Xo(this.currentNavigation),this.events.next(new Of(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{s=!0}}),L2(this.transitionAbortWithErrorSubject.pipe(Qi(l=>{throw l}))),ix(()=>{s||this.cancelNavigationTransition(r,"",ea.SupersededByNewNavigation),this.currentTransition?.id===r.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),ng(l=>{if(this.destroyed)return r.resolve(!1),Ql;if(s=!0,gT(l))this.events.next(new Nf(r.id,this.urlSerializer.serialize(r.extractedUrl),l.message,l.cancellationCode)),function y3(e){return gT(e)&&Rf(e.url)}(l)?this.events.next(new Oy(l.url,l.navigationBehaviorOptions)):r.resolve(!1);else{const d=new fx(r.id,this.urlSerializer.serialize(r.extractedUrl),l,r.targetSnapshot??void 0);try{const g=(0,p.N4e)(this.environmentInjector,()=>this.navigationErrorHandler?.(d));if(!(g instanceof wx))throw this.events.next(d),l;{const{message:v,cancellationCode:M}=Fy(0,g);this.events.next(new Nf(r.id,this.urlSerializer.serialize(r.extractedUrl),v,M)),this.events.next(new Oy(g.redirectTo,g.navigationBehaviorOptions))}}catch(g){this.options.resolveNavigationPromiseOnError?r.resolve(!1):r.reject(g)}}return Ql}))}))}cancelNavigationTransition(n,r,s){const l=new Nf(n.id,this.urlSerializer.serialize(n.extractedUrl),r,s);this.events.next(l),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){const n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=Xo(this.currentNavigation),s=r?.targetBrowserUrl??r?.extractedUrl;return n.toString()!==s?.toString()&&!r?.extras.skipLocationChange}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();function vB(e){return e!==Ry}let bB=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:()=>(0,p.WQX)(wB),providedIn:"root"})}return e})();class xB{shouldDetach(t){return!1}store(t,n){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,n){return t.routeConfig===n.routeConfig}}let wB=(()=>{class e extends xB{static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),DT=(()=>{class e{urlSerializer=(0,p.WQX)(My);options=(0,p.WQX)(Vy,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=(0,p.WQX)(sn);urlHandlingStrategy=(0,p.WQX)(Ix);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new Pf;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:n,initialUrl:r,targetBrowserUrl:s}){const l=void 0!==n?this.urlHandlingStrategy.merge(n,r):r,d=s??l;return d instanceof Pf?this.urlSerializer.serialize(d):d}commitTransition({targetRouterState:n,finalUrl:r,initialUrl:s}){r&&n?(this.currentUrlTree=r,this.rawUrlTree=this.urlHandlingStrategy.merge(r,s),this.routerState=n):this.rawUrlTree=s}routerState=aT(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:n}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n??this.rawUrlTree)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:()=>(0,p.WQX)(CB),providedIn:"root"})}return e})(),CB=(()=>{class e extends DT{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(r=>{"popstate"===r.type&&setTimeout(()=>{n(r.url,r.state,"popstate")})})}handleRouterEvent(n,r){n instanceof dx?this.updateStateMemento():n instanceof n0?this.commitTransition(r):n instanceof oT?"eager"===this.urlUpdateStrategy&&(r.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(r),r)):n instanceof px?(this.commitTransition(r),"deferred"===this.urlUpdateStrategy&&!r.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(r),r)):n instanceof Nf&&n.code!==ea.SupersededByNewNavigation&&n.code!==ea.Redirect?this.restoreHistory(r):n instanceof fx?this.restoreHistory(r,!0):n instanceof Of&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,{extras:r,id:s}){const{replaceUrl:l,state:d}=r;if(this.location.isCurrentPathEqualTo(n)||l){const g=this.browserPageId,v={...d,...this.generateNgRouterState(s,g)};this.location.replaceState(n,"",v)}else{const g={...d,...this.generateNgRouterState(s,this.browserPageId+1)};this.location.go(n,"",g)}}restoreHistory(n,r=!1){if("computed"===this.canceledNavigationResolution){const l=this.currentPageId-this.browserPageId;0!==l?this.location.historyGo(l):this.getCurrentUrlTree()===n.finalUrl&&0===l&&(this.resetInternalState(n),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetInternalState(n),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,r){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:r}:{navigationId:n}}static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const EB={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},MB={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ug=(()=>{class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=(0,p.WQX)(PC);stateManager=(0,p.WQX)(DT);options=(0,p.WQX)(Vy,{optional:!0})||{};pendingTasks=(0,p.WQX)(p.rev);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=(0,p.WQX)(yB);urlSerializer=(0,p.WQX)(My);location=(0,p.WQX)(sn);urlHandlingStrategy=(0,p.WQX)(Ix);injector=(0,p.WQX)(p.uvJ);_events=new St.B;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=(0,p.WQX)(bB);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=(0,p.WQX)(Tx,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!(0,p.WQX)(bx,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}eventsSubscription=new gn.yU;subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(r=>{try{const s=this.navigationTransitions.currentTransition,l=Xo(this.navigationTransitions.currentNavigation);if(null!==s&&null!==l)if(this.stateManager.handleRouterEvent(r,l),r instanceof Nf&&r.code!==ea.Redirect&&r.code!==ea.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Of)this.navigated=!0;else if(r instanceof Oy){const d=r.navigationBehaviorOptions,g=this.urlHandlingStrategy.merge(r.url,s.currentRawUrl),v={browserUrl:s.extras.browserUrl,info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:s.extras.replaceUrl||"eager"===this.urlUpdateStrategy||vB(s.source),...d};this.scheduleNavigation(g,Ry,null,v,{resolve:s.resolve,reject:s.reject,promise:s.promise})}(function i3(e){return!(e instanceof px||e instanceof Oy)})(r)&&this._events.next(r)}catch(s){this.navigationTransitions.transitionAbortWithErrorSubject.next(s)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Ry,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,r,s)=>{this.navigateToSyncWithBrowser(n,s,r)})}navigateToSyncWithBrowser(n,r,s){const l={replaceUrl:!0},d=s?.navigationId?s:null;if(s){const v={...s};delete v.navigationId,delete v.\u0275routerPageId,0!==Object.keys(v).length&&(l.state=v)}const g=this.parseUrl(n);this.scheduleNavigation(g,r,d,l).catch(v=>{this.disposed||this.injector.get(p.ZTf)(v)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return Xo(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(xx),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,r={}){const{relativeTo:s,queryParams:l,fragment:d,queryParamsHandling:g,preserveFragment:v}=r,M=v?this.currentUrlTree.fragment:d;let O,A=null;switch(g??this.options.defaultQueryParamsHandling){case"merge":A={...this.currentUrlTree.queryParams,...l};break;case"preserve":A=this.currentUrlTree.queryParams;break;default:A=l||null}null!==A&&(A=this.removeEmptyProps(A));try{O=X2(s?s.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||"/"!==n[0][0])&&(n=[]),O=this.currentUrlTree.root}return Q2(O,n,A,M??null)}navigateByUrl(n,r={skipLocationChange:!1}){const s=Rf(n)?n:this.parseUrl(n),l=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(l,Ry,null,r)}navigate(n,r={skipLocationChange:!1}){return function TB(e){for(let t=0;t<e.length;t++)if(null==e[t])throw new p.buA(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,r),r)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,r){let s;if(s=!0===r?{...EB}:!1===r?{...MB}:r,Rf(n))return U2(this.currentUrlTree,n,s);const l=this.parseUrl(n);return U2(this.currentUrlTree,l,s)}removeEmptyProps(n){return Object.entries(n).reduce((r,[s,l])=>(null!=l&&(r[s]=l),r),{})}scheduleNavigation(n,r,s,l,d){if(this.disposed)return Promise.resolve(!1);let g,v,M;d?(g=d.resolve,v=d.reject,M=d.promise):M=new Promise((O,j)=>{g=O,v=j});const A=this.pendingTasks.add();return function SB(e,t){e.events.pipe(vh(n=>n instanceof Of||n instanceof Nf||n instanceof fx||n instanceof n0),fn(n=>n instanceof Of||n instanceof n0?0:n instanceof Nf&&(n.code===ea.Redirect||n.code===ea.SupersededByNewNavigation)?2:1),vh(n=>2!==n),tg(1)).subscribe(()=>{t()})}(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(A))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:l,resolve:g,reject:v,promise:M,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),M.catch(O=>Promise.reject(O))}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const Ax=new p.nKC("");function PT(e){return e.routerState.root}function kT(){const e=(0,p.WQX)(p.zZn);return t=>{const n=e.get(ch);if(t!==n.components[0])return;const r=e.get(ug),s=e.get(RT);1===e.get(Px)&&r.initialNavigation(),e.get(OT,null,{optional:!0})?.setUpPreloading(),e.get(Ax,null,{optional:!0})?.init(),r.resetRootComponentType(n.componentTypes[0]),s.closed||(s.next(),s.complete(),s.unsubscribe())}}const RT=new p.nKC("",{factory:()=>new St.B}),Px=new p.nKC("",{providedIn:"root",factory:()=>1}),OT=new p.nKC("");let BB=(()=>{class e{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=(0,p.WQX)(p.zZn);loadingSchedulerFn=(0,p.WQX)(jB,{optional:!0});_engine;constructor(n,r,s,l,d){this.doc=n,this.delegate=r,this.zone=s,this.animationType=l,this.moduleImpl=d}ngOnDestroy(){this._engine?.flush()}loadImpl(){const n=()=>this.moduleImpl??dt.e(700).then(dt.bind(dt,700)).then(s=>s);let r;return r=this.loadingSchedulerFn?this.loadingSchedulerFn(n):n(),r.catch(s=>{throw new p.buA(5300,!1)}).then(({\u0275createEngine:s,\u0275AnimationRendererFactory:l})=>{this._engine=s(this.animationType,this.doc);const d=new l(this.delegate,this._engine,this.zone);return this.delegate=d,d})}createRenderer(n,r){const s=this.delegate.createRenderer(n,r);if(0===s.\u0275type)return s;"boolean"==typeof s.throwOnSyntheticProps&&(s.throwOnSyntheticProps=!1);const l=new zB(s);return r?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(d=>{const g=d.createRenderer(n,r);l.use(g),this.scheduler??=this.injector.get(p.hk6,null,{optional:!0}),this.scheduler?.notify(10)}).catch(d=>{l.use(s)}),l}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(n){this._engine?.flush(),this.delegate.componentReplaced?.(n)}static \u0275fac=function(r){!function m(){throw new Error("invalid")}()};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac})}return e})();class zB{delegate;replay=[];\u0275type=1;constructor(t){this.delegate=t}use(t){if(this.delegate=t,null!==this.replay){for(const n of this.replay)n(t);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(t,n){return this.delegate.createElement(t,n)}createComment(t){return this.delegate.createComment(t)}createText(t){return this.delegate.createText(t)}get destroyNode(){return this.delegate.destroyNode}appendChild(t,n){this.delegate.appendChild(t,n)}insertBefore(t,n,r,s){this.delegate.insertBefore(t,n,r,s)}removeChild(t,n,r){this.delegate.removeChild(t,n,r)}selectRootElement(t,n){return this.delegate.selectRootElement(t,n)}parentNode(t){return this.delegate.parentNode(t)}nextSibling(t){return this.delegate.nextSibling(t)}setAttribute(t,n,r,s){this.delegate.setAttribute(t,n,r,s)}removeAttribute(t,n,r){this.delegate.removeAttribute(t,n,r)}addClass(t,n){this.delegate.addClass(t,n)}removeClass(t,n){this.delegate.removeClass(t,n)}setStyle(t,n,r,s){this.delegate.setStyle(t,n,r,s)}removeStyle(t,n,r){this.delegate.removeStyle(t,n,r)}setProperty(t,n,r){this.shouldReplay(n)&&this.replay.push(s=>s.setProperty(t,n,r)),this.delegate.setProperty(t,n,r)}setValue(t,n){this.delegate.setValue(t,n)}listen(t,n,r,s){return this.shouldReplay(n)&&this.replay.push(l=>l.listen(t,n,r,s)),this.delegate.listen(t,n,r,s)}shouldReplay(t){return null!==this.replay&&t.startsWith("@")}}const jB=new p.nKC("");let qT=(()=>{class e{_viewContainer;_context=new D8;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(n,r){this._viewContainer=n,this._thenTemplateRef=r}set ngIf(n){this._context.$implicit=this._context.ngIf=n,this._updateView()}set ngIfThen(n){ZT(n),this._thenTemplateRef=n,this._thenViewRef=null,this._updateView()}set ngIfElse(n){ZT(n),this._elseTemplateRef=n,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(n,r){return!0}static \u0275fac=function(r){return new(r||e)(h(Zs),h(Sa))};static \u0275dir=Yo({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return e})();class D8{$implicit=null;ngIf=null}function ZT(e,t){if(e&&!e.createEmbeddedView)throw new p.buA(2020,!1)}let KT=(()=>{class e{_ngEl;_differs;_renderer;_ngStyle=null;_differ=null;constructor(n,r,s){this._ngEl=n,this._differs=r,this._renderer=s}set ngStyle(n){this._ngStyle=n,!this._differ&&n&&(this._differ=this._differs.find(n).create())}ngDoCheck(){if(this._differ){const n=this._differ.diff(this._ngStyle);n&&this._applyChanges(n)}}_setStyle(n,r){const[s,l]=n.split("."),d=-1===s.indexOf("-")?void 0:qs.DashCase;null!=r?this._renderer.setStyle(this._ngEl.nativeElement,s,l?`${r}${l}`:r,d):this._renderer.removeStyle(this._ngEl.nativeElement,s,d)}_applyChanges(n){n.forEachRemovedItem(r=>this._setStyle(r.key,null)),n.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),n.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}static \u0275fac=function(r){return new(r||e)(h(Nn),h(dy),h(Uu))};static \u0275dir=Yo({type:e,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}})}return e})(),XT=(()=>{class e{_viewContainerRef;_viewRef=null;ngTemplateOutletContext=null;ngTemplateOutlet=null;ngTemplateOutletInjector=null;constructor(n){this._viewContainerRef=n}ngOnChanges(n){if(this._shouldRecreateView(n)){const r=this._viewContainerRef;if(this._viewRef&&r.remove(r.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const s=this._createContextForwardProxy();this._viewRef=r.createEmbeddedView(this.ngTemplateOutlet,s,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(n){return!!n.ngTemplateOutlet||!!n.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(n,r,s)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,r,s),get:(n,r,s)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,r,s)}})}static \u0275fac=function(r){return new(r||e)(h(Zs))};static \u0275dir=Yo({type:e,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},features:[Ao]})}return e})(),u0=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=Bp({type:e});static \u0275inj=p.G2t({})}return e})(),Ji=(()=>class e{static STARTS_WITH="startsWith";static CONTAINS="contains";static NOT_CONTAINS="notContains";static ENDS_WITH="endsWith";static EQUALS="equals";static NOT_EQUALS="notEquals";static IN="in";static LESS_THAN="lt";static LESS_THAN_OR_EQUAL_TO="lte";static GREATER_THAN="gt";static GREATER_THAN_OR_EQUAL_TO="gte";static BETWEEN="between";static IS="is";static IS_NOT="isNot";static BEFORE="before";static AFTER="after";static DATE_IS="dateIs";static DATE_IS_NOT="dateIsNot";static DATE_BEFORE="dateBefore";static DATE_AFTER="dateAfter"})(),n6=(()=>{class e{template;type;name;constructor(n){this.template=n}getType(){return this.name}static \u0275fac=function(r){return new(r||e)(h(Sa))};static \u0275dir=Yo({type:e,selectors:[["","pTemplate",""]],inputs:{type:"type",name:[0,"pTemplate","name"]}})}return e})(),hg=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=Bp({type:e});static \u0275inj=p.G2t({imports:[u0]})}return e})();function xh(e){return null==e||""===e||Array.isArray(e)&&0===e.length||!(e instanceof Date)&&"object"==typeof e&&0===Object.keys(e).length}function io(e){return!xh(e)}function rc(e,t=!0){return e instanceof Object&&e.constructor===Object&&(t||0!==Object.keys(e).length)}function ul(e,...t){return function qx(e){return"function"==typeof e&&"call"in e&&"apply"in e}(e)?e(...t):e}function td(e,t=!0){return"string"==typeof e&&(t||""!==e)}function rI(e){return td(e)?e.replace(/(-|_)/g,"").toLowerCase():e}function oI(e,t="",n={}){let r=rI(t).split("."),s=r.shift();return s?rc(e)?oI(ul(e[Object.keys(e).find(d=>rI(d)===s)||""],n),r.join("."),n):void 0:ul(e,n)}function Lf(e,t){if(t){let n=t.test(e);return t.lastIndex=0,n}return!1}function d0(e){return e&&e.replace(/\/\*(?:(?!\*\/)[\s\S])*\*\/|[\r\n\t]+/g,"").replace(/ {2,}/g," ").replace(/ ([{:}]) /g,"$1").replace(/([;,]) /g,"$1").replace(/ !/g,"!").replace(/: /g,":").trim()}function sI(e){return td(e)?e.replace(/(_)/g,"-").replace(/[A-Z]/g,(t,n)=>0===n?t:"-"+t.toLowerCase()).toLowerCase():e}var m6=Object.defineProperty,_6=Object.defineProperties,y6=Object.getOwnPropertyDescriptors,Jy=Object.getOwnPropertySymbols,aI=Object.prototype.hasOwnProperty,lI=Object.prototype.propertyIsEnumerable,cI=(e,t,n)=>t in e?m6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,jr=(e,t)=>{for(var n in t||(t={}))aI.call(t,n)&&cI(e,n,t[n]);if(Jy)for(var n of Jy(t))lI.call(t,n)&&cI(e,n,t[n]);return e},Ff=(e,t)=>_6(e,y6(t)),nd=(e,t)=>{var n={};for(var r in e)aI.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Jy)for(var r of Jy(e))t.indexOf(r)<0&&lI.call(e,r)&&(n[r]=e[r]);return n},oc=function r6(){let e=new Map;return{on(t,n){let r=e.get(t);return r?r.push(n):r=[n],e.set(t,r),this},off(t,n){let r=e.get(t);return r&&r.splice(r.indexOf(n)>>>0,1),this},emit(t,n){let r=e.get(t);r&&r.forEach(s=>{s(n)})},clear(){e.clear()}}}(),wh=/{([^}]*)}/g,uI=/(\d+\s+[\+\-\*\/]\s+\d+)/g,dI=/var\([^)]+\)/g;function hI(e){return td(e)?e.replace(/[A-Z]/g,(t,n)=>0===n?t:"."+t.toLowerCase()).toLowerCase():e}function b6(e){return rc(e)&&e.hasOwnProperty("$value")&&e.hasOwnProperty("$type")?e.$value:e}function Yx(e="",t=""){return function x6(e){return e.replaceAll(/ /g,"").replace(/[^\w]/g,"-")}(`${td(e,!1)&&td(t,!1)?`${e}-`:e}${t}`)}function fI(e="",t=""){return`--${Yx(e,t)}`}function pI(e,t="",n="",r=[],s){if(td(e)){let l=e.trim();if(function w6(e=""){return((e.match(/{/g)||[]).length+(e.match(/}/g)||[]).length)%2!=0}(l))return;if(Lf(l,wh)){let d=l.replaceAll(wh,g=>{let v=g.replace(/{|}/g,"").split(".").filter(M=>!r.some(A=>Lf(M,A)));return`var(${fI(n,sI(v.join("-")))}${io(s)?`, ${s}`:""})`});return Lf(d.replace(dI,"0"),uI)?`calc(${d})`:d}return l}if(function p6(e){return io(e)&&!isNaN(e)}(e))return e}function C6(e,t,n){td(t,!1)&&e.push(`${t}:${n};`)}function fg(e,t){return e?`${e}{${t}}`:""}function gI(e,t){if(-1===e.indexOf("dt("))return e;function n(d,g){let v=[],M=0,A="",O=null,j=0;for(;M<=d.length;){let B=d[M];if(('"'===B||"'"===B||"`"===B)&&"\\"!==d[M-1]&&(O=O===B?null:B),!O&&("("===B&&j++,")"===B&&j--,(","===B||M===d.length)&&0===j)){let X=A.trim();X.startsWith("dt(")?v.push(gI(X,g)):v.push(r(X)),A="",M++;continue}void 0!==B&&(A+=B),M++}return v}function r(d){let g=d[0];if(('"'===g||"'"===g||"`"===g)&&d[d.length-1]===g)return d.slice(1,-1);let v=Number(d);return isNaN(v)?d:v}let s=[],l=[];for(let d=0;d<e.length;d++)if("d"===e[d]&&"dt("===e.slice(d,d+3))l.push(d),d+=2;else if(")"===e[d]&&l.length>0){let g=l.pop();0===l.length&&s.push([g,d])}if(!s.length)return e;for(let d=s.length-1;d>=0;d--){let[g,v]=s[d],O=t(...n(e.slice(g+3,v),t));e=e.slice(0,g)+O+e.slice(v+1)}return e}var Ch=(...e)=>Kx(On.getTheme(),...e),Kx=(e={},t,n,r)=>{if(t){let{variable:s,options:l}=On.defaults||{},{prefix:d,transform:g}=e?.options||l||{},v=Lf(t,wh)?t:`{${t}}`;return"value"===r||xh(r)&&"strict"===g?On.getTokenValue(t):pI(v,void 0,d,[s.excludedKeyRegex],n)}return""};function h0(e,...t){return e instanceof Array?gI(e.reduce((r,s,l)=>{var d;return r+s+(null!=(d=ul(t[l],{dt:Ch}))?d:"")},""),Ch):ul(e,{dt:Ch})}var ic={regex:{rules:{class:{pattern:/^\.([a-zA-Z][\w-]*)$/,resolve(e){return{type:"class",selector:e,matched:this.pattern.test(e.trim())}}},attr:{pattern:/^\[(.*)\]$/,resolve(e){return{type:"attr",selector:`:root${e}`,matched:this.pattern.test(e.trim())}}},media:{pattern:/^@media (.*)$/,resolve(e){return{type:"media",selector:e,matched:this.pattern.test(e.trim())}}},system:{pattern:/^system$/,resolve(e){return{type:"system",selector:"@media (prefers-color-scheme: dark)",matched:this.pattern.test(e.trim())}}},custom:{resolve:e=>({type:"custom",selector:e,matched:!0})}},resolve(e){let t=Object.keys(this.rules).filter(n=>"custom"!==n).map(n=>this.rules[n]);return[e].flat().map(n=>{var r;return null!=(r=t.map(s=>s.resolve(n)).find(s=>s.matched))?r:this.rules.custom.resolve(n)})}},_toVariables:(e,t)=>function T6(e,t={}){let n=On.defaults.variable,{prefix:r=n.prefix,selector:s=n.selector,excludedKeyRegex:l=n.excludedKeyRegex}=t,d=[],g=[],v=[{node:e,path:r}];for(;v.length;){let{node:A,path:O}=v.pop();for(let j in A){let X=b6(A[j]),le=Lf(j,l)?Yx(O):Yx(O,sI(j));if(rc(X))v.push({node:X,path:le});else{C6(g,fI(le),pI(X,le,r,[l]));let De=le;r&&De.startsWith(r+"-")&&(De=De.slice(r.length+1)),d.push(De.replace(/-/g,"."))}}}let M=g.join("");return{value:g,tokens:d,declarations:M,css:fg(s,M)}}(e,{prefix:t?.prefix}),getCommon({name:e="",theme:t={},set:r,defaults:s}){var l,d,g,v,M,A,O;let X,le,_e,Ie,De,nt,kt,{preset:j,options:B}=t;if(io(j)&&"strict"!==B.transform){let{primitive:yt,semantic:pn,extend:_n}=j,Vr=pn||{},{colorScheme:Kr}=Vr,Da=nd(Vr,["colorScheme"]),Ai=_n||{},{colorScheme:lc}=Ai,fl=nd(Ai,["colorScheme"]),Tg=Kr||{},{dark:yv}=Tg,vv=nd(Tg,["dark"]),bv=lc||{},{dark:xv}=bv,wv=nd(bv,["dark"]),Cv=io(yt)?this._toVariables({primitive:yt},B):{},Sv=io(Da)?this._toVariables({semantic:Da},B):{},Ev=io(vv)?this._toVariables({light:vv},B):{},OD=io(yv)?this._toVariables({dark:yv},B):{},ND=io(fl)?this._toVariables({semantic:fl},B):{},LD=io(wv)?this._toVariables({light:wv},B):{},FD=io(xv)?this._toVariables({dark:xv},B):{},[wQ,CQ]=[null!=(l=Cv.declarations)?l:"",Cv.tokens],[SQ,EQ]=[null!=(d=Sv.declarations)?d:"",Sv.tokens||[]],[MQ,TQ]=[null!=(g=Ev.declarations)?g:"",Ev.tokens||[]],[IQ,DQ]=[null!=(v=OD.declarations)?v:"",OD.tokens||[]],[AQ,PQ]=[null!=(M=ND.declarations)?M:"",ND.tokens||[]],[kQ,RQ]=[null!=(A=LD.declarations)?A:"",LD.tokens||[]],[OQ,NQ]=[null!=(O=FD.declarations)?O:"",FD.tokens||[]];X=this.transformCSS(e,wQ,"light","variable",B,r,s),le=CQ,_e=`${this.transformCSS(e,`${SQ}${MQ}`,"light","variable",B,r,s)}${this.transformCSS(e,`${IQ}`,"dark","variable",B,r,s)}`,Ie=[...new Set([...EQ,...TQ,...DQ])],De=`${this.transformCSS(e,`${AQ}${kQ}color-scheme:light`,"light","variable",B,r,s)}${this.transformCSS(e,`${OQ}color-scheme:dark`,"dark","variable",B,r,s)}`,nt=[...new Set([...PQ,...RQ,...NQ])],kt=ul(j.css,{dt:Ch})}return{primitive:{css:X,tokens:le},semantic:{css:_e,tokens:Ie},global:{css:De,tokens:nt},style:kt}},getPreset({name:e="",preset:t={},options:n,set:s,defaults:l,selector:d}){var g,v,M;let A,O,j;if(io(t)&&"strict"!==n.transform){let B=e.replace("-directive",""),X=t,{colorScheme:le,extend:_e,css:Ie}=X,De=nd(X,["colorScheme","extend","css"]),nt=_e||{},{colorScheme:kt}=nt,yt=nd(nt,["colorScheme"]),pn=le||{},{dark:_n}=pn,Vr=nd(pn,["dark"]),Kr=kt||{},{dark:Da}=Kr,Ai=nd(Kr,["dark"]),lc=io(De)?this._toVariables({[B]:jr(jr({},De),yt)},n):{},fl=io(Vr)?this._toVariables({[B]:jr(jr({},Vr),Ai)},n):{},Tg=io(_n)?this._toVariables({[B]:jr(jr({},_n),Da)},n):{},[yv,vv]=[null!=(g=lc.declarations)?g:"",lc.tokens||[]],[bv,xv]=[null!=(v=fl.declarations)?v:"",fl.tokens||[]],[wv,Cv]=[null!=(M=Tg.declarations)?M:"",Tg.tokens||[]];A=`${this.transformCSS(B,`${yv}${bv}`,"light","variable",n,s,l,d)}${this.transformCSS(B,wv,"dark","variable",n,s,l,d)}`,O=[...new Set([...vv,...xv,...Cv])],j=ul(Ie,{dt:Ch})}return{css:A,tokens:O,style:j}},getPresetC({name:e="",theme:t={},params:n,set:r,defaults:s}){var l;let{preset:d,options:g}=t,v=null==(l=d?.components)?void 0:l[e];return this.getPreset({name:e,preset:v,options:g,params:n,set:r,defaults:s})},getPresetD({name:e="",theme:t={},params:n,set:r,defaults:s}){var l,d;let g=e.replace("-directive",""),{preset:v,options:M}=t,A=(null==(l=v?.components)?void 0:l[g])||(null==(d=v?.directives)?void 0:d[g]);return this.getPreset({name:g,preset:A,options:M,params:n,set:r,defaults:s})},applyDarkColorScheme:e=>!("none"===e.darkModeSelector||!1===e.darkModeSelector),getColorSchemeOption(e,t){var n;return this.applyDarkColorScheme(e)?this.regex.resolve(!0===e.darkModeSelector?t.options.darkModeSelector:null!=(n=e.darkModeSelector)?n:t.options.darkModeSelector):[]},getLayerOrder(e,t={},n,r){let{cssLayer:s}=t;return s?`@layer ${ul(s.order||s.name||"primeui",n)}`:""},getCommonStyleSheet({name:e="",theme:t={},params:n,props:r={},set:s,defaults:l}){let d=this.getCommon({name:e,theme:t,params:n,set:s,defaults:l}),g=Object.entries(r).reduce((v,[M,A])=>v.push(`${M}="${A}"`)&&v,[]).join(" ");return Object.entries(d||{}).reduce((v,[M,A])=>{if(rc(A)&&Object.hasOwn(A,"css")){let O=d0(A.css);v.push(`<style type="text/css" data-primevue-style-id="${M}-variables" ${g}>${O}</style>`)}return v},[]).join("")},getStyleSheet({name:e="",theme:t={},params:n,props:r={},set:s,defaults:l}){var d;let g={name:e,theme:t,params:n,set:s,defaults:l},v=null==(d=e.includes("-directive")?this.getPresetD(g):this.getPresetC(g))?void 0:d.css,M=Object.entries(r).reduce((A,[O,j])=>A.push(`${O}="${j}"`)&&A,[]).join(" ");return v?`<style type="text/css" data-primevue-style-id="${e}-variables" ${M}>${d0(v)}</style>`:""},createTokens(e={},t,n="",r="",s={}){let l=function(g,v={},M=[]){if(M.includes(this.path))return console.warn(`Circular reference detected at ${this.path}`),{colorScheme:g,path:this.path,paths:v,value:void 0};M.push(this.path),v.name=this.path,v.binding||(v.binding={});let A=this.value;if("string"==typeof this.value&&wh.test(this.value)){let O=this.value.trim().replace(wh,j=>{var B;let X=j.slice(1,-1),le=this.tokens[X];if(!le)return console.warn(`Token not found for path: ${X}`),"__UNRESOLVED__";let _e=le.computed(g,v,M);return Array.isArray(_e)&&2===_e.length?`light-dark(${_e[0].value},${_e[1].value})`:null!=(B=_e?.value)?B:"__UNRESOLVED__"});A=uI.test(O.replace(dI,"0"))?`calc(${O})`:O}return xh(v.binding)&&delete v.binding,M.pop(),{colorScheme:g,path:this.path,paths:v,value:A.includes("__UNRESOLVED__")?void 0:A}},d=(g,v,M)=>{Object.entries(g).forEach(([A,O])=>{let j=Lf(A,t.variable.excludedKeyRegex)?v:v?`${v}.${hI(A)}`:hI(A),B=M?`${M}.${A}`:A;rc(O)?d(O,j,B):(s[j]||(s[j]={paths:[],computed:(X,le={},_e=[])=>{if(1===s[j].paths.length)return s[j].paths[0].computed(s[j].paths[0].scheme,le.binding,_e);if(X&&"none"!==X)for(let Ie=0;Ie<s[j].paths.length;Ie++){let De=s[j].paths[Ie];if(De.scheme===X)return De.computed(X,le.binding,_e)}return s[j].paths.map(Ie=>Ie.computed(Ie.scheme,le[Ie.scheme],_e))}}),s[j].paths.push({path:B,value:O,scheme:B.includes("colorScheme.light")?"light":B.includes("colorScheme.dark")?"dark":"none",computed:l,tokens:s}))})};return d(e,n,r),s},getTokenValue(e,t,n){var r;let s=t.split(".").filter(v=>!Lf(v.toLowerCase(),n.variable.excludedKeyRegex)).join("."),l=t.includes("colorScheme.light")?"light":t.includes("colorScheme.dark")?"dark":void 0,d=[null==(r=e[s])?void 0:r.computed(l)].flat().filter(g=>g);return 1===d.length?d[0].value:d.reduce((g={},v)=>{let M=v,{colorScheme:A}=M,O=nd(M,["colorScheme"]);return g[A]=O,g},void 0)},getSelectorRule:(e,t,n,r)=>"class"===n||"attr"===n?fg(io(t)?`${e}${t},${e} ${t}`:e,r):fg(e,fg(t??":root",r)),transformCSS(e,t,n,r,s={},l,d,g){if(io(t)){let{cssLayer:v}=s;if("style"!==r){let M=this.getColorSchemeOption(s,d);t="dark"===n?M.reduce((A,{type:O,selector:j})=>(io(j)&&(A+=j.includes("[CSS]")?j.replace("[CSS]",t):this.getSelectorRule(j,g,O,t)),A),""):fg(g??":root",t)}if(v){let M={name:"primeui",order:"primeui"};rc(v)&&(M.name=ul(v.name,{name:e,type:r})),io(M.name)&&(t=fg(`@layer ${M.name}`,t),l?.layerNames(M.name))}return t}return""}},On={defaults:{variable:{prefix:"p",selector:":root",excludedKeyRegex:/^(primitive|semantic|components|directives|variables|colorscheme|light|dark|common|root|states|extend|css)$/gi},options:{prefix:"p",darkModeSelector:"system",cssLayer:!1}},_theme:void 0,_layerNames:new Set,_loadedStyleNames:new Set,_loadingStyles:new Set,_tokens:{},update(e={}){let{theme:t}=e;t&&(this._theme=Ff(jr({},t),{options:jr(jr({},this.defaults.options),t.options)}),this._tokens=ic.createTokens(this.preset,this.defaults),this.clearLoadedStyleNames())},get theme(){return this._theme},get preset(){var e;return(null==(e=this.theme)?void 0:e.preset)||{}},get options(){var e;return(null==(e=this.theme)?void 0:e.options)||{}},get tokens(){return this._tokens},getTheme(){return this.theme},setTheme(e){this.update({theme:e}),oc.emit("theme:change",e)},getPreset(){return this.preset},setPreset(e){this._theme=Ff(jr({},this.theme),{preset:e}),this._tokens=ic.createTokens(e,this.defaults),this.clearLoadedStyleNames(),oc.emit("preset:change",e),oc.emit("theme:change",this.theme)},getOptions(){return this.options},setOptions(e){this._theme=Ff(jr({},this.theme),{options:e}),this.clearLoadedStyleNames(),oc.emit("options:change",e),oc.emit("theme:change",this.theme)},getLayerNames(){return[...this._layerNames]},setLayerNames(e){this._layerNames.add(e)},getLoadedStyleNames(){return this._loadedStyleNames},isStyleNameLoaded(e){return this._loadedStyleNames.has(e)},setLoadedStyleName(e){this._loadedStyleNames.add(e)},deleteLoadedStyleName(e){this._loadedStyleNames.delete(e)},clearLoadedStyleNames(){this._loadedStyleNames.clear()},getTokenValue(e){return ic.getTokenValue(this.tokens,e,this.defaults)},getCommon(e="",t){return ic.getCommon({name:e,theme:this.theme,params:t,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getComponent(e="",t){let n={name:e,theme:this.theme,params:t,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return ic.getPresetC(n)},getDirective(e="",t){let n={name:e,theme:this.theme,params:t,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return ic.getPresetD(n)},getCustomPreset(e="",t,n,r){let s={name:e,preset:t,options:this.options,selector:n,params:r,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return ic.getPreset(s)},getLayerOrderCSS(e=""){return ic.getLayerOrder(e,this.options,{names:this.getLayerNames()},this.defaults)},transformCSS(e="",t,n="style",r){return ic.transformCSS(e,t,r,n,this.options,{layerNames:this.setLayerNames.bind(this)},this.defaults)},getCommonStyleSheet(e="",t,n={}){return ic.getCommonStyleSheet({name:e,theme:this.theme,params:t,props:n,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getStyleSheet(e,t,n={}){return ic.getStyleSheet({name:e,theme:this.theme,params:t,props:n,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},onStyleMounted(e){this._loadingStyles.add(e)},onStyleUpdated(e){this._loadingStyles.add(e)},onStyleLoaded(e,{name:t}){this._loadingStyles.size&&(this._loadingStyles.delete(t),oc.emit(`theme:${t}:load`,e),!this._loadingStyles.size&&oc.emit("theme:load"))}};function pg(e,t){if(e&&t){let n=r=>{e.classList?e.classList.remove(r):e.className=e.className.replace(new RegExp("(^|\\b)"+r.split(" ").join("|")+"(\\b|$)","gi")," ")};[t].flat().filter(Boolean).forEach(r=>r.split(" ").forEach(n))}}function ew(e){return e?Math.abs(e.scrollLeft):0}function iw(e,t={}){if(function Sh(e){return typeof Element<"u"?e instanceof Element:null!==e&&"object"==typeof e&&1===e.nodeType&&"string"==typeof e.nodeName}(e)){let n=(r,s)=>{var l,d;let g=null!=(l=e?.$attrs)&&l[r]?[null==(d=e?.$attrs)?void 0:d[r]]:[];return[s].flat().reduce((v,M)=>{if(null!=M){let A=typeof M;if("string"===A||"number"===A)v.push(M);else if("object"===A){let O=Array.isArray(M)?n(r,M):Object.entries(M).map(([j,B])=>"style"!==r||!B&&0!==B?B?j:void 0:`${j.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${B}`);v=O.length?v.concat(O.filter(j=>!!j)):v}}return v},g)};Object.entries(t).forEach(([r,s])=>{if(null!=s){let l=r.match(/^on(.+)/);l?e.addEventListener(l[1].toLowerCase(),s):"p-bind"===r||"pBind"===r?iw(e,s):(s="class"===r?[...new Set(n("class",s))].join(" ").trim():"style"===r?n("style",s).join(";").trim():s,(e.$attrs=e.$attrs||{})&&(e.$attrs[r]=s),e.setAttribute(r,s))}})}}function EI(e){if(e){let t=e.offsetHeight,n=getComputedStyle(e);return t-=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom)+parseFloat(n.borderTopWidth)+parseFloat(n.borderBottomWidth),t}return 0}function II(e){if(e){let t=e.offsetWidth,n=getComputedStyle(e);return t-=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight)+parseFloat(n.borderLeftWidth)+parseFloat(n.borderRightWidth),t}return 0}let X6=0,Q6=(()=>{class e{document=(0,p.WQX)(p.qQL);use(n,r={}){let l=n,d=null;const{immediate:g=!0,manual:v=!1,name:M="style_"+ ++X6,id:A,media:O,nonce:j,first:B=!1,props:X={}}=r;if(this.document){if(d=this.document.querySelector(`style[data-primeng-style-id="${M}"]`)||A&&this.document.getElementById(A)||this.document.createElement("style"),!d.isConnected){l=n;const le=this.document.head;B&&le.firstChild?le.insertBefore(d,le.firstChild):le.appendChild(d),iw(d,{type:"text/css",media:O,nonce:j,"data-primeng-style-id":M})}return d.textContent!==l&&(d.textContent=l),{id:A,name:M,el:d,css:l}}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var f0={_loadedStyleNames:new Set,getLoadedStyleNames(){return this._loadedStyleNames},isStyleNameLoaded(e){return this._loadedStyleNames.has(e)},setLoadedStyleName(e){this._loadedStyleNames.add(e)},deleteLoadedStyleName(e){this._loadedStyleNames.delete(e)},clearLoadedStyleNames(){this._loadedStyleNames.clear()}};let od=(()=>{class e{name="base";useStyle=(0,p.WQX)(Q6);theme=void 0;css=void 0;classes={};inlineStyles={};load=(n,r={},s=l=>l)=>{const l=s(h0`${ul(n,{dt:Ch})}`);return l?this.useStyle.use(d0(l),{name:this.name,...r}):{}};loadCSS=(n={})=>this.load(this.css,n);loadTheme=(n={},r="")=>this.load(this.theme,n,(s="")=>On.transformCSS(n.name||this.name,`${s}${h0`${r}`}`));loadGlobalCSS=(n={})=>this.load("\n.p-hidden-accessible {\n    border: 0;\n    clip: rect(0 0 0 0);\n    height: 1px;\n    margin: -1px;\n    overflow: hidden;\n    padding: 0;\n    position: absolute;\n    width: 1px;\n}\n\n.p-hidden-accessible input,\n.p-hidden-accessible select {\n    transform: scale(0);\n}\n\n.p-overflow-hidden {\n    overflow: hidden;\n    padding-right: dt('scrollbar.width');\n}\n",n);loadGlobalTheme=(n={},r="")=>this.load("\n    *,\n    ::before,\n    ::after {\n        box-sizing: border-box;\n    }\n\n    /* Non vue overlay animations */\n    .p-connected-overlay {\n        opacity: 0;\n        transform: scaleY(0.8);\n        transition:\n            transform 0.12s cubic-bezier(0, 0, 0.2, 1),\n            opacity 0.12s cubic-bezier(0, 0, 0.2, 1);\n    }\n\n    .p-connected-overlay-visible {\n        opacity: 1;\n        transform: scaleY(1);\n    }\n\n    .p-connected-overlay-hidden {\n        opacity: 0;\n        transform: scaleY(1);\n        transition: opacity 0.1s linear;\n    }\n\n    /* Vue based overlay animations */\n    .p-connected-overlay-enter-from {\n        opacity: 0;\n        transform: scaleY(0.8);\n    }\n\n    .p-connected-overlay-leave-to {\n        opacity: 0;\n    }\n\n    .p-connected-overlay-enter-active {\n        transition:\n            transform 0.12s cubic-bezier(0, 0, 0.2, 1),\n            opacity 0.12s cubic-bezier(0, 0, 0.2, 1);\n    }\n\n    .p-connected-overlay-leave-active {\n        transition: opacity 0.1s linear;\n    }\n\n    /* Toggleable Content */\n    .p-toggleable-content-enter-from,\n    .p-toggleable-content-leave-to {\n        max-height: 0;\n    }\n\n    .p-toggleable-content-enter-to,\n    .p-toggleable-content-leave-from {\n        max-height: 1000px;\n    }\n\n    .p-toggleable-content-leave-active {\n        overflow: hidden;\n        transition: max-height 0.45s cubic-bezier(0, 1, 0, 1);\n    }\n\n    .p-toggleable-content-enter-active {\n        overflow: hidden;\n        transition: max-height 1s ease-in-out;\n    }\n\n    .p-disabled,\n    .p-disabled * {\n        cursor: default;\n        pointer-events: none;\n        user-select: none;\n    }\n\n    .p-disabled,\n    .p-component:disabled {\n        opacity: dt('disabled.opacity');\n    }\n\n    .pi {\n        font-size: dt('icon.size');\n    }\n\n    .p-icon {\n        width: dt('icon.size');\n        height: dt('icon.size');\n    }\n\n    .p-overlay-mask {\n        background: dt('mask.background');\n        color: dt('mask.color');\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100%;\n        height: 100%;\n    }\n\n    .p-overlay-mask-enter {\n        animation: p-overlay-mask-enter-animation dt('mask.transition.duration') forwards;\n    }\n\n    .p-overlay-mask-leave {\n        animation: p-overlay-mask-leave-animation dt('mask.transition.duration') forwards;\n    }\n\n    @keyframes p-overlay-mask-enter-animation {\n        from {\n            background: transparent;\n        }\n        to {\n            background: dt('mask.background');\n        }\n    }\n    @keyframes p-overlay-mask-leave-animation {\n        from {\n            background: dt('mask.background');\n        }\n        to {\n            background: transparent;\n        }\n    }\n",n,(s="")=>On.transformCSS(n.name||this.name,`${s}${h0`${r}`}`));getCommonTheme=n=>On.getCommon(this.name,n);getComponentTheme=n=>On.getComponent(this.name,n);getDirectiveTheme=n=>On.getDirective(this.name,n);getPresetTheme=(n,r,s)=>On.getCustomPreset(this.name,n,r,s);getLayerOrderThemeCSS=()=>On.getLayerOrderCSS(this.name);getStyleSheet=(n="",r={})=>{if(this.css){const l=d0(h0`${ul(this.css,{dt:Ch})}${n}`),d=Object.entries(r).reduce((g,[v,M])=>g.push(`${v}="${M}"`)&&g,[]).join(" ");return`<style type="text/css" data-primeng-style-id="${this.name}" ${d}>${l}</style>`}return""};getCommonThemeStyleSheet=(n,r={})=>On.getCommonStyleSheet(this.name,n,r);getThemeStyleSheet=(n,r={})=>{let s=[On.getStyleSheet(this.name,n,r)];if(this.theme){const l="base"===this.name?"global-style":`${this.name}-style`,d=h0`${ul(this.theme,{dt:Ch})}`,g=d0(On.transformCSS(l,d)),v=Object.entries(r).reduce((M,[A,O])=>M.push(`${A}="${O}"`)&&M,[]).join(" ");s.push(`<style type="text/css" data-primeng-style-id="${l}" ${v}>${g}</style>`)}return s.join("")};static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),ez=(()=>{class e{theme=(0,p.vPA)(void 0);csp=(0,p.vPA)({nonce:void 0});isThemeChanged=!1;document=(0,p.WQX)(p.qQL);baseStyle=(0,p.WQX)(od);constructor(){vy(()=>{oc.on("theme:change",n=>{Xo(()=>{this.isThemeChanged=!0,this.theme.set(n)})})}),vy(()=>{const n=this.theme();this.document&&n&&(this.isThemeChanged||this.onThemeChange(n),this.isThemeChanged=!1)})}ngOnDestroy(){On.clearLoadedStyleNames(),oc.clear()}onThemeChange(n){On.setTheme(n),this.document&&this.loadCommonTheme()}loadCommonTheme(){if("none"!==this.theme()&&!On.isStyleNameLoaded("common")){const{primitive:n,semantic:r,global:s,style:l}=this.baseStyle.getCommonTheme?.()||{},d={nonce:this.csp?.()?.nonce};this.baseStyle.load(n?.css,{name:"primitive-variables",...d}),this.baseStyle.load(r?.css,{name:"semantic-variables",...d}),this.baseStyle.load(s?.css,{name:"global-variables",...d}),this.baseStyle.loadGlobalTheme({name:"global-style",...d},l),On.setLoadedStyleName("common")}}setThemeConfig(n){const{theme:r,csp:s}=n||{};r&&this.theme.set(r),s&&this.csp.set(s)}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),DI=(()=>{class e extends ez{ripple=(0,p.vPA)(!1);platformId=(0,p.WQX)(Fs);inputStyle=(0,p.vPA)(null);inputVariant=(0,p.vPA)(null);overlayAppendTo=(0,p.vPA)("self");overlayOptions={};csp=(0,p.vPA)({nonce:void 0});filterMatchModeOptions={text:[Ji.STARTS_WITH,Ji.CONTAINS,Ji.NOT_CONTAINS,Ji.ENDS_WITH,Ji.EQUALS,Ji.NOT_EQUALS],numeric:[Ji.EQUALS,Ji.NOT_EQUALS,Ji.LESS_THAN,Ji.LESS_THAN_OR_EQUAL_TO,Ji.GREATER_THAN,Ji.GREATER_THAN_OR_EQUAL_TO],date:[Ji.DATE_IS,Ji.DATE_IS_NOT,Ji.DATE_BEFORE,Ji.DATE_AFTER]};translation={startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",is:"Is",isNot:"Is not",before:"Before",after:"After",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",completed:"Completed",upload:"Upload",cancel:"Cancel",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",dateFormat:"mm/dd/yy",firstDayOfWeek:0,today:"Today",weekHeader:"Wk",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyMessage:"No results found",searchMessage:"Search results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",emptyFilterMessage:"No results found",fileChosenMessage:"Files",noFileChosenMessage:"No file chosen",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"{page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",previousPageLabel:"Previous Page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left",listLabel:"Option List",selectColor:"Select a color",removeLabel:"Remove",browseFiles:"Browse Files",maximizeLabel:"Maximize"}};zIndex={modal:1100,overlay:1e3,menu:1e3,tooltip:1100};translationSource=new St.B;translationObserver=this.translationSource.asObservable();getTranslation(n){return this.translation[n]}setTranslation(n){this.translation={...this.translation,...n},this.translationSource.next(this.translation)}setConfig(n){const{csp:r,ripple:s,inputStyle:l,inputVariant:d,theme:g,overlayOptions:v,translation:M,filterMatchModeOptions:A,overlayAppendTo:O}=n||{};r&&this.csp.set(r),O&&this.overlayAppendTo.set(O),s&&this.ripple.set(s),l&&this.inputStyle.set(l),d&&this.inputVariant.set(d),v&&(this.overlayOptions=v),M&&this.setTranslation(M),A&&(this.filterMatchModeOptions=A),g&&this.setThemeConfig({theme:g,csp:r})}static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const tz=new p.nKC("PRIME_NG_CONFIG");var gW=Object.defineProperty,_W=Object.getOwnPropertyDescriptors,AI=Object.getOwnPropertySymbols,yW=Object.prototype.hasOwnProperty,vW=Object.prototype.propertyIsEnumerable,PI=(e,t,n)=>t in e?gW(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,bW=(0,Object.defineProperties)(((e,t)=>{for(var n in t||(t={}))yW.call(t,n)&&PI(e,n,t[n]);if(AI)for(var n of AI(t))vW.call(t,n)&&PI(e,n,t[n]);return e})({},{primitive:{borderRadius:{none:"0",xs:"2px",sm:"4px",md:"6px",lg:"8px",xl:"12px"},emerald:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},green:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},lime:{50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},red:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},orange:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},amber:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},yellow:{50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},teal:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},cyan:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},sky:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},blue:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},indigo:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},violet:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},purple:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},fuchsia:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},pink:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},rose:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},slate:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},gray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},zinc:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},neutral:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},stone:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"}},semantic:{transitionDuration:"0.2s",focusRing:{width:"1px",style:"solid",color:"{primary.color}",offset:"2px",shadow:"none"},disabledOpacity:"0.6",iconSize:"1rem",anchorGutter:"2px",primary:{50:"{emerald.50}",100:"{emerald.100}",200:"{emerald.200}",300:"{emerald.300}",400:"{emerald.400}",500:"{emerald.500}",600:"{emerald.600}",700:"{emerald.700}",800:"{emerald.800}",900:"{emerald.900}",950:"{emerald.950}"},formField:{paddingX:"0.75rem",paddingY:"0.5rem",sm:{fontSize:"0.875rem",paddingX:"0.625rem",paddingY:"0.375rem"},lg:{fontSize:"1.125rem",paddingX:"0.875rem",paddingY:"0.625rem"},borderRadius:"{border.radius.md}",focusRing:{width:"0",style:"none",color:"transparent",offset:"0",shadow:"none"},transitionDuration:"{transition.duration}"},list:{padding:"0.25rem 0.25rem",gap:"2px",header:{padding:"0.5rem 1rem 0.25rem 1rem"},option:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}"},optionGroup:{padding:"0.5rem 0.75rem",fontWeight:"600"}},content:{borderRadius:"{border.radius.md}"},mask:{transitionDuration:"0.15s"},navigation:{list:{padding:"0.25rem 0.25rem",gap:"2px"},item:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}",gap:"0.5rem"},submenuLabel:{padding:"0.5rem 0.75rem",fontWeight:"600"},submenuIcon:{size:"0.875rem"}},overlay:{select:{borderRadius:"{border.radius.md}",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},popover:{borderRadius:"{border.radius.md}",padding:"0.75rem",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},modal:{borderRadius:"{border.radius.xl}",padding:"1.25rem",shadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)"},navigation:{shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"}},colorScheme:{light:{surface:{0:"#ffffff",50:"{slate.50}",100:"{slate.100}",200:"{slate.200}",300:"{slate.300}",400:"{slate.400}",500:"{slate.500}",600:"{slate.600}",700:"{slate.700}",800:"{slate.800}",900:"{slate.900}",950:"{slate.950}"},primary:{color:"{primary.500}",contrastColor:"#ffffff",hoverColor:"{primary.600}",activeColor:"{primary.700}"},highlight:{background:"{primary.50}",focusBackground:"{primary.100}",color:"{primary.700}",focusColor:"{primary.800}"},mask:{background:"rgba(0,0,0,0.4)",color:"{surface.200}"},formField:{background:"{surface.0}",disabledBackground:"{surface.200}",filledBackground:"{surface.50}",filledHoverBackground:"{surface.50}",filledFocusBackground:"{surface.50}",borderColor:"{surface.300}",hoverBorderColor:"{surface.400}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.400}",color:"{surface.700}",disabledColor:"{surface.500}",placeholderColor:"{surface.500}",invalidPlaceholderColor:"{red.600}",floatLabelColor:"{surface.500}",floatLabelFocusColor:"{primary.600}",floatLabelActiveColor:"{surface.500}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.700}",hoverColor:"{surface.800}",mutedColor:"{surface.500}",hoverMutedColor:"{surface.600}"},content:{background:"{surface.0}",hoverBackground:"{surface.100}",borderColor:"{surface.200}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},popover:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},modal:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.100}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.100}",activeBackground:"{surface.100}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}}},dark:{surface:{0:"#ffffff",50:"{zinc.50}",100:"{zinc.100}",200:"{zinc.200}",300:"{zinc.300}",400:"{zinc.400}",500:"{zinc.500}",600:"{zinc.600}",700:"{zinc.700}",800:"{zinc.800}",900:"{zinc.900}",950:"{zinc.950}"},primary:{color:"{primary.400}",contrastColor:"{surface.900}",hoverColor:"{primary.300}",activeColor:"{primary.200}"},highlight:{background:"color-mix(in srgb, {primary.400}, transparent 84%)",focusBackground:"color-mix(in srgb, {primary.400}, transparent 76%)",color:"rgba(255,255,255,.87)",focusColor:"rgba(255,255,255,.87)"},mask:{background:"rgba(0,0,0,0.6)",color:"{surface.200}"},formField:{background:"{surface.950}",disabledBackground:"{surface.700}",filledBackground:"{surface.800}",filledHoverBackground:"{surface.800}",filledFocusBackground:"{surface.800}",borderColor:"{surface.600}",hoverBorderColor:"{surface.500}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.300}",color:"{surface.0}",disabledColor:"{surface.400}",placeholderColor:"{surface.400}",invalidPlaceholderColor:"{red.400}",floatLabelColor:"{surface.400}",floatLabelFocusColor:"{primary.color}",floatLabelActiveColor:"{surface.400}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.0}",hoverColor:"{surface.0}",mutedColor:"{surface.400}",hoverMutedColor:"{surface.300}"},content:{background:"{surface.900}",hoverBackground:"{surface.800}",borderColor:"{surface.700}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},popover:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},modal:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.800}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.800}",activeBackground:"{surface.800}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}}}}}}),_W({components:{accordion:{root:{transitionDuration:"{transition.duration}"},panel:{borderWidth:"0 0 1px 0",borderColor:"{content.border.color}"},header:{color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}",padding:"1.125rem",fontWeight:"600",borderRadius:"0",borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",hoverBackground:"{content.background}",activeBackground:"{content.background}",activeHoverBackground:"{content.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},toggleIcon:{color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}"},first:{topBorderRadius:"{content.border.radius}",borderWidth:"0"},last:{bottomBorderRadius:"{content.border.radius}",activeBottomBorderRadius:"0"}},content:{borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",color:"{text.color}",padding:"0 1.125rem 1.125rem 1.125rem"}},autocomplete:{root:{background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},overlay:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},list:{padding:"{list.padding}",gap:"{list.gap}"},option:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},optionGroup:{background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},dropdown:{width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},chip:{borderRadius:"{border.radius.sm}"},emptyMessage:{padding:"{list.option.padding}"},colorScheme:{light:{chip:{focusBackground:"{surface.200}",focusColor:"{surface.800}"},dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",focusColor:"{surface.0}"},dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"}}}},avatar:{root:{width:"2rem",height:"2rem",fontSize:"1rem",background:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},icon:{size:"1rem"},group:{borderColor:"{content.background}",offset:"-0.75rem"},lg:{width:"3rem",height:"3rem",fontSize:"1.5rem",icon:{size:"1.5rem"},group:{offset:"-1rem"}},xl:{width:"4rem",height:"4rem",fontSize:"2rem",icon:{size:"2rem"},group:{offset:"-1.5rem"}}},badge:{root:{borderRadius:"{border.radius.md}",padding:"0 0.5rem",fontSize:"0.75rem",fontWeight:"700",minWidth:"1.5rem",height:"1.5rem"},dot:{size:"0.5rem"},sm:{fontSize:"0.625rem",minWidth:"1.25rem",height:"1.25rem"},lg:{fontSize:"0.875rem",minWidth:"1.75rem",height:"1.75rem"},xl:{fontSize:"1rem",minWidth:"2rem",height:"2rem"},colorScheme:{light:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.500}",color:"{surface.0}"},info:{background:"{sky.500}",color:"{surface.0}"},warn:{background:"{orange.500}",color:"{surface.0}"},danger:{background:"{red.500}",color:"{surface.0}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"{green.400}",color:"{green.950}"},info:{background:"{sky.400}",color:"{sky.950}"},warn:{background:"{orange.400}",color:"{orange.950}"},danger:{background:"{red.400}",color:"{red.950}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}}},blockui:{root:{borderRadius:"{content.border.radius}"}},breadcrumb:{root:{padding:"1rem",background:"{content.background}",gap:"0.5rem",transitionDuration:"{transition.duration}"},item:{color:"{text.muted.color}",hoverColor:"{text.color}",borderRadius:"{content.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",hoverColor:"{navigation.item.icon.focus.color}"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},separator:{color:"{navigation.item.icon.color}"}},button:{root:{borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",gap:"0.5rem",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",iconOnlyWidth:"2.5rem",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}",iconOnlyWidth:"2rem"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}",iconOnlyWidth:"3rem"},label:{fontWeight:"500"},raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"},badgeSize:"1rem",transitionDuration:"{form.field.transition.duration}"},colorScheme:{light:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",borderColor:"{surface.100}",hoverBorderColor:"{surface.200}",activeBorderColor:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}",focusRing:{color:"{surface.600}",shadow:"none"}},info:{background:"{sky.500}",hoverBackground:"{sky.600}",activeBackground:"{sky.700}",borderColor:"{sky.500}",hoverBorderColor:"{sky.600}",activeBorderColor:"{sky.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{sky.500}",shadow:"none"}},success:{background:"{green.500}",hoverBackground:"{green.600}",activeBackground:"{green.700}",borderColor:"{green.500}",hoverBorderColor:"{green.600}",activeBorderColor:"{green.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{green.500}",shadow:"none"}},warn:{background:"{orange.500}",hoverBackground:"{orange.600}",activeBackground:"{orange.700}",borderColor:"{orange.500}",hoverBorderColor:"{orange.600}",activeBorderColor:"{orange.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{orange.500}",shadow:"none"}},help:{background:"{purple.500}",hoverBackground:"{purple.600}",activeBackground:"{purple.700}",borderColor:"{purple.500}",hoverBorderColor:"{purple.600}",activeBorderColor:"{purple.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{purple.500}",shadow:"none"}},danger:{background:"{red.500}",hoverBackground:"{red.600}",activeBackground:"{red.700}",borderColor:"{red.500}",hoverBorderColor:"{red.600}",activeBorderColor:"{red.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{red.500}",shadow:"none"}},contrast:{background:"{surface.950}",hoverBackground:"{surface.900}",activeBackground:"{surface.800}",borderColor:"{surface.950}",hoverBorderColor:"{surface.900}",activeBorderColor:"{surface.800}",color:"{surface.0}",hoverColor:"{surface.0}",activeColor:"{surface.0}",focusRing:{color:"{surface.950}",shadow:"none"}}},outlined:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",borderColor:"{primary.200}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",borderColor:"{green.200}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",borderColor:"{sky.200}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",borderColor:"{orange.200}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",borderColor:"{purple.200}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",borderColor:"{red.200}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.700}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.700}"}},text:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.700}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}},dark:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",borderColor:"{surface.800}",hoverBorderColor:"{surface.700}",activeBorderColor:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}",focusRing:{color:"{surface.300}",shadow:"none"}},info:{background:"{sky.400}",hoverBackground:"{sky.300}",activeBackground:"{sky.200}",borderColor:"{sky.400}",hoverBorderColor:"{sky.300}",activeBorderColor:"{sky.200}",color:"{sky.950}",hoverColor:"{sky.950}",activeColor:"{sky.950}",focusRing:{color:"{sky.400}",shadow:"none"}},success:{background:"{green.400}",hoverBackground:"{green.300}",activeBackground:"{green.200}",borderColor:"{green.400}",hoverBorderColor:"{green.300}",activeBorderColor:"{green.200}",color:"{green.950}",hoverColor:"{green.950}",activeColor:"{green.950}",focusRing:{color:"{green.400}",shadow:"none"}},warn:{background:"{orange.400}",hoverBackground:"{orange.300}",activeBackground:"{orange.200}",borderColor:"{orange.400}",hoverBorderColor:"{orange.300}",activeBorderColor:"{orange.200}",color:"{orange.950}",hoverColor:"{orange.950}",activeColor:"{orange.950}",focusRing:{color:"{orange.400}",shadow:"none"}},help:{background:"{purple.400}",hoverBackground:"{purple.300}",activeBackground:"{purple.200}",borderColor:"{purple.400}",hoverBorderColor:"{purple.300}",activeBorderColor:"{purple.200}",color:"{purple.950}",hoverColor:"{purple.950}",activeColor:"{purple.950}",focusRing:{color:"{purple.400}",shadow:"none"}},danger:{background:"{red.400}",hoverBackground:"{red.300}",activeBackground:"{red.200}",borderColor:"{red.400}",hoverBorderColor:"{red.300}",activeBorderColor:"{red.200}",color:"{red.950}",hoverColor:"{red.950}",activeColor:"{red.950}",focusRing:{color:"{red.400}",shadow:"none"}},contrast:{background:"{surface.0}",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{surface.0}",hoverBorderColor:"{surface.100}",activeBorderColor:"{surface.200}",color:"{surface.950}",hoverColor:"{surface.950}",activeColor:"{surface.950}",focusRing:{color:"{surface.0}",shadow:"none"}}},outlined:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",borderColor:"{primary.700}",color:"{primary.color}"},secondary:{hoverBackground:"rgba(255,255,255,0.04)",activeBackground:"rgba(255,255,255,0.16)",borderColor:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",borderColor:"{green.700}",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",borderColor:"{sky.700}",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",borderColor:"{orange.700}",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",borderColor:"{purple.700}",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",borderColor:"{red.700}",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.500}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.600}",color:"{surface.0}"}},text:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",color:"{primary.color}"},secondary:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}}}},card:{root:{background:"{content.background}",borderRadius:"{border.radius.xl}",color:"{content.color}",shadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},body:{padding:"1.25rem",gap:"0.5rem"},caption:{gap:"0.5rem"},title:{fontSize:"1.25rem",fontWeight:"500"},subtitle:{color:"{text.muted.color}"}},carousel:{root:{transitionDuration:"{transition.duration}"},content:{gap:"0.25rem"},indicatorList:{padding:"1rem",gap:"0.5rem"},indicator:{width:"2rem",height:"0.5rem",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},colorScheme:{light:{indicator:{background:"{surface.200}",hoverBackground:"{surface.300}",activeBackground:"{primary.color}"}},dark:{indicator:{background:"{surface.700}",hoverBackground:"{surface.600}",activeBackground:"{primary.color}"}}}},cascadeselect:{root:{background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},dropdown:{width:"2.5rem",color:"{form.field.icon.color}"},overlay:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},list:{padding:"{list.padding}",gap:"{list.gap}",mobileIndent:"1rem"},option:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",icon:{color:"{list.option.icon.color}",focusColor:"{list.option.icon.focus.color}",size:"0.875rem"}},clearIcon:{color:"{form.field.icon.color}"}},checkbox:{root:{borderRadius:"{border.radius.sm}",width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},icon:{size:"0.875rem",color:"{form.field.color}",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.75rem"},lg:{size:"1rem"}}},chip:{root:{borderRadius:"16px",paddingX:"0.75rem",paddingY:"0.5rem",gap:"0.5rem",transitionDuration:"{transition.duration}"},image:{width:"2rem",height:"2rem"},icon:{size:"1rem"},removeIcon:{size:"1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"}},colorScheme:{light:{root:{background:"{surface.100}",color:"{surface.800}"},icon:{color:"{surface.800}"},removeIcon:{color:"{surface.800}"}},dark:{root:{background:"{surface.800}",color:"{surface.0}"},icon:{color:"{surface.0}"},removeIcon:{color:"{surface.0}"}}}},colorpicker:{root:{transitionDuration:"{transition.duration}"},preview:{width:"1.5rem",height:"1.5rem",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},panel:{shadow:"{overlay.popover.shadow}",borderRadius:"{overlay.popover.borderRadius}"},colorScheme:{light:{panel:{background:"{surface.800}",borderColor:"{surface.900}"},handle:{color:"{surface.0}"}},dark:{panel:{background:"{surface.900}",borderColor:"{surface.700}"},handle:{color:"{surface.0}"}}}},confirmdialog:{icon:{size:"2rem",color:"{overlay.modal.color}"},content:{gap:"1rem"}},confirmpopup:{root:{background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},content:{padding:"{overlay.popover.padding}",gap:"1rem"},icon:{size:"1.5rem",color:"{overlay.popover.color}"},footer:{gap:"0.5rem",padding:"0 {overlay.popover.padding} {overlay.popover.padding} {overlay.popover.padding}"}},contextmenu:{root:{background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},list:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},item:{focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},submenu:{mobileIndent:"1rem"},submenuIcon:{size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},separator:{borderColor:"{content.border.color}"}},datatable:{root:{transitionDuration:"{transition.duration}"},header:{background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},headerCell:{background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{datatable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},columnTitle:{fontWeight:"600"},row:{background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},bodyCell:{borderColor:"{datatable.border.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},footerCell:{background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},columnFooter:{fontWeight:"600"},footer:{background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},dropPoint:{color:"{primary.color}"},columnResizer:{width:"0.5rem"},resizeIndicator:{width:"1px",color:"{primary.color}"},sortIcon:{color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},loadingIcon:{size:"2rem"},rowToggleButton:{hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},filter:{inlineGap:"0.5rem",overlaySelect:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},overlayPopover:{background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}",gap:"0.5rem"},rule:{borderColor:"{content.border.color}"},constraintList:{padding:"{list.padding}",gap:"{list.gap}"},constraint:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",separator:{borderColor:"{content.border.color}"},padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"}},paginatorTop:{borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},paginatorBottom:{borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},colorScheme:{light:{root:{borderColor:"{content.border.color}"},row:{stripedBackground:"{surface.50}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},row:{stripedBackground:"{surface.950}"},bodyCell:{selectedBorderColor:"{primary.900}"}}}},dataview:{root:{borderColor:"transparent",borderWidth:"0",borderRadius:"0",padding:"0"},header:{background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",borderRadius:"0"},content:{background:"{content.background}",color:"{content.color}",borderColor:"transparent",borderWidth:"0",padding:"0",borderRadius:"0"},footer:{background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"1px 0 0 0",padding:"0.75rem 1rem",borderRadius:"0"},paginatorTop:{borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},paginatorBottom:{borderColor:"{content.border.color}",borderWidth:"1px 0 0 0"}},datepicker:{root:{transitionDuration:"{transition.duration}"},panel:{background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}"},header:{background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",padding:"0 0 0.5rem 0"},title:{gap:"0.5rem",fontWeight:"500"},dropdown:{width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},inputIcon:{color:"{form.field.icon.color}"},selectMonth:{hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},selectYear:{hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},group:{borderColor:"{content.border.color}",gap:"{overlay.popover.padding}"},dayView:{margin:"0.5rem 0 0 0"},weekDay:{padding:"0.25rem",fontWeight:"500",color:"{content.color}"},date:{hoverBackground:"{content.hover.background}",selectedBackground:"{primary.color}",rangeSelectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{primary.contrast.color}",rangeSelectedColor:"{highlight.color}",width:"2rem",height:"2rem",borderRadius:"50%",padding:"0.25rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},monthView:{margin:"0.5rem 0 0 0"},month:{padding:"0.375rem",borderRadius:"{content.border.radius}"},yearView:{margin:"0.5rem 0 0 0"},year:{padding:"0.375rem",borderRadius:"{content.border.radius}"},buttonbar:{padding:"0.5rem 0 0 0",borderColor:"{content.border.color}"},timePicker:{padding:"0.5rem 0 0 0",borderColor:"{content.border.color}",gap:"0.5rem",buttonGap:"0.25rem"},colorScheme:{light:{dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"},today:{background:"{surface.200}",color:"{surface.900}"}},dark:{dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"},today:{background:"{surface.700}",color:"{surface.0}"}}}},dialog:{root:{background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",borderRadius:"{overlay.modal.border.radius}",shadow:"{overlay.modal.shadow}"},header:{padding:"{overlay.modal.padding}",gap:"0.5rem"},title:{fontSize:"1.25rem",fontWeight:"600"},content:{padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},footer:{padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}",gap:"0.5rem"}},divider:{root:{borderColor:"{content.border.color}"},content:{background:"{content.background}",color:"{text.color}"},horizontal:{margin:"1rem 0",padding:"0 1rem",content:{padding:"0 0.5rem"}},vertical:{margin:"0 1rem",padding:"0.5rem 0",content:{padding:"0.5rem 0"}}},dock:{root:{background:"rgba(255, 255, 255, 0.1)",borderColor:"rgba(255, 255, 255, 0.2)",padding:"0.5rem",borderRadius:"{border.radius.xl}"},item:{borderRadius:"{content.border.radius}",padding:"0.5rem",size:"3rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}}},drawer:{root:{background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",shadow:"{overlay.modal.shadow}"},header:{padding:"{overlay.modal.padding}"},title:{fontSize:"1.5rem",fontWeight:"600"},content:{padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},footer:{padding:"{overlay.modal.padding}"}},editor:{toolbar:{background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}"},toolbarItem:{color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},overlay:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}",padding:"{list.padding}"},overlayOption:{focusBackground:"{list.option.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},content:{background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"}},fieldset:{root:{background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",padding:"0 1.125rem 1.125rem 1.125rem",transitionDuration:"{transition.duration}"},legend:{background:"{content.background}",hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",borderRadius:"{content.border.radius}",borderWidth:"1px",borderColor:"transparent",padding:"0.5rem 0.75rem",gap:"0.5rem",fontWeight:"600",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},toggleIcon:{color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}"},content:{padding:"0"}},fileupload:{root:{background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},header:{background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"unset",borderWidth:"0",borderRadius:"0",gap:"0.5rem"},content:{highlightBorderColor:"{primary.color}",padding:"0 1.125rem 1.125rem 1.125rem",gap:"1rem"},file:{padding:"1rem",gap:"1rem",borderColor:"{content.border.color}",info:{gap:"0.5rem"}},fileList:{gap:"0.5rem"},progressbar:{height:"0.25rem"},basic:{gap:"0.5rem"}},floatlabel:{root:{color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",activeColor:"{form.field.float.label.active.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",positionY:"{form.field.padding.y}",fontWeight:"500",active:{fontSize:"0.75rem",fontWeight:"400"}},over:{active:{top:"-1.25rem"}},in:{input:{paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},active:{top:"{form.field.padding.y}"}},on:{borderRadius:"{border.radius.xs}",active:{background:"{form.field.background}",padding:"0 0.125rem"}}},galleria:{root:{borderWidth:"1px",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},navButton:{background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.100}",hoverColor:"{surface.0}",size:"3rem",gutter:"0.5rem",prev:{borderRadius:"50%"},next:{borderRadius:"50%"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},navIcon:{size:"1.5rem"},thumbnailsContent:{background:"{content.background}",padding:"1rem 0.25rem"},thumbnailNavButton:{size:"2rem",borderRadius:"{content.border.radius}",gutter:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},thumbnailNavButtonIcon:{size:"1rem"},caption:{background:"rgba(0, 0, 0, 0.5)",color:"{surface.100}",padding:"1rem"},indicatorList:{gap:"0.5rem",padding:"1rem"},indicatorButton:{width:"1rem",height:"1rem",activeBackground:"{primary.color}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},insetIndicatorList:{background:"rgba(0, 0, 0, 0.5)"},insetIndicatorButton:{background:"rgba(255, 255, 255, 0.4)",hoverBackground:"rgba(255, 255, 255, 0.6)",activeBackground:"rgba(255, 255, 255, 0.9)"},closeButton:{size:"3rem",gutter:"0.5rem",background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.50}",hoverColor:"{surface.0}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},closeButtonIcon:{size:"1.5rem"},colorScheme:{light:{thumbnailNavButton:{hoverBackground:"{surface.100}",color:"{surface.600}",hoverColor:"{surface.700}"},indicatorButton:{background:"{surface.200}",hoverBackground:"{surface.300}"}},dark:{thumbnailNavButton:{hoverBackground:"{surface.700}",color:"{surface.400}",hoverColor:"{surface.0}"},indicatorButton:{background:"{surface.700}",hoverBackground:"{surface.600}"}}}},iconfield:{icon:{color:"{form.field.icon.color}"}},iftalabel:{root:{color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",top:"{form.field.padding.y}",fontSize:"0.75rem",fontWeight:"400"},input:{paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"}},image:{root:{transitionDuration:"{transition.duration}"},preview:{icon:{size:"1.5rem"},mask:{background:"{mask.background}",color:"{mask.color}"}},toolbar:{position:{left:"auto",right:"1rem",top:"1rem",bottom:"auto"},blur:"8px",background:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.2)",borderWidth:"1px",borderRadius:"30px",padding:".5rem",gap:"0.5rem"},action:{hoverBackground:"rgba(255,255,255,0.1)",color:"{surface.50}",hoverColor:"{surface.0}",size:"3rem",iconSize:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}}},imagecompare:{handle:{size:"15px",hoverSize:"30px",background:"rgba(255,255,255,0.3)",hoverBackground:"rgba(255,255,255,0.3)",borderColor:"unset",hoverBorderColor:"unset",borderWidth:"0",borderRadius:"50%",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"rgba(255,255,255,0.3)",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}}},inlinemessage:{root:{padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",gap:"0.5rem"},text:{fontWeight:"500"},icon:{size:"1rem"},colorScheme:{light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}}}},inplace:{root:{padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{transition.duration}"},display:{hoverBackground:"{content.hover.background}",hoverColor:"{content.hover.color}"}},inputchips:{root:{background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},chip:{borderRadius:"{border.radius.sm}"},colorScheme:{light:{chip:{focusBackground:"{surface.200}",color:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",color:"{surface.0}"}}}},inputgroup:{addon:{background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.icon.color}",borderRadius:"{form.field.border.radius}",padding:"0.5rem",minWidth:"2.5rem"}},inputnumber:{root:{transitionDuration:"{transition.duration}"},button:{width:"2.5rem",borderRadius:"{form.field.border.radius}",verticalPadding:"{form.field.padding.y}"},colorScheme:{light:{button:{background:"transparent",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.500}",activeColor:"{surface.600}"}},dark:{button:{background:"transparent",hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.300}",activeColor:"{surface.200}"}}}},inputotp:{root:{gap:"0.5rem"},input:{width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"}}},inputtext:{root:{background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}}},knob:{root:{transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},value:{background:"{primary.color}"},range:{background:"{content.border.color}"},text:{color:"{text.muted.color}"}},listbox:{root:{background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",borderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",shadow:"{form.field.shadow}",borderRadius:"{form.field.border.radius}",transitionDuration:"{form.field.transition.duration}"},list:{padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},option:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},optionGroup:{background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},checkmark:{color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},emptyMessage:{padding:"{list.option.padding}"},colorScheme:{light:{option:{stripedBackground:"{surface.50}"}},dark:{option:{stripedBackground:"{surface.900}"}}}},megamenu:{root:{background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",verticalOrientation:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},horizontalOrientation:{padding:"0.5rem 0.75rem",gap:"0.5rem"},transitionDuration:"{transition.duration}"},baseItem:{borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},item:{focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},overlay:{padding:"0",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",shadow:"{overlay.navigation.shadow}",gap:"0.5rem"},submenu:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},submenuLabel:{padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background.}",color:"{navigation.submenu.label.color}"},submenuIcon:{size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},separator:{borderColor:"{content.border.color}"},mobileButton:{borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}}},menu:{root:{background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},list:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},item:{focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},submenuLabel:{padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background}",color:"{navigation.submenu.label.color}"},separator:{borderColor:"{content.border.color}"}},menubar:{root:{background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.5rem 0.75rem",transitionDuration:"{transition.duration}"},baseItem:{borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},item:{focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},submenu:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",mobileIndent:"1rem",icon:{size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"}},separator:{borderColor:"{content.border.color}"},mobileButton:{borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}}},message:{root:{borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},content:{padding:"0.5rem 0.75rem",gap:"0.5rem",sm:{padding:"0.375rem 0.625rem"},lg:{padding:"0.625rem 0.875rem"}},text:{fontSize:"1rem",fontWeight:"500",sm:{fontSize:"0.875rem"},lg:{fontSize:"1.125rem"}},icon:{size:"1.125rem",sm:{size:"1rem"},lg:{size:"1.25rem"}},closeButton:{width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},closeIcon:{size:"1rem",sm:{size:"0.875rem"},lg:{size:"1.125rem"}},outlined:{root:{borderWidth:"1px"}},simple:{content:{padding:"0"}},colorScheme:{light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}},outlined:{color:"{blue.600}",borderColor:"{blue.600}"},simple:{color:"{blue.600}"}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}},outlined:{color:"{green.600}",borderColor:"{green.600}"},simple:{color:"{green.600}"}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}},outlined:{color:"{yellow.600}",borderColor:"{yellow.600}"},simple:{color:"{yellow.600}"}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}},outlined:{color:"{red.600}",borderColor:"{red.600}"},simple:{color:"{red.600}"}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}},outlined:{color:"{surface.500}",borderColor:"{surface.500}"},simple:{color:"{surface.500}"}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}},outlined:{color:"{surface.950}",borderColor:"{surface.950}"},simple:{color:"{surface.950}"}}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}},outlined:{color:"{blue.500}",borderColor:"{blue.500}"},simple:{color:"{blue.500}"}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}},outlined:{color:"{green.500}",borderColor:"{green.500}"},simple:{color:"{green.500}"}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}},outlined:{color:"{yellow.500}",borderColor:"{yellow.500}"},simple:{color:"{yellow.500}"}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}},outlined:{color:"{red.500}",borderColor:"{red.500}"},simple:{color:"{red.500}"}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}},outlined:{color:"{surface.400}",borderColor:"{surface.400}"},simple:{color:"{surface.400}"}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}},outlined:{color:"{surface.0}",borderColor:"{surface.0}"},simple:{color:"{surface.0}"}}}}},metergroup:{root:{borderRadius:"{content.border.radius}",gap:"1rem"},meters:{background:"{content.border.color}",size:"0.5rem"},label:{gap:"0.5rem"},labelMarker:{size:"0.5rem"},labelIcon:{size:"1rem"},labelList:{verticalGap:"0.5rem",horizontalGap:"1rem"}},multiselect:{root:{background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},dropdown:{width:"2.5rem",color:"{form.field.icon.color}"},overlay:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},list:{padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},option:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",gap:"0.5rem"},optionGroup:{background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},chip:{borderRadius:"{border.radius.sm}"},clearIcon:{color:"{form.field.icon.color}"},emptyMessage:{padding:"{list.option.padding}"}},orderlist:{root:{gap:"1.125rem"},controls:{gap:"0.5rem"}},organizationchart:{root:{gutter:"0.75rem",transitionDuration:"{transition.duration}"},node:{background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{content.border.color}",color:"{content.color}",selectedColor:"{highlight.color}",hoverColor:"{content.hover.color}",padding:"0.75rem 1rem",toggleablePadding:"0.75rem 1rem 1.25rem 1rem",borderRadius:"{content.border.radius}"},nodeToggleButton:{background:"{content.background}",hoverBackground:"{content.hover.background}",borderColor:"{content.border.color}",color:"{text.muted.color}",hoverColor:"{text.color}",size:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},connector:{color:"{content.border.color}",borderRadius:"{content.border.radius}",height:"24px"}},overlaybadge:{root:{outline:{width:"2px",color:"{content.background}"}}},paginator:{root:{padding:"0.5rem 1rem",gap:"0.25rem",borderRadius:"{content.border.radius}",background:"{content.background}",color:"{content.color}",transitionDuration:"{transition.duration}"},navButton:{background:"transparent",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}",width:"2.5rem",height:"2.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},currentPageReport:{color:"{text.muted.color}"},jumpToPageInput:{maxWidth:"2.5rem"}},panel:{root:{background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},header:{background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"{content.border.color}",borderWidth:"0",borderRadius:"0"},toggleableHeader:{padding:"0.375rem 1.125rem"},title:{fontWeight:"600"},content:{padding:"0 1.125rem 1.125rem 1.125rem"},footer:{padding:"0 1.125rem 1.125rem 1.125rem"}},panelmenu:{root:{gap:"0.5rem",transitionDuration:"{transition.duration}"},panel:{background:"{content.background}",borderColor:"{content.border.color}",borderWidth:"1px",color:"{content.color}",padding:"0.25rem 0.25rem",borderRadius:"{content.border.radius}",first:{borderWidth:"1px",topBorderRadius:"{content.border.radius}"},last:{borderWidth:"1px",bottomBorderRadius:"{content.border.radius}"}},item:{focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",gap:"0.5rem",padding:"{navigation.item.padding}",borderRadius:"{content.border.radius}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},submenu:{indent:"1rem"},submenuIcon:{color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}"}},password:{meter:{background:"{content.border.color}",borderRadius:"{content.border.radius}",height:".75rem"},icon:{color:"{form.field.icon.color}"},overlay:{background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",padding:"{overlay.popover.padding}",shadow:"{overlay.popover.shadow}"},content:{gap:"0.5rem"},colorScheme:{light:{strength:{weakBackground:"{red.500}",mediumBackground:"{amber.500}",strongBackground:"{green.500}"}},dark:{strength:{weakBackground:"{red.400}",mediumBackground:"{amber.400}",strongBackground:"{green.400}"}}}},picklist:{root:{gap:"1.125rem"},controls:{gap:"0.5rem"}},popover:{root:{background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},content:{padding:"{overlay.popover.padding}"}},progressbar:{root:{background:"{content.border.color}",borderRadius:"{content.border.radius}",height:"1.25rem"},value:{background:"{primary.color}"},label:{color:"{primary.contrast.color}",fontSize:"0.75rem",fontWeight:"600"}},progressspinner:{colorScheme:{light:{root:{colorOne:"{red.500}",colorTwo:"{blue.500}",colorThree:"{green.500}",colorFour:"{yellow.500}"}},dark:{root:{colorOne:"{red.400}",colorTwo:"{blue.400}",colorThree:"{green.400}",colorFour:"{yellow.400}"}}}},radiobutton:{root:{width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},icon:{size:"0.75rem",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.5rem"},lg:{size:"1rem"}}},rating:{root:{gap:"0.25rem",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},icon:{size:"1rem",color:"{text.muted.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}},ripple:{colorScheme:{light:{root:{background:"rgba(0,0,0,0.1)"}},dark:{root:{background:"rgba(255,255,255,0.3)"}}}},scrollpanel:{root:{transitionDuration:"{transition.duration}"},bar:{size:"9px",borderRadius:"{border.radius.sm}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},colorScheme:{light:{bar:{background:"{surface.100}"}},dark:{bar:{background:"{surface.800}"}}}},select:{root:{background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},dropdown:{width:"2.5rem",color:"{form.field.icon.color}"},overlay:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},list:{padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},option:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},optionGroup:{background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},clearIcon:{color:"{form.field.icon.color}"},checkmark:{color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},emptyMessage:{padding:"{list.option.padding}"}},selectbutton:{root:{borderRadius:"{form.field.border.radius}"},colorScheme:{light:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}},dark:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}}}},skeleton:{root:{borderRadius:"{content.border.radius}"},colorScheme:{light:{root:{background:"{surface.200}",animationBackground:"rgba(255,255,255,0.4)"}},dark:{root:{background:"rgba(255, 255, 255, 0.06)",animationBackground:"rgba(255, 255, 255, 0.04)"}}}},slider:{root:{transitionDuration:"{transition.duration}"},track:{background:"{content.border.color}",borderRadius:"{content.border.radius}",size:"3px"},range:{background:"{primary.color}"},handle:{width:"20px",height:"20px",borderRadius:"50%",background:"{content.border.color}",hoverBackground:"{content.border.color}",content:{borderRadius:"50%",hoverBackground:"{content.background}",width:"16px",height:"16px",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.08), 0px 1px 1px 0px rgba(0, 0, 0, 0.14)"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},colorScheme:{light:{handle:{content:{background:"{surface.0}"}}},dark:{handle:{content:{background:"{surface.950}"}}}}},speeddial:{root:{gap:"0.5rem",transitionDuration:"{transition.duration}"}},splitbutton:{root:{borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)"}},splitter:{root:{background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",transitionDuration:"{transition.duration}"},gutter:{background:"{content.border.color}"},handle:{size:"24px",background:"transparent",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}}},stepper:{root:{transitionDuration:"{transition.duration}"},separator:{background:"{content.border.color}",activeBackground:"{primary.color}",margin:"0 0 0 1.625rem",size:"2px"},step:{padding:"0.5rem",gap:"1rem"},stepHeader:{padding:"0",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},stepTitle:{color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},stepNumber:{background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},steppanels:{padding:"0.875rem 0.5rem 1.125rem 0.5rem"},steppanel:{background:"{content.background}",color:"{content.color}",padding:"0",indent:"1rem"}},steps:{root:{transitionDuration:"{transition.duration}"},separator:{background:"{content.border.color}"},itemLink:{borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},itemLabel:{color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},itemNumber:{background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"}},tabmenu:{root:{transitionDuration:"{transition.duration}"},tablist:{borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},item:{background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},itemIcon:{color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},activeBar:{height:"1px",bottom:"-1px",background:"{primary.color}"}},tabs:{root:{transitionDuration:"{transition.duration}"},tablist:{borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},tab:{background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},tabpanel:{background:"{content.background}",color:"{content.color}",padding:"0.875rem 1.125rem 1.125rem 1.125rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"inset {focus.ring.shadow}"}},navButton:{background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",width:"2.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},activeBar:{height:"1px",bottom:"-1px",background:"{primary.color}"},colorScheme:{light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}}},tabview:{root:{transitionDuration:"{transition.duration}"},tabList:{background:"{content.background}",borderColor:"{content.border.color}"},tab:{borderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},tabPanel:{background:"{content.background}",color:"{content.color}"},navButton:{background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}"},colorScheme:{light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}}},tag:{root:{fontSize:"0.875rem",fontWeight:"700",padding:"0.25rem 0.5rem",gap:"0.25rem",borderRadius:"{content.border.radius}",roundedBorderRadius:"{border.radius.xl}"},icon:{size:"0.75rem"},colorScheme:{light:{primary:{background:"{primary.100}",color:"{primary.700}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.100}",color:"{green.700}"},info:{background:"{sky.100}",color:"{sky.700}"},warn:{background:"{orange.100}",color:"{orange.700}"},danger:{background:"{red.100}",color:"{red.700}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"color-mix(in srgb, {primary.500}, transparent 84%)",color:"{primary.300}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",color:"{green.300}"},info:{background:"color-mix(in srgb, {sky.500}, transparent 84%)",color:"{sky.300}"},warn:{background:"color-mix(in srgb, {orange.500}, transparent 84%)",color:"{orange.300}"},danger:{background:"color-mix(in srgb, {red.500}, transparent 84%)",color:"{red.300}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}}},terminal:{root:{background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.color}",height:"18rem",padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{form.field.border.radius}"},prompt:{gap:"0.25rem"},commandResponse:{margin:"2px 0"}},textarea:{root:{background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}}},tieredmenu:{root:{background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},list:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},item:{focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},submenu:{mobileIndent:"1rem"},submenuIcon:{size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},separator:{borderColor:"{content.border.color}"}},timeline:{event:{minHeight:"5rem"},horizontal:{eventContent:{padding:"1rem 0"}},vertical:{eventContent:{padding:"0 1rem"}},eventMarker:{size:"1.125rem",borderRadius:"50%",borderWidth:"2px",background:"{content.background}",borderColor:"{content.border.color}",content:{borderRadius:"50%",size:"0.375rem",background:"{primary.color}",insetShadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"}},eventConnector:{color:"{content.border.color}",size:"2px"}},toast:{root:{width:"25rem",borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},icon:{size:"1.125rem"},content:{padding:"{overlay.popover.padding}",gap:"0.5rem"},text:{gap:"0.5rem"},summary:{fontWeight:"500",fontSize:"1rem"},detail:{fontWeight:"500",fontSize:"0.875rem"},closeButton:{width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},closeIcon:{size:"1rem"},colorScheme:{light:{root:{blur:"1.5px"},info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}}}},dark:{root:{blur:"10px"},info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",detailColor:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}}}}}},togglebutton:{root:{padding:"0.25rem",borderRadius:"{content.border.radius}",gap:"0.5rem",fontWeight:"500",disabledBackground:"{form.field.disabled.background}",disabledBorderColor:"{form.field.disabled.background}",disabledColor:"{form.field.disabled.color}",invalidBorderColor:"{form.field.invalid.border.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",padding:"0.25rem"},lg:{fontSize:"{form.field.lg.font.size}",padding:"0.25rem"}},icon:{disabledColor:"{form.field.disabled.color}"},content:{padding:"0.25rem 0.75rem",borderRadius:"{content.border.radius}",checkedShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.02), 0px 1px 2px 0px rgba(0, 0, 0, 0.04)",sm:{padding:"0.25rem 0.75rem"},lg:{padding:"0.25rem 0.75rem"}},colorScheme:{light:{root:{background:"{surface.100}",checkedBackground:"{surface.100}",hoverBackground:"{surface.100}",borderColor:"{surface.100}",color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}",checkedBorderColor:"{surface.100}"},content:{checkedBackground:"{surface.0}"},icon:{color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}"}},dark:{root:{background:"{surface.950}",checkedBackground:"{surface.950}",hoverBackground:"{surface.950}",borderColor:"{surface.950}",color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}",checkedBorderColor:"{surface.950}"},content:{checkedBackground:"{surface.800}"},icon:{color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}"}}}},toggleswitch:{root:{width:"2.5rem",height:"1.5rem",borderRadius:"30px",gap:"0.25rem",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},borderWidth:"1px",borderColor:"transparent",hoverBorderColor:"transparent",checkedBorderColor:"transparent",checkedHoverBorderColor:"transparent",invalidBorderColor:"{form.field.invalid.border.color}",transitionDuration:"{form.field.transition.duration}",slideDuration:"0.2s"},handle:{borderRadius:"50%",size:"1rem"},colorScheme:{light:{root:{background:"{surface.300}",disabledBackground:"{form.field.disabled.background}",hoverBackground:"{surface.400}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.0}",disabledBackground:"{form.field.disabled.color}",hoverBackground:"{surface.0}",checkedBackground:"{surface.0}",checkedHoverBackground:"{surface.0}",color:"{text.muted.color}",hoverColor:"{text.color}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}},dark:{root:{background:"{surface.700}",disabledBackground:"{surface.600}",hoverBackground:"{surface.600}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.400}",disabledBackground:"{surface.900}",hoverBackground:"{surface.300}",checkedBackground:"{surface.900}",checkedHoverBackground:"{surface.900}",color:"{surface.900}",hoverColor:"{surface.800}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}}}},toolbar:{root:{background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.75rem"}},tooltip:{root:{maxWidth:"12.5rem",gutter:"0.25rem",shadow:"{overlay.popover.shadow}",padding:"0.5rem 0.75rem",borderRadius:"{overlay.popover.border.radius}"},colorScheme:{light:{root:{background:"{surface.700}",color:"{surface.0}"}},dark:{root:{background:"{surface.700}",color:"{surface.0}"}}}},tree:{root:{background:"{content.background}",color:"{content.color}",padding:"1rem",gap:"2px",indent:"1rem",transitionDuration:"{transition.duration}"},node:{padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.color}",hoverColor:"{text.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},gap:"0.25rem"},nodeIcon:{color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}"},nodeToggleButton:{borderRadius:"50%",size:"1.75rem",hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedHoverColor:"{primary.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},loadingIcon:{size:"2rem"},filter:{margin:"0 0 0.5rem 0"}},treeselect:{root:{background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},dropdown:{width:"2.5rem",color:"{form.field.icon.color}"},overlay:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},tree:{padding:"{list.padding}"},emptyMessage:{padding:"{list.option.padding}"},chip:{borderRadius:"{border.radius.sm}"},clearIcon:{color:"{form.field.icon.color}"}},treetable:{root:{transitionDuration:"{transition.duration}"},header:{background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},headerCell:{background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{treetable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},columnTitle:{fontWeight:"600"},row:{background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},bodyCell:{borderColor:"{treetable.border.color}",padding:"0.75rem 1rem",gap:"0.5rem"},footerCell:{background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",padding:"0.75rem 1rem"},columnFooter:{fontWeight:"600"},footer:{background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},columnResizer:{width:"0.5rem"},resizeIndicator:{width:"1px",color:"{primary.color}"},sortIcon:{color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},loadingIcon:{size:"2rem"},nodeToggleButton:{hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},paginatorTop:{borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},paginatorBottom:{borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},colorScheme:{light:{root:{borderColor:"{content.border.color}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},bodyCell:{selectedBorderColor:"{primary.900}"}}}},virtualscroller:{loader:{mask:{background:"{content.background}",color:"{text.muted.color}"},icon:{size:"2rem"}}}}}));const xW={providers:[(0,p.gOD)(),function NN(){return Ti("NgZoneless"),(0,p.EmA)([{provide:p.hk6,useExisting:M1},{provide:jn,useClass:Pb},{provide:p.Evm,useValue:!0},{provide:p.AQb,useValue:!1},[]])}(),function kB(e,...t){return(0,p.EmA)([{provide:Tx,multi:!0,useValue:e},[],{provide:sg,useFactory:PT,deps:[ug]},{provide:KC,multi:!0,useFactory:kT},t.map(n=>n.\u0275providers)])}([]),function VB(e="animations"){return Ti("NgAsyncAnimations"),(0,p.EmA)([{provide:uf,useFactory:(t,n,r)=>new BB(t,n,r,e),deps:[p.qQL,G1,jn]},{provide:yc,useValue:"noop"===e?"NoopAnimations":"BrowserAnimations"}])}(),function nz(...e){const t=e?.map(r=>({provide:tz,useValue:r,multi:!1})),n=function NP(e){return(0,p.EmA)([{provide:ZC,multi:!0,useValue:e}])}(()=>{const r=(0,p.WQX)(DI);e?.forEach(s=>r.setConfig(s))});return(0,p.EmA)([...t,n])}({theme:{preset:bW}})]};var tv=dt(44),nv={};function RI(e="pui_id_"){return Object.hasOwn(nv,e)||(nv[e]=0),nv[e]++,`${e}${nv[e]}`}function p0(...e){if(e){let t=[];for(let n=0;n<e.length;n++){let r=e[n];if(!r)continue;let s=typeof r;if("string"===s||"number"===s)t.push(r);else if("object"===s){let l=Array.isArray(r)?[p0(...r)]:Object.entries(r).map(([d,g])=>g?d:void 0);t=l.length?t.concat(l.filter(d=>!!d)):t}}return t.join(" ").trim()}}let OI=(()=>{class e extends od{name="common";static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),gg=(()=>{class e{document=(0,p.WQX)(p.qQL);platformId=(0,p.WQX)(Fs);el=(0,p.WQX)(Nn);injector=(0,p.WQX)(p.zZn);cd=(0,p.WQX)(uy);renderer=(0,p.WQX)(Uu);config=(0,p.WQX)(DI);baseComponentStyle=(0,p.WQX)(OI);baseStyle=(0,p.WQX)(od);scopedStyleEl;rootEl;dt;get styleOptions(){return{nonce:this.config?.csp().nonce}}get _name(){return this.constructor.name.replace(/^_/,"").toLowerCase()}get componentStyle(){return this._componentStyle}attrSelector=RI("pc");themeChangeListeners=[];_getHostInstance(n){if(n)return n?this.hostName?n.name===this.hostName?n:this._getHostInstance(n.parentInstance):n.parentInstance:void 0}_getOptionValue(n,r="",s={}){return oI(n,r,s)}ngOnInit(){this.document&&(this._loadCoreStyles(),this._loadStyles())}ngAfterViewInit(){this.rootEl=this.el?.nativeElement,this.rootEl&&this.rootEl?.setAttribute(this.attrSelector,"")}ngOnChanges(n){if(this.document&&!function U4(e){return"server"===e}(this.platformId)){const{dt:r}=n;r&&r.currentValue&&(this._loadScopedThemeStyles(r.currentValue),this._themeChangeListener(()=>this._loadScopedThemeStyles(r.currentValue)))}}ngOnDestroy(){this._unloadScopedThemeStyles(),this.themeChangeListeners.forEach(n=>oc.off("theme:change",n))}_loadStyles(){const n=()=>{f0.isStyleNameLoaded("base")||(this.baseStyle.loadGlobalCSS(this.styleOptions),f0.setLoadedStyleName("base")),this._loadThemeStyles()};n(),this._themeChangeListener(()=>n())}_loadCoreStyles(){!f0.isStyleNameLoaded("base")&&this.componentStyle?.name&&(this.baseComponentStyle.loadCSS(this.styleOptions),this.componentStyle&&this.componentStyle?.loadCSS(this.styleOptions),f0.setLoadedStyleName(this.componentStyle?.name))}_loadThemeStyles(){if(!On.isStyleNameLoaded("common")){const{primitive:n,semantic:r,global:s,style:l}=this.componentStyle?.getCommonTheme?.()||{};this.baseStyle.load(n?.css,{name:"primitive-variables",...this.styleOptions}),this.baseStyle.load(r?.css,{name:"semantic-variables",...this.styleOptions}),this.baseStyle.load(s?.css,{name:"global-variables",...this.styleOptions}),this.baseStyle.loadGlobalTheme({name:"global-style",...this.styleOptions},l),On.setLoadedStyleName("common")}if(!On.isStyleNameLoaded(this.componentStyle?.name)&&this.componentStyle?.name){const{css:n,style:r}=this.componentStyle?.getComponentTheme?.()||{};this.componentStyle?.load(n,{name:`${this.componentStyle?.name}-variables`,...this.styleOptions}),this.componentStyle?.loadTheme({name:`${this.componentStyle?.name}-style`,...this.styleOptions},r),On.setLoadedStyleName(this.componentStyle?.name)}if(!On.isStyleNameLoaded("layer-order")){const n=this.componentStyle?.getLayerOrderThemeCSS?.();this.baseStyle.load(n,{name:"layer-order",first:!0,...this.styleOptions}),On.setLoadedStyleName("layer-order")}this.dt&&(this._loadScopedThemeStyles(this.dt),this._themeChangeListener(()=>this._loadScopedThemeStyles(this.dt)))}_loadScopedThemeStyles(n){const{css:r}=this.componentStyle?.getPresetTheme?.(n,`[${this.attrSelector}]`)||{},s=this.componentStyle?.load(r,{name:`${this.attrSelector}-${this.componentStyle?.name}`,...this.styleOptions});this.scopedStyleEl=s?.el}_unloadScopedThemeStyles(){this.scopedStyleEl?.remove()}_themeChangeListener(n=()=>{}){f0.clearLoadedStyleNames(),oc.on("theme:change",n),this.themeChangeListeners.push(n)}cx(n,r={}){return p0(this._getOptionValue(this.$style?.classes,n,{instance:this,...r}))}sx(n="",r=!0,s={}){if(r)return this._getOptionValue(this.$style?.inlineStyles,n,{instance:this,...s})}get parent(){return this.parentInstance}get $style(){return this.parent?this.parent.componentStyle:this.componentStyle}cn=p0;static \u0275fac=function(r){return new(r||e)};static \u0275dir=Yo({type:e,inputs:{dt:"dt"},features:[If([OI,od]),Ao]})}return e})(),NI=(()=>{class e{static zindex=1e3;static calculatedScrollbarWidth=null;static calculatedScrollbarHeight=null;static browser;static addClass(n,r){n&&r&&(n.classList?n.classList.add(r):n.className+=" "+r)}static addMultipleClasses(n,r){if(n&&r)if(n.classList){let s=r.trim().split(" ");for(let l=0;l<s.length;l++)n.classList.add(s[l])}else{let s=r.split(" ");for(let l=0;l<s.length;l++)n.className+=" "+s[l]}}static removeClass(n,r){n&&r&&(n.classList?n.classList.remove(r):n.className=n.className.replace(new RegExp("(^|\\b)"+r.split(" ").join("|")+"(\\b|$)","gi")," "))}static removeMultipleClasses(n,r){n&&r&&[r].flat().filter(Boolean).forEach(s=>s.split(" ").forEach(l=>this.removeClass(n,l)))}static hasClass(n,r){return!(!n||!r)&&(n.classList?n.classList.contains(r):new RegExp("(^| )"+r+"( |$)","gi").test(n.className))}static siblings(n){return Array.prototype.filter.call(n.parentNode.children,function(r){return r!==n})}static find(n,r){return Array.from(n.querySelectorAll(r))}static findSingle(n,r){return this.isElement(n)?n.querySelector(r):null}static index(n){let r=n.parentNode.childNodes,s=0;for(var l=0;l<r.length;l++){if(r[l]==n)return s;1==r[l].nodeType&&s++}return-1}static indexWithinGroup(n,r){let s=n.parentNode?n.parentNode.childNodes:[],l=0;for(var d=0;d<s.length;d++){if(s[d]==n)return l;s[d].attributes&&s[d].attributes[r]&&1==s[d].nodeType&&l++}return-1}static appendOverlay(n,r,s="self"){"self"!==s&&n&&r&&this.appendChild(n,r)}static alignOverlay(n,r,s="self",l=!0){n&&r&&(l&&(n.style.minWidth=`${e.getOuterWidth(r)}px`),"self"===s?this.relativePosition(n,r):this.absolutePosition(n,r))}static relativePosition(n,r,s=!0){const l=nt=>{if(nt)return"relative"===getComputedStyle(nt).getPropertyValue("position")?nt:l(nt.parentElement)},d=n.offsetParent?{width:n.offsetWidth,height:n.offsetHeight}:this.getHiddenElementDimensions(n),g=r.offsetHeight,v=r.getBoundingClientRect(),M=this.getWindowScrollTop(),A=this.getWindowScrollLeft(),O=this.getViewport(),B=l(n)?.getBoundingClientRect()||{top:-1*M,left:-1*A};let X,le,_e="top";v.top+g+d.height>O.height?(X=v.top-B.top-d.height,_e="bottom",v.top+X<0&&(X=-1*v.top)):(X=g+v.top-B.top,_e="top");const Ie=v.left+d.width-O.width;if(le=d.width>O.width?-1*(v.left-B.left):Ie>0?v.left-B.left-Ie:v.left-B.left,n.style.top=X+"px",n.style.left=le+"px",n.style.transformOrigin=_e,s){const nt=function ev(e){for(let t of document?.styleSheets)try{for(let n of t?.cssRules)for(let r of n?.style)if(e.test(r))return{name:r,value:n.style.getPropertyValue(r).trim()}}catch{}return null}(/-anchor-gutter$/)?.value;n.style.marginTop="bottom"===_e?`calc(${nt??"2px"} * -1)`:nt??""}}static absolutePosition(n,r,s=!0){const l=n.offsetParent?{width:n.offsetWidth,height:n.offsetHeight}:this.getHiddenElementDimensions(n),d=l.height,g=l.width,v=r.offsetHeight,M=r.offsetWidth,A=r.getBoundingClientRect(),O=this.getWindowScrollTop(),j=this.getWindowScrollLeft(),B=this.getViewport();let X,le;A.top+v+d>B.height?(X=A.top+O-d,n.style.transformOrigin="bottom",X<0&&(X=O)):(X=v+A.top+O,n.style.transformOrigin="top"),le=A.left+g>B.width?Math.max(0,A.left+j+M-g):A.left+j,n.style.top=X+"px",n.style.left=le+"px",s&&(n.style.marginTop="bottom"===origin?"calc(var(--p-anchor-gutter) * -1)":"calc(var(--p-anchor-gutter))")}static getParents(n,r=[]){return null===n.parentNode?r:this.getParents(n.parentNode,r.concat([n.parentNode]))}static getScrollableParents(n){let r=[];if(n){let s=this.getParents(n);const l=/(auto|scroll)/,d=g=>{let v=window.getComputedStyle(g,null);return l.test(v.getPropertyValue("overflow"))||l.test(v.getPropertyValue("overflowX"))||l.test(v.getPropertyValue("overflowY"))};for(let g of s){let v=1===g.nodeType&&g.dataset.scrollselectors;if(v){let M=v.split(",");for(let A of M){let O=this.findSingle(g,A);O&&d(O)&&r.push(O)}}9!==g.nodeType&&d(g)&&r.push(g)}}return r}static getHiddenElementOuterHeight(n){n.style.visibility="hidden",n.style.display="block";let r=n.offsetHeight;return n.style.display="none",n.style.visibility="visible",r}static getHiddenElementOuterWidth(n){n.style.visibility="hidden",n.style.display="block";let r=n.offsetWidth;return n.style.display="none",n.style.visibility="visible",r}static getHiddenElementDimensions(n){let r={};return n.style.visibility="hidden",n.style.display="block",r.width=n.offsetWidth,r.height=n.offsetHeight,n.style.display="none",n.style.visibility="visible",r}static scrollInView(n,r){let s=getComputedStyle(n).getPropertyValue("borderTopWidth"),l=s?parseFloat(s):0,d=getComputedStyle(n).getPropertyValue("paddingTop"),g=d?parseFloat(d):0,v=n.getBoundingClientRect(),A=r.getBoundingClientRect().top+document.body.scrollTop-(v.top+document.body.scrollTop)-l-g,O=n.scrollTop,j=n.clientHeight,B=this.getOuterHeight(r);A<0?n.scrollTop=O+A:A+B>j&&(n.scrollTop=O+A-j+B)}static fadeIn(n,r){n.style.opacity=0;let s=+new Date,l=0,d=function(){l=+n.style.opacity.replace(",",".")+((new Date).getTime()-s)/r,n.style.opacity=l,s=+new Date,+l<1&&(window.requestAnimationFrame&&requestAnimationFrame(d)||setTimeout(d,16))};d()}static fadeOut(n,r){var s=1,g=50/r;let v=setInterval(()=>{(s-=g)<=0&&(s=0,clearInterval(v)),n.style.opacity=s},50)}static getWindowScrollTop(){let n=document.documentElement;return(window.pageYOffset||n.scrollTop)-(n.clientTop||0)}static getWindowScrollLeft(){let n=document.documentElement;return(window.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}static matches(n,r){var s=Element.prototype;return(s.matches||s.webkitMatchesSelector||s.mozMatchesSelector||s.msMatchesSelector||function(d){return-1!==[].indexOf.call(document.querySelectorAll(d),this)}).call(n,r)}static getOuterWidth(n,r){let s=n.offsetWidth;if(r){let l=getComputedStyle(n);s+=parseFloat(l.marginLeft)+parseFloat(l.marginRight)}return s}static getHorizontalPadding(n){let r=getComputedStyle(n);return parseFloat(r.paddingLeft)+parseFloat(r.paddingRight)}static getHorizontalMargin(n){let r=getComputedStyle(n);return parseFloat(r.marginLeft)+parseFloat(r.marginRight)}static innerWidth(n){let r=n.offsetWidth,s=getComputedStyle(n);return r+=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight),r}static width(n){let r=n.offsetWidth,s=getComputedStyle(n);return r-=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight),r}static getInnerHeight(n){let r=n.offsetHeight,s=getComputedStyle(n);return r+=parseFloat(s.paddingTop)+parseFloat(s.paddingBottom),r}static getOuterHeight(n,r){let s=n.offsetHeight;if(r){let l=getComputedStyle(n);s+=parseFloat(l.marginTop)+parseFloat(l.marginBottom)}return s}static getHeight(n){let r=n.offsetHeight,s=getComputedStyle(n);return r-=parseFloat(s.paddingTop)+parseFloat(s.paddingBottom)+parseFloat(s.borderTopWidth)+parseFloat(s.borderBottomWidth),r}static getWidth(n){let r=n.offsetWidth,s=getComputedStyle(n);return r-=parseFloat(s.paddingLeft)+parseFloat(s.paddingRight)+parseFloat(s.borderLeftWidth)+parseFloat(s.borderRightWidth),r}static getViewport(){let n=window,r=document,s=r.documentElement,l=r.getElementsByTagName("body")[0];return{width:n.innerWidth||s.clientWidth||l.clientWidth,height:n.innerHeight||s.clientHeight||l.clientHeight}}static getOffset(n){var r=n.getBoundingClientRect();return{top:r.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:r.left+(window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0)}}static replaceElementWith(n,r){let s=n.parentNode;if(!s)throw"Can't replace element";return s.replaceChild(r,n)}static getUserAgent(){if(navigator&&this.isClient())return navigator.userAgent}static isIE(){var n=window.navigator.userAgent;return n.indexOf("MSIE ")>0||(n.indexOf("Trident/")>0?(n.indexOf("rv:"),!0):n.indexOf("Edge/")>0)}static isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}static isAndroid(){return/(android)/i.test(navigator.userAgent)}static isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0}static appendChild(n,r){if(this.isElement(r))r.appendChild(n);else{if(!(r&&r.el&&r.el.nativeElement))throw"Cannot append "+r+" to "+n;r.el.nativeElement.appendChild(n)}}static removeChild(n,r){if(this.isElement(r))r.removeChild(n);else{if(!r.el||!r.el.nativeElement)throw"Cannot remove "+n+" from "+r;r.el.nativeElement.removeChild(n)}}static removeElement(n){"remove"in Element.prototype?n.remove():n.parentNode.removeChild(n)}static isElement(n){return"object"==typeof HTMLElement?n instanceof HTMLElement:n&&"object"==typeof n&&null!==n&&1===n.nodeType&&"string"==typeof n.nodeName}static calculateScrollbarWidth(n){if(n){let r=getComputedStyle(n);return n.offsetWidth-n.clientWidth-parseFloat(r.borderLeftWidth)-parseFloat(r.borderRightWidth)}{if(null!==this.calculatedScrollbarWidth)return this.calculatedScrollbarWidth;let r=document.createElement("div");r.className="p-scrollbar-measure",document.body.appendChild(r);let s=r.offsetWidth-r.clientWidth;return document.body.removeChild(r),this.calculatedScrollbarWidth=s,s}}static calculateScrollbarHeight(){if(null!==this.calculatedScrollbarHeight)return this.calculatedScrollbarHeight;let n=document.createElement("div");n.className="p-scrollbar-measure",document.body.appendChild(n);let r=n.offsetHeight-n.clientHeight;return document.body.removeChild(n),this.calculatedScrollbarWidth=r,r}static invokeElementMethod(n,r,s){n[r].apply(n,s)}static clearSelection(){if(window.getSelection)window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().rangeCount>0&&window.getSelection().getRangeAt(0).getClientRects().length>0&&window.getSelection().removeAllRanges();else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch{}}static getBrowser(){if(!this.browser){let n=this.resolveUserAgent();this.browser={},n.browser&&(this.browser[n.browser]=!0,this.browser.version=n.version),this.browser.chrome?this.browser.webkit=!0:this.browser.webkit&&(this.browser.safari=!0)}return this.browser}static resolveUserAgent(){let n=navigator.userAgent.toLowerCase(),r=/(chrome)[ \/]([\w.]+)/.exec(n)||/(webkit)[ \/]([\w.]+)/.exec(n)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(n)||/(msie) ([\w.]+)/.exec(n)||n.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(n)||[];return{browser:r[1]||"",version:r[2]||"0"}}static isInteger(n){return Number.isInteger?Number.isInteger(n):"number"==typeof n&&isFinite(n)&&Math.floor(n)===n}static isHidden(n){return!n||null===n.offsetParent}static isVisible(n){return n&&null!=n.offsetParent}static isExist(n){return null!==n&&typeof n<"u"&&n.nodeName&&n.parentNode}static focus(n,r){n&&document.activeElement!==n&&n.focus(r)}static getFocusableSelectorString(n=""){return`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},\n        [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},\n        input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},\n        select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},\n        textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},\n        [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},\n        [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},\n        .p-inputtext:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n},\n        .p-button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${n}`}static getFocusableElements(n,r=""){let s=this.find(n,this.getFocusableSelectorString(r)),l=[];for(let d of s){const g=getComputedStyle(d);this.isVisible(d)&&"none"!=g.display&&"hidden"!=g.visibility&&l.push(d)}return l}static getFocusableElement(n,r=""){let s=this.findSingle(n,this.getFocusableSelectorString(r));if(s){const l=getComputedStyle(s);if(this.isVisible(s)&&"none"!=l.display&&"hidden"!=l.visibility)return s}return null}static getFirstFocusableElement(n,r=""){const s=this.getFocusableElements(n,r);return s.length>0?s[0]:null}static getLastFocusableElement(n,r){const s=this.getFocusableElements(n,r);return s.length>0?s[s.length-1]:null}static getNextFocusableElement(n,r=!1){const s=e.getFocusableElements(n);let l=0;if(s&&s.length>0){const d=s.indexOf(s[0].ownerDocument.activeElement);r?l=-1==d||0===d?s.length-1:d-1:-1!=d&&d!==s.length-1&&(l=d+1)}return s[l]}static generateZIndex(){return this.zindex=this.zindex||999,++this.zindex}static getSelection(){return window.getSelection?window.getSelection().toString():document.getSelection?document.getSelection().toString():document.selection?document.selection.createRange().text:null}static getTargetElement(n,r){if(!n)return null;switch(n){case"document":return document;case"window":return window;case"@next":return r?.nextElementSibling;case"@prev":return r?.previousElementSibling;case"@parent":return r?.parentElement;case"@grandparent":return r?.parentElement.parentElement;default:const s=typeof n;if("string"===s)return document.querySelector(n);if("object"===s&&n.hasOwnProperty("nativeElement"))return this.isExist(n.nativeElement)?n.nativeElement:void 0;const d=(g=n)&&g.constructor&&g.call&&g.apply?n():n;return d&&9===d.nodeType||this.isExist(d)?d:null}var g}static isClient(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}static getAttribute(n,r){if(n){const s=n.getAttribute(r);return isNaN(s)?"true"===s||"false"===s?"true"===s:s:+s}}static calculateBodyScrollbarWidth(){return window.innerWidth-document.documentElement.offsetWidth}static blockBodyScroll(n="p-overflow-hidden"){document.body.style.setProperty("--scrollbar-width",this.calculateBodyScrollbarWidth()+"px"),this.addClass(document.body,n)}static unblockBodyScroll(n="p-overflow-hidden"){document.body.style.removeProperty("--scrollbar-width"),this.removeClass(document.body,n)}static createElement(n,r={},...s){if(n){const l=document.createElement(n);return this.setAttributes(l,r),l.append(...s),l}}static setAttribute(n,r="",s){this.isElement(n)&&null!=s&&n.setAttribute(r,s)}static setAttributes(n,r={}){if(this.isElement(n)){const s=(l,d)=>{const g=n?.$attrs?.[l]?[n?.$attrs?.[l]]:[];return[d].flat().reduce((v,M)=>{if(null!=M){const A=typeof M;if("string"===A||"number"===A)v.push(M);else if("object"===A){const O=Array.isArray(M)?s(l,M):Object.entries(M).map(([j,B])=>"style"!==l||!B&&0!==B?B?j:void 0:`${j.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${B}`);v=O.length?v.concat(O.filter(j=>!!j)):v}}return v},g)};Object.entries(r).forEach(([l,d])=>{if(null!=d){const g=l.match(/^on(.+)/);g?n.addEventListener(g[1].toLowerCase(),d):"pBind"===l?this.setAttributes(n,d):(d="class"===l?[...new Set(s("class",d))].join(" ").trim():"style"===l?s("style",d).join(";").trim():d,(n.$attrs=n.$attrs||{})&&(n.$attrs[l]=d),n.setAttribute(l,d))}})}}static isFocusableElement(n,r=""){return!!this.isElement(n)&&n.matches(`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},\n                [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},\n                input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},\n                select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},\n                textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},\n                [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r},\n                [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${r}`)}}return e})(),wW=(()=>{class e extends gg{autofocus=!1;focused=!1;platformId=(0,p.WQX)(Fs);document=(0,p.WQX)(p.qQL);host=(0,p.WQX)(Nn);ngAfterContentChecked(){!1===this.autofocus?this.host.nativeElement.removeAttribute("autofocus"):this.host.nativeElement.setAttribute("autofocus",!0),this.focused||this.autoFocus()}ngAfterViewChecked(){this.focused||this.autoFocus()}autoFocus(){zM(this.platformId)&&this.autofocus&&setTimeout(()=>{const n=NI.getFocusableElements(this.host?.nativeElement);0===n.length&&this.host.nativeElement.focus(),n.length>0&&n[0].focus(),this.focused=!0})}static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275dir=Yo({type:e,selectors:[["","pAutoFocus",""]],inputs:{autofocus:[0,"pAutoFocus","autofocus"]},features:[qu]})}return e})();const EW={root:({instance:e})=>["p-badge p-component",{"p-badge-circle":io(e.value())&&1===String(e.value()).length,"p-badge-dot":xh(e.value()),"p-badge-sm":"small"===e.size()||"small"===e.badgeSize(),"p-badge-lg":"large"===e.size()||"large"===e.badgeSize(),"p-badge-xl":"xlarge"===e.size()||"xlarge"===e.badgeSize(),"p-badge-info":"info"===e.severity(),"p-badge-success":"success"===e.severity(),"p-badge-warn":"warn"===e.severity(),"p-badge-danger":"danger"===e.severity(),"p-badge-secondary":"secondary"===e.severity(),"p-badge-contrast":"contrast"===e.severity()}]};let LI=(()=>{class e extends od{name="badge";theme="\n    \n    .p-badge {\n        display: inline-flex;\n        border-radius: dt('badge.border.radius');\n        align-items: center;\n        justify-content: center;\n        padding: dt('badge.padding');\n        background: dt('badge.primary.background');\n        color: dt('badge.primary.color');\n        font-size: dt('badge.font.size');\n        font-weight: dt('badge.font.weight');\n        min-width: dt('badge.min.width');\n        height: dt('badge.height');\n    }\n\n    .p-badge-dot {\n        width: dt('badge.dot.size');\n        min-width: dt('badge.dot.size');\n        height: dt('badge.dot.size');\n        border-radius: 50%;\n        padding: 0;\n    }\n\n    .p-badge-circle {\n        padding: 0;\n        border-radius: 50%;\n    }\n\n    .p-badge-secondary {\n        background: dt('badge.secondary.background');\n        color: dt('badge.secondary.color');\n    }\n\n    .p-badge-success {\n        background: dt('badge.success.background');\n        color: dt('badge.success.color');\n    }\n\n    .p-badge-info {\n        background: dt('badge.info.background');\n        color: dt('badge.info.color');\n    }\n\n    .p-badge-warn {\n        background: dt('badge.warn.background');\n        color: dt('badge.warn.color');\n    }\n\n    .p-badge-danger {\n        background: dt('badge.danger.background');\n        color: dt('badge.danger.color');\n    }\n\n    .p-badge-contrast {\n        background: dt('badge.contrast.background');\n        color: dt('badge.contrast.color');\n    }\n\n    .p-badge-sm {\n        font-size: dt('badge.sm.font.size');\n        min-width: dt('badge.sm.min.width');\n        height: dt('badge.sm.height');\n    }\n\n    .p-badge-lg {\n        font-size: dt('badge.lg.font.size');\n        min-width: dt('badge.lg.min.width');\n        height: dt('badge.lg.height');\n    }\n\n    .p-badge-xl {\n        font-size: dt('badge.xl.font.size');\n        min-width: dt('badge.xl.min.width');\n        height: dt('badge.xl.height');\n    }\n\n\n    /* For PrimeNG (directive)*/\n    .p-overlay-badge {\n        position: relative;\n    }\n\n    .p-overlay-badge > .p-badge {\n        position: absolute;\n        top: 0;\n        inset-inline-end: 0;\n        transform: translate(50%, -50%);\n        transform-origin: 100% 0;\n        margin: 0;\n    }\n";classes=EW;static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275prov=p.jDH({token:e,factory:e.\u0275fac})}return e})(),FI=(()=>{class e extends gg{styleClass=mh();badgeSize=mh();size=mh();severity=mh();value=mh();badgeDisabled=mh(!1,{transform:Ss});_componentStyle=(0,p.WQX)(LI);static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275cmp=Wu({type:e,selectors:[["p-badge"]],hostVars:4,hostBindings:function(r,s){2&r&&(Yu(s.cn(s.cx("root"),s.styleClass())),u1("display",s.badgeDisabled()?"none":null))},inputs:{styleClass:[1,"styleClass"],badgeSize:[1,"badgeSize"],size:[1,"size"],severity:[1,"severity"],value:[1,"value"],badgeDisabled:[1,"badgeDisabled"]},features:[If([LI]),qu],decls:1,vars:1,template:function(r,s){1&r&&h1(0),2&r&&ny(s.value())},dependencies:[u0,hg],encapsulation:2,changeDetection:0})}return e})(),TW=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=Bp({type:e});static \u0275inj=p.G2t({imports:[FI,hg,hg]})}return e})();const DW=["*"],AW={root:"p-fluid"};let BI=(()=>{class e extends od{name="fluid";classes=AW;theme="\n    .p-progressbar {\n        display: block;\n        position: relative;\n        overflow: hidden;\n        height: dt('progressbar.height');\n        background: dt('progressbar.background');\n        border-radius: dt('progressbar.border.radius');\n    }\n\n    .p-progressbar-value {\n        margin: 0;\n        background: dt('progressbar.value.background');\n    }\n\n    .p-progressbar-label {\n        color: dt('progressbar.label.color');\n        font-size: dt('progressbar.label.font.size');\n        font-weight: dt('progressbar.label.font.weight');\n    }\n\n    .p-progressbar-determinate .p-progressbar-value {\n        height: 100%;\n        width: 0%;\n        position: absolute;\n        display: none;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        overflow: hidden;\n        transition: width 1s ease-in-out;\n    }\n\n    .p-progressbar-determinate .p-progressbar-label {\n        display: inline-flex;\n    }\n\n    .p-progressbar-indeterminate .p-progressbar-value::before {\n        content: '';\n        position: absolute;\n        background: inherit;\n        inset-block-start: 0;\n        inset-inline-start: 0;\n        inset-block-end: 0;\n        will-change: inset-inline-start, inset-inline-end;\n        animation: p-progressbar-indeterminate-anim 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;\n    }\n\n    .p-progressbar-indeterminate .p-progressbar-value::after {\n        content: '';\n        position: absolute;\n        background: inherit;\n        inset-block-start: 0;\n        inset-inline-start: 0;\n        inset-block-end: 0;\n        will-change: inset-inline-start, inset-inline-end;\n        animation: p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) infinite;\n        animation-delay: 1.15s;\n    }\n\n    @keyframes p-progressbar-indeterminate-anim {\n        0% {\n            inset-inline-start: -35%;\n            inset-inline-end: 100%;\n        }\n        60% {\n            inset-inline-start: 100%;\n            inset-inline-end: -90%;\n        }\n        100% {\n            inset-inline-start: 100%;\n            inset-inline-end: -90%;\n        }\n    }\n    @-webkit-keyframes p-progressbar-indeterminate-anim {\n        0% {\n            inset-inline-start: -35%;\n            inset-inline-end: 100%;\n        }\n        60% {\n            inset-inline-start: 100%;\n            inset-inline-end: -90%;\n        }\n        100% {\n            inset-inline-start: 100%;\n            inset-inline-end: -90%;\n        }\n    }\n\n    @keyframes p-progressbar-indeterminate-anim-short {\n        0% {\n            inset-inline-start: -200%;\n            inset-inline-end: 100%;\n        }\n        60% {\n            inset-inline-start: 107%;\n            inset-inline-end: -8%;\n        }\n        100% {\n            inset-inline-start: 107%;\n            inset-inline-end: -8%;\n        }\n    }\n    @-webkit-keyframes p-progressbar-indeterminate-anim-short {\n        0% {\n            inset-inline-start: -200%;\n            inset-inline-end: 100%;\n        }\n        60% {\n            inset-inline-start: 107%;\n            inset-inline-end: -8%;\n        }\n        100% {\n            inset-inline-start: 107%;\n            inset-inline-end: -8%;\n        }\n    }\n";static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275prov=p.jDH({token:e,factory:e.\u0275fac})}return e})(),kW=(()=>{class e extends gg{_componentStyle=(0,p.WQX)(BI);static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275cmp=Wu({type:e,selectors:[["p-fluid"]],hostVars:2,hostBindings:function(r,s){2&r&&Yu(s.cx("root"))},features:[If([BI]),qu],ngContentSelectors:DW,decls:1,vars:0,template:function(r,s){1&r&&(Q_(),J_(0))},dependencies:[u0],encapsulation:2,changeDetection:0})}return e})();const RW=["*"];let zI=(()=>{class e extends od{name="baseicon";css="\n.p-icon {\n    display: inline-block;\n    vertical-align: baseline;\n}\n\n.p-icon-spin {\n    -webkit-animation: p-icon-spin 2s infinite linear;\n    animation: p-icon-spin 2s infinite linear;\n}\n\n@-webkit-keyframes p-icon-spin {\n    0% {\n        -webkit-transform: rotate(0deg);\n        transform: rotate(0deg);\n    }\n    100% {\n        -webkit-transform: rotate(359deg);\n        transform: rotate(359deg);\n    }\n}\n\n@keyframes p-icon-spin {\n    0% {\n        -webkit-transform: rotate(0deg);\n        transform: rotate(0deg);\n    }\n    100% {\n        -webkit-transform: rotate(359deg);\n        transform: rotate(359deg);\n    }\n}\n";static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),LW=(()=>{class e extends gg{spin=!1;_componentStyle=(0,p.WQX)(zI);getClassNames(){return p0("p-icon",{"p-icon-spin":this.spin})}static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275cmp=Wu({type:e,selectors:[["ng-component"]],hostAttrs:["width","14","height","14","viewBox","0 0 14 14","fill","none","xmlns","http://www.w3.org/2000/svg"],hostVars:2,hostBindings:function(r,s){2&r&&Yu(s.getClassNames())},inputs:{spin:[2,"spin","spin",Ss]},features:[If([zI]),qu],ngContentSelectors:RW,decls:1,vars:0,template:function(r,s){1&r&&(Q_(),J_(0))},encapsulation:2,changeDetection:0})}return e})();const FW=["data-p-icon","spinner"];let BW=(()=>{class e extends LW{pathId;ngOnInit(){super.ngOnInit(),this.pathId="url(#"+RI()+")"}static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275cmp=Wu({type:e,selectors:[["","data-p-icon","spinner"]],features:[qu],attrs:FW,decls:5,vars:2,consts:[["d","M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(r,s){1&r&&(p.qSk(),km(0,"g"),Om(1,"path",0),Rm(),km(2,"defs")(3,"clipPath",1),Om(4,"rect",2),Rm()()),2&r&&(Zu("clip-path",s.pathId),qi(3),r1("id",s.pathId))},encapsulation:2})}return e})();const VW={root:"p-ink"};let jI=(()=>{class e extends od{name="ripple";theme="\n    \n    .p-ink {\n        display: block;\n        position: absolute;\n        background: dt('ripple.background');\n        border-radius: 100%;\n        transform: scale(0);\n        pointer-events: none;\n    }\n\n    .p-ink-active {\n        animation: ripple 0.4s linear;\n    }\n\n    @keyframes ripple {\n        100% {\n            opacity: 0;\n            transform: scale(2.5);\n        }\n    }\n\n    /* For PrimeNG */\n    .p-ripple {\n        overflow: hidden;\n        position: relative;\n    }\n\n    .p-ripple-disabled .p-ink {\n        display: none !important;\n    }\n\n    @keyframes ripple {\n        100% {\n            opacity: 0;\n            transform: scale(2.5);\n        }\n    }\n";classes=VW;static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275prov=p.jDH({token:e,factory:e.\u0275fac})}return e})(),GW=(()=>{class e extends gg{zone=(0,p.WQX)(jn);_componentStyle=(0,p.WQX)(jI);animationListener;mouseDownListener;timeout;constructor(){super(),vy(()=>{zM(this.platformId)&&(this.config.ripple()?this.zone.runOutsideAngular(()=>{this.create(),this.mouseDownListener=this.renderer.listen(this.el.nativeElement,"mousedown",this.onMouseDown.bind(this))}):this.remove())})}ngAfterViewInit(){super.ngAfterViewInit()}onMouseDown(n){let r=this.getInk();if(!r||"none"===this.document.defaultView?.getComputedStyle(r,null).display)return;if(pg(r,"p-ink-active"),!EI(r)&&!II(r)){let g=Math.max(function tw(e,t){if(e instanceof HTMLElement){let n=e.offsetWidth;if(t){let r=getComputedStyle(e);n+=parseFloat(r.marginLeft)+parseFloat(r.marginRight)}return n}return 0}(this.el.nativeElement),function aw(e,t){if(e){let n=e.offsetHeight;if(t){let r=getComputedStyle(e);n+=parseFloat(r.marginTop)+parseFloat(r.marginBottom)}return n}return 0}(this.el.nativeElement));r.style.height=g+"px",r.style.width=g+"px"}let s=function MI(e){if(e){let t=e.getBoundingClientRect();return{top:t.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:t.left+(window.pageXOffset||ew(document.documentElement)||ew(document.body)||0)}}return{top:"auto",left:"auto"}}(this.el.nativeElement),l=n.pageX-s.left+this.document.body.scrollTop-II(r)/2,d=n.pageY-s.top+this.document.body.scrollLeft-EI(r)/2;this.renderer.setStyle(r,"top",d+"px"),this.renderer.setStyle(r,"left",l+"px"),function Qx(e,t){if(e&&t){let n=r=>{(function D6(e,t){return!!e&&(e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className))})(e,r)||(e.classList?e.classList.add(r):e.className+=" "+r)};[t].flat().filter(Boolean).forEach(r=>r.split(" ").forEach(n))}}(r,"p-ink-active"),this.timeout=setTimeout(()=>{let g=this.getInk();g&&pg(g,"p-ink-active")},401)}getInk(){const n=this.el.nativeElement.children;for(let r=0;r<n.length;r++)if("string"==typeof n[r].className&&-1!==n[r].className.indexOf("p-ink"))return n[r];return null}resetInk(){let n=this.getInk();n&&pg(n,"p-ink-active")}onAnimationEnd(n){this.timeout&&clearTimeout(this.timeout),pg(n.currentTarget,"p-ink-active")}create(){let n=this.renderer.createElement("span");this.renderer.addClass(n,"p-ink"),this.renderer.appendChild(this.el.nativeElement,n),this.renderer.setAttribute(n,"aria-hidden","true"),this.renderer.setAttribute(n,"role","presentation"),this.animationListener||(this.animationListener=this.renderer.listen(n,"animationend",this.onAnimationEnd.bind(this)))}remove(){let n=this.getInk();n&&(this.mouseDownListener&&this.mouseDownListener(),this.animationListener&&this.animationListener(),this.mouseDownListener=null,this.animationListener=null,function K6(e){var t;e&&("remove"in Element.prototype?e.remove():null==(t=e.parentNode)||t.removeChild(e))}(n))}ngOnDestroy(){this.config&&this.config.ripple()&&this.remove(),super.ngOnDestroy()}static \u0275fac=function(r){return new(r||e)};static \u0275dir=Yo({type:e,selectors:[["","pRipple",""]],hostAttrs:[1,"p-ripple"],features:[If([jI]),qu]})}return e})();const HW=["content"],WW=["loadingicon"],qW=["icon"],ZW=["*"],VI=e=>({class:e});function YW(e,t){1&e&&e1(0)}function KW(e,t){1&e&&fh(0,"span"),2&e&&(Yu(Kl(3).cx("loadingIcon")),Zu("aria-hidden",!0)("data-pc-section","loadingicon"))}function XW(e,t){if(1&e&&(p.qSk(),fh(0,"svg",7)),2&e){const n=Kl(3);Yu(n.cn(n.cx("loadingIcon"),n.spinnerIconClass())),si("spin",!0),Zu("aria-hidden",!0)("data-pc-section","loadingicon")}}function QW(e,t){if(1&e&&(Wp(0),ah(1,KW,1,4,"span",3)(2,XW,1,5,"svg",6),Cf()),2&e){const n=Kl(2);qi(),si("ngIf",n.loadingIcon),qi(),si("ngIf",!n.loadingIcon)}}function JW(e,t){}function eq(e,t){if(1&e&&ah(0,JW,0,0,"ng-template",8),2&e){const n=Kl(2);si("ngIf",n.loadingIconTemplate||n._loadingIconTemplate)}}function tq(e,t){if(1&e&&(Wp(0),ah(1,QW,3,2,"ng-container",2)(2,eq,1,1,null,5),Cf()),2&e){const n=Kl();qi(),si("ngIf",!n.loadingIconTemplate&&!n._loadingIconTemplate),qi(),si("ngTemplateOutlet",n.loadingIconTemplate||n._loadingIconTemplate)("ngTemplateOutletContext",y1(3,VI,n.cx("loadingIcon")))}}function nq(e,t){1&e&&fh(0,"span"),2&e&&(Yu(Kl(2).cx("icon")),Zu("data-pc-section","icon"))}function rq(e,t){}function oq(e,t){if(1&e&&ah(0,rq,0,0,"ng-template",8),2&e){const n=Kl(2);si("ngIf",!n.icon&&(n.iconTemplate||n._iconTemplate))}}function iq(e,t){if(1&e&&(Wp(0),ah(1,nq,1,3,"span",3)(2,oq,1,1,null,5),Cf()),2&e){const n=Kl();qi(),si("ngIf",n.icon&&!n.iconTemplate&&!n._iconTemplate),qi(),si("ngTemplateOutlet",n.iconTemplate||n._iconTemplate)("ngTemplateOutletContext",y1(3,VI,n.cx("icon")))}}function sq(e,t){if(1&e&&(Am(0,"span"),h1(1),Pm()),2&e){const n=Kl();Yu(n.cx("label")),Zu("aria-hidden",n.icon&&!n.label)("data-pc-section","label"),qi(),ny(n.label)}}function aq(e,t){if(1&e&&fh(0,"p-badge",9),2&e){const n=Kl();si("value",n.badge)("severity",n.badgeSeverity)}}const lq={root:({instance:e})=>["p-button p-component",{"p-button-icon-only":(e.icon||e.buttonProps?.icon||e.iconTemplate||e._iconTemplate||e.loadingIcon||e.loadingIconTemplate||e._loadingIconTemplate)&&!e.label&&!e.buttonProps?.label,"p-button-vertical":("top"===e.iconPos||"bottom"===e.iconPos)&&e.label,"p-button-loading":e.loading||e.buttonProps?.loading,"p-button-link":e.link||e.buttonProps?.link,[`p-button-${e.severity||e.buttonProps?.severity}`]:e.severity||e.buttonProps?.severity,"p-button-raised":e.raised||e.buttonProps?.raised,"p-button-rounded":e.rounded||e.buttonProps?.rounded,"p-button-text":e.text||"text"===e.variant||e.buttonProps?.text||"text"===e.buttonProps?.variant,"p-button-outlined":e.outlined||"outlined"===e.variant||e.buttonProps?.outlined||"outlined"===e.buttonProps?.variant,"p-button-sm":"small"===e.size||"small"===e.buttonProps?.size,"p-button-lg":"large"===e.size||"large"===e.buttonProps?.size,"p-button-plain":e.plain||e.buttonProps?.plain,"p-button-fluid":e.hasFluid}],loadingIcon:"p-button-loading-icon",icon:({instance:e})=>["p-button-icon",{[`p-button-icon-${e.iconPos||e.buttonProps?.iconPos}`]:e.label||e.buttonProps?.label,"p-button-icon-left":("left"===e.iconPos||"left"===e.buttonProps?.iconPos)&&e.label||e.buttonProps?.label,"p-button-icon-right":("right"===e.iconPos||"right"===e.buttonProps?.iconPos)&&e.label||e.buttonProps?.label},e.icon,e.buttonProps?.icon],spinnerIcon:({instance:e})=>Object.entries(e.iconClass()).filter(([,t])=>!!t).reduce((t,[n])=>t+` ${n}`,"p-button-loading-icon"),label:"p-button-label"};let UI=(()=>{class e extends od{name="button";theme="\n    .p-button {\n        display: inline-flex;\n        cursor: pointer;\n        user-select: none;\n        align-items: center;\n        justify-content: center;\n        overflow: hidden;\n        position: relative;\n        color: dt('button.primary.color');\n        background: dt('button.primary.background');\n        border: 1px solid dt('button.primary.border.color');\n        padding: dt('button.padding.y') dt('button.padding.x');\n        font-size: 1rem;\n        font-family: inherit;\n        font-feature-settings: inherit;\n        transition:\n            background dt('button.transition.duration'),\n            color dt('button.transition.duration'),\n            border-color dt('button.transition.duration'),\n            outline-color dt('button.transition.duration'),\n            box-shadow dt('button.transition.duration');\n        border-radius: dt('button.border.radius');\n        outline-color: transparent;\n        gap: dt('button.gap');\n    }\n\n    .p-button:disabled {\n        cursor: default;\n    }\n\n    .p-button-icon-right {\n        order: 1;\n    }\n\n    .p-button-icon-right:dir(rtl) {\n        order: -1;\n    }\n\n    .p-button:not(.p-button-vertical) .p-button-icon:not(.p-button-icon-right):dir(rtl) {\n        order: 1;\n    }\n\n    .p-button-icon-bottom {\n        order: 2;\n    }\n\n    .p-button-icon-only {\n        width: dt('button.icon.only.width');\n        padding-inline-start: 0;\n        padding-inline-end: 0;\n        gap: 0;\n    }\n\n    .p-button-icon-only.p-button-rounded {\n        border-radius: 50%;\n        height: dt('button.icon.only.width');\n    }\n\n    .p-button-icon-only .p-button-label {\n        visibility: hidden;\n        width: 0;\n    }\n\n    .p-button-icon-only::after {\n        content: \"\0A0\";\n        visibility: hidden;\n        width: 0;\n    }\n\n    .p-button-sm {\n        font-size: dt('button.sm.font.size');\n        padding: dt('button.sm.padding.y') dt('button.sm.padding.x');\n    }\n\n    .p-button-sm .p-button-icon {\n        font-size: dt('button.sm.font.size');\n    }\n\n    .p-button-sm.p-button-icon-only {\n        width: dt('button.sm.icon.only.width');\n    }\n\n    .p-button-sm.p-button-icon-only.p-button-rounded {\n        height: dt('button.sm.icon.only.width');\n    }\n\n    .p-button-lg {\n        font-size: dt('button.lg.font.size');\n        padding: dt('button.lg.padding.y') dt('button.lg.padding.x');\n    }\n\n    .p-button-lg .p-button-icon {\n        font-size: dt('button.lg.font.size');\n    }\n\n    .p-button-lg.p-button-icon-only {\n        width: dt('button.lg.icon.only.width');\n    }\n\n    .p-button-lg.p-button-icon-only.p-button-rounded {\n        height: dt('button.lg.icon.only.width');\n    }\n\n    .p-button-vertical {\n        flex-direction: column;\n    }\n\n    .p-button-label {\n        font-weight: dt('button.label.font.weight');\n    }\n\n    .p-button-fluid {\n        width: 100%;\n    }\n\n    .p-button-fluid.p-button-icon-only {\n        width: dt('button.icon.only.width');\n    }\n\n    .p-button:not(:disabled):hover {\n        background: dt('button.primary.hover.background');\n        border: 1px solid dt('button.primary.hover.border.color');\n        color: dt('button.primary.hover.color');\n    }\n\n    .p-button:not(:disabled):active {\n        background: dt('button.primary.active.background');\n        border: 1px solid dt('button.primary.active.border.color');\n        color: dt('button.primary.active.color');\n    }\n\n    .p-button:focus-visible {\n        box-shadow: dt('button.primary.focus.ring.shadow');\n        outline: dt('button.focus.ring.width') dt('button.focus.ring.style') dt('button.primary.focus.ring.color');\n        outline-offset: dt('button.focus.ring.offset');\n    }\n\n    .p-button .p-badge {\n        min-width: dt('button.badge.size');\n        height: dt('button.badge.size');\n        line-height: dt('button.badge.size');\n    }\n\n    .p-button-raised {\n        box-shadow: dt('button.raised.shadow');\n    }\n\n    .p-button-rounded {\n        border-radius: dt('button.rounded.border.radius');\n    }\n\n    .p-button-secondary {\n        background: dt('button.secondary.background');\n        border: 1px solid dt('button.secondary.border.color');\n        color: dt('button.secondary.color');\n    }\n\n    .p-button-secondary:not(:disabled):hover {\n        background: dt('button.secondary.hover.background');\n        border: 1px solid dt('button.secondary.hover.border.color');\n        color: dt('button.secondary.hover.color');\n    }\n\n    .p-button-secondary:not(:disabled):active {\n        background: dt('button.secondary.active.background');\n        border: 1px solid dt('button.secondary.active.border.color');\n        color: dt('button.secondary.active.color');\n    }\n\n    .p-button-secondary:focus-visible {\n        outline-color: dt('button.secondary.focus.ring.color');\n        box-shadow: dt('button.secondary.focus.ring.shadow');\n    }\n\n    .p-button-success {\n        background: dt('button.success.background');\n        border: 1px solid dt('button.success.border.color');\n        color: dt('button.success.color');\n    }\n\n    .p-button-success:not(:disabled):hover {\n        background: dt('button.success.hover.background');\n        border: 1px solid dt('button.success.hover.border.color');\n        color: dt('button.success.hover.color');\n    }\n\n    .p-button-success:not(:disabled):active {\n        background: dt('button.success.active.background');\n        border: 1px solid dt('button.success.active.border.color');\n        color: dt('button.success.active.color');\n    }\n\n    .p-button-success:focus-visible {\n        outline-color: dt('button.success.focus.ring.color');\n        box-shadow: dt('button.success.focus.ring.shadow');\n    }\n\n    .p-button-info {\n        background: dt('button.info.background');\n        border: 1px solid dt('button.info.border.color');\n        color: dt('button.info.color');\n    }\n\n    .p-button-info:not(:disabled):hover {\n        background: dt('button.info.hover.background');\n        border: 1px solid dt('button.info.hover.border.color');\n        color: dt('button.info.hover.color');\n    }\n\n    .p-button-info:not(:disabled):active {\n        background: dt('button.info.active.background');\n        border: 1px solid dt('button.info.active.border.color');\n        color: dt('button.info.active.color');\n    }\n\n    .p-button-info:focus-visible {\n        outline-color: dt('button.info.focus.ring.color');\n        box-shadow: dt('button.info.focus.ring.shadow');\n    }\n\n    .p-button-warn {\n        background: dt('button.warn.background');\n        border: 1px solid dt('button.warn.border.color');\n        color: dt('button.warn.color');\n    }\n\n    .p-button-warn:not(:disabled):hover {\n        background: dt('button.warn.hover.background');\n        border: 1px solid dt('button.warn.hover.border.color');\n        color: dt('button.warn.hover.color');\n    }\n\n    .p-button-warn:not(:disabled):active {\n        background: dt('button.warn.active.background');\n        border: 1px solid dt('button.warn.active.border.color');\n        color: dt('button.warn.active.color');\n    }\n\n    .p-button-warn:focus-visible {\n        outline-color: dt('button.warn.focus.ring.color');\n        box-shadow: dt('button.warn.focus.ring.shadow');\n    }\n\n    .p-button-help {\n        background: dt('button.help.background');\n        border: 1px solid dt('button.help.border.color');\n        color: dt('button.help.color');\n    }\n\n    .p-button-help:not(:disabled):hover {\n        background: dt('button.help.hover.background');\n        border: 1px solid dt('button.help.hover.border.color');\n        color: dt('button.help.hover.color');\n    }\n\n    .p-button-help:not(:disabled):active {\n        background: dt('button.help.active.background');\n        border: 1px solid dt('button.help.active.border.color');\n        color: dt('button.help.active.color');\n    }\n\n    .p-button-help:focus-visible {\n        outline-color: dt('button.help.focus.ring.color');\n        box-shadow: dt('button.help.focus.ring.shadow');\n    }\n\n    .p-button-danger {\n        background: dt('button.danger.background');\n        border: 1px solid dt('button.danger.border.color');\n        color: dt('button.danger.color');\n    }\n\n    .p-button-danger:not(:disabled):hover {\n        background: dt('button.danger.hover.background');\n        border: 1px solid dt('button.danger.hover.border.color');\n        color: dt('button.danger.hover.color');\n    }\n\n    .p-button-danger:not(:disabled):active {\n        background: dt('button.danger.active.background');\n        border: 1px solid dt('button.danger.active.border.color');\n        color: dt('button.danger.active.color');\n    }\n\n    .p-button-danger:focus-visible {\n        outline-color: dt('button.danger.focus.ring.color');\n        box-shadow: dt('button.danger.focus.ring.shadow');\n    }\n\n    .p-button-contrast {\n        background: dt('button.contrast.background');\n        border: 1px solid dt('button.contrast.border.color');\n        color: dt('button.contrast.color');\n    }\n\n    .p-button-contrast:not(:disabled):hover {\n        background: dt('button.contrast.hover.background');\n        border: 1px solid dt('button.contrast.hover.border.color');\n        color: dt('button.contrast.hover.color');\n    }\n\n    .p-button-contrast:not(:disabled):active {\n        background: dt('button.contrast.active.background');\n        border: 1px solid dt('button.contrast.active.border.color');\n        color: dt('button.contrast.active.color');\n    }\n\n    .p-button-contrast:focus-visible {\n        outline-color: dt('button.contrast.focus.ring.color');\n        box-shadow: dt('button.contrast.focus.ring.shadow');\n    }\n\n    .p-button-outlined {\n        background: transparent;\n        border-color: dt('button.outlined.primary.border.color');\n        color: dt('button.outlined.primary.color');\n    }\n\n    .p-button-outlined:not(:disabled):hover {\n        background: dt('button.outlined.primary.hover.background');\n        border-color: dt('button.outlined.primary.border.color');\n        color: dt('button.outlined.primary.color');\n    }\n\n    .p-button-outlined:not(:disabled):active {\n        background: dt('button.outlined.primary.active.background');\n        border-color: dt('button.outlined.primary.border.color');\n        color: dt('button.outlined.primary.color');\n    }\n\n    .p-button-outlined.p-button-secondary {\n        border-color: dt('button.outlined.secondary.border.color');\n        color: dt('button.outlined.secondary.color');\n    }\n\n    .p-button-outlined.p-button-secondary:not(:disabled):hover {\n        background: dt('button.outlined.secondary.hover.background');\n        border-color: dt('button.outlined.secondary.border.color');\n        color: dt('button.outlined.secondary.color');\n    }\n\n    .p-button-outlined.p-button-secondary:not(:disabled):active {\n        background: dt('button.outlined.secondary.active.background');\n        border-color: dt('button.outlined.secondary.border.color');\n        color: dt('button.outlined.secondary.color');\n    }\n\n    .p-button-outlined.p-button-success {\n        border-color: dt('button.outlined.success.border.color');\n        color: dt('button.outlined.success.color');\n    }\n\n    .p-button-outlined.p-button-success:not(:disabled):hover {\n        background: dt('button.outlined.success.hover.background');\n        border-color: dt('button.outlined.success.border.color');\n        color: dt('button.outlined.success.color');\n    }\n\n    .p-button-outlined.p-button-success:not(:disabled):active {\n        background: dt('button.outlined.success.active.background');\n        border-color: dt('button.outlined.success.border.color');\n        color: dt('button.outlined.success.color');\n    }\n\n    .p-button-outlined.p-button-info {\n        border-color: dt('button.outlined.info.border.color');\n        color: dt('button.outlined.info.color');\n    }\n\n    .p-button-outlined.p-button-info:not(:disabled):hover {\n        background: dt('button.outlined.info.hover.background');\n        border-color: dt('button.outlined.info.border.color');\n        color: dt('button.outlined.info.color');\n    }\n\n    .p-button-outlined.p-button-info:not(:disabled):active {\n        background: dt('button.outlined.info.active.background');\n        border-color: dt('button.outlined.info.border.color');\n        color: dt('button.outlined.info.color');\n    }\n\n    .p-button-outlined.p-button-warn {\n        border-color: dt('button.outlined.warn.border.color');\n        color: dt('button.outlined.warn.color');\n    }\n\n    .p-button-outlined.p-button-warn:not(:disabled):hover {\n        background: dt('button.outlined.warn.hover.background');\n        border-color: dt('button.outlined.warn.border.color');\n        color: dt('button.outlined.warn.color');\n    }\n\n    .p-button-outlined.p-button-warn:not(:disabled):active {\n        background: dt('button.outlined.warn.active.background');\n        border-color: dt('button.outlined.warn.border.color');\n        color: dt('button.outlined.warn.color');\n    }\n\n    .p-button-outlined.p-button-help {\n        border-color: dt('button.outlined.help.border.color');\n        color: dt('button.outlined.help.color');\n    }\n\n    .p-button-outlined.p-button-help:not(:disabled):hover {\n        background: dt('button.outlined.help.hover.background');\n        border-color: dt('button.outlined.help.border.color');\n        color: dt('button.outlined.help.color');\n    }\n\n    .p-button-outlined.p-button-help:not(:disabled):active {\n        background: dt('button.outlined.help.active.background');\n        border-color: dt('button.outlined.help.border.color');\n        color: dt('button.outlined.help.color');\n    }\n\n    .p-button-outlined.p-button-danger {\n        border-color: dt('button.outlined.danger.border.color');\n        color: dt('button.outlined.danger.color');\n    }\n\n    .p-button-outlined.p-button-danger:not(:disabled):hover {\n        background: dt('button.outlined.danger.hover.background');\n        border-color: dt('button.outlined.danger.border.color');\n        color: dt('button.outlined.danger.color');\n    }\n\n    .p-button-outlined.p-button-danger:not(:disabled):active {\n        background: dt('button.outlined.danger.active.background');\n        border-color: dt('button.outlined.danger.border.color');\n        color: dt('button.outlined.danger.color');\n    }\n\n    .p-button-outlined.p-button-contrast {\n        border-color: dt('button.outlined.contrast.border.color');\n        color: dt('button.outlined.contrast.color');\n    }\n\n    .p-button-outlined.p-button-contrast:not(:disabled):hover {\n        background: dt('button.outlined.contrast.hover.background');\n        border-color: dt('button.outlined.contrast.border.color');\n        color: dt('button.outlined.contrast.color');\n    }\n\n    .p-button-outlined.p-button-contrast:not(:disabled):active {\n        background: dt('button.outlined.contrast.active.background');\n        border-color: dt('button.outlined.contrast.border.color');\n        color: dt('button.outlined.contrast.color');\n    }\n\n    .p-button-outlined.p-button-plain {\n        border-color: dt('button.outlined.plain.border.color');\n        color: dt('button.outlined.plain.color');\n    }\n\n    .p-button-outlined.p-button-plain:not(:disabled):hover {\n        background: dt('button.outlined.plain.hover.background');\n        border-color: dt('button.outlined.plain.border.color');\n        color: dt('button.outlined.plain.color');\n    }\n\n    .p-button-outlined.p-button-plain:not(:disabled):active {\n        background: dt('button.outlined.plain.active.background');\n        border-color: dt('button.outlined.plain.border.color');\n        color: dt('button.outlined.plain.color');\n    }\n\n    .p-button-text {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.text.primary.color');\n    }\n\n    .p-button-text:not(:disabled):hover {\n        background: dt('button.text.primary.hover.background');\n        border-color: transparent;\n        color: dt('button.text.primary.color');\n    }\n\n    .p-button-text:not(:disabled):active {\n        background: dt('button.text.primary.active.background');\n        border-color: transparent;\n        color: dt('button.text.primary.color');\n    }\n\n    .p-button-text.p-button-secondary {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.text.secondary.color');\n    }\n\n    .p-button-text.p-button-secondary:not(:disabled):hover {\n        background: dt('button.text.secondary.hover.background');\n        border-color: transparent;\n        color: dt('button.text.secondary.color');\n    }\n\n    .p-button-text.p-button-secondary:not(:disabled):active {\n        background: dt('button.text.secondary.active.background');\n        border-color: transparent;\n        color: dt('button.text.secondary.color');\n    }\n\n    .p-button-text.p-button-success {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.text.success.color');\n    }\n\n    .p-button-text.p-button-success:not(:disabled):hover {\n        background: dt('button.text.success.hover.background');\n        border-color: transparent;\n        color: dt('button.text.success.color');\n    }\n\n    .p-button-text.p-button-success:not(:disabled):active {\n        background: dt('button.text.success.active.background');\n        border-color: transparent;\n        color: dt('button.text.success.color');\n    }\n\n    .p-button-text.p-button-info {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.text.info.color');\n    }\n\n    .p-button-text.p-button-info:not(:disabled):hover {\n        background: dt('button.text.info.hover.background');\n        border-color: transparent;\n        color: dt('button.text.info.color');\n    }\n\n    .p-button-text.p-button-info:not(:disabled):active {\n        background: dt('button.text.info.active.background');\n        border-color: transparent;\n        color: dt('button.text.info.color');\n    }\n\n    .p-button-text.p-button-warn {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.text.warn.color');\n    }\n\n    .p-button-text.p-button-warn:not(:disabled):hover {\n        background: dt('button.text.warn.hover.background');\n        border-color: transparent;\n        color: dt('button.text.warn.color');\n    }\n\n    .p-button-text.p-button-warn:not(:disabled):active {\n        background: dt('button.text.warn.active.background');\n        border-color: transparent;\n        color: dt('button.text.warn.color');\n    }\n\n    .p-button-text.p-button-help {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.text.help.color');\n    }\n\n    .p-button-text.p-button-help:not(:disabled):hover {\n        background: dt('button.text.help.hover.background');\n        border-color: transparent;\n        color: dt('button.text.help.color');\n    }\n\n    .p-button-text.p-button-help:not(:disabled):active {\n        background: dt('button.text.help.active.background');\n        border-color: transparent;\n        color: dt('button.text.help.color');\n    }\n\n    .p-button-text.p-button-danger {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.text.danger.color');\n    }\n\n    .p-button-text.p-button-danger:not(:disabled):hover {\n        background: dt('button.text.danger.hover.background');\n        border-color: transparent;\n        color: dt('button.text.danger.color');\n    }\n\n    .p-button-text.p-button-danger:not(:disabled):active {\n        background: dt('button.text.danger.active.background');\n        border-color: transparent;\n        color: dt('button.text.danger.color');\n    }\n\n    .p-button-text.p-button-contrast {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.text.contrast.color');\n    }\n\n    .p-button-text.p-button-contrast:not(:disabled):hover {\n        background: dt('button.text.contrast.hover.background');\n        border-color: transparent;\n        color: dt('button.text.contrast.color');\n    }\n\n    .p-button-text.p-button-contrast:not(:disabled):active {\n        background: dt('button.text.contrast.active.background');\n        border-color: transparent;\n        color: dt('button.text.contrast.color');\n    }\n\n    .p-button-text.p-button-plain {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.text.plain.color');\n    }\n\n    .p-button-text.p-button-plain:not(:disabled):hover {\n        background: dt('button.text.plain.hover.background');\n        border-color: transparent;\n        color: dt('button.text.plain.color');\n    }\n\n    .p-button-text.p-button-plain:not(:disabled):active {\n        background: dt('button.text.plain.active.background');\n        border-color: transparent;\n        color: dt('button.text.plain.color');\n    }\n\n    .p-button-link {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.link.color');\n    }\n\n    .p-button-link:not(:disabled):hover {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.link.hover.color');\n    }\n\n    .p-button-link:not(:disabled):hover .p-button-label {\n        text-decoration: underline;\n    }\n\n    .p-button-link:not(:disabled):active {\n        background: transparent;\n        border-color: transparent;\n        color: dt('button.link.active.color');\n    }\n";classes=lq;static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275prov=p.jDH({token:e,factory:e.\u0275fac})}return e})(),uq=(()=>{class e extends gg{type="button";iconPos="left";icon;badge;label;disabled;loading=!1;loadingIcon;raised=!1;rounded=!1;text=!1;plain=!1;severity;outlined=!1;link=!1;tabindex;size;variant;style;styleClass;badgeClass;badgeSeverity="secondary";ariaLabel;buttonProps;autofocus;fluid=mh(void 0,{transform:Ss});onClick=new Ki;onFocus=new Ki;onBlur=new Ki;contentTemplate;loadingIconTemplate;iconTemplate;templates;pcFluid=(0,p.WQX)(kW,{optional:!0,host:!0,skipSelf:!0});get hasFluid(){return this.fluid()??!!this.pcFluid}_componentStyle=(0,p.WQX)(UI);_contentTemplate;_iconTemplate;_loadingIconTemplate;ngAfterContentInit(){this.templates?.forEach(n=>{switch(n.getType()){case"content":default:this._contentTemplate=n.template;break;case"icon":this._iconTemplate=n.template;break;case"loadingicon":this._loadingIconTemplate=n.template}})}spinnerIconClass(){return Object.entries(this.iconClass()).filter(([,n])=>!!n).reduce((n,[r])=>n+` ${r}`,"p-button-loading-icon")}iconClass(){return{[`p-button-loading-icon pi-spin ${this.loadingIcon??""}`]:this.loading,"p-button-icon":!0,"p-button-icon-left":"left"===this.iconPos&&this.label,"p-button-icon-right":"right"===this.iconPos&&this.label,"p-button-icon-top":"top"===this.iconPos&&this.label,"p-button-icon-bottom":"bottom"===this.iconPos&&this.label}}static \u0275fac=(()=>{let n;return function(s){return(n||(n=lo(e)))(s||e)}})();static \u0275cmp=Wu({type:e,selectors:[["p-button"]],contentQueries:function(r,s,l){if(1&r&&(Zp(l,HW,5),Zp(l,WW,5),Zp(l,qW,5),Zp(l,n6,4)),2&r){let d;Ef(d=Mf())&&(s.contentTemplate=d.first),Ef(d=Mf())&&(s.loadingIconTemplate=d.first),Ef(d=Mf())&&(s.iconTemplate=d.first),Ef(d=Mf())&&(s.templates=d)}},inputs:{type:"type",iconPos:"iconPos",icon:"icon",badge:"badge",label:"label",disabled:[2,"disabled","disabled",Ss],loading:[2,"loading","loading",Ss],loadingIcon:"loadingIcon",raised:[2,"raised","raised",Ss],rounded:[2,"rounded","rounded",Ss],text:[2,"text","text",Ss],plain:[2,"plain","plain",Ss],severity:"severity",outlined:[2,"outlined","outlined",Ss],link:[2,"link","link",Ss],tabindex:[2,"tabindex","tabindex",N4],size:"size",variant:"variant",style:"style",styleClass:"styleClass",badgeClass:"badgeClass",badgeSeverity:"badgeSeverity",ariaLabel:"ariaLabel",buttonProps:"buttonProps",autofocus:[2,"autofocus","autofocus",Ss],fluid:[1,"fluid"]},outputs:{onClick:"onClick",onFocus:"onFocus",onBlur:"onBlur"},features:[If([UI]),qu],ngContentSelectors:ZW,decls:7,vars:15,consts:[["pRipple","",3,"click","focus","blur","ngStyle","disabled","pAutoFocus"],[4,"ngTemplateOutlet"],[4,"ngIf"],[3,"class",4,"ngIf"],[3,"value","severity",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["data-p-icon","spinner",3,"class","spin",4,"ngIf"],["data-p-icon","spinner",3,"spin"],[3,"ngIf"],[3,"value","severity"]],template:function(r,s){1&r&&(Q_(),Am(0,"button",0),X_("click",function(d){return s.onClick.emit(d)})("focus",function(d){return s.onFocus.emit(d)})("blur",function(d){return s.onBlur.emit(d)}),J_(1),ah(2,YW,1,0,"ng-container",1)(3,tq,3,5,"ng-container",2)(4,iq,3,5,"ng-container",2)(5,sq,2,5,"span",3)(6,aq,1,2,"p-badge",4),Pm()),2&r&&(Yu(s.cn(s.cx("root"),s.styleClass,null==s.buttonProps?null:s.buttonProps.styleClass)),si("ngStyle",s.style||(null==s.buttonProps?null:s.buttonProps.style))("disabled",s.disabled||s.loading||(null==s.buttonProps?null:s.buttonProps.disabled))("pAutoFocus",s.autofocus||(null==s.buttonProps?null:s.buttonProps.autofocus)),Zu("type",s.type||(null==s.buttonProps?null:s.buttonProps.type))("aria-label",s.ariaLabel||(null==s.buttonProps?null:s.buttonProps.ariaLabel))("data-pc-name","button")("data-pc-section","root")("tabindex",s.tabindex||(null==s.buttonProps?null:s.buttonProps.tabindex)),qi(2),si("ngTemplateOutlet",s.contentTemplate||s._contentTemplate),qi(),si("ngIf",s.loading),qi(),si("ngIf",!s.loading),qi(),si("ngIf",!s.contentTemplate&&!s._contentTemplate&&s.label),qi(),si("ngIf",!s.contentTemplate&&!s._contentTemplate&&s.badge))},dependencies:[u0,qT,XT,KT,GW,wW,BW,TW,FI,hg],encapsulation:2,changeDetection:0})}return e})(),dq=(()=>{class e{static \u0275fac=function(r){return new(r||e)};static \u0275mod=Bp({type:e});static \u0275inj=p.G2t({imports:[u0,uq,hg,hg]})}return e})();var $I=.0066943799901413165,g0=484813681109536e-20,ot=Math.PI/2,wt=1e-10,Di=.017453292519943295,eu=57.29577951308232,rr=Math.PI/4,m0=2*Math.PI,Do=3.14159265359;const yq={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},vq={mm:{to_meter:.001},cm:{to_meter:.01},ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937},fath:{to_meter:1.8288},kmi:{to_meter:1852},"us-ch":{to_meter:20.1168402336805},"us-mi":{to_meter:1609.34721869444},km:{to_meter:1e3},"ind-ft":{to_meter:.30479841},"ind-yd":{to_meter:.91439523},mi:{to_meter:1609.344},yd:{to_meter:.9144},ch:{to_meter:20.1168},link:{to_meter:.201168},dm:{to_meter:.1},in:{to_meter:.0254},"ind-ch":{to_meter:20.11669506},"us-in":{to_meter:.025400050800101},"us-yd":{to_meter:.914401828803658}};var HI=/[\s_\-\/\(\)]/g;function Eh(e,t){if(e[t])return e[t];for(var l,n=Object.keys(e),r=t.toLowerCase().replace(HI,""),s=-1;++s<n.length;)if((l=n[s]).toLowerCase().replace(HI,"")===r)return e[l]}function cw(e){var r,s,l,t={},n=e.split("+").map(function(g){return g.trim()}).filter(function(g){return g}).reduce(function(g,v){var M=v.split("=");return M.push(!0),g[M[0].toLowerCase()]=M[1],g},{}),d={proj:"projName",datum:"datumCode",rf:function(g){t.rf=parseFloat(g)},lat_0:function(g){t.lat0=g*Di},lat_1:function(g){t.lat1=g*Di},lat_2:function(g){t.lat2=g*Di},lat_ts:function(g){t.lat_ts=g*Di},lon_0:function(g){t.long0=g*Di},lon_1:function(g){t.long1=g*Di},lon_2:function(g){t.long2=g*Di},alpha:function(g){t.alpha=parseFloat(g)*Di},gamma:function(g){t.rectified_grid_angle=parseFloat(g)*Di},lonc:function(g){t.longc=g*Di},x_0:function(g){t.x0=parseFloat(g)},y_0:function(g){t.y0=parseFloat(g)},k_0:function(g){t.k0=parseFloat(g)},k:function(g){t.k0=parseFloat(g)},a:function(g){t.a=parseFloat(g)},b:function(g){t.b=parseFloat(g)},r:function(g){t.a=t.b=parseFloat(g)},r_a:function(){t.R_A=!0},zone:function(g){t.zone=parseInt(g,10)},south:function(){t.utmSouth=!0},towgs84:function(g){t.datum_params=g.split(",").map(function(v){return parseFloat(v)})},to_meter:function(g){t.to_meter=parseFloat(g)},units:function(g){t.units=g;var v=Eh(vq,g);v&&(t.to_meter=v.to_meter)},from_greenwich:function(g){t.from_greenwich=g*Di},pm:function(g){var v=Eh(yq,g);t.from_greenwich=(v||parseFloat(g))*Di},nadgrids:function(g){"@null"===g?t.datumCode="none":t.nadgrids=g},axis:function(g){var v="ewnsud";3===g.length&&-1!==v.indexOf(g.substr(0,1))&&-1!==v.indexOf(g.substr(1,1))&&-1!==v.indexOf(g.substr(2,1))&&(t.axis=g)},approx:function(){t.approx=!0}};for(r in n)s=n[r],r in d?"function"==typeof(l=d[r])?l(s):t[l]=s:t[r]=s;return"string"==typeof t.datumCode&&"WGS84"!==t.datumCode&&(t.datumCode=t.datumCode.toLowerCase()),t}const WI=class bq{static getId(t){const n=t.find(r=>Array.isArray(r)&&"ID"===r[0]);return n&&n.length>=3?{authority:n[1],code:parseInt(n[2],10)}:null}static convertUnit(t,n="unit"){if(!t||t.length<3)return{type:n,name:"unknown",conversion_factor:null};const r=t[1],s=parseFloat(t[2])||null,l=t.find(g=>Array.isArray(g)&&"ID"===g[0]);return{type:n,name:r,conversion_factor:s,id:l?{authority:l[1],code:parseInt(l[2],10)}:null}}static convertAxis(t){const n=t[1]||"Unknown";let r;const s=n.match(/^\((.)\)$/);if(s){const M=s[1].toUpperCase();if("E"===M)r="east";else if("N"===M)r="north";else{if("U"!==M)throw new Error(`Unknown axis abbreviation: ${M}`);r="up"}}else r=t[2]?t[2].toLowerCase():"unknown";const l=t.find(M=>Array.isArray(M)&&"ORDER"===M[0]),d=l?parseInt(l[1],10):null,g=t.find(M=>Array.isArray(M)&&("LENGTHUNIT"===M[0]||"ANGLEUNIT"===M[0]||"SCALEUNIT"===M[0]));return{name:n,direction:r,unit:this.convertUnit(g),order:d}}static extractAxes(t){return t.filter(n=>Array.isArray(n)&&"AXIS"===n[0]).map(n=>this.convertAxis(n)).sort((n,r)=>(n.order||0)-(r.order||0))}static convert(t,n={}){switch(t[0]){case"PROJCRS":n.type="ProjectedCRS",n.name=t[1],n.base_crs=t.find(B=>Array.isArray(B)&&"BASEGEOGCRS"===B[0])?this.convert(t.find(B=>Array.isArray(B)&&"BASEGEOGCRS"===B[0])):null,n.conversion=t.find(B=>Array.isArray(B)&&"CONVERSION"===B[0])?this.convert(t.find(B=>Array.isArray(B)&&"CONVERSION"===B[0])):null;const r=t.find(B=>Array.isArray(B)&&"CS"===B[0]);r&&(n.coordinate_system={type:r[1],axis:this.extractAxes(t)});const s=t.find(B=>Array.isArray(B)&&"LENGTHUNIT"===B[0]);if(s){const B=this.convertUnit(s);n.coordinate_system.unit=B}n.id=this.getId(t);break;case"BASEGEOGCRS":case"GEOGCRS":n.type="GeographicCRS",n.name=t[1];const l=t.find(B=>Array.isArray(B)&&("DATUM"===B[0]||"ENSEMBLE"===B[0]));if(l){const B=this.convert(l);"ENSEMBLE"===l[0]?n.datum_ensemble=B:n.datum=B;const X=t.find(le=>Array.isArray(le)&&"PRIMEM"===le[0]);X&&"Greenwich"!==X[1]&&(B.prime_meridian={name:X[1],longitude:parseFloat(X[2])})}n.coordinate_system={type:"ellipsoidal",axis:this.extractAxes(t)},n.id=this.getId(t);break;case"DATUM":n.type="GeodeticReferenceFrame",n.name=t[1],n.ellipsoid=t.find(B=>Array.isArray(B)&&"ELLIPSOID"===B[0])?this.convert(t.find(B=>Array.isArray(B)&&"ELLIPSOID"===B[0])):null;break;case"ENSEMBLE":n.type="DatumEnsemble",n.name=t[1],n.members=t.filter(B=>Array.isArray(B)&&"MEMBER"===B[0]).map(B=>({type:"DatumEnsembleMember",name:B[1],id:this.getId(B)}));const d=t.find(B=>Array.isArray(B)&&"ENSEMBLEACCURACY"===B[0]);d&&(n.accuracy=parseFloat(d[1]));const g=t.find(B=>Array.isArray(B)&&"ELLIPSOID"===B[0]);g&&(n.ellipsoid=this.convert(g)),n.id=this.getId(t);break;case"ELLIPSOID":n.type="Ellipsoid",n.name=t[1],n.semi_major_axis=parseFloat(t[2]),n.inverse_flattening=parseFloat(t[3]),t.find(B=>Array.isArray(B)&&"LENGTHUNIT"===B[0])&&this.convert(t.find(B=>Array.isArray(B)&&"LENGTHUNIT"===B[0]),n);break;case"CONVERSION":n.type="Conversion",n.name=t[1],n.method=t.find(B=>Array.isArray(B)&&"METHOD"===B[0])?this.convert(t.find(B=>Array.isArray(B)&&"METHOD"===B[0])):null,n.parameters=t.filter(B=>Array.isArray(B)&&"PARAMETER"===B[0]).map(B=>this.convert(B));break;case"METHOD":n.type="Method",n.name=t[1],n.id=this.getId(t);break;case"PARAMETER":n.type="Parameter",n.name=t[1],n.value=parseFloat(t[2]),n.unit=this.convertUnit(t.find(B=>Array.isArray(B)&&("LENGTHUNIT"===B[0]||"ANGLEUNIT"===B[0]||"SCALEUNIT"===B[0]))),n.id=this.getId(t);break;case"BOUNDCRS":n.type="BoundCRS";const M=t.find(B=>Array.isArray(B)&&"SOURCECRS"===B[0]);if(M){const B=M.find(X=>Array.isArray(X));n.source_crs=B?this.convert(B):null}const A=t.find(B=>Array.isArray(B)&&"TARGETCRS"===B[0]);if(A){const B=A.find(X=>Array.isArray(X));n.target_crs=B?this.convert(B):null}const O=t.find(B=>Array.isArray(B)&&"ABRIDGEDTRANSFORMATION"===B[0]);n.transformation=O?this.convert(O):null;break;case"ABRIDGEDTRANSFORMATION":if(n.type="Transformation",n.name=t[1],n.method=t.find(B=>Array.isArray(B)&&"METHOD"===B[0])?this.convert(t.find(B=>Array.isArray(B)&&"METHOD"===B[0])):null,n.parameters=t.filter(B=>Array.isArray(B)&&("PARAMETER"===B[0]||"PARAMETERFILE"===B[0])).map(B=>"PARAMETER"===B[0]?this.convert(B):"PARAMETERFILE"===B[0]?{name:B[1],value:B[2],id:{authority:"EPSG",code:8656}}:void 0),7===n.parameters.length){const B=n.parameters[6];"Scale difference"===B.name&&(B.value=Math.round(1e12*(B.value-1))/1e6)}n.id=this.getId(t);break;case"AXIS":n.coordinate_system||(n.coordinate_system={type:"unspecified",axis:[]}),n.coordinate_system.axis.push(this.convertAxis(t));break;case"LENGTHUNIT":const j=this.convertUnit(t,"LinearUnit");n.coordinate_system&&n.coordinate_system.axis&&n.coordinate_system.axis.forEach(B=>{B.unit||(B.unit=j)}),j.conversion_factor&&1!==j.conversion_factor&&n.semi_major_axis&&(n.semi_major_axis={value:n.semi_major_axis,unit:j});break;default:n.keyword=t[0]}return n}},wq=class xq extends WI{static convert(t,n={}){return super.convert(t,n),n.coordinate_system&&"Cartesian"===n.coordinate_system.subtype&&delete n.coordinate_system,n.usage&&delete n.usage,n}},Sq=class Cq extends WI{static convert(t,n={}){super.convert(t,n);const r=t.find(l=>Array.isArray(l)&&"CS"===l[0]);r&&(n.coordinate_system={subtype:r[1],axis:this.extractAxes(t)});const s=t.find(l=>Array.isArray(l)&&"USAGE"===l[0]);if(s){const l=s.find(v=>Array.isArray(v)&&"SCOPE"===v[0]),d=s.find(v=>Array.isArray(v)&&"AREA"===v[0]),g=s.find(v=>Array.isArray(v)&&"BBOX"===v[0]);n.usage={},l&&(n.usage.scope=l[1]),d&&(n.usage.area=d[1]),g&&(n.usage.bbox=g.slice(1))}return n}};var _0=1,Dq=/\s/,Aq=/[A-Za-z]/,Pq=/[A-Za-z84_]/,ov=/[,\]]/,KI=/[\d\.E\-\+]/;function id(e){if("string"!=typeof e)throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=_0}function dw(e,t,n){Array.isArray(t)&&(n.unshift(t),t=null);var s=n.reduce(function(l,d){return _g(d,l),l},t?{}:e);t&&(e[t]=s)}function _g(e,t){if(Array.isArray(e)){var n=e.shift();if("PARAMETER"===n&&(n=e.shift()),1===e.length)return Array.isArray(e[0])?(t[n]={},void _g(e[0],t[n])):void(t[n]=e[0]);if(e.length)if("TOWGS84"!==n){if("AXIS"===n)return n in t||(t[n]=[]),void t[n].push(e);var r;switch(Array.isArray(n)||(t[n]={}),n){case"UNIT":case"PRIMEM":case"VERT_DATUM":return t[n]={name:e[0].toLowerCase(),convert:e[1]},void(3===e.length&&_g(e[2],t[n]));case"SPHEROID":case"ELLIPSOID":return t[n]={name:e[0],a:e[1],rf:e[2]},void(4===e.length&&_g(e[3],t[n]));case"EDATUM":case"ENGINEERINGDATUM":case"LOCAL_DATUM":case"DATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":return e[0]=["name",e[0]],void dw(t,n,e);case"COMPD_CS":case"COMPOUNDCRS":case"FITTED_CS":case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"ENGCRS":case"ENGINEERINGCRS":return e[0]=["name",e[0]],dw(t,n,e),void(t[n].type=n);default:for(r=-1;++r<e.length;)if(!Array.isArray(e[r]))return _g(e,t[n]);return dw(t,n,e)}}else t[n]=e;else t[n]=!0}else t[e]=!0}function sc(e){return.017453292519943295*e}function XI(e){const t=(e.projName||"").toLowerCase().replace(/_/g," ");!e.long0&&e.longc&&("albers conic equal area"===t||"lambert azimuthal equal area"===t)&&(e.long0=e.longc),e.lat_ts||!e.lat1||"stereographic south pole"!==t&&"polar stereographic (variant b)"!==t?!e.lat_ts&&e.lat0&&("polar stereographic"===t||"polar stereographic (variant a)"===t)&&(e.lat_ts=e.lat0,e.lat0=sc(e.lat0>0?90:-90),delete e.lat1):(e.lat0=sc(e.lat1>0?90:-90),e.lat_ts=e.lat1,delete e.lat1)}function QI(e){let t={units:null,to_meter:void 0};return"string"==typeof e?(t.units=e.toLowerCase(),"metre"===t.units&&(t.units="meter"),"meter"===t.units&&(t.to_meter=1)):e&&e.name&&(t.units=e.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.to_meter=e.conversion_factor),t}function JI(e){return"object"==typeof e?e.value*e.unit.conversion_factor:e}function eD(e,t){e.ellipsoid.radius?(t.a=e.ellipsoid.radius,t.rf=0):(t.a=JI(e.ellipsoid.semi_major_axis),void 0!==e.ellipsoid.inverse_flattening?t.rf=e.ellipsoid.inverse_flattening:void 0!==e.ellipsoid.semi_major_axis&&void 0!==e.ellipsoid.semi_minor_axis&&(t.rf=t.a/(t.a-JI(e.ellipsoid.semi_minor_axis))))}function iv(e,t={}){return e&&"object"==typeof e?"BoundCRS"===e.type?(iv(e.source_crs,t),e.transformation&&(e.transformation.method&&"NTv2"===e.transformation.method.name?t.nadgrids=e.transformation.parameters[0].value:t.datum_params=e.transformation.parameters.map(n=>n.value)),t):(Object.keys(e).forEach(n=>{const r=e[n];if(null!==r)switch(n){case"name":if(t.srsCode)break;t.name=r,t.srsCode=r;break;case"type":"GeographicCRS"===r?t.projName="longlat":"ProjectedCRS"===r&&e.conversion&&e.conversion.method&&(t.projName=e.conversion.method.name);break;case"datum":case"datum_ensemble":r.ellipsoid&&(t.ellps=r.ellipsoid.name,eD(r,t)),r.prime_meridian&&(t.from_greenwich=r.prime_meridian.longitude*Math.PI/180);break;case"ellipsoid":t.ellps=r.name,eD(r,t);break;case"prime_meridian":t.long0=(r.longitude||0)*Math.PI/180;break;case"coordinate_system":if(r.axis)if(t.axis=r.axis.map(s=>{const l=s.direction;if("east"===l)return"e";if("north"===l)return"n";if("west"===l)return"w";if("south"===l)return"s";throw new Error(`Unknown axis direction: ${l}`)}).join("")+"u",r.unit){const{units:s,to_meter:l}=QI(r.unit);t.units=s,t.to_meter=l}else if(r.axis[0]&&r.axis[0].unit){const{units:s,to_meter:l}=QI(r.axis[0].unit);t.units=s,t.to_meter=l}break;case"id":r.authority&&r.code&&(t.title=r.authority+":"+r.code);break;case"conversion":r.method&&r.method.name&&(t.projName=r.method.name),r.parameters&&r.parameters.forEach(s=>{const l=s.name.toLowerCase().replace(/\s+/g,"_"),d=s.value;t[l]=s.unit&&s.unit.conversion_factor?d*s.unit.conversion_factor:"degree"===s.unit?d*Math.PI/180:d});break;case"unit":r.name&&(t.units=r.name.toLowerCase(),"metre"===t.units&&(t.units="meter")),r.conversion_factor&&(t.to_meter=r.conversion_factor);break;case"base_crs":iv(r,t),t.datumCode=r.id?r.id.authority+"_"+r.id.code:r.name}}),void 0!==t.latitude_of_false_origin&&(t.lat0=t.latitude_of_false_origin),void 0!==t.longitude_of_false_origin&&(t.long0=t.longitude_of_false_origin),void 0!==t.latitude_of_standard_parallel&&(t.lat0=t.latitude_of_standard_parallel,t.lat1=t.latitude_of_standard_parallel),void 0!==t.latitude_of_1st_standard_parallel&&(t.lat1=t.latitude_of_1st_standard_parallel),void 0!==t.latitude_of_2nd_standard_parallel&&(t.lat2=t.latitude_of_2nd_standard_parallel),void 0!==t.latitude_of_projection_centre&&(t.lat0=t.latitude_of_projection_centre),void 0!==t.longitude_of_projection_centre&&(t.longc=t.longitude_of_projection_centre),void 0!==t.easting_at_false_origin&&(t.x0=t.easting_at_false_origin),void 0!==t.northing_at_false_origin&&(t.y0=t.northing_at_false_origin),void 0!==t.latitude_of_natural_origin&&(t.lat0=t.latitude_of_natural_origin),void 0!==t.longitude_of_natural_origin&&(t.long0=t.longitude_of_natural_origin),void 0!==t.longitude_of_origin&&(t.long0=t.longitude_of_origin),void 0!==t.false_easting&&(t.x0=t.false_easting),t.easting_at_projection_centre&&(t.x0=t.easting_at_projection_centre),void 0!==t.false_northing&&(t.y0=t.false_northing),t.northing_at_projection_centre&&(t.y0=t.northing_at_projection_centre),void 0!==t.standard_parallel_1&&(t.lat1=t.standard_parallel_1),void 0!==t.standard_parallel_2&&(t.lat2=t.standard_parallel_2),void 0!==t.scale_factor_at_natural_origin&&(t.k0=t.scale_factor_at_natural_origin),void 0!==t.scale_factor_at_projection_centre&&(t.k0=t.scale_factor_at_projection_centre),void 0!==t.scale_factor_on_pseudo_standard_parallel&&(t.k0=t.scale_factor_on_pseudo_standard_parallel),void 0!==t.azimuth&&(t.alpha=t.azimuth),void 0!==t.azimuth_at_projection_centre&&(t.alpha=t.azimuth_at_projection_centre),t.angle_from_rectified_to_skew_grid&&(t.rectified_grid_angle=t.angle_from_rectified_to_skew_grid),XI(t),t):e}id.prototype.readCharicter=function(){var e=this.text[this.place++];if(4!==this.state)for(;Dq.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case _0:return this.neutral(e);case 2:return this.keyword(e);case 4:return this.quoted(e);case 5:return this.afterquote(e);case 3:return this.number(e);case-1:return}},id.prototype.afterquote=function(e){if('"'===e)return this.word+='"',void(this.state=4);if(ov.test(e))return this.word=this.word.trim(),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in afterquote yet, index '+this.place)},id.prototype.afterItem=function(e){return","===e?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=_0)):"]"===e?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=_0,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},id.prototype.number=function(e){if(!KI.test(e)){if(ov.test(e))return this.word=parseFloat(this.word),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in number yet, index '+this.place)}this.word+=e},id.prototype.quoted=function(e){'"'!==e?this.word+=e:this.state=5},id.prototype.keyword=function(e){if(Pq.test(e))this.word+=e;else{if("["===e){var t=[];return t.push(this.word),this.level++,null===this.root?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,void(this.state=_0)}if(!ov.test(e))throw new Error("havn't handled \""+e+'" in keyword yet, index '+this.place);this.afterItem(e)}},id.prototype.neutral=function(e){if(Aq.test(e))return this.word=e,void(this.state=2);if('"'===e)return this.word="",void(this.state=4);if(KI.test(e))return this.word=e,void(this.state=3);if(!ov.test(e))throw new Error("havn't handled \""+e+'" in neutral yet, index '+this.place);this.afterItem(e)},id.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};var Oq=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];function tD(e){for(var t=Object.keys(e),n=0,r=t.length;n<r;++n){var s=t[n];-1!==Oq.indexOf(s)&&Lq(e[s]),"object"==typeof e[s]&&tD(e[s])}}function Lq(e){if(e.AUTHORITY){var t=Object.keys(e.AUTHORITY)[0];t&&t in e.AUTHORITY&&(e.title=t+":"+e.AUTHORITY[t])}if("GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):e.projName="object"==typeof e.PROJECTION?Object.keys(e.PROJECTION)[0]:e.PROJECTION,e.AXIS){for(var n="",r=0,s=e.AXIS.length;r<s;++r){var l=[e.AXIS[r][0].toLowerCase(),e.AXIS[r][1].toLowerCase()];-1!==l[0].indexOf("north")||("y"===l[0]||"lat"===l[0])&&"north"===l[1]?n+="n":-1!==l[0].indexOf("south")||("y"===l[0]||"lat"===l[0])&&"south"===l[1]?n+="s":-1!==l[0].indexOf("east")||("x"===l[0]||"lon"===l[0])&&"east"===l[1]?n+="e":(-1!==l[0].indexOf("west")||("x"===l[0]||"lon"===l[0])&&"west"===l[1])&&(n+="w")}2===n.length&&(n+="u"),3===n.length&&(e.axis=n)}e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&("GEOGCS"===e.type?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var d=e.GEOGCS;function g(A){return A*(e.to_meter||1)}"GEOGCS"===e.type&&(d=e),d&&(e.datumCode=d.DATUM?d.DATUM.name.toLowerCase():d.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),"new_zealand_1949"===e.datumCode&&(e.datumCode="nzgd49"),("wgs_1984"===e.datumCode||"world_geodetic_system_1984"===e.datumCode)&&("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"belge_1972"===e.datumCode&&(e.datumCode="rnb72"),d.DATUM&&d.DATUM.SPHEROID&&(e.ellps=d.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=d.DATUM.SPHEROID.a,e.rf=parseFloat(d.DATUM.SPHEROID.rf,10)),d.DATUM&&d.DATUM.TOWGS84&&(e.datum_params=d.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),"ch1903+"===e.datumCode&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),e.rectified_grid_angle&&(e.rectified_grid_angle=sc(e.rectified_grid_angle)),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",sc],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",sc],["x0","false_easting",g],["y0","false_northing",g],["long0","central_meridian",sc],["lat0","latitude_of_origin",sc],["lat0","standard_parallel_1",sc],["lat1","standard_parallel_1",sc],["lat2","standard_parallel_2",sc],["azimuth","Azimuth"],["alpha","azimuth",sc],["srsCode","name"]].forEach(function(A){return function Nq(e,t){var n=t[0],r=t[1];!(n in e)&&r in e&&(e[n]=e[r],3===t.length&&(e[n]=t[2](e[n])))}(e,A)}),XI(e)}function hw(e){if("object"==typeof e)return iv(e);const t=function Tq(e){const t=e.toUpperCase();return t.includes("PROJCRS")||t.includes("GEOGCRS")||t.includes("BOUNDCRS")||t.includes("VERTCRS")||t.includes("LENGTHUNIT")||t.includes("ANGLEUNIT")||t.includes("SCALEUNIT")?"WKT2":(t.includes("PROJCS")||t.includes("GEOGCS")||t.includes("LOCAL_CS")||t.includes("VERT_CS")||t.includes("UNIT"),"WKT1")}(e);var n=function kq(e){return new id(e).output()}(e);if("WKT2"===t)return iv(function Mq(e){return("2019"===function Eq(e){return e.find(t=>Array.isArray(t)&&"USAGE"===t[0])?"2019":(e.find(t=>Array.isArray(t)&&"CS"===t[0]),"2015")}(e)?Sq:wq).convert(e)}(n));var r=n[0],s={};return _g(n,s),tD(s),s[r]}function dl(e){var t=this;if(2===arguments.length){var n=arguments[1];dl[e]="string"==typeof n?"+"===n.charAt(0)?cw(arguments[1]):hw(arguments[1]):n}else if(1===arguments.length){if(Array.isArray(e))return e.map(function(r){return Array.isArray(r)?dl.apply(t,r):dl(r)});if("string"==typeof e){if(e in dl)return dl[e]}else"EPSG"in e?dl["EPSG:"+e.EPSG]=e:"ESRI"in e?dl["ESRI:"+e.ESRI]=e:"IAU2000"in e?dl["IAU2000:"+e.IAU2000]=e:console.log(e);return}}!function hq(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");for(var t=1;t<=60;++t)e("EPSG:"+(32600+t),"+proj=utm +zone="+t+" +datum=WGS84 +units=m"),e("EPSG:"+(32700+t),"+proj=utm +zone="+t+" +south +datum=WGS84 +units=m");e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}(dl);const sv=dl;var jq=["3857","900913","3785","102113"];function nD(e,t){var n,r;if(e=e||{},!t)return e;for(r in t)void 0!==(n=t[r])&&(e[r]=n);return e}function tu(e,t,n){var r=e*t;return n/Math.sqrt(1-r*r)}function y0(e){return e<0?-1:1}function It(e){return Math.abs(e)<=Do?e:e-y0(e)*m0}function ac(e,t,n){var r=e*n;return r=Math.pow((1-r)/(1+r),.5*e),Math.tan(.5*(ot-t))/r}function v0(e,t){for(var r,s,n=.5*e,l=ot-2*Math.atan(t),d=0;d<=15;d++)if(r=e*Math.sin(l),l+=s=ot-2*Math.atan(t*Math.pow((1-r)/(1+r),n))-l,Math.abs(s)<=1e-10)return l;return-9999}function rD(e){return e}var Jq=[{init:function Wq(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):tu(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},forward:function qq(e){var r,s,t=e.x,n=e.y;if(n*eu>90&&n*eu<-90&&t*eu>180&&t*eu<-180)return null;if(Math.abs(Math.abs(n)-ot)<=wt)return null;if(this.sphere)r=this.x0+this.a*this.k0*It(t-this.long0),s=this.y0+this.a*this.k0*Math.log(Math.tan(rr+.5*n));else{var l=Math.sin(n),d=ac(this.e,n,l);r=this.x0+this.a*this.k0*It(t-this.long0),s=this.y0-this.a*this.k0*Math.log(d)}return e.x=r,e.y=s,e},inverse:function Zq(e){var r,s,t=e.x-this.x0,n=e.y-this.y0;if(this.sphere)s=ot-2*Math.atan(Math.exp(-n/(this.a*this.k0)));else{var l=Math.exp(-n/(this.a*this.k0));if(-9999===(s=v0(this.e,l)))return null}return r=It(this.long0+t/(this.a*this.k0)),e.x=r,e.y=s,e},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","Mercator_Variant_A","merc"]},{init:function Xq(){},forward:rD,inverse:rD,names:["longlat","identity"]}],jf={},yg=[];function oD(e,t){var n=yg.length;return e.names?(yg[n]=e,e.names.forEach(function(r){jf[r.toLowerCase()]=n}),this):(console.log(t),!0)}function iD(e){return e.replace(/[-\(\)\s]+/g," ").trim().replace(/ /g,"_")}const nZ={start:function tZ(){Jq.forEach(oD)},add:oD,get:function eZ(e){if(!e)return!1;var t=e.toLowerCase();return typeof jf[t]<"u"&&yg[jf[t]]||(t=iD(t))in jf&&yg[jf[t]]?yg[jf[t]]:void 0}},sD={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk80ign:{a:6378249.2,b:6356515,rf:293.4660213,ellipseName:"Clarke 1880 (IGN)"},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"},WGS84:{a:6378137,rf:298.257223563,ellipseName:"WGS 84"},sphere:{a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},oZ=sD.WGS84;var av={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},mgi:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Militar-Geographische Institut"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Ordnance Survey of Great Britain 1936"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"},EPSG_5451:{towgs84:"6.41,-49.05,-11.28,1.5657,0.5242,6.9718,-5.7649"},IGNF_LURESG:{towgs84:"-192.986,13.673,-39.309,-0.4099,-2.9332,2.6881,0.43"},EPSG_4614:{towgs84:"-119.4248,-303.65872,-11.00061,1.164298,0.174458,1.096259,3.657065"},EPSG_4615:{towgs84:"-494.088,-312.129,279.877,-1.423,-1.013,1.59,-0.748"},ESRI_37241:{towgs84:"-76.822,257.457,-12.817,2.136,-0.033,-2.392,-0.031"},ESRI_37249:{towgs84:"-440.296,58.548,296.265,1.128,10.202,4.559,-0.438"},ESRI_37245:{towgs84:"-511.151,-181.269,139.609,1.05,2.703,1.798,3.071"},EPSG_4178:{towgs84:"24.9,-126.4,-93.2,-0.063,-0.247,-0.041,1.01"},EPSG_4622:{towgs84:"-472.29,-5.63,-304.12,0.4362,-0.8374,0.2563,1.8984"},EPSG_4625:{towgs84:"126.93,547.94,130.41,-2.7867,5.1612,-0.8584,13.8227"},EPSG_5252:{towgs84:"0.023,0.036,-0.068,0.00176,0.00912,-0.01136,0.00439"},EPSG_4314:{towgs84:"597.1,71.4,412.1,0.894,0.068,-1.563,7.58"},EPSG_4282:{towgs84:"-178.3,-316.7,-131.5,5.278,6.077,10.979,19.166"},EPSG_4231:{towgs84:"-83.11,-97.38,-117.22,0.0276,-0.2167,0.2147,0.1218"},EPSG_4274:{towgs84:"-230.994,102.591,25.199,0.633,-0.239,0.9,1.95"},EPSG_4134:{towgs84:"-180.624,-225.516,173.919,-0.81,-1.898,8.336,16.71006"},EPSG_4254:{towgs84:"18.38,192.45,96.82,0.056,-0.142,-0.2,-0.0013"},EPSG_4159:{towgs84:"-194.513,-63.978,-25.759,-3.4027,3.756,-3.352,-0.9175"},EPSG_4687:{towgs84:"0.072,-0.507,-0.245,0.0183,-0.0003,0.007,-0.0093"},EPSG_4227:{towgs84:"-83.58,-397.54,458.78,-17.595,-2.847,4.256,3.225"},EPSG_4746:{towgs84:"599.4,72.4,419.2,-0.062,-0.022,-2.723,6.46"},EPSG_4745:{towgs84:"612.4,77,440.2,-0.054,0.057,-2.797,2.55"},EPSG_6311:{towgs84:"8.846,-4.394,-1.122,-0.00237,-0.146528,0.130428,0.783926"},EPSG_4289:{towgs84:"565.7381,50.4018,465.2904,-1.91514,1.60363,-9.09546,4.07244"},EPSG_4230:{towgs84:"-68.863,-134.888,-111.49,-0.53,-0.14,0.57,-3.4"},EPSG_4154:{towgs84:"-123.02,-158.95,-168.47"},EPSG_4156:{towgs84:"570.8,85.7,462.8,4.998,1.587,5.261,3.56"},EPSG_4299:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4179:{towgs84:"33.4,-146.6,-76.3,-0.359,-0.053,0.844,-0.84"},EPSG_4313:{towgs84:"-106.8686,52.2978,-103.7239,0.3366,-0.457,1.8422,-1.2747"},EPSG_4194:{towgs84:"163.511,127.533,-159.789"},EPSG_4195:{towgs84:"105,326,-102.5"},EPSG_4196:{towgs84:"-45,417,-3.5"},EPSG_4611:{towgs84:"-162.619,-276.959,-161.764,0.067753,-2.243649,-1.158827,-1.094246"},EPSG_4633:{towgs84:"137.092,131.66,91.475,-1.9436,-11.5993,-4.3321,-7.4824"},EPSG_4641:{towgs84:"-408.809,366.856,-412.987,1.8842,-0.5308,2.1655,-121.0993"},EPSG_4643:{towgs84:"-480.26,-438.32,-643.429,16.3119,20.1721,-4.0349,-111.7002"},EPSG_4300:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4188:{towgs84:"482.5,-130.6,564.6,-1.042,-0.214,-0.631,8.15"},EPSG_4660:{towgs84:"982.6087,552.753,-540.873,32.39344,-153.25684,-96.2266,16.805"},EPSG_4662:{towgs84:"97.295,-263.247,310.882,-1.5999,0.8386,3.1409,13.3259"},EPSG_3906:{towgs84:"577.88891,165.22205,391.18289,4.9145,-0.94729,-13.05098,7.78664"},EPSG_4307:{towgs84:"-209.3622,-87.8162,404.6198,0.0046,3.4784,0.5805,-1.4547"},EPSG_6892:{towgs84:"-76.269,-16.683,68.562,-6.275,10.536,-4.286,-13.686"},EPSG_4690:{towgs84:"221.597,152.441,176.523,2.403,1.3893,0.884,11.4648"},EPSG_4691:{towgs84:"218.769,150.75,176.75,3.5231,2.0037,1.288,10.9817"},EPSG_4629:{towgs84:"72.51,345.411,79.241,-1.5862,-0.8826,-0.5495,1.3653"},EPSG_4630:{towgs84:"165.804,216.213,180.26,-0.6251,-0.4515,-0.0721,7.4111"},EPSG_4692:{towgs84:"217.109,86.452,23.711,0.0183,-0.0003,0.007,-0.0093"},EPSG_9333:{towgs84:"0,0,0,-8.393,0.749,-10.276,0"},EPSG_9059:{towgs84:"0,0,0"},EPSG_4312:{towgs84:"601.705,84.263,485.227,4.7354,1.3145,5.393,-2.3887"},EPSG_4123:{towgs84:"-96.062,-82.428,-121.753,4.801,0.345,-1.376,1.496"},EPSG_4309:{towgs84:"-124.45,183.74,44.64,-0.4384,0.5446,-0.9706,-2.1365"},ESRI_104106:{towgs84:"-283.088,-70.693,117.445,-1.157,0.059,-0.652,-4.058"},EPSG_4281:{towgs84:"-219.247,-73.802,269.529"},EPSG_4322:{towgs84:"0,0,4.5"},EPSG_4324:{towgs84:"0,0,1.9"},EPSG_4284:{towgs84:"43.822,-108.842,-119.585,1.455,-0.761,0.737,0.549"},EPSG_4277:{towgs84:"446.448,-125.157,542.06,0.15,0.247,0.842,-20.489"},EPSG_4207:{towgs84:"-282.1,-72.2,120,-1.529,0.145,-0.89,-4.46"},EPSG_4688:{towgs84:"347.175,1077.618,2623.677,33.9058,-70.6776,9.4013,186.0647"},EPSG_4689:{towgs84:"410.793,54.542,80.501,-2.5596,-2.3517,-0.6594,17.3218"},EPSG_4720:{towgs84:"0,0,4.5"},EPSG_4273:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},EPSG_4240:{towgs84:"204.64,834.74,293.8"},EPSG_4817:{towgs84:"278.3,93,474.5,7.889,0.05,-6.61,6.21"},ESRI_104131:{towgs84:"426.62,142.62,460.09,4.98,4.49,-12.42,-17.1"},EPSG_4265:{towgs84:"-104.1,-49.1,-9.9,0.971,-2.917,0.714,-11.68"},EPSG_4263:{towgs84:"-111.92,-87.85,114.5,1.875,0.202,0.219,0.032"},EPSG_4298:{towgs84:"-689.5937,623.84046,-65.93566,-0.02331,1.17094,-0.80054,5.88536"},EPSG_4270:{towgs84:"-253.4392,-148.452,386.5267,0.15605,0.43,-0.1013,-0.0424"},EPSG_4229:{towgs84:"-121.8,98.1,-10.7"},EPSG_4220:{towgs84:"-55.5,-348,-229.2"},EPSG_4214:{towgs84:"12.646,-155.176,-80.863"},EPSG_4232:{towgs84:"-345,3,223"},EPSG_4238:{towgs84:"-1.977,-13.06,-9.993,0.364,0.254,0.689,-1.037"},EPSG_4168:{towgs84:"-170,33,326"},EPSG_4131:{towgs84:"199,931,318.9"},EPSG_4152:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_5228:{towgs84:"572.213,85.334,461.94,4.9732,1.529,5.2484,3.5378"},EPSG_8351:{towgs84:"485.021,169.465,483.839,7.786342,4.397554,4.102655,0"},EPSG_4683:{towgs84:"-127.62,-67.24,-47.04,-3.068,4.903,1.578,-1.06"},EPSG_4133:{towgs84:"0,0,0"},EPSG_7373:{towgs84:"0.819,-0.5762,-1.6446,-0.00378,-0.03317,0.00318,0.0693"},EPSG_9075:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9072:{towgs84:"-0.9102,2.0141,0.5602,0.029039,0.010065,0.010101,0"},EPSG_9294:{towgs84:"1.16835,-1.42001,-2.24431,-0.00822,-0.05508,0.01818,0.23388"},EPSG_4212:{towgs84:"-267.434,173.496,181.814,-13.4704,8.7154,7.3926,14.7492"},EPSG_4191:{towgs84:"-44.183,-0.58,-38.489,2.3867,2.7072,-3.5196,-8.2703"},EPSG_4237:{towgs84:"52.684,-71.194,-13.975,-0.312,-0.1063,-0.3729,1.0191"},EPSG_4740:{towgs84:"-1.08,-0.27,-0.9"},EPSG_4124:{towgs84:"419.3836,99.3335,591.3451,0.850389,1.817277,-7.862238,-0.99496"},EPSG_5681:{towgs84:"584.9636,107.7175,413.8067,1.1155,0.2824,-3.1384,7.9922"},EPSG_4141:{towgs84:"23.772,17.49,17.859,-0.3132,-1.85274,1.67299,-5.4262"},EPSG_4204:{towgs84:"-85.645,-273.077,-79.708,2.289,-1.421,2.532,3.194"},EPSG_4319:{towgs84:"226.702,-193.337,-35.371,-2.229,-4.391,9.238,0.9798"},EPSG_4200:{towgs84:"24.82,-131.21,-82.66"},EPSG_4130:{towgs84:"0,0,0"},EPSG_4127:{towgs84:"-82.875,-57.097,-156.768,-2.158,1.524,-0.982,-0.359"},EPSG_4149:{towgs84:"674.374,15.056,405.346"},EPSG_4617:{towgs84:"-0.991,1.9072,0.5129,1.25033e-7,4.6785e-8,5.6529e-8,0"},EPSG_4663:{towgs84:"-210.502,-66.902,-48.476,2.094,-15.067,-5.817,0.485"},EPSG_4664:{towgs84:"-211.939,137.626,58.3,-0.089,0.251,0.079,0.384"},EPSG_4665:{towgs84:"-105.854,165.589,-38.312,-0.003,-0.026,0.024,-0.048"},EPSG_4666:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},EPSG_4756:{towgs84:"-192.873,-39.382,-111.202,-0.00205,-0.0005,0.00335,0.0188"},EPSG_4723:{towgs84:"-179.483,-69.379,-27.584,-7.862,8.163,6.042,-13.925"},EPSG_4726:{towgs84:"8.853,-52.644,180.304,-0.393,-2.323,2.96,-24.081"},EPSG_4267:{towgs84:"-8.0,160.0,176.0"},EPSG_5365:{towgs84:"-0.16959,0.35312,0.51846,0.03385,-0.16325,0.03446,0.03693"},EPSG_4218:{towgs84:"304.5,306.5,-318.1"},EPSG_4242:{towgs84:"-33.722,153.789,94.959,-8.581,-4.478,4.54,8.95"},EPSG_4216:{towgs84:"-292.295,248.758,429.447,4.9971,2.99,6.6906,1.0289"},ESRI_104105:{towgs84:"631.392,-66.551,481.442,1.09,-4.445,-4.487,-4.43"},ESRI_104129:{towgs84:"0,0,0"},EPSG_4673:{towgs84:"174.05,-25.49,112.57"},EPSG_4202:{towgs84:"-124,-60,154"},EPSG_4203:{towgs84:"-117.763,-51.51,139.061,0.292,0.443,0.277,-0.191"},EPSG_3819:{towgs84:"595.48,121.69,515.35,4.115,-2.9383,0.853,-3.408"},EPSG_8694:{towgs84:"-93.799,-132.737,-219.073,-1.844,0.648,-6.37,-0.169"},EPSG_4145:{towgs84:"275.57,676.78,229.6"},EPSG_4283:{towgs84:"61.55,-10.87,-40.19,39.4924,32.7221,32.8979,-9.994"},EPSG_4317:{towgs84:"2.3287,-147.0425,-92.0802,-0.3092483,0.32482185,0.49729934,5.68906266"},EPSG_4272:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993"},EPSG_4248:{towgs84:"-307.7,265.3,-363.5"},EPSG_5561:{towgs84:"24,-121,-76"},EPSG_5233:{towgs84:"-0.293,766.95,87.713,0.195704,1.695068,3.473016,-0.039338"},ESRI_104130:{towgs84:"-86,-98,-119"},ESRI_104102:{towgs84:"682,-203,480"},ESRI_37207:{towgs84:"7,-10,-26"},EPSG_4675:{towgs84:"59.935,118.4,-10.871"},ESRI_104109:{towgs84:"-89.121,-348.182,260.871"},ESRI_104112:{towgs84:"-185.583,-230.096,281.361"},ESRI_104113:{towgs84:"25.1,-275.6,222.6"},IGNF_WGS72G:{towgs84:"0,12,6"},IGNF_NTFG:{towgs84:"-168,-60,320"},IGNF_EFATE57G:{towgs84:"-127,-769,472"},IGNF_PGP50G:{towgs84:"324.8,153.6,172.1"},IGNF_REUN47G:{towgs84:"94,-948,-1262"},IGNF_CSG67G:{towgs84:"-186,230,110"},IGNF_GUAD48G:{towgs84:"-467,-16,-300"},IGNF_TAHI51G:{towgs84:"162,117,154"},IGNF_TAHAAG:{towgs84:"65,342,77"},IGNF_NUKU72G:{towgs84:"84,274,65"},IGNF_PETRELS72G:{towgs84:"365,194,166"},IGNF_WALL78G:{towgs84:"253,-133,-127"},IGNF_MAYO50G:{towgs84:"-382,-59,-262"},IGNF_TANNAG:{towgs84:"-139,-967,436"},IGNF_IGN72G:{towgs84:"-13,-348,292"},IGNF_ATIGG:{towgs84:"1118,23,66"},IGNF_FANGA84G:{towgs84:"150.57,158.33,118.32"},IGNF_RUSAT84G:{towgs84:"202.13,174.6,-15.74"},IGNF_KAUE70G:{towgs84:"126.74,300.1,-75.49"},IGNF_MOP90G:{towgs84:"-10.8,-1.8,12.77"},IGNF_MHPF67G:{towgs84:"338.08,212.58,-296.17"},IGNF_TAHI79G:{towgs84:"160.61,116.05,153.69"},IGNF_ANAA92G:{towgs84:"1.5,3.84,4.81"},IGNF_MARQUI72G:{towgs84:"330.91,-13.92,58.56"},IGNF_APAT86G:{towgs84:"143.6,197.82,74.05"},IGNF_TUBU69G:{towgs84:"237.17,171.61,-77.84"},IGNF_STPM50G:{towgs84:"11.363,424.148,373.13"},EPSG_4150:{towgs84:"674.374,15.056,405.346"},EPSG_4754:{towgs84:"-208.4058,-109.8777,-2.5764"},ESRI_104101:{towgs84:"374,150,588"},EPSG_4693:{towgs84:"0,-0.15,0.68"},EPSG_6207:{towgs84:"293.17,726.18,245.36"},EPSG_4153:{towgs84:"-133.63,-157.5,-158.62"},EPSG_4132:{towgs84:"-241.54,-163.64,396.06"},EPSG_4221:{towgs84:"-154.5,150.7,100.4"},EPSG_4266:{towgs84:"-80.7,-132.5,41.1"},EPSG_4193:{towgs84:"-70.9,-151.8,-41.4"},EPSG_5340:{towgs84:"-0.41,0.46,-0.35"},EPSG_4246:{towgs84:"-294.7,-200.1,525.5"},EPSG_4318:{towgs84:"-3.2,-5.7,2.8"},EPSG_4121:{towgs84:"-199.87,74.79,246.62"},EPSG_4223:{towgs84:"-260.1,5.5,432.2"},EPSG_4158:{towgs84:"-0.465,372.095,171.736"},EPSG_4285:{towgs84:"-128.16,-282.42,21.93"},EPSG_4613:{towgs84:"-404.78,685.68,45.47"},EPSG_4607:{towgs84:"195.671,332.517,274.607"},EPSG_4475:{towgs84:"-381.788,-57.501,-256.673"},EPSG_4208:{towgs84:"-157.84,308.54,-146.6"},EPSG_4743:{towgs84:"70.995,-335.916,262.898"},EPSG_4710:{towgs84:"-323.65,551.39,-491.22"},EPSG_7881:{towgs84:"-0.077,0.079,0.086"},EPSG_4682:{towgs84:"283.729,735.942,261.143"},EPSG_4739:{towgs84:"-156,-271,-189"},EPSG_4679:{towgs84:"-80.01,253.26,291.19"},EPSG_4750:{towgs84:"-56.263,16.136,-22.856"},EPSG_4644:{towgs84:"-10.18,-350.43,291.37"},EPSG_4695:{towgs84:"-103.746,-9.614,-255.95"},EPSG_4292:{towgs84:"-355,21,72"},EPSG_4302:{towgs84:"-61.702,284.488,472.052"},EPSG_4143:{towgs84:"-124.76,53,466.79"},EPSG_4606:{towgs84:"-153,153,307"},EPSG_4699:{towgs84:"-770.1,158.4,-498.2"},EPSG_4247:{towgs84:"-273.5,110.6,-357.9"},EPSG_4160:{towgs84:"8.88,184.86,106.69"},EPSG_4161:{towgs84:"-233.43,6.65,173.64"},EPSG_9251:{towgs84:"-9.5,122.9,138.2"},EPSG_9253:{towgs84:"-78.1,101.6,133.3"},EPSG_4297:{towgs84:"-198.383,-240.517,-107.909"},EPSG_4269:{towgs84:"0,0,0"},EPSG_4301:{towgs84:"-147,506,687"},EPSG_4618:{towgs84:"-59,-11,-52"},EPSG_4612:{towgs84:"0,0,0"},EPSG_4678:{towgs84:"44.585,-131.212,-39.544"},EPSG_4250:{towgs84:"-130,29,364"},EPSG_4144:{towgs84:"214,804,268"},EPSG_4147:{towgs84:"-17.51,-108.32,-62.39"},EPSG_4259:{towgs84:"-254.1,-5.36,-100.29"},EPSG_4164:{towgs84:"-76,-138,67"},EPSG_4211:{towgs84:"-378.873,676.002,-46.255"},EPSG_4182:{towgs84:"-422.651,-172.995,84.02"},EPSG_4224:{towgs84:"-143.87,243.37,-33.52"},EPSG_4225:{towgs84:"-205.57,168.77,-4.12"},EPSG_5527:{towgs84:"-67.35,3.88,-38.22"},EPSG_4752:{towgs84:"98,390,-22"},EPSG_4310:{towgs84:"-30,190,89"},EPSG_9248:{towgs84:"-192.26,65.72,132.08"},EPSG_4680:{towgs84:"124.5,-63.5,-281"},EPSG_4701:{towgs84:"-79.9,-158,-168.9"},EPSG_4706:{towgs84:"-146.21,112.63,4.05"},EPSG_4805:{towgs84:"682,-203,480"},EPSG_4201:{towgs84:"-165,-11,206"},EPSG_4210:{towgs84:"-157,-2,-299"},EPSG_4183:{towgs84:"-104,167,-38"},EPSG_4139:{towgs84:"11,72,-101"},EPSG_4668:{towgs84:"-86,-98,-119"},EPSG_4717:{towgs84:"-2,151,181"},EPSG_4732:{towgs84:"102,52,-38"},EPSG_4280:{towgs84:"-377,681,-50"},EPSG_4209:{towgs84:"-138,-105,-289"},EPSG_4261:{towgs84:"31,146,47"},EPSG_4658:{towgs84:"-73,46,-86"},EPSG_4721:{towgs84:"265.025,384.929,-194.046"},EPSG_4222:{towgs84:"-136,-108,-292"},EPSG_4601:{towgs84:"-255,-15,71"},EPSG_4602:{towgs84:"725,685,536"},EPSG_4603:{towgs84:"72,213.7,93"},EPSG_4605:{towgs84:"9,183,236"},EPSG_4621:{towgs84:"137,248,-430"},EPSG_4657:{towgs84:"-28,199,5"},EPSG_4316:{towgs84:"103.25,-100.4,-307.19"},EPSG_4642:{towgs84:"-13,-348,292"},EPSG_4698:{towgs84:"145,-187,103"},EPSG_4192:{towgs84:"-206.1,-174.7,-87.7"},EPSG_4311:{towgs84:"-265,120,-358"},EPSG_4135:{towgs84:"58,-283,-182"},ESRI_104138:{towgs84:"198,-226,-347"},EPSG_4245:{towgs84:"-11,851,5"},EPSG_4142:{towgs84:"-125,53,467"},EPSG_4213:{towgs84:"-106,-87,188"},EPSG_4253:{towgs84:"-133,-77,-51"},EPSG_4129:{towgs84:"-132,-110,-335"},EPSG_4713:{towgs84:"-77,-128,142"},EPSG_4239:{towgs84:"217,823,299"},EPSG_4146:{towgs84:"295,736,257"},EPSG_4155:{towgs84:"-83,37,124"},EPSG_4165:{towgs84:"-173,253,27"},EPSG_4672:{towgs84:"175,-38,113"},EPSG_4236:{towgs84:"-637,-549,-203"},EPSG_4251:{towgs84:"-90,40,88"},EPSG_4271:{towgs84:"-2,374,172"},EPSG_4175:{towgs84:"-88,4,101"},EPSG_4716:{towgs84:"298,-304,-375"},EPSG_4315:{towgs84:"-23,259,-9"},EPSG_4744:{towgs84:"-242.2,-144.9,370.3"},EPSG_4244:{towgs84:"-97,787,86"},EPSG_4293:{towgs84:"616,97,-251"},EPSG_4714:{towgs84:"-127,-769,472"},EPSG_4736:{towgs84:"260,12,-147"},EPSG_6883:{towgs84:"-235,-110,393"},EPSG_6894:{towgs84:"-63,176,185"},EPSG_4205:{towgs84:"-43,-163,45"},EPSG_4256:{towgs84:"41,-220,-134"},EPSG_4262:{towgs84:"639,405,60"},EPSG_4604:{towgs84:"174,359,365"},EPSG_4169:{towgs84:"-115,118,426"},EPSG_4620:{towgs84:"-106,-129,165"},EPSG_4184:{towgs84:"-203,141,53"},EPSG_4616:{towgs84:"-289,-124,60"},EPSG_9403:{towgs84:"-307,-92,127"},EPSG_4684:{towgs84:"-133,-321,50"},EPSG_4708:{towgs84:"-491,-22,435"},EPSG_4707:{towgs84:"114,-116,-333"},EPSG_4709:{towgs84:"145,75,-272"},EPSG_4712:{towgs84:"-205,107,53"},EPSG_4711:{towgs84:"124,-234,-25"},EPSG_4718:{towgs84:"230,-199,-752"},EPSG_4719:{towgs84:"211,147,111"},EPSG_4724:{towgs84:"208,-435,-229"},EPSG_4725:{towgs84:"189,-79,-202"},EPSG_4735:{towgs84:"647,1777,-1124"},EPSG_4722:{towgs84:"-794,119,-298"},EPSG_4728:{towgs84:"-307,-92,127"},EPSG_4734:{towgs84:"-632,438,-609"},EPSG_4727:{towgs84:"912,-58,1227"},EPSG_4729:{towgs84:"185,165,42"},EPSG_4730:{towgs84:"170,42,84"},EPSG_4733:{towgs84:"276,-57,149"},ESRI_37218:{towgs84:"230,-199,-752"},ESRI_37240:{towgs84:"-7,215,225"},ESRI_37221:{towgs84:"252,-209,-751"},ESRI_4305:{towgs84:"-123,-206,219"},ESRI_104139:{towgs84:"-73,-247,227"},EPSG_4748:{towgs84:"51,391,-36"},EPSG_4219:{towgs84:"-384,664,-48"},EPSG_4255:{towgs84:"-333,-222,114"},EPSG_4257:{towgs84:"-587.8,519.75,145.76"},EPSG_4646:{towgs84:"-963,510,-359"},EPSG_6881:{towgs84:"-24,-203,268"},EPSG_6882:{towgs84:"-183,-15,273"},EPSG_4715:{towgs84:"-104,-129,239"},IGNF_RGF93GDD:{towgs84:"0,0,0"},IGNF_RGM04GDD:{towgs84:"0,0,0"},IGNF_RGSPM06GDD:{towgs84:"0,0,0"},IGNF_RGTAAF07GDD:{towgs84:"0,0,0"},IGNF_RGFG95GDD:{towgs84:"0,0,0"},IGNF_RGNCG:{towgs84:"0,0,0"},IGNF_RGPFGDD:{towgs84:"0,0,0"},IGNF_ETRS89G:{towgs84:"0,0,0"},IGNF_RGR92GDD:{towgs84:"0,0,0"},EPSG_4173:{towgs84:"0,0,0"},EPSG_4180:{towgs84:"0,0,0"},EPSG_4619:{towgs84:"0,0,0"},EPSG_4667:{towgs84:"0,0,0"},EPSG_4075:{towgs84:"0,0,0"},EPSG_6706:{towgs84:"0,0,0"},EPSG_7798:{towgs84:"0,0,0"},EPSG_4661:{towgs84:"0,0,0"},EPSG_4669:{towgs84:"0,0,0"},EPSG_8685:{towgs84:"0,0,0"},EPSG_4151:{towgs84:"0,0,0"},EPSG_9702:{towgs84:"0,0,0"},EPSG_4758:{towgs84:"0,0,0"},EPSG_4761:{towgs84:"0,0,0"},EPSG_4765:{towgs84:"0,0,0"},EPSG_8997:{towgs84:"0,0,0"},EPSG_4023:{towgs84:"0,0,0"},EPSG_4670:{towgs84:"0,0,0"},EPSG_4694:{towgs84:"0,0,0"},EPSG_4148:{towgs84:"0,0,0"},EPSG_4163:{towgs84:"0,0,0"},EPSG_4167:{towgs84:"0,0,0"},EPSG_4189:{towgs84:"0,0,0"},EPSG_4190:{towgs84:"0,0,0"},EPSG_4176:{towgs84:"0,0,0"},EPSG_4659:{towgs84:"0,0,0"},EPSG_3824:{towgs84:"0,0,0"},EPSG_3889:{towgs84:"0,0,0"},EPSG_4046:{towgs84:"0,0,0"},EPSG_4081:{towgs84:"0,0,0"},EPSG_4558:{towgs84:"0,0,0"},EPSG_4483:{towgs84:"0,0,0"},EPSG_5013:{towgs84:"0,0,0"},EPSG_5264:{towgs84:"0,0,0"},EPSG_5324:{towgs84:"0,0,0"},EPSG_5354:{towgs84:"0,0,0"},EPSG_5371:{towgs84:"0,0,0"},EPSG_5373:{towgs84:"0,0,0"},EPSG_5381:{towgs84:"0,0,0"},EPSG_5393:{towgs84:"0,0,0"},EPSG_5489:{towgs84:"0,0,0"},EPSG_5593:{towgs84:"0,0,0"},EPSG_6135:{towgs84:"0,0,0"},EPSG_6365:{towgs84:"0,0,0"},EPSG_5246:{towgs84:"0,0,0"},EPSG_7886:{towgs84:"0,0,0"},EPSG_8431:{towgs84:"0,0,0"},EPSG_8427:{towgs84:"0,0,0"},EPSG_8699:{towgs84:"0,0,0"},EPSG_8818:{towgs84:"0,0,0"},EPSG_4757:{towgs84:"0,0,0"},EPSG_9140:{towgs84:"0,0,0"},EPSG_8086:{towgs84:"0,0,0"},EPSG_4686:{towgs84:"0,0,0"},EPSG_4737:{towgs84:"0,0,0"},EPSG_4702:{towgs84:"0,0,0"},EPSG_4747:{towgs84:"0,0,0"},EPSG_4749:{towgs84:"0,0,0"},EPSG_4674:{towgs84:"0,0,0"},EPSG_4755:{towgs84:"0,0,0"},EPSG_4759:{towgs84:"0,0,0"},EPSG_4762:{towgs84:"0,0,0"},EPSG_4763:{towgs84:"0,0,0"},EPSG_4764:{towgs84:"0,0,0"},EPSG_4166:{towgs84:"0,0,0"},EPSG_4170:{towgs84:"0,0,0"},EPSG_5546:{towgs84:"0,0,0"},EPSG_7844:{towgs84:"0,0,0"},EPSG_4818:{towgs84:"589,76,480"}};for(var aZ in av){var fw=av[aZ];fw.datumName&&(av[fw.datumName]=fw)}const lZ=av;var pw={};function fZ(e,t){return gw.apply(this,arguments)}function gw(){return(gw=Tn(function*(e,t){for(var n=[],r=yield t.getImageCount(),s=r-1;s>=0;s--){var l=yield t.getImage(s),g=yield l.readRasters(),v=[l.getWidth(),l.getHeight()],M=l.getBoundingBox().map(aD),A=[l.fileDirectory.ModelPixelScale[0],l.fileDirectory.ModelPixelScale[1]].map(aD),O=M[0]+(v[0]-1)*A[0],j=M[3]-(v[1]-1)*A[1],B=g[0],X=g[1],le=[];for(let De=v[1]-1;De>=0;De--)for(let nt=v[0]-1;nt>=0;nt--){var _e=De*v[0]+nt;le.push([-Mh(X[_e]),Mh(B[_e])])}n.push({del:A,lim:v,ll:[-O,j],cvs:le})}var Ie={header:{nSubgrids:r},subgrids:n};return pw[e]=Ie,Ie})).apply(this,arguments)}function gZ(e){if(0===e.length)return null;var t="@"===e[0];return t&&(e=e.slice(1)),"null"===e?{name:"null",mandatory:!t,grid:null,isNull:!0}:{name:e,mandatory:!t,grid:pw[e]||null,isNull:!1}}function aD(e){return e*Math.PI/180}function Mh(e){return e/3600*Math.PI/180}function mw(e,t,n){return String.fromCharCode.apply(null,new Uint8Array(e.buffer.slice(t,n)))}function vZ(e){return e.map(function(t){return[Mh(t.longitudeShift),Mh(t.latitudeShift)]})}function bZ(e,t,n){return{name:mw(e,t+8,t+16).trim(),parent:mw(e,t+24,t+24+8).trim(),lowerLatitude:e.getFloat64(t+72,n),upperLatitude:e.getFloat64(t+88,n),lowerLongitude:e.getFloat64(t+104,n),upperLongitude:e.getFloat64(t+120,n),latitudeInterval:e.getFloat64(t+136,n),longitudeInterval:e.getFloat64(t+152,n),gridNodeCount:e.getInt32(t+168,n)}}function xZ(e,t,n,r,s){var l=t+176,d=16;!1===s&&(d=8);for(var g=[],v=0;v<n.gridNodeCount;v++){var M={latitudeShift:e.getFloat32(l+v*d,r),longitudeShift:e.getFloat32(l+v*d+4,r)};!1!==s&&(M.latitudeAccuracy=e.getFloat32(l+v*d+8,r),M.longitudeAccuracy=e.getFloat32(l+v*d+12,r)),g.push(M)}return g}function vg(e,t){if(!(this instanceof vg))return new vg(e);this.forward=null,this.inverse=null,this.init=null,this.names=null,t=t||function(M){if(M)throw M};var n=function $q(e){if(!function Fq(e){return"string"==typeof e}(e))return"projName"in e?e:hw(e);if(function Bq(e){return e in sv}(e))return sv[e];if(function zq(e){return 0!==e.indexOf("+")&&-1!==e.indexOf("[")||"object"==typeof e&&!("srsCode"in e)}(e)){var t=hw(e);if(function Vq(e){var t=Eh(e,"authority");if(t){var n=Eh(t,"epsg");return n&&jq.indexOf(n)>-1}}(t))return sv["EPSG:3857"];var n=function Uq(e){var t=Eh(e,"extension");if(t)return Eh(t,"proj4")}(t);return n?cw(n):t}return function Gq(e){return"+"===e[0]}(e)?cw(e):void 0}(e);if("object"==typeof n){var r=vg.projections.get(n.projName);if(r){if(n.datumCode&&"none"!==n.datumCode){var s=Eh(lZ,n.datumCode);s&&(n.datum_params=n.datum_params||(s.towgs84?s.towgs84.split(","):null),n.ellps=s.ellipse,n.datumName=s.datumName?s.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84",n.lat1=n.lat1||n.lat0;var l=function sZ(e,t,n,r,s){if(!e){var l=Eh(sD,r);l||(l=oZ),e=l.a,t=l.b,n=l.rf}return n&&!t&&(t=(1-1/n)*e),(0===n||Math.abs(e-t)<wt)&&(s=!0,t=e),{a:e,b:t,rf:n,sphere:s}}(n.a,n.b,n.rf,n.ellps,n.sphere),d=function iZ(e,t,n,r){var s=e*e,l=t*t,d=(s-l)/s,g=0;return r?(s=(e*=1-d*(.16666666666666666+d*(.04722222222222222+.022156084656084655*d)))*e,d=0):g=Math.sqrt(d),{es:d,e:g,ep2:(s-l)/l}}(l.a,l.b,0,n.R_A),g=function pZ(e){return void 0===e?null:e.split(",").map(gZ)}(n.nadgrids),v=n.datum||function cZ(e,t,n,r,s,l,d){var g={};return g.datum_type=void 0===e||"none"===e?5:4,t&&(g.datum_params=t.map(parseFloat),(0!==g.datum_params[0]||0!==g.datum_params[1]||0!==g.datum_params[2])&&(g.datum_type=1),g.datum_params.length>3&&(0!==g.datum_params[3]||0!==g.datum_params[4]||0!==g.datum_params[5]||0!==g.datum_params[6])&&(g.datum_type=2,g.datum_params[3]*=g0,g.datum_params[4]*=g0,g.datum_params[5]*=g0,g.datum_params[6]=g.datum_params[6]/1e6+1)),d&&(g.datum_type=3,g.grids=d),g.a=n,g.b=r,g.es=s,g.ep2=l,g}(n.datumCode,n.datum_params,l.a,l.b,d.es,d.ep2,g);nD(this,n),nD(this,r),this.a=l.a,this.b=l.b,this.rf=l.rf,this.sphere=l.sphere,this.es=d.es,this.e=d.e,this.ep2=d.ep2,this.datum=v,"init"in this&&"function"==typeof this.init&&this.init(),t(null,this)}else t("Could not get projection name from: "+e)}else t("Could not parse to valid json: "+e)}(vg.projections=nZ).start();const bg=vg;function lD(e,t,n){var d,g,M,r=e.x,s=e.y,l=e.z?e.z:0;if(s<-ot&&s>-1.001*ot)s=-ot;else if(s>ot&&s<1.001*ot)s=ot;else{if(s<-ot)return{x:-1/0,y:-1/0,z:e.z};if(s>ot)return{x:1/0,y:1/0,z:e.z}}return r>Math.PI&&(r-=2*Math.PI),g=Math.sin(s),M=Math.cos(s),{x:((d=n/Math.sqrt(1-t*(g*g)))+l)*M*Math.cos(r),y:(d+l)*M*Math.sin(r),z:(d*(1-t)+l)*g}}function cD(e,t,n,r){var g,v,M,A,O,j,B,X,le,_e,Ie,De,nt,_n,Kr,kt=e.x,yt=e.y,pn=e.z?e.z:0;if(g=Math.sqrt(kt*kt+yt*yt),v=Math.sqrt(kt*kt+yt*yt+pn*pn),g/n<1e-12){if(_n=0,v/n<1e-12)return Kr=-r,{x:e.x,y:e.y,z:e.z}}else _n=Math.atan2(yt,kt);M=pn/v,X=(A=g/v)*(1-t)*(O=1/Math.sqrt(1-t*(2-t)*A*A)),le=M*O,nt=0;do{nt++,j=t*(B=n/Math.sqrt(1-t*le*le))/(B+(Kr=g*X+pn*le-B*(1-t*le*le))),De=(Ie=M*(O=1/Math.sqrt(1-j*(2-j)*A*A)))*X-(_e=A*(1-j)*O)*le,X=_e,le=Ie}while(De*De>1e-24&&nt<30);return{x:_n,y:Math.atan(Ie/Math.abs(_e)),z:Kr}}function lv(e){return 1===e||2===e}function uD(e,t,n){if(null===e.grids||0===e.grids.length)return console.log("Grid shift grids not found"),-1;var r={x:-n.x,y:n.y},s={x:Number.NaN,y:Number.NaN},l=[];e:for(var d=0;d<e.grids.length;d++){var g=e.grids[d];if(l.push(g.name),g.isNull){s=r;break}if(null!==g.grid)for(var v=g.grid.subgrids,M=0,A=v.length;M<A;M++){var O=v[M],j=(Math.abs(O.del[1])+Math.abs(O.del[0]))/1e4;if(!(O.ll[1]-j>r.y||O.ll[0]-j>r.x||O.ll[1]+(O.lim[1]-1)*O.del[1]+j<r.y||O.ll[0]+(O.lim[0]-1)*O.del[0]+j<r.x||(s=MZ(r,t,O),isNaN(s.x))))break e}else if(g.mandatory)return console.log("Unable to find mandatory grid '"+g.name+"'"),-1}return isNaN(s.x)?(console.log("Failed to find a grid shift table for location '"+-r.x*eu+" "+r.y*eu+" tried: '"+l+"'"),-1):(n.x=-s.x,n.y=s.y,0)}function MZ(e,t,n){var r={x:Number.NaN,y:Number.NaN};if(isNaN(e.x))return r;var s={x:e.x,y:e.y};s.x-=n.ll[0],s.y-=n.ll[1],s.x=It(s.x-Math.PI)+Math.PI;var l=dD(s,n);if(t){if(isNaN(l.x))return r;l.x=s.x-l.x,l.y=s.y-l.y;var v,M,d=9;do{if(M=dD(l,n),isNaN(M.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}l.x+=(v={x:s.x-(M.x+l.x),y:s.y-(M.y+l.y)}).x,l.y+=v.y}while(d--&&Math.abs(v.x)>1e-12&&Math.abs(v.y)>1e-12);if(d<0)return console.log("Inverse grid shift iterator failed to converge."),r;r.x=It(l.x+n.ll[0]),r.y=l.y+n.ll[1]}else isNaN(l.x)||(r.x=e.x+l.x,r.y=e.y+l.y);return r}function dD(e,t){var d,n={x:e.x/t.del[0],y:e.y/t.del[1]},r_x=Math.floor(n.x),r_y=Math.floor(n.y),s_x=n.x-1*r_x,s_y=n.y-1*r_y,l={x:Number.NaN,y:Number.NaN};if(r_x<0||r_x>=t.lim[0]||r_y<0||r_y>=t.lim[1])return l;var g_x=t.cvs[d=r_y*t.lim[0]+r_x][0],g_y=t.cvs[d][1];d++;var v_x=t.cvs[d][0],v_y=t.cvs[d][1],M_x=t.cvs[d+=t.lim[0]][0],M_y=t.cvs[d][1];d--;var A_y=t.cvs[d][1],O=s_x*s_y,j=s_x*(1-s_y),B=(1-s_x)*(1-s_y),X=(1-s_x)*s_y;return l.x=B*g_x+j*v_x+X*t.cvs[d][0]+O*M_x,l.y=B*g_y+j*v_y+X*A_y+O*M_y,l}function hD(e,t,n){var d,g,v,r=n.x,s=n.y,l=n.z||0,M={};for(v=0;v<3;v++)if(!t||2!==v||void 0!==n.z)switch(0===v?(d=r,g=-1!=="ew".indexOf(e.axis[v])?"x":"y"):1===v?(d=s,g=-1!=="ns".indexOf(e.axis[v])?"y":"x"):(d=l,g="z"),e.axis[v]){case"e":case"n":M[g]=d;break;case"w":case"s":M[g]=-d;break;case"u":void 0!==n[g]&&(M.z=d);break;case"d":void 0!==n[g]&&(M.z=-d);break;default:return null}return M}function fD(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t}function pD(e){if("function"==typeof Number.isFinite){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof e||e!=e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function cv(e,t,n,r){var s,l=void 0!==(n=Array.isArray(n)?fD(n):{x:n.x,y:n.y,z:n.z,m:n.m}).z;if(function TZ(e){pD(e.x),pD(e.y)}(n),e.datum&&t.datum&&function IZ(e,t){return(1===e.datum.datum_type||2===e.datum.datum_type||3===e.datum.datum_type)&&"WGS84"!==t.datumCode||(1===t.datum.datum_type||2===t.datum.datum_type||3===t.datum.datum_type)&&"WGS84"!==e.datumCode}(e,t)&&(n=cv(e,s=new bg("WGS84"),n,r),e=s),r&&"enu"!==e.axis&&(n=hD(e,!1,n)),"longlat"===e.projName)n={x:n.x*Di,y:n.y*Di,z:n.z||0};else if(e.to_meter&&(n={x:n.x*e.to_meter,y:n.y*e.to_meter,z:n.z||0}),!(n=e.inverse(n)))return;if(e.from_greenwich&&(n.x+=e.from_greenwich),n=function EZ(e,t,n){if(function wZ(e,t){return!(e.datum_type!==t.datum_type||e.a!==t.a||Math.abs(e.es-t.es)>5e-11)&&(1===e.datum_type?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:2!==e.datum_type||e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6])}(e,t)||5===e.datum_type||5===t.datum_type)return n;var r=e.a,s=e.es;if(3===e.datum_type){if(0!==uD(e,!1,n))return;r=6378137,s=$I}var d=t.a,g=t.b,v=t.es;return 3===t.datum_type&&(d=6378137,g=6356752.314,v=$I),s!==v||r!==d||lv(e.datum_type)||lv(t.datum_type)?(n=lD(n,s,r),lv(e.datum_type)&&(n=function CZ(e,t,n){if(1===t)return{x:e.x+n[0],y:e.y+n[1],z:e.z+n[2]};if(2===t){var d=n[3],g=n[4],v=n[5],M=n[6];return{x:M*(e.x-v*e.y+g*e.z)+n[0],y:M*(v*e.x+e.y-d*e.z)+n[1],z:M*(-g*e.x+d*e.y+e.z)+n[2]}}}(n,e.datum_type,e.datum_params)),lv(t.datum_type)&&(n=function SZ(e,t,n){if(1===t)return{x:e.x-n[0],y:e.y-n[1],z:e.z-n[2]};if(2===t){var d=n[3],g=n[4],v=n[5],M=n[6],A=(e.x-n[0])/M,O=(e.y-n[1])/M,j=(e.z-n[2])/M;return{x:A+v*O-g*j,y:-v*A+O+d*j,z:g*A-d*O+j}}}(n,t.datum_type,t.datum_params)),n=cD(n,v,d,g),3!==t.datum_type||0===uD(t,!0,n)?n:void 0):n}(e.datum,t.datum,n))return t.from_greenwich&&(n={x:n.x-t.from_greenwich,y:n.y,z:n.z||0}),"longlat"===t.projName?n={x:n.x*eu,y:n.y*eu,z:n.z||0}:(n=t.forward(n),t.to_meter&&(n={x:n.x/t.to_meter,y:n.y/t.to_meter,z:n.z||0})),r&&"enu"!==t.axis?hD(t,!0,n):(n&&!l&&delete n.z,n)}var gD=bg("WGS84");function _w(e,t,n,r){var s,l,d;return Array.isArray(n)?(s=cv(e,t,n,r)||{x:NaN,y:NaN},n.length>2?typeof e.name<"u"&&"geocent"===e.name||typeof t.name<"u"&&"geocent"===t.name?"number"==typeof s.z?[s.x,s.y,s.z].concat(n.slice(3)):[s.x,s.y,n[2]].concat(n.slice(3)):[s.x,s.y].concat(n.slice(2)):[s.x,s.y]):(l=cv(e,t,n,r),2===(d=Object.keys(n)).length||d.forEach(function(g){if(typeof e.name<"u"&&"geocent"===e.name||typeof t.name<"u"&&"geocent"===t.name){if("x"===g||"y"===g||"z"===g)return}else if("x"===g||"y"===g)return;l[g]=n[g]}),l)}function uv(e){return e instanceof bg?e:"object"==typeof e&&"oProj"in e?e.oProj:bg(e)}const PZ={forward:vD,inverse:function kZ(e){var t=vw(CD(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat,t.lon,t.lat]:[t.left,t.bottom,t.right,t.top]},toPoint:bD};function vD(e,t){return t=t||5,function NZ(e,t){var n="00000"+e.easting,r="00000"+e.northing;return e.zoneNumber+e.zoneLetter+function LZ(e,t,n){var r=wD(n);return function FZ(e,t,n){var r=n-1,s="AJSAJS".charCodeAt(r),l="AFAFAF".charCodeAt(r),d=s+e-1,g=l+t,v=!1;return d>90&&(d=d-90+65-1,v=!0),(73===d||s<73&&d>73||(d>73||s<73)&&v)&&d++,(79===d||s<79&&d>79||(d>79||s<79)&&v)&&73===++d&&d++,d>90&&(d=d-90+65-1),g>86?(g=g-86+65-1,v=!0):v=!1,(73===g||l<73&&g>73||(g>73||l<73)&&v)&&g++,(79===g||l<79&&g>79||(g>79||l<79)&&v)&&73===++g&&g++,g>86&&(g=g-86+65-1),String.fromCharCode(d)+String.fromCharCode(g)}(Math.floor(e/1e5),Math.floor(t/1e5)%20,r)}(e.easting,e.northing,e.zoneNumber)+n.substr(n.length-5,t)+r.substr(r.length-5,t)}(function RZ(e){var g,v,M,A,O,le,_e,t=e.lat,n=e.lon,r=6378137,s=.00669438,l=.9996,B=yw(t),X=yw(n);_e=Math.floor((n+180)/6)+1,180===n&&(_e=60),t>=56&&t<64&&n>=3&&n<12&&(_e=32),t>=72&&t<84&&(n>=0&&n<9?_e=31:n>=9&&n<21?_e=33:n>=21&&n<33?_e=35:n>=33&&n<42&&(_e=37)),le=yw(6*(_e-1)-180+3),g=s/(1-s),v=r/Math.sqrt(1-s*Math.sin(B)*Math.sin(B)),M=Math.tan(B)*Math.tan(B),A=g*Math.cos(B)*Math.cos(B);var Ie=l*v*((O=Math.cos(B)*(X-le))+(1-M+A)*O*O*O/6+(5-18*M+M*M+72*A-58*g)*O*O*O*O*O/120)+5e5,De=l*(r*(.9983242984503243*B-.002514607064228144*Math.sin(2*B)+2639046602129982e-21*Math.sin(4*B)-35*s*s*s/3072*Math.sin(6*B))+v*Math.tan(B)*(O*O/2+(5-M+9*A+4*A*A)*O*O*O*O/24+(61-58*M+M*M+600*A-330*g)*O*O*O*O*O*O/720));return t<0&&(De+=1e7),{northing:Math.round(De),easting:Math.round(Ie),zoneNumber:_e,zoneLetter:OZ(t)}}({lat:e[1],lon:e[0]}),t)}function bD(e){var t=vw(CD(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function yw(e){return e*(Math.PI/180)}function xD(e){return e/Math.PI*180}function vw(e){var t=e.northing,n=e.easting,r=e.zoneLetter,s=e.zoneNumber;if(s<0||s>60)return null;var v,A,O,j,B,X,_e,Ie,De,l=.9996,d=6378137,g=.00669438,M=(1-Math.sqrt(1-g))/(1+Math.sqrt(1-g)),nt=n-5e5,kt=t;r<"N"&&(kt-=1e7),_e=6*(s-1)-180+3,v=g/(1-g),De=(Ie=kt/l/6367449.145945056)+(3*M/2-27*M*M*M/32)*Math.sin(2*Ie)+(21*M*M/16-55*M*M*M*M/32)*Math.sin(4*Ie)+151*M*M*M/96*Math.sin(6*Ie),A=d/Math.sqrt(1-g*Math.sin(De)*Math.sin(De)),O=Math.tan(De)*Math.tan(De),j=v*Math.cos(De)*Math.cos(De),B=d*(1-g)/Math.pow(1-g*Math.sin(De)*Math.sin(De),1.5),X=nt/(A*l);var yt=De-A*Math.tan(De)/B*(X*X/2-(5+3*O+10*j-4*j*j-9*v)*X*X*X*X/24+(61+90*O+298*j+45*O*O-252*v-3*j*j)*X*X*X*X*X*X/720);yt=xD(yt);var _n,pn=(X-(1+2*O+j)*X*X*X/6+(5-2*j+28*O-3*j*j+8*v+24*O*O)*X*X*X*X*X/120)/Math.cos(De);if(pn=_e+xD(pn),e.accuracy){var Vr=vw({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});_n={top:Vr.lat,right:Vr.lon,bottom:yt,left:pn}}else _n={lat:yt,lon:pn};return _n}function OZ(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function wD(e){var t=e%6;return 0===t&&(t=6),t}function CD(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var s,t=e.length,n=null,r="",l=0;!/[A-Z]/.test(s=e.charAt(l));){if(l>=2)throw"MGRSPoint bad conversion from: "+e;r+=s,l++}var d=parseInt(r,10);if(0===l||l+3>t)throw"MGRSPoint bad conversion from: "+e;var g=e.charAt(l++);if(g<="A"||"B"===g||"Y"===g||g>="Z"||"I"===g||"O"===g)throw"MGRSPoint zone letter "+g+" not handled: "+e;n=e.substring(l,l+=2);for(var v=wD(d),M=function BZ(e,t){for(var n="AJSAJS".charCodeAt(t-1),r=1e5,s=!1;n!==e.charCodeAt(0);){if(73===++n&&n++,79===n&&n++,n>90){if(s)throw"Bad character: "+e;n=65,s=!0}r+=1e5}return r}(n.charAt(0),v),A=function zZ(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;for(var n="AFAFAF".charCodeAt(t-1),r=0,s=!1;n!==e.charCodeAt(0);){if(73===++n&&n++,79===n&&n++,n>86){if(s)throw"Bad character: "+e;n=65,s=!0}r+=1e5}return r}(n.charAt(1),v);A<jZ(g);)A+=2e6;var O=t-l;if(O%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var le,_e,Ie,j=O/2,B=0,X=0;return j>0&&(le=1e5/Math.pow(10,j),_e=e.substring(l,l+j),B=parseFloat(_e)*le,Ie=e.substring(l+j),X=parseFloat(Ie)*le),{easting:B+M,northing:X+A,zoneLetter:g,zoneNumber:d,accuracy:le}}function jZ(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}function wg(e,t,n){if(!(this instanceof wg))return new wg(e,t,n);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"==typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"==typeof e&&typeof t>"u"){var r=e.split(",");this.x=parseFloat(r[0]),this.y=parseFloat(r[1]),this.z=parseFloat(r[2])||0}else this.x=e,this.y=t,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}wg.fromMGRS=function(e){return new wg(bD(e))},wg.prototype.toMGRS=function(e){return vD([this.x,this.y],e)};const VZ=wg;var ED=.01953125,MD=.01068115234375;function bw(e){var t=[];t[0]=1-e*(.25+e*(.046875+e*(ED+e*MD))),t[1]=e*(.75-e*(.046875+e*(ED+e*MD)));var n=e*e;return t[2]=n*(.46875-e*(.013020833333333334+.007120768229166667*e)),t[3]=(n*=e)*(.3645833333333333-.005696614583333333*e),t[4]=n*e*.3076171875,t}function Cg(e,t,n,r){return r[0]*e-(n*=t)*(r[1]+(t*=t)*(r[2]+t*(r[3]+t*r[4])))}function xw(e,t,n){for(var r=1/(1-t),s=e,l=20;l;--l){var d=Math.sin(s),g=1-t*d*d;if(s-=g=(Cg(s,d,Math.cos(s),n)-e)*(g*Math.sqrt(g))*r,Math.abs(g)<wt)return s}return s}const dv={init:function QZ(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=bw(this.es),this.ml0=Cg(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function JZ(e){var s,l,d,n=e.y,r=It(e.x-this.long0),g=Math.sin(n),v=Math.cos(n);if(this.es){var A=v*r,O=Math.pow(A,2),j=this.ep2*Math.pow(v,2),B=Math.pow(j,2),X=Math.abs(v)>wt?Math.tan(n):0,le=Math.pow(X,2),_e=Math.pow(le,2);s=1-this.es*Math.pow(g,2),A/=Math.sqrt(s);var Ie=Cg(n,g,v,this.en);l=this.a*(this.k0*A*(1+O/6*(1-le+j+O/20*(5-18*le+_e+14*j-58*le*j+O/42*(61+179*_e-_e*le-479*le)))))+this.x0,d=this.a*(this.k0*(Ie-this.ml0+g*r*A/2*(1+O/12*(5-le+9*j+4*B+O/30*(61+_e-58*le+270*j-330*le*j+O/56*(1385+543*_e-_e*le-3111*le))))))+this.y0}else{var M=v*Math.sin(r);if(Math.abs(Math.abs(M)-1)<wt)return 93;if(l=.5*this.a*this.k0*Math.log((1+M)/(1-M))+this.x0,d=v*Math.cos(r)/Math.sqrt(1-Math.pow(M,2)),(M=Math.abs(d))>=1){if(M-1>wt)return 93;d=0}else d=Math.acos(d);n<0&&(d=-d),d=this.a*this.k0*(d-this.lat0)+this.y0}return e.x=l,e.y=d,e},inverse:function eY(e){var t,n,r,s,l=1/this.a*(e.x-this.x0),d=1/this.a*(e.y-this.y0);if(this.es)if(n=xw(t=this.ml0+d/this.k0,this.es,this.en),Math.abs(n)<ot){var O=Math.sin(n),j=Math.cos(n),B=Math.abs(j)>wt?Math.tan(n):0,X=this.ep2*Math.pow(j,2),le=Math.pow(X,2),_e=Math.pow(B,2),Ie=Math.pow(_e,2);t=1-this.es*Math.pow(O,2);var De=l*Math.sqrt(t)/this.k0,nt=Math.pow(De,2);r=n-(t*=B)*nt/(1-this.es)*.5*(1-nt/12*(5+3*_e-9*X*_e+X-4*le-nt/30*(61+90*_e-252*X*_e+45*Ie+46*X-nt/56*(1385+3633*_e+4095*Ie+1574*Ie*_e)))),s=It(this.long0+De*(1-nt/6*(1+2*_e+X-nt/20*(5+28*_e+24*Ie+8*X*_e+6*X-nt/42*(61+662*_e+1320*Ie+720*Ie*_e))))/j)}else r=ot*y0(d),s=0;else{var g=Math.exp(l/this.k0),v=.5*(g-1/g),A=Math.cos(this.lat0+d/this.k0);t=Math.sqrt((1-Math.pow(A,2))/(1+Math.pow(v,2))),r=Math.asin(t),d<0&&(r=-r),s=0===v&&0===A?0:It(Math.atan2(v,A)+this.long0)}return e.x=s,e.y=r,e},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function TD(e){var t=Math.exp(e);return(t-1/t)/2}function ra(e,t){e=Math.abs(e),t=Math.abs(t);var n=Math.max(e,t),r=Math.min(e,t)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))}function ww(e,t){for(var d,n=2*Math.cos(2*t),r=e.length-1,s=e[r],l=0;--r>=0;)d=n*s-l+e[r],l=s,s=d;return t+d*Math.sin(2*t)}function ID(e,t,n){for(var X,le,r=Math.sin(t),s=Math.cos(t),l=TD(n),d=function iY(e){var t=Math.exp(e);return(t+1/t)/2}(n),g=2*s*d,v=-2*r*l,M=e.length-1,A=e[M],O=0,j=0,B=0;--M>=0;)X=j,le=O,A=g*(j=A)-X-v*(O=B)+e[M],B=v*j-le+g*O;return[(g=r*d)*A-(v=s*l)*B,g*B+v*A]}const hv={init:function sY(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(dv.init.apply(this),this.forward=dv.forward,this.inverse=dv.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),n=t;this.cgb[0]=t*(2+t*(-2/3+t*(t*(116/45+t*(26/45+t*(-2854/675)))-2))),this.cbg[0]=t*(t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))-2),this.cgb[1]=(n*=t)*(7/3+t*(t*(-227/45+t*(2704/315+t*(2323/945)))-1.6)),this.cbg[1]=n*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),this.cgb[2]=(n*=t)*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=n*(-26/15+t*(34/21+t*(1.6+t*(-12686/2835)))),this.cgb[3]=(n*=t)*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=n*(1237/630+t*(t*(-24832/14175)-2.4)),this.cgb[4]=(n*=t)*(4174/315+t*(-144838/6237)),this.cbg[4]=n*(-734/315+t*(109598/31185)),this.cgb[5]=(n*=t)*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=t*(t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))-.5),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=n*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=n*(13/48+t*(t*(557/1440+t*(281/630+t*(-1983433/1935360)))-.6)),this.utg[2]=(n*=t)*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=n*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),this.utg[3]=(n*=t)*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=n*(49561/161280+t*(-179/168+t*(6601661/7257600))),this.utg[4]=(n*=t)*(-4583/161280+t*(108847/3991680)),this.gtu[4]=n*(34729/80640+t*(-3418889/1995840)),this.utg[5]=(n*=t)*(-20648693/638668800),this.gtu[5]=.6650675310896665*n;var r=ww(this.cbg,this.lat0);this.Zb=-this.Qn*(r+function oY(e,t){for(var d,n=2*Math.cos(t),r=e.length-1,s=e[r],l=0;--r>=0;)d=n*s-l+e[r],l=s,s=d;return Math.sin(t)*d}(this.gtu,2*r))},forward:function aY(e){var t=It(e.x-this.long0),n=e.y;n=ww(this.cbg,n);var r=Math.sin(n),s=Math.cos(n),l=Math.sin(t),d=Math.cos(t);n=Math.atan2(r,d*s),t=Math.atan2(l*s,ra(r,s*d)),t=function rY(e){var t=Math.abs(e);return t=function nY(e){var t=1+e,n=t-1;return 0===n?e:e*Math.log(t)/n}(t*(1+t/(ra(1,t)+1))),e<0?-t:t}(Math.tan(t));var v,M,g=ID(this.gtu,2*n,2*t);return n+=g[0],t+=g[1],Math.abs(t)<=2.623395162778?(v=this.a*(this.Qn*t)+this.x0,M=this.a*(this.Qn*n+this.Zb)+this.y0):(v=1/0,M=1/0),e.x=v,e.y=M,e},inverse:function lY(e){var r,s,t=1/this.a*(e.x-this.x0),n=1/this.a*(e.y-this.y0);if(n=(n-this.Zb)/this.Qn,t/=this.Qn,Math.abs(t)<=2.623395162778){var l=ID(this.utg,2*n,2*t);n+=l[0],t+=l[1],t=Math.atan(TD(t));var d=Math.sin(n),g=Math.cos(n),v=Math.sin(t),M=Math.cos(t);n=Math.atan2(d*M,ra(v,M*g)),r=It((t=Math.atan2(v,M*g))+this.long0),s=ww(this.cgb,n)}else r=1/0,s=1/0;return e.x=r,e.y=s,e},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","Gauss Kruger","Gauss_Kruger","tmerc"]},pY={init:function hY(){var e=function uY(e,t){if(void 0===e){if((e=Math.floor(30*(It(t)+Math.PI)/Math.PI)+1)<0)return 0;if(e>60)return 60}return e}(this.zone,this.long0);if(void 0===e)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*Di,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,hv.init.apply(this),this.forward=hv.forward,this.inverse=hv.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function Cw(e,t){return Math.pow((1-e)/(1+e),t)}const Sw={init:function mY(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+rr)/(Math.pow(Math.tan(.5*this.lat0+rr),this.C)*Cw(this.e*e,this.ratexp))},forward:function _Y(e){var t=e.x,n=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+rr),this.C)*Cw(this.e*Math.sin(n),this.ratexp))-ot,e.x=this.C*t,e},inverse:function yY(e){for(var n=e.x/this.C,r=e.y,s=Math.pow(Math.tan(.5*r+rr)/this.K,1/this.C),l=20;l>0&&(r=2*Math.atan(s*Cw(this.e*Math.sin(e.y),-.5*this.e))-ot,!(Math.abs(r-e.y)<1e-14));--l)e.y=r;return l?(e.x=n,e.y=r,e):null},names:["gauss"]},SY={init:function bY(){Sw.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function xY(e){var t,n,r,s;return e.x=It(e.x-this.long0),Sw.forward.apply(this,[e]),t=Math.sin(e.y),n=Math.cos(e.y),r=Math.cos(e.x),e.x=(s=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*n*r))*n*Math.sin(e.x),e.y=s*(this.cosc0*t-this.sinc0*n*r),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function wY(e){var t,n,r,s,l;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,l=ra(e.x,e.y)){var d=2*Math.atan2(l,this.R2);t=Math.sin(d),n=Math.cos(d),s=Math.asin(n*this.sinc0+e.y*t*this.cosc0/l),r=Math.atan2(e.x*t,l*this.cosc0*n-e.y*this.sinc0*t)}else s=this.phic0,r=0;return e.x=r,e.y=s,Sw.inverse.apply(this,[e]),e.x=It(e.x+this.long0),e},names:["Stereographic_North_Pole","Oblique_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};function Ew(e,t,n){return t*=n,Math.tan(.5*(ot+e))*Math.pow((1-t)/(1+t),.5*n)}const DY={init:function EY(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=wt&&(this.k0=.5*(1+y0(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=wt&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=wt&&Math.abs(Math.cos(this.lat_ts))>wt&&(this.k0=.5*this.cons*tu(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ac(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=tu(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(Ew(this.lat0,this.sinlat0,this.e))-ot,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function MY(e){var l,d,g,v,M,A,t=e.x,n=e.y,r=Math.sin(n),s=Math.cos(n),O=It(t-this.long0);return Math.abs(Math.abs(t-this.long0)-Math.PI)<=wt&&Math.abs(n+this.lat0)<=wt?(e.x=NaN,e.y=NaN,e):this.sphere?(l=2*this.k0/(1+this.sinlat0*r+this.coslat0*s*Math.cos(O)),e.x=this.a*l*s*Math.sin(O)+this.x0,e.y=this.a*l*(this.coslat0*r-this.sinlat0*s*Math.cos(O))+this.y0,e):(d=2*Math.atan(Ew(n,r,this.e))-ot,v=Math.cos(d),g=Math.sin(d),Math.abs(this.coslat0)<=wt?(M=ac(this.e,n*this.con,this.con*r),e.x=this.x0+(A=2*this.a*this.k0*M/this.cons)*Math.sin(t-this.long0),e.y=this.y0-this.con*A*Math.cos(t-this.long0),e):(Math.abs(this.sinlat0)<wt?(l=2*this.a*this.k0/(1+v*Math.cos(O)),e.y=l*g):(l=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*g+this.cosX0*v*Math.cos(O))),e.y=l*(this.cosX0*g-this.sinX0*v*Math.cos(O))+this.y0),e.x=l*v*Math.sin(O)+this.x0,e))},inverse:function TY(e){e.x-=this.x0,e.y-=this.y0;var t,n,s,l,d=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var g=2*Math.atan(d/(2*this.a*this.k0));return t=this.long0,n=this.lat0,d<=wt?(e.x=t,e.y=n,e):(n=Math.asin(Math.cos(g)*this.sinlat0+e.y*Math.sin(g)*this.coslat0/d),t=Math.abs(this.coslat0)<wt?It(this.lat0>0?this.long0+Math.atan2(e.x,-1*e.y):this.long0+Math.atan2(e.x,e.y)):It(this.long0+Math.atan2(e.x*Math.sin(g),d*this.coslat0*Math.cos(g)-e.y*this.sinlat0*Math.sin(g))),e.x=t,e.y=n,e)}if(Math.abs(this.coslat0)<=wt){if(d<=wt)return n=this.lat0,e.x=t=this.long0,e.y=n,e;e.x*=this.con,e.y*=this.con,n=this.con*v0(this.e,d*this.cons/(2*this.a*this.k0)),t=this.con*It(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else s=2*Math.atan(d*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,d<=wt?l=this.X0:(l=Math.asin(Math.cos(s)*this.sinX0+e.y*Math.sin(s)*this.cosX0/d),t=It(this.long0+Math.atan2(e.x*Math.sin(s),d*this.cosX0*Math.cos(s)-e.y*this.sinX0*Math.sin(s)))),n=-1*v0(this.e,Math.tan(.5*(ot+l)));return e.x=t,e.y=n,e},names:["stere","Stereographic_South_Pole","Polar_Stereographic_variant_A","Polar_Stereographic_variant_B","Polar_Stereographic"],ssfn_:Ew},OY={init:function AY(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),n=this.a,s=1/this.rf,l=2*s-Math.pow(s,2),d=this.e=Math.sqrt(l);this.R=this.k0*n*Math.sqrt(1-l)/(1-l*Math.pow(t,2)),this.alpha=Math.sqrt(1+l/(1-l)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var g=Math.log(Math.tan(Math.PI/4+this.b0/2)),v=Math.log(Math.tan(Math.PI/4+e/2)),M=Math.log((1+d*t)/(1-d*t));this.K=g-this.alpha*v+this.alpha*d/2*M},forward:function PY(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),s=2*(Math.atan(Math.exp(-this.alpha*(t+n)+this.K))-Math.PI/4),l=this.alpha*(e.x-this.lambda0),d=Math.atan(Math.sin(l)/(Math.sin(this.b0)*Math.tan(s)+Math.cos(this.b0)*Math.cos(l))),g=Math.asin(Math.cos(this.b0)*Math.sin(s)-Math.sin(this.b0)*Math.cos(s)*Math.cos(l));return e.y=this.R/2*Math.log((1+Math.sin(g))/(1-Math.sin(g)))+this.y0,e.x=this.R*d+this.x0,e},inverse:function kY(e){for(var r=(e.x-this.x0)/this.R,s=2*(Math.atan(Math.exp((e.y-this.y0)/this.R))-Math.PI/4),l=Math.asin(Math.cos(this.b0)*Math.sin(s)+Math.sin(this.b0)*Math.cos(s)*Math.cos(r)),d=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(s))),g=this.lambda0+d/this.alpha,v=0,M=l,A=-1e3,O=0;Math.abs(M-A)>1e-7;){if(++O>20)return;v=1/this.alpha*(Math.log(Math.tan(Math.PI/4+l/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(M))/2)),A=M,M=2*Math.atan(Math.exp(v))-Math.PI/2}return e.x=g,e.y=M,e},names:["somerc"]};var Sg=1e-7;const jY={init:function LY(){var e,t,n,r,s,l,d,g,v,M,O,A=0,j=0,B=0,X=0,le=0,_e=0,Ie=0;this.no_off=function NY(e){var t=["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"],n="object"==typeof e.projName?Object.keys(e.projName)[0]:e.projName;return"no_uoff"in e||"no_off"in e||-1!==t.indexOf(n)||-1!==t.indexOf(iD(n))}(this),this.no_rot="no_rot"in this;var De=!1;"alpha"in this&&(De=!0);var nt=!1;if("rectified_grid_angle"in this&&(nt=!0),De&&(Ie=this.alpha),nt&&(A=this.rectified_grid_angle),De||nt)j=this.longc;else if(B=this.long1,le=this.lat1,X=this.long2,_e=this.lat2,Math.abs(le-_e)<=Sg||(e=Math.abs(le))<=Sg||Math.abs(e-ot)<=Sg||Math.abs(Math.abs(this.lat0)-ot)<=Sg||Math.abs(Math.abs(_e)-ot)<=Sg)throw new Error;var kt=1-this.es;t=Math.sqrt(kt),Math.abs(this.lat0)>wt?(g=Math.sin(this.lat0),n=Math.cos(this.lat0),e=1-this.es*g*g,this.B=n*n,this.B=Math.sqrt(1+this.es*this.B*this.B/kt),this.A=this.B*this.k0*t/e,(s=(r=this.B*t/(n*Math.sqrt(e)))*r-1)<=0?s=0:(s=Math.sqrt(s),this.lat0<0&&(s=-s)),this.E=s+=r,this.E*=Math.pow(ac(this.e,this.lat0,g),this.B)):(this.B=1/t,this.A=this.k0,this.E=r=s=1),De||nt?(De?(O=Math.asin(Math.sin(Ie)/r),nt||(A=Ie)):(O=A,Ie=Math.asin(r*Math.sin(O))),this.lam0=j-Math.asin(.5*(s-1/s)*Math.tan(O))/this.B):(l=Math.pow(ac(this.e,le,Math.sin(le)),this.B),d=Math.pow(ac(this.e,_e,Math.sin(_e)),this.B),s=this.E/l,v=(d-l)/(d+l),M=((M=this.E*this.E)-d*l)/(M+d*l),(e=B-X)<-Math.PI?X-=m0:e>Math.PI&&(X+=m0),this.lam0=It(.5*(B+X)-Math.atan(M*Math.tan(.5*this.B*(B-X))/v)/this.B),O=Math.atan(2*Math.sin(this.B*It(B-this.lam0))/(s-1/s)),A=Ie=Math.asin(r*Math.sin(O))),this.singam=Math.sin(O),this.cosgam=Math.cos(O),this.sinrot=Math.sin(A),this.cosrot=Math.cos(A),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(r*r-1)/Math.cos(Ie))),this.lat0<0&&(this.u_0=-this.u_0)),s=.5*O,this.v_pole_n=this.ArB*Math.log(Math.tan(rr-s)),this.v_pole_s=this.ArB*Math.log(Math.tan(rr+s))},forward:function FY(e){var n,r,s,l,d,g,v,M,t={};if(e.x=e.x-this.lam0,Math.abs(Math.abs(e.y)-ot)>wt){if(n=.5*((d=this.E/Math.pow(ac(this.e,e.y,Math.sin(e.y)),this.B))-(g=1/d)),r=.5*(d+g),l=Math.sin(this.B*e.x),s=(n*this.singam-l*this.cosgam)/r,Math.abs(Math.abs(s)-1)<wt)throw new Error;M=.5*this.ArB*Math.log((1-s)/(1+s)),g=Math.cos(this.B*e.x),v=Math.abs(g)<Sg?this.A*e.x:this.ArB*Math.atan2(n*this.cosgam+l*this.singam,g)}else M=e.y>0?this.v_pole_n:this.v_pole_s,v=this.ArB*e.y;return this.no_rot?(t.x=v,t.y=M):(t.x=M*this.cosrot+(v-=this.u_0)*this.sinrot,t.y=v*this.cosrot-M*this.sinrot),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},inverse:function BY(e){var t,n,r,s,l,d,g,v={};if(e.x=1/this.a*(e.x-this.x0),e.y=1/this.a*(e.y-this.y0),this.no_rot?(n=e.y,t=e.x):(n=e.x*this.cosrot-e.y*this.sinrot,t=e.y*this.cosrot+e.x*this.sinrot+this.u_0),s=.5*((r=Math.exp(-this.BrA*n))-1/r),l=.5*(r+1/r),g=((d=Math.sin(this.BrA*t))*this.cosgam+s*this.singam)/l,Math.abs(Math.abs(g)-1)<wt)v.x=0,v.y=g<0?-ot:ot;else{if(v.y=this.E/Math.sqrt((1+g)/(1-g)),v.y=v0(this.e,Math.pow(v.y,1/this.B)),v.y===1/0)throw new Error;v.x=-this.rB*Math.atan2(s*this.cosgam-d*this.singam,Math.cos(this.BrA*t))}return v.x+=this.lam0,v},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_variant_A","Hotine_Oblique_Mercator_Variant_B","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},HY={init:function VY(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<wt)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),n=Math.cos(this.lat1),r=tu(this.e,t,n),s=ac(this.e,this.lat1,t),l=Math.sin(this.lat2),d=Math.cos(this.lat2),g=tu(this.e,l,d),v=ac(this.e,this.lat2,l),M=Math.abs(Math.abs(this.lat0)-ot)<wt?0:ac(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>wt?Math.log(r/g)/Math.log(s/v):t,isNaN(this.ns)&&(this.ns=t),this.f0=r/(this.ns*Math.pow(s,this.ns)),this.rh=this.a*this.f0*Math.pow(M,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function UY(e){var t=e.x,n=e.y;Math.abs(2*Math.abs(n)-Math.PI)<=wt&&(n=y0(n)*(ot-2*wt));var s,l,r=Math.abs(Math.abs(n)-ot);if(r>wt)s=ac(this.e,n,Math.sin(n)),l=this.a*this.f0*Math.pow(s,this.ns);else{if((r=n*this.ns)<=0)return null;l=0}var d=this.ns*It(t-this.long0);return e.x=this.k0*(l*Math.sin(d))+this.x0,e.y=this.k0*(this.rh-l*Math.cos(d))+this.y0,e},inverse:function GY(e){var t,n,r,s,l,d=(e.x-this.x0)/this.k0,g=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(d*d+g*g),n=1):(t=-Math.sqrt(d*d+g*g),n=-1);var v=0;if(0!==t&&(v=Math.atan2(n*d,n*g)),0!==t||this.ns>0){if(n=1/this.ns,r=Math.pow(t/(this.a*this.f0),n),-9999===(s=v0(this.e,r)))return null}else s=-ot;return l=It(v/this.ns+this.long0),e.x=l,e.y=s,e},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]},KY={init:function WY(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function qY(e){var t,n,r,s,l,d,g,M=e.y,A=It(e.x-this.long0);return t=Math.pow((1+this.e*Math.sin(M))/(1-this.e*Math.sin(M)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(M/2+this.s45),this.alfa)/t)-this.s45),r=-A*this.alfa,s=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),l=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(s)),d=this.n*l,g=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(s/2+this.s45),this.n),e.y=g*Math.cos(d)/1,e.x=g*Math.sin(d)/1,this.czech||(e.y*=-1,e.x*=-1),e},inverse:function ZY(e){var t,n,r,s,d,g,v,M=e.x;e.x=e.y,e.y=M,this.czech||(e.y*=-1,e.x*=-1),d=Math.sqrt(e.x*e.x+e.y*e.y),s=Math.atan2(e.y,e.x)/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/d,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(s)),n=Math.asin(Math.cos(r)*Math.sin(s)/Math.cos(t)),e.x=this.long0-n/this.alfa,g=t,v=0;var A=0;do{e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(g))/(1-this.e*Math.sin(g)),this.e/2))-this.s45),Math.abs(g-e.y)<1e-10&&(v=1),g=e.y,A+=1}while(0===v&&A<15);return A>=15?null:e},names:["Krovak","krovak"]};function Is(e,t,n,r,s){return e*s-t*Math.sin(2*s)+n*Math.sin(4*s)-r*Math.sin(6*s)}function w0(e){return 1-.25*e*(1+e/16*(3+1.25*e))}function C0(e){return.375*e*(1+.25*e*(1+.46875*e))}function S0(e){return.05859375*e*e*(1+.75*e)}function E0(e){return e*e*e*(35/3072)}function Mw(e,t,n){var r=t*n;return e/Math.sqrt(1-r*r)}function Th(e){return Math.abs(e)<ot?e:e-y0(e)*Math.PI}function fv(e,t,n,r,s){var l,d;l=e/t;for(var g=0;g<15;g++)if(l+=d=(e-(t*l-n*Math.sin(2*l)+r*Math.sin(4*l)-s*Math.sin(6*l)))/(t-2*n*Math.cos(2*l)+4*r*Math.cos(4*l)-6*s*Math.cos(6*l)),Math.abs(d)<=1e-10)return l;return NaN}const tK={init:function XY(){this.sphere||(this.e0=w0(this.es),this.e1=C0(this.es),this.e2=S0(this.es),this.e3=E0(this.es),this.ml0=this.a*Is(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function QY(e){var t,n,r=e.x,s=e.y;if(r=It(r-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(s)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(s),Math.cos(r))-this.lat0);else{var l=Math.sin(s),d=Math.cos(s),g=Mw(this.a,this.e,l),v=Math.tan(s)*Math.tan(s),M=r*Math.cos(s),A=M*M,O=this.es*d*d/(1-this.es);t=g*M*(1-A*v*(1/6-(8-v+8*O)*A/120)),n=this.a*Is(this.e0,this.e1,this.e2,this.e3,s)-this.ml0+g*l/d*A*(.5+(5-v+6*O)*A/24)}return e.x=t+this.x0,e.y=n+this.y0,e},inverse:function JY(e){e.x-=this.x0,e.y-=this.y0;var r,s,t=e.x/this.a,n=e.y/this.a;if(this.sphere){var l=n+this.lat0;r=Math.asin(Math.sin(l)*Math.cos(t)),s=Math.atan2(Math.tan(t),Math.cos(l))}else{var g=fv(this.ml0/this.a+n,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(g)-ot)<=wt)return e.x=this.long0,e.y=ot,n<0&&(e.y*=-1),e;var v=Mw(this.a,this.e,Math.sin(g)),M=v*v*v/this.a/this.a*(1-this.es),A=Math.pow(Math.tan(g),2),O=t*this.a/v,j=O*O;r=g-v*Math.tan(g)/M*O*O*(.5-(1+3*A)*O*O/24),s=O*(1-j*(A/3+(1+3*A)*A*j/15))/Math.cos(g)}return e.x=It(s+this.long0),e.y=Th(r),e},names:["Cassini","Cassini_Soldner","cass"]};function Ih(e,t){var n;return e>1e-7?(1-e*e)*(t/(1-(n=e*t)*n)-.5/e*Math.log((1-n)/(1+n))):2*t}const pK={init:function nK(){var t,e=Math.abs(this.lat0);if(this.mode=Math.abs(e-ot)<wt?this.lat0<0?1:2:Math.abs(e)<wt?3:4,this.es>0)switch(this.qp=Ih(this.e,1),this.mmf=.5/(1-this.es),this.apa=function dK(e){var t,n=[];return n[0]=.3333333333333333*e,n[0]+=.17222222222222222*(t=e*e),n[1]=.06388888888888888*t,n[0]+=.10257936507936508*(t*=e),n[1]+=.0664021164021164*t,n[2]=.016415012942191543*t,n}(this.es),this.mode){case 2:case 1:this.dd=1;break;case 3:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case 4:this.rq=Math.sqrt(.5*this.qp),t=Math.sin(this.lat0),this.sinb1=Ih(this.e,t)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*t*t)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else 4===this.mode&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function rK(e){var t,n,r,s,l,d,g,v,M,A,O=e.x,j=e.y;if(O=It(O-this.long0),this.sphere){if(l=Math.sin(j),A=Math.cos(j),r=Math.cos(O),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((n=this.mode===this.EQUIT?1+A*r:1+this.sinph0*l+this.cosph0*A*r)<=wt)return null;t=(n=Math.sqrt(2/n))*A*Math.sin(O),n*=this.mode===this.EQUIT?l:this.cosph0*l-this.sinph0*A*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(j+this.lat0)<wt)return null;n=rr-.5*j,t=(n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)))*Math.sin(O),n*=r}}else{switch(g=0,v=0,M=0,r=Math.cos(O),s=Math.sin(O),l=Math.sin(j),d=Ih(this.e,l),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(g=d/this.qp,v=Math.sqrt(1-g*g)),this.mode){case this.OBLIQ:M=1+this.sinb1*g+this.cosb1*v*r;break;case this.EQUIT:M=1+v*r;break;case this.N_POLE:M=ot+j,d=this.qp-d;break;case this.S_POLE:M=j-ot,d=this.qp+d}if(Math.abs(M)<wt)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:M=Math.sqrt(2/M),n=this.mode===this.OBLIQ?this.ymf*M*(this.cosb1*g-this.sinb1*v*r):(M=Math.sqrt(2/(1+v*r)))*g*this.ymf,t=this.xmf*M*v*s;break;case this.N_POLE:case this.S_POLE:d>=0?(t=(M=Math.sqrt(d))*s,n=r*(this.mode===this.S_POLE?M:-M)):t=n=0}}return e.x=this.a*t+this.x0,e.y=this.a*n+this.y0,e},inverse:function oK(e){e.x-=this.x0,e.y-=this.y0;var r,s,l,d,g,v,M,t=e.x/this.a,n=e.y/this.a;if(this.sphere){var O,A=0,j=0;if((s=.5*(O=Math.sqrt(t*t+n*n)))>1)return null;switch(s=2*Math.asin(s),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(j=Math.sin(s),A=Math.cos(s)),this.mode){case this.EQUIT:s=Math.abs(O)<=wt?0:Math.asin(n*j/O),t*=j,n=A*O;break;case this.OBLIQ:s=Math.abs(O)<=wt?this.lat0:Math.asin(A*this.sinph0+n*j*this.cosph0/O),t*=j*this.cosph0,n=(A-Math.sin(s)*this.sinph0)*O;break;case this.N_POLE:n=-n,s=ot-s;break;case this.S_POLE:s-=ot}r=0!==n||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(t,n):0}else{if(M=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(t/=this.dd,n*=this.dd,(v=Math.sqrt(t*t+n*n))<wt)return e.x=this.long0,e.y=this.lat0,e;d=2*Math.asin(.5*v/this.rq),l=Math.cos(d),t*=d=Math.sin(d),this.mode===this.OBLIQ?(g=this.qp*(M=l*this.sinb1+n*d*this.cosb1/v),n=v*this.cosb1*l-n*this.sinb1*d):(g=this.qp*(M=n*d/v),n=v*l)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(n=-n),!(g=t*t+n*n))return e.x=this.long0,e.y=this.lat0,e;M=1-g/this.qp,this.mode===this.S_POLE&&(M=-M)}r=Math.atan2(t,n),s=function hK(e,t){var n=e+e;return e+t[0]*Math.sin(n)+t[1]*Math.sin(n+n)+t[2]*Math.sin(n+n+n)}(Math.asin(M),this.apa)}return e.x=It(this.long0+r),e.y=s,e},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function Dh(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)}const bK={init:function gK(){Math.abs(this.lat1+this.lat2)<wt||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=tu(this.e3,this.sin_po,this.cos_po),this.qs1=Ih(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=tu(this.e3,this.sin_po,this.cos_po),this.qs2=Ih(this.e3,this.sin_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Ih(this.e3,this.sin_po),this.ns0=Math.abs(this.lat1-this.lat2)>wt?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function mK(e){var t=e.x,n=e.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=Ih(this.e3,this.sin_phi),s=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,l=this.ns0*It(t-this.long0),d=s*Math.sin(l)+this.x0,g=this.rh-s*Math.cos(l)+this.y0;return e.x=d,e.y=g,e},inverse:function _K(e){var t,r,s,l,d;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),r=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),r=-1),s=0,0!==t&&(s=Math.atan2(r*e.x,r*e.y)),r=t*this.ns0/this.a,d=this.sphere?Math.asin((this.c-r*r)/(2*this.ns0)):this.phi1z(this.e3,(this.c-r*r)/this.ns0),l=It(s/this.ns0+this.long0),e.x=l,e.y=d,e},names:["Albers_Conic_Equal_Area","Albers_Equal_Area","Albers","aea"],phi1z:function yK(e,t){var n,s,l,d,g=Dh(.5*t);if(e<wt)return g;for(var v=e*e,M=1;M<=25;M++)if(g+=d=.5*(l=1-(s=e*(n=Math.sin(g)))*s)*l/Math.cos(g)*(t/(1-v)-n/l+.5/e*Math.log((1-s)/(1+s))),Math.abs(d)<=1e-7)return g;return null}},EK={init:function xK(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function wK(e){var t,n,r,s,d,g,v,A=e.y;return r=It(e.x-this.long0),t=Math.sin(A),n=Math.cos(A),s=Math.cos(r),(d=this.sin_p14*t+this.cos_p14*n*s)>0||Math.abs(d)<=wt?(g=this.x0+1*this.a*n*Math.sin(r)/d,v=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*n*s)/d):(g=this.x0+this.infinity_dist*n*Math.sin(r),v=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*n*s)),e.x=g,e.y=v,e},inverse:function CK(e){var t,n,r,s,l,d;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(s=Math.atan2(t,this.rc),n=Math.sin(s),d=Dh((r=Math.cos(s))*this.sin_p14+e.y*n*this.cos_p14/t),l=Math.atan2(e.x*n,t*this.cos_p14*r-e.y*this.sin_p14*n),l=It(this.long0+l)):(d=this.phic0,l=0),e.x=l,e.y=d,e},names:["gnom"]},PK={init:function TK(){this.sphere||(this.k0=tu(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function IK(e){var r,s,n=e.y,l=It(e.x-this.long0);if(this.sphere)r=this.x0+this.a*l*Math.cos(this.lat_ts),s=this.y0+this.a*Math.sin(n)/Math.cos(this.lat_ts);else{var d=Ih(this.e,Math.sin(n));r=this.x0+this.a*this.k0*l,s=this.y0+this.a*d*.5/this.k0}return e.x=r,e.y=s,e},inverse:function DK(e){var t,n;return e.x-=this.x0,e.y-=this.y0,this.sphere?(t=It(this.long0+e.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(n=function MK(e,t){var n=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-n)<1e-6)return t<0?-1*ot:ot;for(var s,l,d,g,r=Math.asin(.5*t),v=0;v<30;v++)if(l=Math.sin(r),d=Math.cos(r),g=e*l,r+=s=Math.pow(1-g*g,2)/(2*d)*(t/(1-e*e)-l/(1-g*g)+.5/e*Math.log((1-g)/(1+g))),Math.abs(s)<=1e-10)return r;return NaN}(this.e,2*e.y*this.k0/this.a),t=It(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=n,e},names:["cea"]},LK={init:function kK(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function RK(e){var n=e.y,r=It(e.x-this.long0),s=Th(n-this.lat0);return e.x=this.x0+this.a*r*this.rc,e.y=this.y0+this.a*s,e},inverse:function OK(e){var n=e.y;return e.x=It(this.long0+(e.x-this.x0)/(this.a*this.rc)),e.y=Th(this.lat0+(n-this.y0)/this.a),e},names:["Equirectangular","Equidistant_Cylindrical","Equidistant_Cylindrical_Spherical","eqc"]},VK={init:function FK(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=w0(this.es),this.e1=C0(this.es),this.e2=S0(this.es),this.e3=E0(this.es),this.ml0=this.a*Is(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function BK(e){var r,s,l,n=e.y,d=It(e.x-this.long0);if(l=d*Math.sin(n),this.sphere)Math.abs(n)<=wt?(r=this.a*d,s=-1*this.a*this.lat0):(r=this.a*Math.sin(l)/Math.tan(n),s=this.a*(Th(n-this.lat0)+(1-Math.cos(l))/Math.tan(n)));else if(Math.abs(n)<=wt)r=this.a*d,s=-1*this.ml0;else{var g=Mw(this.a,this.e,Math.sin(n))/Math.tan(n);r=g*Math.sin(l),s=this.a*Is(this.e0,this.e1,this.e2,this.e3,n)-this.ml0+g*(1-Math.cos(l))}return e.x=r+this.x0,e.y=s+this.y0,e},inverse:function zK(e){var t,n,r,s,l,d,g,v,M;if(r=e.x-this.x0,s=e.y-this.y0,this.sphere)if(Math.abs(s+this.a*this.lat0)<=wt)t=It(r/this.a+this.long0),n=0;else{var A;for(g=r*r/this.a/this.a+(d=this.lat0+s/this.a)*d,v=d,l=20;l;--l)if(v+=M=-1*(d*(v*(A=Math.tan(v))+1)-v-.5*(v*v+g)*A)/((v-d)/A-1),Math.abs(M)<=wt){n=v;break}t=It(this.long0+Math.asin(r*Math.tan(v)/this.a)/Math.sin(n))}else if(Math.abs(s+this.ml0)<=wt)n=0,t=It(this.long0+r/this.a);else{var O,j,B,X,le;for(g=r*r/this.a/this.a+(d=(this.ml0+s)/this.a)*d,v=d,l=20;l;--l)if(le=this.e*Math.sin(v),O=Math.sqrt(1-le*le)*Math.tan(v),j=this.a*Is(this.e0,this.e1,this.e2,this.e3,v),B=this.e0-2*this.e1*Math.cos(2*v)+4*this.e2*Math.cos(4*v)-6*this.e3*Math.cos(6*v),v-=M=(d*(O*(X=j/this.a)+1)-X-.5*O*(X*X+g))/(this.es*Math.sin(2*v)*(X*X+g-2*d*X)/(4*O)+(d-X)*(O*B-2/Math.sin(2*v))-B),Math.abs(M)<=wt){n=v;break}O=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),t=It(this.long0+Math.asin(r*O/this.a)/Math.sin(n))}return e.x=t,e.y=n,e},names:["Polyconic","American_Polyconic","poly"]},WK={init:function UK(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function GK(e){var t,d=(e.y-this.lat0)/g0*1e-5,g=e.x-this.long0,v=1,M=0;for(t=1;t<=10;t++)M+=this.A[t]*(v*=d);var le,A=M,O=g,j=1,B=0,_e=0,Ie=0;for(t=1;t<=6;t++)le=B*A+j*O,_e=_e+this.B_re[t]*(j=j*A-B*O)-this.B_im[t]*(B=le),Ie=Ie+this.B_im[t]*j+this.B_re[t]*B;return e.x=Ie*this.a+this.x0,e.y=_e*this.a+this.y0,e},inverse:function $K(e){var t,O,d=(e.y-this.y0)/this.a,g=(e.x-this.x0)/this.a,v=1,M=0,j=0,B=0;for(t=1;t<=6;t++)O=M*d+v*g,j=j+this.C_re[t]*(v=v*d-M*g)-this.C_im[t]*(M=O),B=B+this.C_im[t]*v+this.C_re[t]*M;for(var X=0;X<this.iterations;X++){var De,le=j,_e=B,nt=d,kt=g;for(t=2;t<=6;t++)De=_e*j+le*B,nt+=(t-1)*(this.B_re[t]*(le=le*j-_e*B)-this.B_im[t]*(_e=De)),kt+=(t-1)*(this.B_im[t]*le+this.B_re[t]*_e);le=1,_e=0;var yt=this.B_re[1],pn=this.B_im[1];for(t=2;t<=6;t++)De=_e*j+le*B,yt+=t*(this.B_re[t]*(le=le*j-_e*B)-this.B_im[t]*(_e=De)),pn+=t*(this.B_im[t]*le+this.B_re[t]*_e);var _n=yt*yt+pn*pn;j=(nt*yt+kt*pn)/_n,B=(kt*yt-nt*pn)/_n}var Vr=j,Kr=B,Da=1,Ai=0;for(t=1;t<=9;t++)Ai+=this.D[t]*(Da*=Vr);var lc=this.lat0+Ai*g0*1e5;return e.x=this.long0+Kr,e.y=lc,e},names:["New_Zealand_Map_Grid","nzmg"]},XK={init:function qK(){},forward:function ZK(e){var n=e.y,r=It(e.x-this.long0),s=this.x0+this.a*r,l=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return e.x=s,e.y=l,e},inverse:function YK(e){e.x-=this.x0,e.y-=this.y0;var t=It(this.long0+e.x/this.a),n=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=n,e},names:["Miller_Cylindrical","mill"]},rX={init:function JK(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=bw(this.es)},forward:function eX(e){var t,n,r=e.x,s=e.y;if(r=It(r-this.long0),this.sphere){if(this.m)for(var l=this.n*Math.sin(s),d=20;d;--d){var g=(this.m*s+Math.sin(s)-l)/(this.m+Math.cos(s));if(s-=g,Math.abs(g)<wt)break}else s=1!==this.n?Math.asin(this.n*Math.sin(s)):s;t=this.a*this.C_x*r*(this.m+Math.cos(s)),n=this.a*this.C_y*s}else{var v=Math.sin(s),M=Math.cos(s);n=this.a*Cg(s,v,M,this.en),t=this.a*r*M/Math.sqrt(1-this.es*v*v)}return e.x=t,e.y=n,e},inverse:function tX(e){var t,r,s;return e.x-=this.x0,r=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,r/=this.C_x*(this.m+Math.cos(t)),this.m?t=Dh((this.m*t+Math.sin(t))/this.n):1!==this.n&&(t=Dh(Math.sin(t)/this.n)),r=It(r+this.long0),t=Th(t)):(t=xw(e.y/this.a,this.es,this.en),(s=Math.abs(t))<ot?(s=Math.sin(t),r=It(this.long0+e.x*Math.sqrt(1-this.es*s*s)/(this.a*Math.cos(t)))):s-wt<ot&&(r=this.long0)),e.x=r,e.y=t,e},names:["Sinusoidal","sinu"]},lX={init:function oX(){},forward:function iX(e){for(var n=e.y,r=It(e.x-this.long0),s=n,l=Math.PI*Math.sin(n);;){var d=-(s+Math.sin(s)-l)/(1+Math.cos(s));if(s+=d,Math.abs(d)<wt)break}s/=2,Math.PI/2-Math.abs(n)<wt&&(r=0);var g=.900316316158*this.a*r*Math.cos(s)+this.x0,v=1.4142135623731*this.a*Math.sin(s)+this.y0;return e.x=g,e.y=v,e},inverse:function sX(e){var t,n;e.x-=this.x0,e.y-=this.y0,n=e.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),t=Math.asin(n);var r=It(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*t+Math.sin(2*t))/Math.PI,Math.abs(n)>1&&(n=1);var s=Math.asin(n);return e.x=r,e.y=s,e},names:["Mollweide","moll"]},fX={init:function cX(){Math.abs(this.lat1+this.lat2)<wt||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=w0(this.es),this.e1=C0(this.es),this.e2=S0(this.es),this.e3=E0(this.es),this.sin_phi=Math.sin(this.lat1),this.cos_phi=Math.cos(this.lat1),this.ms1=tu(this.e,this.sin_phi,this.cos_phi),this.ml1=Is(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<wt?this.ns=this.sin_phi:(this.sin_phi=Math.sin(this.lat2),this.cos_phi=Math.cos(this.lat2),this.ms2=tu(this.e,this.sin_phi,this.cos_phi),this.ml2=Is(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Is(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function uX(e){var r,t=e.x,n=e.y;if(this.sphere)r=this.a*(this.g-n);else{var s=Is(this.e0,this.e1,this.e2,this.e3,n);r=this.a*(this.g-s)}var l=this.ns*It(t-this.long0),d=this.x0+r*Math.sin(l),g=this.y0+this.rh-r*Math.cos(l);return e.x=d,e.y=g,e},inverse:function dX(e){var t,n,r,s;e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns>=0?(n=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(n=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var l=0;return 0!==n&&(l=Math.atan2(t*e.x,t*e.y)),this.sphere?(s=It(this.long0+l/this.ns),r=Th(this.g-n/this.a),e.x=s,e.y=r,e):(r=fv(this.g-n/this.a,this.e0,this.e1,this.e2,this.e3),s=It(this.long0+l/this.ns),e.x=s,e.y=r,e)},names:["Equidistant_Conic","eqdc"]},yX={init:function pX(){this.R=this.a},forward:function gX(e){var s,l,n=e.y,r=It(e.x-this.long0);Math.abs(n)<=wt&&(s=this.x0+this.R*r,l=this.y0);var d=Dh(2*Math.abs(n/Math.PI));(Math.abs(r)<=wt||Math.abs(Math.abs(n)-ot)<=wt)&&(s=this.x0,l=n>=0?this.y0+Math.PI*this.R*Math.tan(.5*d):this.y0+Math.PI*this.R*-Math.tan(.5*d));var g=.5*Math.abs(Math.PI/r-r/Math.PI),v=g*g,M=Math.sin(d),A=Math.cos(d),O=A/(M+A-1),B=O*(2/M-1),X=B*B,le=Math.PI*this.R*(g*(O-X)+Math.sqrt(v*(O-X)*(O-X)-(X+v)*(O*O-X)))/(X+v);r<0&&(le=-le),s=this.x0+le;var _e=v+O;return le=Math.PI*this.R*(B*_e-g*Math.sqrt((X+v)*(v+1)-_e*_e))/(X+v),l=n>=0?this.y0+le:this.y0-le,e.x=s,e.y=l,e},inverse:function mX(e){var t,n,r,s,l,d,g,v,M,A,O,j;return e.x-=this.x0,e.y-=this.y0,O=Math.PI*this.R,l=(r=e.x/O)*r+(s=e.y/O)*s,O=3*(s*s/(v=-2*(d=-Math.abs(s)*(1+l))+1+2*s*s+l*l)+(2*(g=d-2*s*s+r*r)*g*g/v/v/v-9*d*g/v/v)/27)/(M=(d-g*g/3/v)/v)/(A=2*Math.sqrt(-M/3)),Math.abs(O)>1&&(O=O>=0?1:-1),j=Math.acos(O)/3,n=e.y>=0?(-A*Math.cos(j+Math.PI/3)-g/3/v)*Math.PI:-(-A*Math.cos(j+Math.PI/3)-g/3/v)*Math.PI,t=Math.abs(r)<wt?this.long0:It(this.long0+Math.PI*(l-1+Math.sqrt(1+2*(r*r-s*s)+l*l))/2/r),e.x=t,e.y=n,e},names:["Van_der_Grinten_I","VanDerGrinten","Van_der_Grinten","vandg"]},EX={init:function xX(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0),this.f=this.es/(1+Math.sqrt(1-this.es))},forward:function wX(e){var d,g,v,M,A,O,j,B,X,le,_e,t=e.x,n=e.y,r=Math.sin(e.y),s=Math.cos(e.y),l=It(t-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=wt?(e.x=this.x0+this.a*(ot-n)*Math.sin(l),e.y=this.y0-this.a*(ot-n)*Math.cos(l),e):Math.abs(this.sin_p12+1)<=wt?(e.x=this.x0+this.a*(ot+n)*Math.sin(l),e.y=this.y0+this.a*(ot+n)*Math.cos(l),e):(X=this.sin_p12*r+this.cos_p12*s*Math.cos(l),B=(j=Math.acos(X))?j/Math.sin(j):1,e.x=this.x0+this.a*B*s*Math.sin(l),e.y=this.y0+this.a*B*(this.cos_p12*r-this.sin_p12*s*Math.cos(l)),e):(d=w0(this.es),g=C0(this.es),v=S0(this.es),M=E0(this.es),Math.abs(this.sin_p12-1)<=wt?(A=this.a*Is(d,g,v,M,ot),O=this.a*Is(d,g,v,M,n),e.x=this.x0+(A-O)*Math.sin(l),e.y=this.y0-(A-O)*Math.cos(l),e):Math.abs(this.sin_p12+1)<=wt?(A=this.a*Is(d,g,v,M,ot),O=this.a*Is(d,g,v,M,n),e.x=this.x0+(A+O)*Math.sin(l),e.y=this.y0+(A+O)*Math.cos(l),e):Math.abs(t)<wt&&Math.abs(n-this.lat0)<wt?(e.x=e.y=0,e):(le=function vX(e,t,n,r,s,l){const d=r-t,g=Math.atan((1-l)*Math.tan(e)),v=Math.atan((1-l)*Math.tan(n)),M=Math.sin(g),A=Math.cos(g),O=Math.sin(v),j=Math.cos(v);let X,_e,Ie,De,nt,kt,yt,pn,_n,Vr,Kr,Da,Ai,lc,fl,B=d,le=100;do{if(_e=Math.sin(B),Ie=Math.cos(B),De=Math.sqrt(j*_e*(j*_e)+(A*O-M*j*Ie)*(A*O-M*j*Ie)),0===De)return{azi1:0,s12:0};nt=M*O+A*j*Ie,kt=Math.atan2(De,nt),yt=A*j*_e/De,pn=1-yt*yt,_n=0!==pn?nt-2*M*O/pn:0,Vr=l/16*pn*(4+l*(4-3*pn)),X=B,B=d+(1-Vr)*l*yt*(kt+Vr*De*(_n+Vr*nt*(2*_n*_n-1)))}while(Math.abs(B-X)>1e-12&&--le>0);return 0===le?{azi1:NaN,s12:NaN}:(Kr=pn*(s*s-s*(1-l)*(s*(1-l)))/(s*(1-l)*(s*(1-l))),Da=1+Kr/16384*(4096+Kr*(Kr*(320-175*Kr)-768)),Ai=Kr/1024*(256+Kr*(Kr*(74-47*Kr)-128)),lc=Ai*De*(_n+Ai/4*(nt*(2*_n*_n-1)-Ai/6*_n*(4*De*De-3)*(4*_n*_n-3))),fl=s*(1-l)*Da*(kt-lc),{azi1:Math.atan2(j*_e,A*O-M*j*Ie),s12:fl})}(this.lat0,this.long0,n,t,this.a,this.f),_e=le.azi1,e.x=le.s12*Math.sin(_e),e.y=le.s12*Math.cos(_e),e))},inverse:function CX(e){var t,n,r,s,l,d,g,v,M,A,O,j,X,le,_e;return e.x-=this.x0,e.y-=this.y0,this.sphere?(t=Math.sqrt(e.x*e.x+e.y*e.y))>2*ot*this.a?void 0:(n=t/this.a,r=Math.sin(n),s=Math.cos(n),l=this.long0,Math.abs(t)<=wt?d=this.lat0:(d=Dh(s*this.sin_p12+e.y*r*this.cos_p12/t),g=Math.abs(this.lat0)-ot,l=Math.abs(g)<=wt?It(this.lat0>=0?this.long0+Math.atan2(e.x,-e.y):this.long0-Math.atan2(-e.x,e.y)):It(this.long0+Math.atan2(e.x*r,t*this.cos_p12*s-e.y*this.sin_p12*r))),e.x=l,e.y=d,e):(v=w0(this.es),M=C0(this.es),A=S0(this.es),O=E0(this.es),Math.abs(this.sin_p12-1)<=wt?(d=fv(((j=this.a*Is(v,M,A,O,ot))-(t=Math.sqrt(e.x*e.x+e.y*e.y)))/this.a,v,M,A,O),l=It(this.long0+Math.atan2(e.x,-1*e.y)),e.x=l,e.y=d,e):Math.abs(this.sin_p12+1)<=wt?(j=this.a*Is(v,M,A,O,ot),d=fv(((t=Math.sqrt(e.x*e.x+e.y*e.y))-j)/this.a,v,M,A,O),l=It(this.long0+Math.atan2(e.x,e.y)),e.x=l,e.y=d,e):(X=Math.atan2(e.x,e.y),le=Math.sqrt(e.x*e.x+e.y*e.y),_e=function bX(e,t,n,r,s,l){const d=Math.atan((1-l)*Math.tan(e)),g=Math.sin(d),v=Math.cos(d),M=Math.sin(n),A=Math.cos(n),O=Math.atan2(g,v*A),j=v*M,B=1-j*j,X=B*(s*s-s*(1-l)*(s*(1-l)))/(s*(1-l)*(s*(1-l))),le=1+X/16384*(4096+X*(X*(320-175*X)-768)),_e=X/1024*(256+X*(X*(74-47*X)-128));let De,kt,yt,pn,_n,Ie=r/(s*(1-l)*le),nt=100;do{kt=Math.cos(2*O+Ie),yt=Math.sin(Ie),pn=Math.cos(Ie),_n=_e*yt*(kt+_e/4*(pn*(2*kt*kt-1)-_e/6*kt*(4*yt*yt-3)*(4*kt*kt-3))),De=Ie,Ie=r/(s*(1-l)*le)+_n}while(Math.abs(Ie-De)>1e-12&&--nt>0);if(0===nt)return{lat2:NaN,lon2:NaN};const Vr=g*yt-v*pn*A,Ai=l/16*B*(4+l*(4-3*B));return{lat2:Math.atan2(g*pn+v*yt*A,(1-l)*Math.sqrt(j*j+Vr*Vr)),lon2:t+(Math.atan2(yt*M,v*pn-g*yt*A)-(1-Ai)*l*j*(Ie+Ai*yt*(kt+Ai*pn*(2*kt*kt-1))))}}(this.lat0,this.long0,X,le,this.a,this.f),e.x=_e.lon2,e.y=_e.lat2,e))},names:["Azimuthal_Equidistant","aeqd"]},AX={init:function MX(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function TX(e){var t,n,r,s,d,g,v,A=e.y;return r=It(e.x-this.long0),t=Math.sin(A),n=Math.cos(A),s=Math.cos(r),((d=this.sin_p14*t+this.cos_p14*n*s)>0||Math.abs(d)<=wt)&&(g=1*this.a*n*Math.sin(r),v=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*n*s)),e.x=g,e.y=v,e},inverse:function IX(e){var t,n,r,s,l,d,g;return e.x-=this.x0,e.y-=this.y0,n=Dh((t=Math.sqrt(e.x*e.x+e.y*e.y))/this.a),r=Math.sin(n),s=Math.cos(n),d=this.long0,Math.abs(t)<=wt?(g=this.lat0,e.x=d,e.y=g,e):(g=Dh(s*this.sin_p14+e.y*r*this.cos_p14/t),l=Math.abs(this.lat0)-ot,Math.abs(l)<=wt?(d=It(this.lat0>=0?this.long0+Math.atan2(e.x,-e.y):this.long0-Math.atan2(-e.x,e.y)),e.x=d,e.y=g,e):(d=It(this.long0+Math.atan2(e.x*r,t*this.cos_p14*s-e.y*this.sin_p14*r)),e.x=d,e.y=g,e))},names:["ortho"]};function gv(e,t,n,r){var s;return e<wt?(r.value=1,s=0):(s=Math.atan2(t,n),Math.abs(s)<=rr?r.value=1:s>rr&&s<=ot+rr?(r.value=2,s-=ot):s>ot+rr||s<=-(ot+rr)?(r.value=3,s=s>=0?s-Do:s+Do):(r.value=4,s+=ot)),s}function Eg(e,t){var n=e+t;return n<-Do?n+=m0:n>+Do&&(n-=m0),n}const NX={init:function PX(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.face=this.lat0>=ot-rr/2?5:this.lat0<=-(ot-rr/2)?6:Math.abs(this.long0)<=rr?1:Math.abs(this.long0)<=ot+rr?this.long0>0?2:4:3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function kX(e){var n,r,s,l,d,g,t={x:0,y:0},v={value:0};if(e.x-=this.long0,n=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(e.y)):e.y,r=e.x,5===this.face)l=ot-n,r>=rr&&r<=ot+rr?(v.value=1,s=r-ot):r>ot+rr||r<=-(ot+rr)?(v.value=2,s=r>0?r-Do:r+Do):r>-(ot+rr)&&r<=-rr?(v.value=3,s=r+ot):(v.value=4,s=r);else if(6===this.face)l=ot+n,r>=rr&&r<=ot+rr?(v.value=1,s=-r+ot):r<rr&&r>=-rr?(v.value=2,s=-r):r<-rr&&r>=-(ot+rr)?(v.value=3,s=-r-ot):(v.value=4,s=r>0?-r+Do:-r-Do);else{var M,A,O,j,B,X;2===this.face?r=Eg(r,+ot):3===this.face?r=Eg(r,+Do):4===this.face&&(r=Eg(r,-ot)),j=Math.sin(n),B=Math.cos(n),X=Math.sin(r),M=B*Math.cos(r),A=B*X,O=j,1===this.face?s=gv(l=Math.acos(M),O,A,v):2===this.face?s=gv(l=Math.acos(A),O,-M,v):3===this.face?s=gv(l=Math.acos(-M),O,-A,v):4===this.face?s=gv(l=Math.acos(-A),O,M,v):(l=s=0,v.value=1)}return g=Math.atan(12/Do*(s+Math.acos(Math.sin(s)*Math.cos(rr))-ot)),d=Math.sqrt((1-Math.cos(l))/(Math.cos(g)*Math.cos(g))/(1-Math.cos(Math.atan(1/Math.cos(s))))),2===v.value?g+=ot:3===v.value?g+=Do:4===v.value&&(g+=1.5*Do),t.x=d*Math.cos(g),t.y=d*Math.sin(g),t.x=t.x*this.a+this.x0,t.y=t.y*this.a+this.y0,e.x=t.x,e.y=t.y,e},inverse:function RX(e){var n,r,s,l,d,g,v,M,A,le,_e,Ie,t={lam:0,phi:0},O={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,r=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),n=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?O.value=1:e.y>=0&&e.y>=Math.abs(e.x)?(O.value=2,n-=ot):e.x<0&&-e.x>=Math.abs(e.y)?(O.value=3,n=n<0?n+Do:n-Do):(O.value=4,n+=ot),A=Do/12*Math.tan(n),d=Math.sin(A)/(Math.cos(A)-1/Math.sqrt(2)),g=Math.atan(d),(v=1-(s=Math.cos(n))*s*(l=Math.tan(r))*l*(1-Math.cos(Math.atan(1/Math.cos(g)))))<-1?v=-1:v>1&&(v=1),5===this.face)M=Math.acos(v),t.phi=ot-M,t.lam=1===O.value?g+ot:2===O.value?g<0?g+Do:g-Do:3===O.value?g-ot:g;else if(6===this.face)M=Math.acos(v),t.phi=M-ot,t.lam=1===O.value?-g+ot:2===O.value?-g:3===O.value?-g-ot:g<0?-g-Do:-g+Do;else{var j,B,X;A=(j=v)*j,B=(A+=(X=A>=1?0:Math.sqrt(1-A)*Math.sin(g))*X)>=1?0:Math.sqrt(1-A),2===O.value?(A=B,B=-X,X=A):3===O.value?(B=-B,X=-X):4===O.value&&(A=B,B=X,X=-A),2===this.face?(A=j,j=-B,B=A):3===this.face?(j=-j,B=-B):4===this.face&&(A=j,j=B,B=-A),t.phi=Math.acos(-X)-ot,t.lam=Math.atan2(B,j),2===this.face?t.lam=Eg(t.lam,-ot):3===this.face?t.lam=Eg(t.lam,-Do):4===this.face&&(t.lam=Eg(t.lam,+ot))}return 0!==this.es&&(le=t.phi<0?1:0,_e=Math.tan(t.phi),Ie=this.b/Math.sqrt(_e*_e+this.one_minus_f_squared),t.phi=Math.atan(Math.sqrt(this.a*this.a-Ie*Ie)/(this.one_minus_f*Ie)),le&&(t.phi=-t.phi)),t.lam+=this.long0,e.x=t.lam,e.y=t.phi,e},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var Aw=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],M0=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],kD=eu/5,LX=1/kD,mv=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))};const GX={init:function zX(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function jX(e){var t=It(e.x-this.long0),n=Math.abs(e.y),r=Math.floor(n*kD);r<0?r=0:r>=18&&(r=17);var s={x:mv(Aw[r],n=eu*(n-LX*r))*t,y:mv(M0[r],n)};return e.y<0&&(s.y=-s.y),s.x=s.x*this.a*.8487+this.x0,s.y=s.y*this.a*1.3523+this.y0,s},inverse:function VX(e){var t={x:(e.x-this.x0)/(.8487*this.a),y:Math.abs(e.y-this.y0)/(1.3523*this.a)};if(t.y>=1)t.x/=Aw[18][0],t.y=e.y<0?-ot:ot;else{var n=Math.floor(18*t.y);for(n<0?n=0:n>=18&&(n=17);;)if(M0[n][0]>t.y)--n;else{if(!(M0[n+1][0]<=t.y))break;++n}var r=M0[n],s=5*(t.y-r[0])/(M0[n+1][0]-r[0]);s=function BX(e,t,n,r){for(var s=t;r;--r){var l=e(s);if(s-=l,Math.abs(l)<n)break}return s}(function(l){return(mv(r,l)-t.y)/function(e,t){return e[1]+t*(2*e[2]+3*t*e[3])}(r,l)},s,wt,100),t.x/=mv(Aw[n],s),t.y=(5*n+s)*Di,e.y<0&&(t.y=-t.y)}return t.x=It(t.x+this.long0),t},names:["Robinson","robin"]},ZX={init:function $X(){this.name="geocent"},forward:function HX(e){return lD(e,this.es,this.a)},inverse:function WX(e){return cD(e,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var T0={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const JX={init:function YX(){if(Object.keys(T0).forEach(function(n){if(typeof this[n]>"u")this[n]=T0[n].def;else{if(T0[n].num&&isNaN(this[n]))throw new Error("Invalid parameter value, must be numeric "+n+" = "+this[n]);T0[n].num&&(this[n]=parseFloat(this[n]))}T0[n].degrees&&(this[n]=this[n]*Di)}.bind(this)),Math.abs(Math.abs(this.lat0)-ot)<wt?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<wt?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var e=this.tilt,t=this.azi;this.cg=Math.cos(t),this.sg=Math.sin(t),this.cw=Math.cos(e),this.sw=Math.sin(e)},forward:function KX(e){e.x-=this.long0;var s,l,d,g,t=Math.sin(e.y),n=Math.cos(e.y),r=Math.cos(e.x);switch(this.mode){case 3:l=this.sinph0*t+this.cosph0*n*r;break;case 2:l=n*r;break;case 1:l=-t;break;case 0:l=t}switch(s=(l=this.pn1/(this.p-l))*n*Math.sin(e.x),this.mode){case 3:l*=this.cosph0*t-this.sinph0*n*r;break;case 2:l*=t;break;case 0:l*=-n*r;break;case 1:l*=n*r}return s=(s*this.cg-l*this.sg)*this.cw*(g=1/((d=l*this.cg+s*this.sg)*this.sw*this.h1+this.cw)),l=d*g,e.x=s*this.a,e.y=l*this.a,e},inverse:function XX(e){e.x/=this.a,e.y/=this.a;var n,r,s,t={x:e.x,y:e.y};e.x=(n=this.pn1*e.x*(s=1/(this.pn1-e.y*this.sw)))*this.cg+(r=this.pn1*e.y*this.cw*s)*this.sg,e.y=r*this.cg-n*this.sg;var l=ra(e.x,e.y);if(Math.abs(l)<wt)t.x=0,t.y=e.y;else{var d,g;switch(g=1-l*l*this.pfact,g=(this.p-Math.sqrt(g))/(this.pn1/l+l/this.pn1),d=Math.sqrt(1-g*g),this.mode){case 3:t.y=Math.asin(d*this.sinph0+e.y*g*this.cosph0/l),e.y=(d-this.sinph0*Math.sin(t.y))*l,e.x*=g*this.cosph0;break;case 2:t.y=Math.asin(e.y*g/l),e.y=d*l,e.x*=g;break;case 0:t.y=Math.asin(d),e.y=-e.y;break;case 1:t.y=-Math.asin(d)}t.x=Math.atan2(e.x,e.y)}return e.x=t.x+this.long0,e.y=t.y,e},names:["Tilted_Perspective","tpers"]},oQ={init:function eQ(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var e=1-this.es,t=1/e;this.radius_p=Math.sqrt(e),this.radius_p2=e,this.radius_p_inv2=t,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function tQ(e){var r,s,l,d,t=e.x,n=e.y;if(t-=this.long0,"ellipse"===this.shape){n=Math.atan(this.radius_p2*Math.tan(n));var g=this.radius_p/ra(this.radius_p*Math.cos(n),Math.sin(n));if(s=g*Math.cos(t)*Math.cos(n),l=g*Math.sin(t)*Math.cos(n),d=g*Math.sin(n),(this.radius_g-s)*s-l*l-d*d*this.radius_p_inv2<0)return e.x=Number.NaN,e.y=Number.NaN,e;r=this.radius_g-s,this.flip_axis?(e.x=this.radius_g_1*Math.atan(l/ra(d,r)),e.y=this.radius_g_1*Math.atan(d/r)):(e.x=this.radius_g_1*Math.atan(l/r),e.y=this.radius_g_1*Math.atan(d/ra(l,r)))}else"sphere"===this.shape&&(r=Math.cos(n),s=Math.cos(t)*r,l=Math.sin(t)*r,d=Math.sin(n),r=this.radius_g-s,this.flip_axis?(e.x=this.radius_g_1*Math.atan(l/ra(d,r)),e.y=this.radius_g_1*Math.atan(d/r)):(e.x=this.radius_g_1*Math.atan(l/r),e.y=this.radius_g_1*Math.atan(d/ra(l,r))));return e.x=e.x*this.a,e.y=e.y*this.a,e},inverse:function nQ(e){var s,l,d,g,t=-1,n=0,r=0;if(e.x=e.x/this.a,e.y=e.y/this.a,"ellipse"===this.shape){this.flip_axis?(r=Math.tan(e.y/this.radius_g_1),n=Math.tan(e.x/this.radius_g_1)*ra(1,r)):(n=Math.tan(e.x/this.radius_g_1),r=Math.tan(e.y/this.radius_g_1)*ra(1,n));var v=r/this.radius_p;if((d=(l=2*this.radius_g*t)*l-4*(s=n*n+v*v+t*t)*this.C)<0)return e.x=Number.NaN,e.y=Number.NaN,e;g=(-l-Math.sqrt(d))/(2*s),t=this.radius_g+g*t,n*=g,r*=g,e.x=Math.atan2(n,t),e.y=Math.atan(r*Math.cos(e.x)/t),e.y=Math.atan(this.radius_p_inv2*Math.tan(e.y))}else if("sphere"===this.shape){if(this.flip_axis?(r=Math.tan(e.y/this.radius_g_1),n=Math.tan(e.x/this.radius_g_1)*Math.sqrt(1+r*r)):(n=Math.tan(e.x/this.radius_g_1),r=Math.tan(e.y/this.radius_g_1)*Math.sqrt(1+n*n)),(d=(l=2*this.radius_g*t)*l-4*(s=n*n+r*r+t*t)*this.C)<0)return e.x=Number.NaN,e.y=Number.NaN,e;g=(-l-Math.sqrt(d))/(2*s),t=this.radius_g+g*t,n*=g,r*=g,e.x=Math.atan2(n,t),e.y=Math.atan(r*Math.cos(e.x)/t)}return e.x=e.x+this.long0,e},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};var I0=1.340264,D0=-.081106,A0=893e-6,P0=.003796,_v=Math.sqrt(3)/2;const cQ={init:function iQ(){this.es=0,this.long0=void 0!==this.long0?this.long0:0},forward:function sQ(e){var t=It(e.x-this.long0),r=Math.asin(_v*Math.sin(e.y)),s=r*r,l=s*s*s;return e.x=t*Math.cos(r)/(_v*(I0+3*D0*s+l*(7*A0+9*P0*s))),e.y=r*(I0+D0*s+l*(A0+P0*s)),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function aQ(e){e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a;var s,l,v,M,r=e.y;for(M=0;M<12&&(r-=v=(r*(I0+D0*(s=r*r)+(l=s*s*s)*(A0+P0*s))-e.y)/(I0+3*D0*s+l*(7*A0+9*P0*s)),!(Math.abs(v)<1e-9));++M);return e.x=_v*e.x*(I0+3*D0*(s=r*r)+(l=s*s*s)*(7*A0+9*P0*s))/Math.cos(r),e.y=Math.asin(Math.sin(r)/_v),e.x=It(e.x+this.long0),e},names:["eqearth","Equal Earth","Equal_Earth"]};var k0=1e-10;function dQ(e){var r,s,l,t=It(e.x-(this.long0||0)),n=e.y;return r=this.am1+this.m1-Cg(n,s=Math.sin(n),l=Math.cos(n),this.en),s=l*t/(r*Math.sqrt(1-this.es*s*s)),e.x=r*Math.sin(s),e.y=this.am1-r*Math.cos(s),e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function hQ(e){var t,n,r,s;if(e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a,n=ra(e.x,e.y=this.am1-e.y),s=xw(this.am1+this.m1-n,this.es,this.en),(t=Math.abs(s))<ot)t=Math.sin(s),r=n*Math.atan2(e.x,e.y)*Math.sqrt(1-this.es*t*t)/Math.cos(s);else{if(!(Math.abs(t-ot)<=k0))throw new Error;r=0}return e.x=It(r+(this.long0||0)),e.y=Th(s),e}function fQ(e){var r,s,t=It(e.x-(this.long0||0)),n=e.y;return s=this.cphi1+this.phi1-n,Math.abs(s)>k0?(e.x=s*Math.sin(r=t*Math.cos(n)/s),e.y=this.cphi1-s*Math.cos(r)):e.x=e.y=0,e.x=this.a*e.x+(this.x0||0),e.y=this.a*e.y+(this.y0||0),e}function pQ(e){e.x=(e.x-(this.x0||0))/this.a,e.y=(e.y-(this.y0||0))/this.a;var t,n,r=ra(e.x,e.y=this.cphi1-e.y);if(n=this.cphi1+this.phi1-r,Math.abs(n)>ot)throw new Error;return t=Math.abs(Math.abs(n)-ot)<=k0?0:r*Math.atan2(e.x,e.y)/Math.cos(n),e.x=It(t+(this.long0||0)),e.y=Th(n),e}const mQ={init:function uQ(){var e;if(this.phi1=this.lat1,Math.abs(this.phi1)<k0)throw new Error;this.es?(this.en=bw(this.es),this.m1=Cg(this.phi1,this.am1=Math.sin(this.phi1),e=Math.cos(this.phi1),this.en),this.am1=e/(Math.sqrt(1-this.es*this.am1*this.am1)*this.am1),this.inverse=hQ,this.forward=dQ):(this.cphi1=Math.abs(this.phi1)+k0>=ot?0:1/Math.tan(this.phi1),this.inverse=pQ,this.forward=fQ)},names:["bonne","Bonne (Werner lat_1=90)"]},RD=Object.assign(function DZ(e,t,n){var r,s,d,l=!1;return typeof t>"u"?(s=uv(e),r=gD,l=!0):(typeof t.x<"u"||Array.isArray(t))&&(n=t,s=uv(e),r=gD,l=!0),r||(r=uv(e)),s||(s=uv(t)),n?_w(r,s,n):(d={forward:function(g,v){return _w(r,s,g,v)},inverse:function(g,v){return _w(s,r,g,v)}},l&&(d.oProj=s),d)},{defaultDatum:"WGS84",Proj:bg,WGS84:new bg("WGS84"),Point:VZ,toPoint:fD,defs:sv,nadgrid:function dZ(e,t,n){return t instanceof ArrayBuffer?function hZ(e,t,n){var r=!0;void 0!==n&&!1===n.includeErrorFields&&(r=!1);var s=new DataView(t),l=function mZ(e){var t=e.getInt32(8,!1);return 11!==t&&(11!==(t=e.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(s),d=function _Z(e,t){return{nFields:e.getInt32(8,t),nSubgridFields:e.getInt32(24,t),nSubgrids:e.getInt32(40,t),shiftType:mw(e,56,64).trim(),fromSemiMajorAxis:e.getFloat64(120,t),fromSemiMinorAxis:e.getFloat64(136,t),toSemiMajorAxis:e.getFloat64(152,t),toSemiMinorAxis:e.getFloat64(168,t)}}(s,l),g=function yZ(e,t,n,r){for(var s=176,l=[],d=0;d<t.nSubgrids;d++){var g=bZ(e,s,n),v=xZ(e,s,g,n,r),M=Math.round(1+(g.upperLongitude-g.lowerLongitude)/g.longitudeInterval),A=Math.round(1+(g.upperLatitude-g.lowerLatitude)/g.latitudeInterval);l.push({ll:[Mh(g.lowerLongitude),Mh(g.lowerLatitude)],del:[Mh(g.longitudeInterval),Mh(g.latitudeInterval)],lim:[M,A],count:g.gridNodeCount,cvs:vZ(v)});var O=16;!1===r&&(O=8),s+=176+g.gridNodeCount*O}return l}(s,d,l,r),v={header:d,subgrids:g};return pw[e]=v,v}(e,t,n):{ready:fZ(e,t)}},transform:cv,mgrs:PZ,version:"__VERSION__"});!function _Q(e){e.Proj.projections.add(dv),e.Proj.projections.add(hv),e.Proj.projections.add(pY),e.Proj.projections.add(SY),e.Proj.projections.add(DY),e.Proj.projections.add(OY),e.Proj.projections.add(jY),e.Proj.projections.add(HY),e.Proj.projections.add(KY),e.Proj.projections.add(tK),e.Proj.projections.add(pK),e.Proj.projections.add(bK),e.Proj.projections.add(EK),e.Proj.projections.add(PK),e.Proj.projections.add(LK),e.Proj.projections.add(VK),e.Proj.projections.add(WK),e.Proj.projections.add(XK),e.Proj.projections.add(rX),e.Proj.projections.add(lX),e.Proj.projections.add(fX),e.Proj.projections.add(yX),e.Proj.projections.add(EX),e.Proj.projections.add(AX),e.Proj.projections.add(NX),e.Proj.projections.add(GX),e.Proj.projections.add(ZX),e.Proj.projections.add(JX),e.Proj.projections.add(oQ),e.Proj.projections.add(cQ),e.Proj.projections.add(mQ)}(RD);const R0=RD;let yQ=(()=>{class e{STANDARD_CRS="EPSG:3857";constructor(){R0.defs("EPSG:4326","+proj=longlat +datum=WGS84 +no_defs"),R0.defs("EPSG:3857","+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs"),R0.defs("EPSG:22175","+proj=tmerc +lat_0=0 +lon_0=-57 +k=1 +x_0=5500000 +y_0=0 +ellps=GRS80 +units=m +no_defs")}KNOWN_CRS={"EPSG:3857":{epsg:"EPSG:3857",name:"Web Mercator",isWebMercator:!0},"EPSG:4326":{epsg:"EPSG:4326",name:"WGS84 Geographic",isWebMercator:!1},"EPSG:22183":{epsg:"EPSG:22183",name:"POSGAR 98 / Argentina 3",isWebMercator:!1},"EPSG:5343":{epsg:"EPSG:5343",name:"POSGAR 2007 / Argentina 3",isWebMercator:!1}};getStandardCRS(){return this.STANDARD_CRS}isWebMercatorCompatible(n){if(!n)return!0;const r=this.KNOWN_CRS[n.toUpperCase()];return!!r&&r.isWebMercator}getCRSInfo(n){return n?this.KNOWN_CRS[n.toUpperCase()]||null:this.KNOWN_CRS[this.STANDARD_CRS]}extractFirstCoordinate(n){if(!n||!n.coordinates)return null;switch(n.type){case"Point":return n.coordinates;case"LineString":case"MultiPoint":return n.coordinates[0];case"Polygon":case"MultiLineString":return n.coordinates[0][0];case"MultiPolygon":return n.coordinates[0][0][0];default:return null}}detectCRSFromCoordinates(n,r){return Math.abs(n)>180&&Math.abs(r)>90?"EPSG:3857":n>=-75&&n<=-53&&r>=-55&&r<=-21?"EPSG:4326":n>1e6&&n<8e6&&r>1e6&&r<8e6?"EPSG:22183":"EPSG:4326"}transformGeoJSON(n,r){var s=this;return Tn(function*(l,d,g="EPSG:4326"){if(d?.toUpperCase()===g?.toUpperCase())return(yield fetch(l)).json();try{const M=yield(yield fetch(l)).json();try{const A=s.extractFirstCoordinate(M.features?.[0]?.geometry);A&&R0(d,g,A)}catch{}return s.transformGeoJSONCoordinates(M,d,g)}catch(v){throw console.error(`Error transformando GeoJSON de ${d} a ${g}:`,v),v}}).apply(this,arguments)}transformGeoJSONCoordinates(n,r,s){const l=JSON.parse(JSON.stringify(n));return l.features&&l.features.forEach(d=>{d.geometry&&this.transformGeometry(d.geometry,r,s)}),l.crs&&("EPSG:4326"===s?delete l.crs:l.crs={type:"name",properties:{name:`urn:ogc:def:crs:${s}`}}),l}transformGeometry(n,r,s){if(n.coordinates)switch(n.type){case"Point":n.coordinates=this.transformCoordinate(n.coordinates,r,s);break;case"LineString":case"MultiPoint":n.coordinates=n.coordinates.map(l=>this.transformCoordinate(l,r,s));break;case"Polygon":case"MultiLineString":n.coordinates=n.coordinates.map(l=>l.map(d=>this.transformCoordinate(d,r,s)));break;case"MultiPolygon":n.coordinates=n.coordinates.map(l=>l.map(d=>d.map(g=>this.transformCoordinate(g,r,s))))}}transformCoordinate(n,r,s){try{let l=n;return"EPSG:22175"===r&&(l=[-Math.abs(n[0]),-Math.abs(n[1])]),R0(r,s,l)}catch(l){return console.warn(`Error transformando coordenada de ${r} a ${s}:`,l),n}}static \u0275fac=function(r){return new(r||e)};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})(),vQ=(()=>{class e{coordinateSystemService;constructor(n){this.coordinateSystemService=n}getAvailableLayers(){return this.layerMetadata.filter(n=>n.enabled)}getDefaultLayer(){return this.layerMetadata[0].id}getSources(){return{osm:{type:"raster",tiles:["https://tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256,attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},esriWorldImagery:{type:"raster",tiles:["https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"],tileSize:256,attribution:"Tiles \xa9 Esri \u2014 Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"},googleSatellite:{type:"raster",tiles:["https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}"],tileSize:256,maxzoom:21,attribution:"\xa9 Google Maps"},argenMap:{type:"raster",tiles:["https://wms.ign.gob.ar/geoserver/gwc/service/tms/1.0.0/capabaseargenmap@EPSG%3A3857@png/{z}/{x}/{y}.png"],tileSize:256,maxzoom:21,attribution:"\xa9 IGN Argentina",scheme:"tms"},googleMaps:{type:"raster",tiles:["https://mt1.google.com/vt/lyrs=m&x={x}&y={y}&z={z}"],tileSize:256,maxzoom:21,attribution:"\xa9 Google Maps"},googleHybrid:{type:"raster",tiles:["https://mt1.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}"],tileSize:256,maxzoom:21,attribution:"\xa9 Google Maps"},esriTransportation:{type:"raster",tiles:["https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}"],tileSize:256,attribution:"\xa9 Esri"},comisarias:{type:"geojson",data:"assets/json/comisarias.geojson"},escuelas:{type:"geojson",data:"assets/json/escuelas.geojson"},partidos:{type:"geojson",data:"assets/json/partidos.geojson"},hidro:{type:"geojson",data:"assets/json/hidro.geojson"},localidades:{type:"geojson",data:"assets/json/localidades.geojson"},provincias:{type:"geojson",data:"assets/json/provincias.geojson"},rutas:{type:"geojson",data:"assets/json/rutas.geojson"}}}getLayers(){return[{id:"osm-tiles",type:"raster",source:"osm"},{id:"esri-satellite-tiles",type:"raster",source:"esriWorldImagery",layout:{visibility:"none"}},{id:"google-satellite-tiles",type:"raster",source:"googleSatellite",layout:{visibility:"none"}},{id:"argenmap-tiles",type:"raster",source:"argenMap",layout:{visibility:"none"}},{id:"google-maps-tiles",type:"raster",source:"googleMaps",layout:{visibility:"none"}},{id:"google-hybrid-tiles",type:"raster",source:"googleHybrid",layout:{visibility:"none"}},{id:"esri-transportation-tiles",type:"raster",source:"esriTransportation",layout:{visibility:"none"}},{id:"comisarias",type:"circle",source:"comisarias",layout:{visibility:"none"},paint:{"circle-radius":6,"circle-color":"#00b300","circle-stroke-width":2,"circle-stroke-color":"#ffffff"}},{id:"escuelas",type:"circle",source:"escuelas",layout:{visibility:"none"},paint:{"circle-radius":6,"circle-color":"#b37400ff","circle-stroke-width":2,"circle-stroke-color":"#ffffff"}},{id:"partidos",type:"fill",source:"partidos",layout:{visibility:"none"},paint:{"fill-color":"#3388ff","fill-opacity":.3,"fill-outline-color":"#2255aa"}},{id:"hidro",type:"line",source:"hidro",layout:{visibility:"none"},paint:{"line-color":"#0000ff","line-width":2}},{id:"localidades",type:"circle",source:"localidades",layout:{visibility:"none"},paint:{"circle-radius":6,"circle-color":"rgba(44, 187, 0, 1)"}},{id:"provincias",type:"fill",source:"provincias",layout:{visibility:"none"},paint:{"fill-color":"#3388ff","fill-opacity":.3,"fill-outline-color":"#aa2276ff"}},{id:"rutas",type:"line",source:"rutas",layout:{visibility:"none"},paint:{"line-color":"#ff0000","line-width":2}}]}layerMetadata=[{id:"osm-tiles",sourceId:"osm",displayName:"OpenStreetMap",enabled:!0},{id:"esri-satellite-tiles",sourceId:"esriWorldImagery",displayName:"Sat\xe9lite (Esri)",enabled:!0},{id:"argenmap-tiles",sourceId:"argenMap",displayName:"ArgenMap (IGN)",enabled:!0},{id:"google-maps-tiles",sourceId:"googleMaps",displayName:"Google Maps",enabled:!0},{id:"google-hybrid-tiles",sourceId:"googleHybrid",displayName:"Google H\xedbrido",enabled:!0},{id:"google-satellite-tiles",sourceId:"googleSatellite",displayName:"Google Sat\xe9lite",enabled:!0},{id:"esri-transportation-tiles",sourceId:"esriTransportation",displayName:"Esri Transporte",enabled:!0}];overlayMetadata=[{id:"comisarias",sourceId:"comisarias",displayName:"Comisar\xedas",enabled:!0,visible:!1,crs:"EPSG:4326"},{id:"escuelas",sourceId:"escuelas",displayName:"Escuelas",enabled:!0,visible:!1,crs:"EPSG:4326"},{id:"partidos",sourceId:"partidos",displayName:"Partidos",enabled:!0,visible:!1,crs:"EPSG:4326"},{id:"hidro",sourceId:"hidro",displayName:"Hidrograf\xeda",enabled:!0,visible:!1,crs:"EPSG:4326"},{id:"localidades",sourceId:"localidades",displayName:"Localidades",enabled:!0,visible:!1,crs:"EPSG:4326"},{id:"provincias",sourceId:"provincias",displayName:"Provincias",enabled:!0,visible:!1,crs:"EPSG:4326"},{id:"rutas",sourceId:"rutas",displayName:"Rutas",enabled:!0,visible:!1,crs:"EPSG:4326"}];getAvailableOverlays(){return this.overlayMetadata.filter(n=>n.enabled)}getMapStyle(){return{version:8,sources:this.getSources(),layers:this.getLayers()}}static \u0275fac=function(r){return new(r||e)(p.KVO(yQ))};static \u0275prov=p.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();const bQ=["mapContainer"];let xQ=(()=>{class e{layersService;mapContainer;map;currentLayerId="";availableLayers=[];availableOverlays=[];constructor(n){this.layersService=n}ngOnInit(){this.availableLayers=this.layersService.getAvailableLayers(),this.availableOverlays=this.layersService.getAvailableOverlays(),this.currentLayerId=this.layersService.getDefaultLayer(),this.initializeMap()}initializeMap(){var n=this;return Tn(function*(){const r=n.layersService.getMapStyle();n.map=new tv.Map({container:n.mapContainer.nativeElement,style:r,center:[-58.3816,-34.6037],zoom:5,attributionControl:!1}),n.map.addControl(new tv.NavigationControl({visualizePitch:!0}),"top-right"),n.map.addControl(new tv.AttributionControl,"bottom-left"),n.map.on("click",v=>{const M=n.availableOverlays.filter(X=>"visible"===n.map.getLayoutProperty(X.id,"visibility")).map(X=>X.id);if(0===M.length)return;const A=n.map.queryRenderedFeatures(v.point,{layers:M});if(!A.length)return;const j=A[0].properties;let B="<table>";for(const X in j)B+=`<tr><th style="text-align:left; padding-right:8px;">${X}</th><td>${j[X]}</td></tr>`;B+="</table>",(new tv.Popup).setLngLat(v.lngLat).setHTML(B).addTo(n.map)});const s=n;let l,d;n.map.addControl({onAdd(){const v=document.createElement("div");v.className="maplibregl-ctrl maplibregl-ctrl-group";const M=document.createElement("select");if(M.title="Seleccionar capa base",M.setAttribute("aria-label","Seleccionar capa base"),s.availableLayers.map(O=>({value:O.id,text:O.displayName})).forEach(O=>{const j=document.createElement("option");j.value=O.value,j.textContent=O.text,j.selected=O.value===s.currentLayerId,M.appendChild(j)}),M.style.width="auto",M.style.minWidth="140px",M.style.padding="4px 8px",M.style.fontSize="12px",M.style.border="none",M.style.background="white",M.style.cursor="pointer",M.addEventListener("change",()=>{s.switchToLayer(M.value)}),v.appendChild(M),s.availableOverlays.length>0){const O=document.createElement("div");O.style.marginTop="8px",O.style.padding="4px 8px",O.style.background="white",O.style.borderTop="1px solid #ccc";const j=document.createElement("div");j.textContent="Capas superpuestas:",j.style.fontSize="11px",j.style.fontWeight="bold",j.style.marginBottom="4px",O.appendChild(j),s.availableOverlays.forEach(B=>{const X=document.createElement("div");X.style.display="flex",X.style.alignItems="center",X.style.marginBottom="2px";const le=document.createElement("input");le.type="checkbox",le.id=`overlay-${B.id}`,le.checked=B.visible,le.style.marginRight="6px";const _e=document.createElement("label");_e.setAttribute("for",`overlay-${B.id}`),_e.textContent=B.displayName,_e.style.fontSize="11px",_e.style.cursor="pointer",le.addEventListener("change",()=>{s.toggleOverlay(B.id,le.checked)}),X.appendChild(le),X.appendChild(_e),O.appendChild(X)}),v.appendChild(O)}return l=v,d=M,v},onRemove(){l&&l.parentNode&&l.parentNode.removeChild(l),l=void 0,d=void 0}},"top-left")})()}switchToLayer(n){this.map&&(this.availableLayers.forEach(r=>{this.map.setLayoutProperty(r.id,"visibility","none")}),this.map.setLayoutProperty(n,"visibility","visible"),this.currentLayerId=n)}toggleOverlay(n,r){if(!this.map)return;this.map.setLayoutProperty(n,"visibility",r?"visible":"none");const s=this.availableOverlays.find(l=>l.id===n);s&&(s.visible=r)}ngOnDestroy(){this.map?.remove()}static \u0275fac=function(r){return new(r||e)(h(vQ))};static \u0275cmp=Wu({type:e,selectors:[["app-mapa"]],viewQuery:function(r,s){if(1&r&&GS(bQ,7),2&r){let l;Ef(l=Mf())&&(s.mapContainer=l.first)}},decls:2,vars:0,consts:[["mapContainer",""],[1,"map-container"]],template:function(r,s){1&r&&Om(0,"div",1,0)},dependencies:[dq],styles:["[_nghost-%COMP%]{display:block;width:100%;height:100vh}.map-container[_ngcontent-%COMP%]{width:100%;height:100%}[_nghost-%COMP%]     .maplibregl-popup-content{background:#23272f;color:#fff;border-radius:10px;font-size:1.1em;box-shadow:0 2px 12px #00000040;padding:16px 20px;max-width:740px;min-width:420px;overflow-x:auto;word-break:break-word}[_nghost-%COMP%]     .maplibregl-popup-tip{border-top-color:#23272f!important}[_nghost-%COMP%]     .maplibregl-popup-content table{width:100%;border-collapse:collapse}[_nghost-%COMP%]     .maplibregl-popup-content th, [_nghost-%COMP%]     .maplibregl-popup-content td{padding:4px 8px;border-bottom:1px solid #444}[_nghost-%COMP%]     .maplibregl-popup-content th{font-weight:700;color:#90caf9;background:transparent}[_nghost-%COMP%]     .maplibregl-popup-content tr:last-child td{border-bottom:none}"]})}return e})();(function LL(e,t){return function f4(e){Ue(8);try{const{rootComponent:t,appProviders:n,platformProviders:r}=e,s=n4(r),l=[C1({}),{provide:p.hk6,useExisting:M1},p.gv8,...n||[]];return function uM(e){const t=$m(e)?e.r3Injector:e.moduleRef.injector,n=t.get(jn);return n.run(()=>{$m(e)?e.r3Injector.resolveInjectorInitializers():e.moduleRef.resolveInjectorInitializers();const r=t.get(p.ZTf);let s;if(n.runOutsideAngular(()=>{s=n.onError.subscribe({next:r})}),$m(e)){const l=()=>t.destroy(),d=e.platformInjector.get(cy);d.add(l),t.onDestroy(()=>{s.unsubscribe(),d.delete(l)})}else{const l=()=>e.moduleRef.destroy(),d=e.platformInjector.get(cy);d.add(l),e.moduleRef.onDestroy(()=>{z_(e.allPlatformModules,e.moduleRef),s.unsubscribe(),d.delete(l)})}return function JN(e,t,n){try{const r=n();return B_(r)?r.catch(s=>{throw t.runOutsideAngular(()=>e(s)),s}):r}catch(r){throw t.runOutsideAngular(()=>e(r)),r}}(r,n,()=>{const l=t.get(p.rev),d=l.add(),g=t.get(YC);return g.runInitializers(),g.donePromise.then(()=>{if(function oR(e){"string"==typeof e&&(CS=e.toLowerCase().replace(/_/g,"-"))}(t.get(gh,q_)||q_),!t.get(XN,!0))return $m(e)?t.get(ch):(e.allPlatformModules.push(e.moduleRef),e.moduleRef);if($m(e)){const A=t.get(ch);return void 0!==e.rootComponent&&A.bootstrap(e.rootComponent),A}return dM?.(e.moduleRef,e.allPlatformModules),e.moduleRef}).finally(()=>{l.remove(d)})})})}({r3Injector:new Kw({providers:l,parent:s,debugName:"",runEnvironmentInitializers:!1}).injector,platformInjector:s,rootComponent:t})}catch(t){return Promise.reject(t)}finally{Ue(9)}}({rootComponent:e,...s2(t)})})((()=>{class e{title="mapLibre";static \u0275fac=function(r){return new(r||e)};static \u0275cmp=Wu({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(r,s){1&r&&fh(0,"app-mapa")},dependencies:[xQ],encapsulation:2})}return e})(),xW).catch(e=>console.error(e))},440:(Xr,cn,dt)=>{"use strict";function p(Le,gt){return Object.is(Le,gt)}dt.d(cn,{Ag:()=>Qo,Bg:()=>zt,EF:()=>an,H8:()=>p,Ht:()=>yn,JC:()=>Ut,KE:()=>mt,KO:()=>vo,KZ:()=>Wn,Ny:()=>Vn,TO:()=>_r,Wu:()=>Vo,XR:()=>Nt,a7:()=>gn,bh:()=>En,j2:()=>Lt,mC:()=>li,mK:()=>_t,n5:()=>Or,nR:()=>vn,pL:()=>Qe,s0:()=>Nr,si:()=>Cn});let St=null,W=!1,y=1,Ye=null;const En=Symbol("SIGNAL");function yn(Le){const gt=St;return St=Le,gt}function vn(){return St}function mt(){return W}const Qe={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function _t(Le){if(W)throw new Error("");if(null===St)return;St.consumerOnSignalRead(Le);const gt=St.producersTail;if(void 0!==gt&&gt.producer===Le)return;let At;const Vt=St.recomputing;if(Vt&&(At=void 0!==gt?gt.nextProducer:St.producers,void 0!==At&&At.producer===Le))return St.producersTail=At,void(At.lastReadVersion=Le.version);const bn=Le.consumersTail;if(void 0!==bn&&bn.consumer===St&&(!Vt||function Sr(Le,gt){const At=gt.producersTail;if(void 0!==At){let Vt=gt.producers;do{if(Vt===Le)return!0;if(Vt===At)break;Vt=Vt.nextProducer}while(void 0!==Vt)}return!1}(bn,St)))return;const Lr=Tn(St),ao={producer:Le,consumer:St,nextProducer:At,prevConsumer:bn,lastReadVersion:Le.version,nextConsumer:void 0};St.producersTail=ao,void 0!==gt?gt.nextProducer=ao:St.producers=ao,Lr&&Ge(Le,ao)}function Ut(Le){if((!Tn(Le)||Le.dirty)&&(Le.dirty||Le.lastCleanEpoch!==y)){if(!Le.producerMustRecompute(Le)&&!Cn(Le))return void _r(Le);Le.producerRecomputeValue(Le),_r(Le)}}function Gt(Le){if(void 0===Le.consumers)return;const gt=W;W=!0;try{for(let At=Le.consumers;void 0!==At;At=At.nextConsumer){const Vt=At.consumer;Vt.dirty||Mn(Vt)}}finally{W=gt}}function sn(){return!1!==St?.consumerAllowSignalWrites}function Mn(Le){Le.dirty=!0,Gt(Le),Le.consumerMarkedDirty?.(Le)}function _r(Le){Le.dirty=!1,Le.lastCleanEpoch=y}function zt(Le){return Le&&(Le.producersTail=void 0,Le.recomputing=!0),yn(Le)}function Vo(Le,gt){if(yn(gt),!Le)return;Le.recomputing=!1;const At=Le.producersTail;let Vt=void 0!==At?At.nextProducer:Le.producers;if(void 0!==Vt){if(Tn(Le))do{Vt=ir(Vt)}while(void 0!==Vt);void 0!==At?At.nextProducer=void 0:Le.producers=void 0}}function Cn(Le){for(let gt=Le.producers;void 0!==gt;gt=gt.nextProducer){const At=gt.producer,Vt=gt.lastReadVersion;if(Vt!==At.version||(Ut(At),Vt!==At.version))return!0}return!1}function Nt(Le){if(Tn(Le)){let gt=Le.producers;for(;void 0!==gt;)gt=ir(gt)}Le.producers=void 0,Le.producersTail=void 0,Le.consumers=void 0,Le.consumersTail=void 0}function Ge(Le,gt){const At=Le.consumersTail,Vt=Tn(Le);if(void 0!==At?(gt.nextConsumer=At.nextConsumer,At.nextConsumer=gt):(gt.nextConsumer=void 0,Le.consumers=gt),gt.prevConsumer=At,Le.consumersTail=gt,!Vt)for(let bn=Le.producers;void 0!==bn;bn=bn.nextProducer)Ge(bn.producer,bn)}function ir(Le){const gt=Le.producer,At=Le.nextProducer,Vt=Le.nextConsumer,bn=Le.prevConsumer;if(Le.nextConsumer=void 0,Le.prevConsumer=void 0,void 0!==Vt?Vt.prevConsumer=bn:gt.consumersTail=bn,void 0!==bn)bn.nextConsumer=Vt;else if(gt.consumers=Vt,!Tn(gt)){let Lr=gt.producers;for(;void 0!==Lr;)Lr=ir(Lr)}return At}function Tn(Le){return Le.consumerIsAlwaysLive||void 0!==Le.consumers}function gn(Le){Ye?.(Le)}function Wn(Le,gt){const At=Object.create(fn);At.computation=Le,void 0!==gt&&(At.equal=gt);const Vt=()=>{if(Ut(At),_t(At),At.value===an)throw At.error;return At.value};return Vt[En]=At,gn(At),Vt}const Qo=Symbol("UNSET"),Vn=Symbol("COMPUTING"),an=Symbol("ERRORED"),fn={...Qe,value:Qo,dirty:!0,error:null,equal:p,kind:"computed",producerMustRecompute:Le=>Le.value===Qo||Le.value===Vn,producerRecomputeValue(Le){if(Le.value===Vn)throw new Error("");const gt=Le.value;Le.value=Vn;const At=zt(Le);let Vt,bn=!1;try{Vt=Le.computation(),yn(null),bn=gt!==Qo&&gt!==an&&Vt!==an&&Le.equal(gt,Vt)}catch(Lr){Vt=an,Le.error=Lr}finally{Vo(Le,At)}bn?Le.value=gt:(Le.value=Vt,Le.version++)}};let yo=function Un(){throw new Error};function Rr(Le){yo(Le)}function vo(Le){yo=Le}let Uo=null;function Or(Le,gt){const At=Object.create(Nr);At.value=Le,void 0!==gt&&(At.equal=gt);const Vt=()=>function Qn(Le){return _t(Le),Le.value}(At);return Vt[En]=At,gn(At),[Vt,ao=>Lt(At,ao),ao=>li(At,ao)]}function Lt(Le,gt){sn()||Rr(Le),Le.equal(Le.value,gt)||(Le.value=gt,function Jn(Le){Le.version++,function Ht(){y++}(),Gt(Le),Uo?.(Le)}(Le))}function li(Le,gt){sn()||Rr(Le),Lt(Le,gt(Le.value))}const Nr={...Qe,equal:p,value:void 0,kind:"signal"}},494:(Xr,cn,dt)=>{"use strict";dt.d(cn,{s:()=>p});const p="function"==typeof Symbol&&Symbol.observable||"@@observable"},615:(Xr,cn,dt)=>{"use strict";let p;function St(){return p}function W(k){const G=p;return p=k,G}dt.d(cn,{JEi:()=>mc,EJG:()=>cd,Yrj:()=>ud,VVG:()=>to,Y20:()=>wl,SKP:()=>fc,hk6:()=>Lc,eVN:()=>Vi,b5C:()=>Ba,rQE:()=>Ns,X5O:()=>is,qFA:()=>hd,qQL:()=>ri,abz:()=>Ci,tQN:()=>xl,pcR:()=>bl,oMQ:()=>Ah,Mlv:()=>ts,MZA:()=>ks,M0L:()=>su,Z63:()=>co,VML:()=>$i,uvJ:()=>ti,zcH:()=>on,Wg1:()=>Hr,Yw1:()=>_c,jgP:()=>Li,tcA:()=>Fa,ID:()=>mi,YEL:()=>pc,B9r:()=>ns,GBX:()=>wo,ZTf:()=>ds,nKC:()=>qn,zZn:()=>Hs,rJ1:()=>pu,nfM:()=>lu,s6P:()=>au,K29:()=>La,CQl:()=>bt,p9y:()=>Zt,zSs:()=>Et,ONQ:()=>ci,hmW:()=>Jt,yAH:()=>ki,KXn:()=>cs,oTH:()=>pi,Czx:()=>Fi,f7T:()=>Wo,wVl:()=>yl,GYQ:()=>hs,u5s:()=>Td,rev:()=>Mu,Ds7:()=>vl,e5P:()=>da,Iaj:()=>dd,GpT:()=>gc,buA:()=>Ht,AQb:()=>Yn,jNX:()=>fu,eDl:()=>vr,qlT:()=>ha,bm_:()=>Ph,r4V:()=>Eu,ok8:()=>_t,Evm:()=>Md,Jy$:()=>So,laP:()=>sn,EYC:()=>pl,ng7:()=>sd,llW:()=>fi,gsJ:()=>dc,GZS:()=>Sl,iYM:()=>Qn,PEr:()=>zs,z7f:()=>li,LZP:()=>oa,Xln:()=>an,yzR:()=>El,TWe:()=>du,LIA:()=>Vn,GWr:()=>Uo,pbo:()=>Or,bBq:()=>ja,Af3:()=>ld,zQk:()=>pa,oZy:()=>Va,tF7:()=>Nr,ZFY:()=>di,cP4:()=>zi,MdC:()=>uu,XvL:()=>Rr,KET:()=>bc,Tkx:()=>_d,iw4:()=>fn,tdH:()=>Bl,pr_:()=>Le,IAh:()=>yo,U45:()=>Sr,WrV:()=>Wn,kNT:()=>Jn,MI:()=>md,biv:()=>Rh,ZQF:()=>Un,Cv0:()=>Qo,W0r:()=>vc,R2n:()=>Bs,O8q:()=>Vf,VKj:()=>gd,Rom:()=>cu,z6V:()=>nu,n$e:()=>Nt,hjC:()=>ko,Pz9:()=>Xa,PQT:()=>Qr,VX4:()=>ur,_Z$:()=>sr,N79:()=>bd,xLP:()=>ou,zuh:()=>Ve,BI7:()=>Ee,U7d:()=>we,uXy:()=>Ne,nZS:()=>be,ihb:()=>wa,ID8:()=>fo,gv8:()=>xu,dwj:()=>Vo,Bqz:()=>uc,OsK:()=>Gt,Rfq:()=>Tn,kRk:()=>Gi,c$7:()=>Pc,gxQ:()=>No,ckz:()=>kl,kLh:()=>zt,xUg:()=>Qt,KdJ:()=>_i,db4:()=>ni,VPL:()=>Ol,MT:()=>Bh,Z9v:()=>Rc,Ab:()=>xa,w7Z:()=>zh,Mx4:()=>Dc,veI:()=>ba,HaV:()=>Ra,Agf:()=>ca,znI:()=>Oh,wGu:()=>hi,ebl:()=>Pi,OAn:()=>va,_0$:()=>Al,UaU:()=>Vh,vaC:()=>wc,d31:()=>Cc,ZRn:()=>yd,phH:()=>$o,WbQ:()=>Ni,WB9:()=>Rs,d_l:()=>en,vNG:()=>Pl,oyA:()=>ml,_px:()=>Za,CpD:()=>Co,XRZ:()=>ga,klJ:()=>Tc,Fje:()=>mu,b$O:()=>Ha,SMZ:()=>_r,WQX:()=>xo,MzJ:()=>cc,jXY:()=>Dn,MME:()=>ln,JlV:()=>Fs,Qs1:()=>fd,srX:()=>za,vOT:()=>Il,YWB:()=>wd,EPY:()=>fa,yoD:()=>Ls,P3H:()=>Lh,Jzi:()=>cr,rFz:()=>_u,JjR:()=>Us,M6u:()=>Os,KtD:()=>$a,muV:()=>Lr,A0l:()=>Oo,q$2:()=>Cl,yP_:()=>Fn,EFk:()=>pd,Hps:()=>Nc,UhH:()=>Rl,QuC:()=>uo,Y3W:()=>Ho,n$r:()=>Ed,K7h:()=>er,FRF:()=>gl,ezK:()=>Jo,m7n:()=>Gf,niQ:()=>Cd,krE:()=>Vs,bll:()=>Nl,Hh6:()=>Tl,EmA:()=>Mr,blu:()=>ss,HAh:()=>_a,WfI:()=>la,xbp:()=>Fh,jvu:()=>bu,lQ1:()=>Tu,gOD:()=>Sd,Rc9:()=>Ro,E6O:()=>iu,DyX:()=>gu,eFE:()=>Zn,dMS:()=>ya,HUe:()=>ma,nl4:()=>gn,N4e:()=>$r,XaM:()=>Ue,YXz:()=>Ka,Kw3:()=>kc,vQI:()=>Wa,RZ9:()=>Oc,GA0:()=>vu,iMd:()=>Ac,Pfq:()=>Nh,xyx:()=>as,a2B:()=>Fr,kcM:()=>te,DFp:()=>Ao,P2g:()=>yu,cBl:()=>vi,ypq:()=>jh,vPA:()=>Cu,HO5:()=>Su,M_e:()=>Ua,B22:()=>Uf,ik5:()=>ji,AsM:()=>Cn,PP7:()=>Gn,$8:()=>Lt,$Hz:()=>at,zAe:()=>Ml,IvY:()=>xc,_gW:()=>Sc,F1c:()=>Ga,ITl:()=>Dl,brz:()=>Ur,jRZ:()=>yi,SX7:()=>Uh,jDH:()=>gt,G2t:()=>Vt,fuf:()=>Mc,cSN:()=>xd,KVO:()=>Oi,dmw:()=>Pa,joV:()=>wi,By9:()=>Ll,qSk:()=>xi,Njj:()=>Ui,eBV:()=>Ic});const Ye=Symbol("NotFound");function yn(k){return k===Ye||"\u0275NotFound"===k?.name}Error;var vn=dt(440),mt=dt(412),Ce=dt(985);const _t="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss";class Ht extends Error{code;constructor(G,ae){super(Gt(G,ae)),this.code=G}}function Gt(k,G){return`${function Ut(k){return`NG0${Math.abs(k)}`}(k)}${G?": "+G:""}`}const sn=globalThis;function _r(){return!1}function zt(k){for(let G in k)if(k[G]===zt)return G;throw Error("")}function Vo(k,G){for(const ae in G)G.hasOwnProperty(ae)&&!k.hasOwnProperty(ae)&&(k[ae]=G[ae])}function Cn(k){if("string"==typeof k)return k;if(Array.isArray(k))return`[${k.map(Cn).join(", ")}]`;if(null==k)return""+k;const G=k.overriddenName||k.name;if(G)return`${G}`;const ae=k.toString();if(null==ae)return""+ae;const Ae=ae.indexOf("\n");return Ae>=0?ae.slice(0,Ae):ae}function Nt(k,G){return k?G?`${k} ${G}`:k:G||""}const ir=zt({__forward_ref__:zt});function Tn(k){return k.__forward_ref__=Tn,k.toString=function(){return Cn(this())},k}function gn(k){return cr(k)?k():k}function cr(k){return"function"==typeof k&&k.hasOwnProperty(ir)&&k.__forward_ref__===Tn}function Sr(k,G){"number"!=typeof k&&Lt(G,typeof k,"number","===")}function Wn(k,G,ae){Sr(k,"Expected a number"),function vo(k,G,ae){k<=G||Lt(ae,k,G,"<=")}(k,ae,"Expected number to be less than or equal to"),Or(k,G,"Expected number to be greater than or equal to")}function Qo(k,G){"string"!=typeof k&&Lt(G,null===k?"null":typeof k,"string","===")}function Vn(k,G){"function"!=typeof k&&Lt(G,null===k?"null":typeof k,"function","===")}function an(k,G,ae){k!=G&&Lt(ae,k,G,"==")}function fn(k,G,ae){k==G&&Lt(ae,k,G,"!=")}function Un(k,G,ae){k!==G&&Lt(ae,k,G,"===")}function yo(k,G,ae){k===G&&Lt(ae,k,G,"!==")}function Rr(k,G,ae){k<G||Lt(ae,k,G,"<")}function Uo(k,G,ae){k>G||Lt(ae,k,G,">")}function Or(k,G,ae){k>=G||Lt(ae,k,G,">=")}function Qn(k,G){null==k&&Lt(G,k,null,"!=")}function Lt(k,G,ae,Ae){throw new Error(`ASSERTION ERROR: ${k}`+(null==Ae?"":` [Expected=> ${ae} ${Ae} ${G} <=Actual]`))}function li(k){k instanceof Node||Lt(`The provided value must be an instance of a DOM Node but got ${Cn(k)}`)}function oa(k){k instanceof Element||Lt(`The provided value must be an element but got ${Cn(k)}`)}function Nr(k,G){Qn(k,"Array must be defined.");const ae=k.length;(G<0||G>=ae)&&Lt(`Index expected to be less than ${ae} but got ${G}`)}function Jn(k,...G){if(-1!==G.indexOf(k))return!0;Lt(`Expected value to be one of ${JSON.stringify(G)} but was ${JSON.stringify(k)}.`)}function Le(k){null!==(0,vn.nR)()&&Lt(`${k}() should never be called in a reactive context.`)}function gt(k){return{token:k.token,providedIn:k.providedIn||null,factory:k.factory,value:void 0}}function Vt(k){return{providers:k.providers||[],imports:k.imports||[]}}function bn(k){return function ao(k,G){return k.hasOwnProperty(G)&&k[G]||null}(k,ki)}function Lr(k){return null!==bn(k)}function Pi(k){return k&&k.hasOwnProperty(ci)?k[ci]:null}const ki=zt({\u0275prov:zt}),ci=zt({\u0275inj:zt});class qn{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(G,ae){this._desc=G,this.\u0275prov=void 0,"number"==typeof ae?this.__NG_ELEMENT_ID__=ae:void 0!==ae&&(this.\u0275prov=gt({token:this,providedIn:ae.providedIn||"root",factory:ae.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}let Ri;function Go(){return Lt("getInjectorProfilerContext should never be called in production mode"),Ri}function Ao(k){Lt("setInjectorProfilerContext should never be called in production mode");const G=Ri;return Ri=k,G}const xe=[],K=()=>{};function te(k){return Lt("setInjectorProfiler should never be called in production mode"),null!==k?(xe.includes(k)||xe.push(k),()=>function ee(k){const G=xe.indexOf(k);-1!==G&&xe.splice(G,1)}(k)):(xe.length=0,K)}function de(k){Lt("Injector profiler should never be called in production mode");for(let G=0;G<xe.length;G++)(0,xe[G])(k)}function be(k,G=!1){let ae;Lt("Injector profiler should never be called in production mode"),ae="function"==typeof k||k instanceof qn?k:gn(k.provide);let Ae=k;k instanceof qn&&(Ae=k.\u0275prov||k),de({type:2,context:Go(),providerRecord:{token:ae,provider:Ae,isViewProvider:G}})}function we(k){Lt("Injector profiler should never be called in production mode"),de({type:4,context:Go(),token:k})}function Ne(k){Lt("Injector profiler should never be called in production mode"),de({type:1,context:Go(),instance:{value:k}})}function Ee(k,G,ae){Lt("Injector profiler should never be called in production mode"),de({type:0,context:Go(),service:{token:k,value:G,flags:ae}})}function Ve(k){Lt("Injector profiler should never be called in production mode"),de({type:3,context:Go(),effect:k})}function Ue(k,G,ae){Lt("runInInjectorProfilerContext should never be called in production mode");const Ae=Ao({injector:k,token:G});try{ae()}finally{Ao(Ae)}}function We(k){return k&&!!k.\u0275providers}const bt=zt({\u0275cmp:zt}),Me=zt({\u0275dir:zt}),Ft=zt({\u0275pipe:zt}),Jt=zt({\u0275mod:zt}),Et=zt({\u0275fac:zt}),Zt=zt({__NG_ELEMENT_ID__:zt}),kn=zt({__NG_ENV_ID__:zt});function Zn(k){return"string"==typeof k?k:null==k?"":String(k)}function Gn(k){return"function"==typeof k?k.name||k.toString():"object"==typeof k&&null!=k&&"function"==typeof k.type?k.type.name||k.type.toString():Zn(k)}function sr(k){let G=k[bt]||null;return null!==G&&G.debugInfo?function rn(k){return k.filePath&&k.lineNumber?`${k.className} (at ${k.filePath}:${k.lineNumber})`:k.className}(G.debugInfo):Gn(k)}const un=zt({ngErrorCode:zt}),yr=zt({ngErrorMessage:zt}),Ke=zt({ngTokenPath:zt});function Qr(k,G){return Er("",-200,G)}function ur(k,G){return function Kt(k,G){return k.message=function As(k,G,ae=[],Ae=null){let He="";ae&&ae.length>1&&(He=` Path: ${ae.join(" -> ")}.`);return Gt(G,`${k}${Ae?` Source: ${Ae}.`:""}${He}`)}(k[yr]||k.message,k[un],k[Ke],G),k}(Qr(0,G),null)}function at(k,G){throw new Ht(-201,!1)}function Er(k,G,ae){const Ae=new Ht(G,k);return Ae[un]=G,Ae[yr]=k,ae&&(Ae[Ke]=ae),Ae}let jt;function aa(){return jt}function Fr(k){const G=jt;return jt=k,G}function cc(k,G,ae){const Ae=bn(k);return Ae&&"root"==Ae.providedIn?void 0===Ae.value?Ae.value=Ae.factory():Ae.value:8&ae?null:void 0!==G?G:void at()}function di(k){}const Rn={},bo="__NG_DI_FLAG__";class Po{injector;constructor(G){this.injector=G}retrieve(G,ae){const Ae=ko(ae)||0;try{return this.injector.get(G,8&Ae?null:Rn,Ae)}catch(He){if(yn(He))return He;throw He}}}function In(k,G=0){const ae=St();if(void 0===ae)throw new Ht(-203,!1);if(null===ae)return cc(k,void 0,G);{const Ae=function Ps(k){return{optional:!!(8&k),host:!!(1&k),self:!!(2&k),skipSelf:!!(4&k)}}(G),He=ae.retrieve(k,Ae);if(yn(He)){if(Ae.optional)return null;throw He}return He}}function Oi(k,G=0){return(aa()||In)(gn(k),G)}function Pa(k){throw new Ht(202,!1)}function xo(k,G){return Oi(k,ko(G))}function ko(k){return typeof k>"u"||"number"==typeof k?k:0|(k.optional&&8)|(k.host&&1)|(k.self&&2)|(k.skipSelf&&4)}function ka(k){const G=[];for(let ae=0;ae<k.length;ae++){const Ae=gn(k[ae]);if(Array.isArray(Ae)){if(0===Ae.length)throw new Ht(900,!1);let He,ft=0;for(let An=0;An<Ae.length;An++){const Kn=Ae[An],Ir=ru(Kn);"number"==typeof Ir?-1===Ir?He=Kn.token:ft|=Ir:He=Kn}G.push(Oi(He,ft))}else G.push(Oi(Ae))}return G}function nu(k,G){return k[bo]=G,k.prototype[bo]=G,k}function ru(k){return k[bo]}function hi(k,G){return k.hasOwnProperty(Et)?k[Et]:null}function sd(k,G,ae){if(k.length!==G.length)return!1;for(let Ae=0;Ae<k.length;Ae++){let He=k[Ae],ft=G[Ae];if(ae&&(He=ae(He),ft=ae(ft)),ft!==He)return!1}return!0}function uc(k){return k.flat(Number.POSITIVE_INFINITY)}function ou(k,G){k.forEach(ae=>Array.isArray(ae)?ou(ae,G):G(ae))}function pl(k,G,ae){G>=k.length?k.push(ae):k.splice(G,0,ae)}function iu(k,G){return G>=k.length-1?k.pop():k.splice(G,1)[0]}function la(k,G){const ae=[];for(let Ae=0;Ae<k;Ae++)ae.push(G);return ae}function dc(k,G,ae){const Ae=k.length-ae;for(;G<Ae;)k[G]=k[G+ae],G++;for(;ae--;)k.pop()}function fi(k,G,ae,Ae){let He=k.length;if(He==G)k.push(ae,Ae);else if(1===He)k.push(Ae,k[0]),k[0]=ae;else{for(He--,k.push(k[He-1],k[He]);He>G;)k[He]=k[He-2],He--;k[G]=ae,k[G+1]=Ae}}function Jo(k,G,ae){let Ae=gl(k,G);return Ae>=0?k[1|Ae]=ae:(Ae=~Ae,fi(k,Ae,G,ae)),Ae}function er(k,G){const ae=gl(k,G);if(ae>=0)return k[1|ae]}function gl(k,G){return function lo(k,G,ae){let Ae=0,He=k.length>>ae;for(;He!==Ae;){const ft=Ae+(He-Ae>>1),An=k[ft<<ae];if(G===An)return ft<<ae;An>G?He=ft:Ae=ft+1}return~(He<<ae)}(k,G,1)}const ks={},ts=[],co=new qn(""),Xt=new qn("",-1),ns=new qn("");class pi{get(G,ae=Rn){if(ae===Rn){const He=Er("",-201);throw He.name="\u0275NotFound",He}return ae}}function $o(k){return k[Jt]||null}function Ni(k){const G=$o(k);if(!G)throw new Ht(915,!1);return G}function Qt(k){return k[bt]||null}function ca(k){const G=Ra(k);if(!G)throw new Ht(916,!1);return G}function Ra(k){return k[Me]||null}function ml(k){return k[Ft]||null}function uo(k){const G=Qt(k)||Ra(k)||ml(k);return null!==G&&G.standalone}function Mr(k){return{\u0275providers:k}}function Tr(...k){return{\u0275providers:Dn(0,k),\u0275fromNgModule:!0}}function Dn(k,...G){const ae=[],Ae=new Set;let He;const ft=An=>{ae.push(An)};return ou(G,An=>{const Kn=An;Ur(Kn,ft,[],Ae)&&(He||=[],He.push(Kn))}),void 0!==He&&ad(He,ft),ae}function ad(k,G){for(let ae=0;ae<k.length;ae++){const{ngModule:Ae,providers:He}=k[ae];Nn(He,ft=>{G(ft,Ae)})}}function Ur(k,G,ae,Ae){if(!(k=gn(k)))return!1;let He=null,ft=Pi(k);const An=!ft&&Qt(k);if(ft||An){if(An&&!An.standalone)return!1;He=k}else{const Ir=k.ngModule;if(ft=Pi(Ir),!ft)return!1;He=Ir}const Kn=Ae.has(He);if(An){if(Kn)return!1;if(Ae.add(He),An.dependencies){const Ir="function"==typeof An.dependencies?An.dependencies():An.dependencies;for(const Xn of Ir)Ur(Xn,G,ae,Ae)}}else{if(!ft)return!1;{if(null!=ft.imports&&!Kn){let Xn;Ae.add(He);try{ou(ft.imports,wn=>{Ur(wn,G,ae,Ae)&&(Xn||=[],Xn.push(wn))})}finally{}void 0!==Xn&&ad(Xn,G)}if(!Kn){const Xn=hi(He)||(()=>new He);G({provide:He,useFactory:Xn,deps:ts},He),G({provide:ns,useValue:He,multi:!0},He),G({provide:co,useValue:()=>Oi(He),multi:!0},He)}const Ir=ft.providers;if(null!=Ir&&!Kn){const Xn=k;Nn(Ir,wn=>{G(wn,Xn)})}}}return He!==k&&void 0!==k.providers}function Nn(k,G){for(let ae of k)We(ae)&&(ae=ae.\u0275providers),Array.isArray(ae)?Nn(ae,G):G(ae)}const Ln=zt({provide:String,useValue:zt});function rs(k){return null!==k&&"object"==typeof k&&Ln in k}function Ho(k){return"function"==typeof k}function ln(k){return!!k.useClass}const wo=new qn(""),eo={},ei={};let ua;function Rs(){return void 0===ua&&(ua=new pi),ua}class ti{}class da extends ti{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(G,ae,Ae,He){super(),this.parent=ae,this.source=Ae,this.scopes=He,Na(G,An=>this.processProvider(An)),this.records.set(Xt,gi(void 0,this)),He.has("environment")&&this.records.set(ti,gi(void 0,this));const ft=this.records.get(wo);null!=ft&&"string"==typeof ft.value&&this.scopes.add(ft.value),this.injectorDefTypes=new Set(this.get(ns,ts,{self:!0}))}retrieve(G,ae){const Ae=ko(ae)||0;try{return this.get(G,Rn,Ae)}catch(He){if(yn(He))return He;throw He}}destroy(){dr(this),this._destroyed=!0;const G=(0,vn.Ht)(null);try{for(const Ae of this._ngOnDestroyHooks)Ae.ngOnDestroy();const ae=this._onDestroyHooks;this._onDestroyHooks=[];for(const Ae of ae)Ae()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),(0,vn.Ht)(G)}}onDestroy(G){return dr(this),this._onDestroyHooks.push(G),()=>this.removeOnDestroy(G)}runInContext(G){dr(this);const ae=W(this),Ae=Fr(void 0);try{return G()}finally{W(ae),Fr(Ae)}}get(G,ae=Rn,Ae){if(dr(this),G.hasOwnProperty(kn))return G[kn](this);const He=ko(Ae),An=W(this),Kn=Fr(void 0);try{if(!(4&He)){let Xn=this.records.get(G);if(void 0===Xn){const wn=function ar(k){return"function"==typeof k||"object"==typeof k&&"InjectionToken"===k.ngMetadataName}(G)&&bn(G);Xn=wn&&this.injectableDefInScope(wn)?gi(Oa(G),eo):null,this.records.set(G,Xn)}if(null!=Xn)return this.hydrate(G,Xn,He)}return(2&He?Rs():this.parent).get(G,ae=8&He&&ae===Rn?null:ae)}catch(Ir){const Xn=function ui(k){return k[un]}(Ir);throw-200===Xn||-201===Xn?new Ht(Xn,null):Ir}finally{Fr(Kn),W(An)}}resolveInjectorInitializers(){const G=(0,vn.Ht)(null),ae=W(this),Ae=Fr(void 0);try{const ft=this.get(co,ts,{self:!0});for(const An of ft)An()}finally{W(ae),Fr(Ae),(0,vn.Ht)(G)}}toString(){const G=[],ae=this.records;for(const Ae of ae.keys())G.push(Cn(Ae));return`R3Injector[${G.join(", ")}]`}processProvider(G){let ae=Ho(G=gn(G))?G:gn(G&&G.provide);const Ae=function _l(k){return rs(k)?gi(void 0,k.useValue):gi(Ro(k),eo)}(G);if(!Ho(G)&&!0===G.multi){let He=this.records.get(ae);He||(He=gi(void 0,eo,!0),He.factory=()=>ka(He.multi),this.records.set(ae,He)),ae=G,He.multi.push(G)}this.records.set(ae,Ae)}hydrate(G,ae,Ae){const He=(0,vn.Ht)(null);try{if(ae.value===ei)throw Qr(Cn(G));return ae.value===eo&&(ae.value=ei,ae.value=ae.factory(void 0,Ae)),"object"==typeof ae.value&&ae.value&&function os(k){return null!==k&&"object"==typeof k&&"function"==typeof k.ngOnDestroy}(ae.value)&&this._ngOnDestroyHooks.add(ae.value),ae.value}finally{(0,vn.Ht)(He)}}injectableDefInScope(G){if(!G.providedIn)return!1;const ae=gn(G.providedIn);return"string"==typeof ae?"any"===ae||this.scopes.has(ae):this.injectorDefTypes.has(ae)}removeOnDestroy(G){const ae=this._onDestroyHooks.indexOf(G);-1!==ae&&this._onDestroyHooks.splice(ae,1)}}function Oa(k){const G=bn(k),ae=null!==G?G.factory:hi(k);if(null!==ae)return ae;if(k instanceof qn)throw new Ht(204,!1);if(k instanceof Function)return function hc(k){if(k.length>0)throw new Ht(204,!1);const ae=function Ds(k){return(k?.[ki]??null)||null}(k);return null!==ae?()=>ae.factory(k):()=>new k}(k);throw new Ht(204,!1)}function Ro(k,G,ae){let Ae;if(Ho(k)){const He=gn(k);return hi(He)||Oa(He)}if(rs(k))Ae=()=>gn(k.useValue);else if(function Wt(k){return!(!k||!k.useFactory)}(k))Ae=()=>k.useFactory(...ka(k.deps||[]));else if(function Ot(k){return!(!k||!k.useExisting)}(k))Ae=(He,ft)=>Oi(gn(k.useExisting),void 0!==ft&&8&ft?8:void 0);else{const He=gn(k&&(k.useClass||k.provide));if(!function Gr(k){return!!k.deps}(k))return hi(He)||Oa(He);Ae=()=>new He(...ka(k.deps))}return Ae}function dr(k){if(k.destroyed)throw new Ht(205,!1)}function gi(k,G,ae=!1){return{factory:k,value:G,multi:ae?[]:void 0}}function Na(k,G){for(const ae of k)Array.isArray(ae)?Na(ae,G):ae&&We(ae)?Na(ae.\u0275providers,G):G(ae)}function $r(k,G){let ae;k instanceof da?(dr(k),ae=k):ae=new Po(k);const He=W(ae),ft=Fr(void 0);try{return G()}finally{W(He),Fr(ft)}}function Os(){return void 0!==aa()||null!=St()}function ld(k){if(!Os())throw new Ht(-203,!1)}const Li=0,vr=1,Hr=2,Wo=3,La=4,ha=5,Fa=6,to=7,fc=8,pc=9,su=10,gc=11,cd=12,ud=13,is=14,Ba=15,Ns=16,yl=17,vl=18,mi=19,Ah=20,Fi=21,bl=22,xl=23,dd=24,mc=25,_c=26,Bi=1,hd=6,au=7,Ph=8,lu=9,wl=10;function Cl(k){return Array.isArray(k)&&"object"==typeof k[Bi]}function Oo(k){return Array.isArray(k)&&!0===k[Bi]}function za(k){return!!(4&k.flags)}function fd(k){return k.componentOffset>-1}function Ls(k){return!(1&~k.flags)}function Fs(k){return!!k.template}function pd(k){return!!(512&k[Hr])}function fa(k){return!(256&~k[Hr])}function gd(k,G){cu(k,G[vr])}function Vf(k,G){const ae=G+_c;Nr(k,ae),Rr(ae,k[vr].bindingStartIndex,"TNodes should be created before any bindings")}function cu(k,G){Bs(k);const ae=G.data;for(let Ae=_c;Ae<ae.length;Ae++)if(ae[Ae]===k)return;Lt("This TNode does not belong to this TView.")}function Bs(k){Qn(k,"TNode must be defined"),k&&"object"==typeof k&&k.hasOwnProperty("directiveStylingLast")||Lt("Not of type TNode, got: "+k)}function vc(k){Qn(k,"Expected TIcu to be defined"),"number"!=typeof k.currentCaseLViewIndex&&Lt("Object is not of TIcu type.")}function Sl(k,G="Type passed in is not ComponentType, it does not have '\u0275cmp' property."){Qt(k)||Lt(G)}function bc(k,G="Type passed in is not NgModuleType, it does not have '\u0275mod' property."){$o(k)||Lt(G)}function ja(k){Qn(k,"currentTNode should exist!"),Qn(k.parent,"currentTNode should have a parent")}function zi(k){Qn(k,"LContainer must be defined"),an(Oo(k),!0,"Expecting LContainer")}function uu(k){Qn(k,"LView must be defined"),an(Cl(k),!0,"Expecting LView")}function El(k,G){an(k.firstCreatePass,!0,G||"Should only be called in first create pass.")}function du(k,G){an(k.firstUpdatePass,!0,"Should only be called in first update pass.")}function zs(k){(void 0===k.type||null==k.selectors||void 0===k.inputs)&&Lt("Expected a DirectiveDef/ComponentDef and this object does not seem to have the expected shape.")}function pa(k,G){hu(_c,k.bindingStartIndex,G)}function Va(k,G){hu(k[1].expandoStartIndex,k.length,G)}function hu(k,G,ae){k<=ae&&ae<G||Lt(`Index out of range (expecting ${k} <= ${ae} < ${G})`)}function Rh(k,G){Qn(k[Ba],"Component views should exist."),Qn(k[Ba][ha].projection,"Components with projection nodes (<ng-content>) must have projection slots defined.")}function md(k,G){Qn(k,"Component views should always have a parent view (component's host view)")}function _d(k,G){Va(k,G),Va(k,G+8),Sr(k[G+0],"injectorIndex should point to a bloom filter"),Sr(k[G+1],"injectorIndex should point to a bloom filter"),Sr(k[G+2],"injectorIndex should point to a bloom filter"),Sr(k[G+3],"injectorIndex should point to a bloom filter"),Sr(k[G+4],"injectorIndex should point to a bloom filter"),Sr(k[G+5],"injectorIndex should point to a bloom filter"),Sr(k[G+6],"injectorIndex should point to a bloom filter"),Sr(k[G+7],"injectorIndex should point to a bloom filter"),Sr(k[G+8],"injectorIndex should point to parent injector")}const fu="svg",pu="math";function xc(k){for(;Array.isArray(k);)k=k[Li];return k}function Ml(k){for(;Array.isArray(k);){if("object"==typeof k[Bi])return k;k=k[Li]}return null}function wc(k,G){return xc(G[k])}function Cc(k,G){return xc(G[k.index])}function yd(k,G){const ae=null===k?-1:k.index;return-1!==ae?xc(G[ae]):null}function ga(k,G){return k.data[G]}function Tl(k,G){return k[G]}function Ua(k,G,ae,Ae){ae>=k.data.length&&(k.data[ae]=null,k.blueprint[ae]=null),G[ae]=Ae}function _i(k,G){const ae=G[k];return Cl(ae)?ae:ae[Li]}function Il(k){return!(4&~k[Hr])}function Ga(k){return!(128&~k[Hr])}function Dl(k){return Oo(k[Wo])}function ni(k,G){return null==G?null:k[G]}function ma(k){k[yl]=0}function _a(k){1024&k[Hr]||(k[Hr]|=1024,Ga(k)&&ss(k))}function yi(k,G){for(;k>0;)G=G[is],k--;return G}function ya(k){return!!(9216&k[Hr]||k[dd]?.dirty)}function Sc(k){k[su].changeDetectionScheduler?.notify(8),64&k[Hr]&&(k[Hr]|=1024),ya(k)&&ss(k)}function ss(k){k[su].changeDetectionScheduler?.notify(0);let G=Al(k);for(;null!==G&&!(8192&G[Hr])&&(G[Hr]|=8192,Ga(G));)G=Al(G)}function ji(k,G){if(fa(k))throw new Ht(911,!1);null===k[Fi]&&(k[Fi]=[]),k[Fi].push(G)}function gu(k,G){if(null===k[Fi])return;const ae=k[Fi].indexOf(G);-1!==ae&&k[Fi].splice(ae,1)}function Al(k){const G=k[Wo];return Oo(G)?G[Wo]:G}function en(k){return k[to]??=[]}function Pl(k){return k.cleanup??=[]}function Uf(k,G,ae,Ae){const He=en(G);He.push(ae),k.firstCreatePass&&Pl(k).push(Ae,He.length-1)}const qt={lFrame:Ca(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var Vi=function(k){return k[k.Off=0]="Off",k[k.Exhaustive=1]="Exhaustive",k[k.OnlyDirtyViews=2]="OnlyDirtyViews",k}(Vi||{});let Ec=0,vd=!1;function Oh(){return qt.lFrame.elementDepthCount}function mu(){qt.lFrame.elementDepthCount++}function bd(){qt.lFrame.elementDepthCount--}function kl(){return qt.bindingsEnabled}function $a(){return null!==qt.skipHydrationRootTNode}function Rl(k){return qt.skipHydrationRootTNode===k}function xd(){qt.bindingsEnabled=!0}function Mc(){qt.bindingsEnabled=!1}function Vs(){qt.skipHydrationRootTNode=null}function va(){return qt.lFrame.lView}function Tc(){return qt.lFrame.tView}function Ic(k){return qt.lFrame.contextLView=k,k[fc]}function Ui(k){return qt.lFrame.contextLView=null,k}function Dc(){let k=ba();for(;null!==k&&64===k.type;)k=k.parent;return k}function ba(){return qt.lFrame.currentTNode}function xa(){const k=qt.lFrame,G=k.currentTNode;return k.isParent?G:G.parent}function Ac(k,G){const ae=qt.lFrame;ae.currentTNode=k,ae.isParent=G}function wd(){return qt.lFrame.isParent}function Nh(){qt.lFrame.isParent=!1}function Ol(){return qt.lFrame.contextLView}function _u(){return Lt("Must never be called in production mode"),Ec!==Vi.Off}function Lh(){return Lt("Must never be called in production mode"),Ec===Vi.Exhaustive}function yu(k){Lt("Must never be called in production mode"),Ec=k}function Fn(){return vd}function vi(k){const G=vd;return vd=k,G}function No(){const k=qt.lFrame;let G=k.bindingRootIndex;return-1===G&&(G=k.bindingRootIndex=k.tView.bindingStartIndex),G}function Pc(){return qt.lFrame.bindingIndex}function kc(k){return qt.lFrame.bindingIndex=k}function Fh(){return qt.lFrame.bindingIndex++}function Ha(k){const G=qt.lFrame,ae=G.bindingIndex;return G.bindingIndex=G.bindingIndex+k,ae}function Us(){return qt.lFrame.inI18n}function as(k){qt.lFrame.inI18n=k}function Wa(k,G){const ae=qt.lFrame;ae.bindingIndex=ae.bindingRootIndex=k,Oc(G)}function Rc(){return qt.lFrame.currentDirectiveIndex}function Oc(k){qt.lFrame.currentDirectiveIndex=k}function Bh(k){const G=qt.lFrame.currentDirectiveIndex;return-1===G?null:k[G]}function zh(){return qt.lFrame.currentQueryIndex}function vu(k){qt.lFrame.currentQueryIndex=k}function bi(k){const G=k[vr];return 2===G.type?G.declTNode:1===G.type?k[ha]:null}function wa(k,G,ae){if(4&ae){let He=G,ft=k;for(;!(He=He.parent,null!==He||1&ae||(He=bi(ft),null===He||(ft=ft[is],10&He.type))););if(null===He)return!1;G=He,k=ft}const Ae=qt.lFrame=Gs();return Ae.currentTNode=G,Ae.lView=k,!0}function fo(k){const G=Gs(),ae=k[vr];qt.lFrame=G,G.currentTNode=ae.firstChild,G.lView=k,G.tView=ae,G.contextLView=k,G.bindingIndex=ae.bindingStartIndex,G.inI18n=!1}function Gs(){const k=qt.lFrame,G=null===k?null:k.child;return null===G?Ca(k):G}function Ca(k){const G={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:k,child:null,inI18n:!1};return null!==k&&(k.child=G),G}function qa(){const k=qt.lFrame;return qt.lFrame=k.parent,k.currentTNode=null,k.lView=null,k}const Cd=qa;function Nl(){const k=qa();k.isParent=!0,k.tView=null,k.selectedIndex=-1,k.contextLView=null,k.elementDepthCount=0,k.currentDirectiveIndex=-1,k.currentNamespace=null,k.bindingRootIndex=-1,k.bindingIndex=-1,k.currentQueryIndex=0}function bu(k){return(qt.lFrame.contextLView=yi(k,qt.lFrame.contextLView))[fc]}function Za(){return qt.lFrame.selectedIndex}function jh(k){qt.lFrame.selectedIndex=k}function Co(){const k=qt.lFrame;return ga(k.tView,k.selectedIndex)}function xi(){qt.lFrame.currentNamespace=fu}function Ll(){qt.lFrame.currentNamespace=pu}function wi(){!function Ya(){qt.lFrame.currentNamespace=null}()}function Vh(){return qt.lFrame.currentNamespace}let $s=!0;function Uh(){return $s}function Gf(k){$s=k}let ls={elements:void 0};function Ka(k){void 0===ls.elements&&(ls.elements=k)}function Gi(){return ls}function ht(k,G=null,ae=null,Ae){const He=Xa(k,G,ae,Ae);return He.resolveInjectorInitializers(),He}function Xa(k,G=null,ae=null,Ae,He=new Set){const ft=[ae||ts,Tr(k)];return Ae=Ae||("object"==typeof k?void 0:Cn(k)),new da(ft,G||Rs(),Ae||null,He)}class Hs{static THROW_IF_NOT_FOUND=Rn;static NULL=new pi;static create(G,ae){if(Array.isArray(G))return ht({name:""},ae,G,"");{const Ae=G.name??"";return ht({name:Ae},G.parent,G.providers,Ae)}}static \u0275prov=gt({token:Hs,providedIn:"any",factory:()=>Oi(Xt)});static __NG_ELEMENT_ID__=-1}const ri=new qn("");let Ci=(()=>class k{static __NG_ELEMENT_ID__=us;static __NG_ENV_ID__=ae=>ae})();class cs extends Ci{_lView;constructor(G){super(),this._lView=G}get destroyed(){return fa(this._lView)}onDestroy(G){const ae=this._lView;return ji(ae,G),()=>gu(ae,G)}}function us(){return new cs(va())}class on{_console=console;handleError(G){this._console.error("ERROR",G)}}const ds=new qn("",{providedIn:"root",factory:()=>{const k=xo(ti);let G;return ae=>{k.destroyed&&!G?setTimeout(()=>{throw ae}):(G??=k.get(on),G.handleError(ae))}}}),xu={provide:co,useValue:()=>{xo(on)},multi:!0},Fl=new qn("",{providedIn:"root",factory:()=>{const k=xo(ri).defaultView;if(!k)return;const G=xo(ds),ae=ft=>{G(ft.reason),ft.preventDefault()},Ae=ft=>{G(ft.error?ft.error:new Error(ft.message,{cause:ft})),ft.preventDefault()},He=()=>{k.addEventListener("unhandledrejection",ae),k.addEventListener("error",Ae)};typeof Zone<"u"?Zone.root.run(He):He(),xo(Ci).onDestroy(()=>{k.removeEventListener("error",Ae),k.removeEventListener("unhandledrejection",ae)})}});function Sd(){return Mr([(k=()=>{xo(Fl)},Mr([{provide:co,multi:!0,useValue:k}]))]);var k}function Nc(k){return"function"==typeof k&&void 0!==k[vn.bh]}function Cu(k,G){const[ae,Ae,He]=(0,vn.n5)(k,G?.equal),ft=ae;return ft.set=Ae,ft.update=He,ft.asReadonly=Su.bind(ft),ft}function Su(){const k=this[vn.bh];if(void 0===k.readonlyFn){const G=()=>this();G[vn.bh]=k,k.readonlyFn=G}return k.readonlyFn}function Ed(k){return Nc(k)&&"function"==typeof k.set}class Lc{}const Md=new qn("",{providedIn:"root",factory:()=>!1}),hs=new qn("",{providedIn:"root",factory:()=>!1}),So=new qn(""),Yn=new qn("");function Bl(k,G){if(null!==(0,vn.nR)())throw new Ht(-602,!1)}let Eu=(()=>class k{view;node;constructor(ae,Ae){this.view=ae,this.node=Ae}static __NG_ELEMENT_ID__=Gh})();function Gh(){return new Eu(va(),Dc())}let Mu=(()=>{class k{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new mt.t(!1);get hasPendingTasks(){return!this.destroyed&&this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new Ce.c(ae=>{ae.next(!1),ae.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);const ae=this.taskId++;return this.pendingTasks.add(ae),ae}has(ae){return this.pendingTasks.has(ae)}remove(ae){this.pendingTasks.delete(ae),0===this.pendingTasks.size&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=gt({token:k,providedIn:"root",factory:()=>new k})}return k})(),Td=(()=>{class k{internalPendingTasks=xo(Mu);scheduler=xo(Lc);errorHandler=xo(ds);add(){const ae=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(ae)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(ae))}}run(ae){const Ae=this.add();ae().catch(this.errorHandler).finally(Ae)}static \u0275prov=gt({token:k,providedIn:"root",factory:()=>new k})}return k})();function Tu(...k){}let $i=(()=>{class k{static \u0275prov=gt({token:k,providedIn:"root",factory:()=>new Fc})}return k})();class Fc{dirtyEffectCount=0;queues=new Map;add(G){this.enqueue(G),this.schedule(G)}schedule(G){G.dirty&&this.dirtyEffectCount++}remove(G){const Ae=this.queues.get(G.zone);Ae.has(G)&&(Ae.delete(G),G.dirty&&this.dirtyEffectCount--)}enqueue(G){const ae=G.zone;this.queues.has(ae)||this.queues.set(ae,new Set);const Ae=this.queues.get(ae);Ae.has(G)||Ae.add(G)}flush(){for(;this.dirtyEffectCount>0;){let G=!1;for(const[ae,Ae]of this.queues)G||=null===ae?this.flushQueue(Ae):ae.run(()=>this.flushQueue(Ae));G||(this.dirtyEffectCount=0)}}flushQueue(G){let ae=!1;for(const Ae of G)Ae.dirty&&(this.dirtyEffectCount--,ae=!0,Ae.run());return ae}}},669:(Xr,cn,dt)=>{"use strict";function p(St){return St}dt.d(cn,{D:()=>p})},707:(Xr,cn,dt)=>{"use strict";dt.d(cn,{Ms:()=>sn,vU:()=>_t});var p=dt(71),St=dt(359),W=dt(26),y=dt(334),Ye=dt(343);const En=mt("C",void 0,void 0);function mt(Cn,Nt,Ge){return{kind:Cn,value:Nt,error:Ge}}var Ce=dt(270),Qe=dt(786);class _t extends St.yU{constructor(Nt){super(),this.isStopped=!1,Nt?(this.destination=Nt,(0,St.Uv)(Nt)&&Nt.add(this)):this.destination=Vo}static create(Nt,Ge,ir){return new sn(Nt,Ge,ir)}next(Nt){this.isStopped?zt(function vn(Cn){return mt("N",Cn,void 0)}(Nt),this):this._next(Nt)}error(Nt){this.isStopped?zt(function yn(Cn){return mt("E",void 0,Cn)}(Nt),this):(this.isStopped=!0,this._error(Nt))}complete(){this.isStopped?zt(En,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Nt){this.destination.next(Nt)}_error(Nt){try{this.destination.error(Nt)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ht=Function.prototype.bind;function Ut(Cn,Nt){return Ht.call(Cn,Nt)}class Gt{constructor(Nt){this.partialObserver=Nt}next(Nt){const{partialObserver:Ge}=this;if(Ge.next)try{Ge.next(Nt)}catch(ir){Mn(ir)}}error(Nt){const{partialObserver:Ge}=this;if(Ge.error)try{Ge.error(Nt)}catch(ir){Mn(ir)}else Mn(Nt)}complete(){const{partialObserver:Nt}=this;if(Nt.complete)try{Nt.complete()}catch(Ge){Mn(Ge)}}}class sn extends _t{constructor(Nt,Ge,ir){let Tn;if(super(),(0,p.T)(Nt)||!Nt)Tn={next:Nt??void 0,error:Ge??void 0,complete:ir??void 0};else{let gn;this&&W.$.useDeprecatedNextContext?(gn=Object.create(Nt),gn.unsubscribe=()=>this.unsubscribe(),Tn={next:Nt.next&&Ut(Nt.next,gn),error:Nt.error&&Ut(Nt.error,gn),complete:Nt.complete&&Ut(Nt.complete,gn)}):Tn=Nt}this.destination=new Gt(Tn)}}function Mn(Cn){W.$.useDeprecatedSynchronousErrorHandling?(0,Qe.l)(Cn):(0,y.m)(Cn)}function zt(Cn,Nt){const{onStoppedNotification:Ge}=W.$;Ge&&Ce.f.setTimeout(()=>Ge(Cn,Nt))}const Vo={closed:!0,next:Ye.l,error:function _r(Cn){throw Cn},complete:Ye.l}},786:(Xr,cn,dt)=>{"use strict";dt.d(cn,{Y:()=>W,l:()=>y});var p=dt(26);let St=null;function W(Ye){if(p.$.useDeprecatedSynchronousErrorHandling){const En=!St;if(En&&(St={errorThrown:!1,error:null}),Ye(),En){const{errorThrown:yn,error:vn}=St;if(St=null,yn)throw vn}}else Ye()}function y(Ye){p.$.useDeprecatedSynchronousErrorHandling&&St&&(St.errorThrown=!0,St.error=Ye)}},853:(Xr,cn,dt)=>{"use strict";function p(St){const y=St(Ye=>{Error.call(Ye),Ye.stack=(new Error).stack});return y.prototype=Object.create(Error.prototype),y.prototype.constructor=y,y}dt.d(cn,{L:()=>p})},908:(Xr,cn,dt)=>{"use strict";function p(St,W){if(St){const y=St.indexOf(W);0<=y&&St.splice(y,1)}}dt.d(cn,{o:()=>p})},985:(Xr,cn,dt)=>{"use strict";dt.d(cn,{c:()=>vn});var p=dt(707),St=dt(359),W=dt(494),y=dt(203),Ye=dt(26),En=dt(71),yn=dt(786);let vn=(()=>{class _t{constructor(Ut){Ut&&(this._subscribe=Ut)}lift(Ut){const Gt=new _t;return Gt.source=this,Gt.operator=Ut,Gt}subscribe(Ut,Gt,sn){const Mn=function Qe(_t){return _t&&_t instanceof p.vU||function Ce(_t){return _t&&(0,En.T)(_t.next)&&(0,En.T)(_t.error)&&(0,En.T)(_t.complete)}(_t)&&(0,St.Uv)(_t)}(Ut)?Ut:new p.Ms(Ut,Gt,sn);return(0,yn.Y)(()=>{const{operator:_r,source:zt}=this;Mn.add(_r?_r.call(Mn,zt):zt?this._subscribe(Mn):this._trySubscribe(Mn))}),Mn}_trySubscribe(Ut){try{return this._subscribe(Ut)}catch(Gt){Ut.error(Gt)}}forEach(Ut,Gt){return new(Gt=mt(Gt))((sn,Mn)=>{const _r=new p.Ms({next:zt=>{try{Ut(zt)}catch(Vo){Mn(Vo),_r.unsubscribe()}},error:Mn,complete:sn});this.subscribe(_r)})}_subscribe(Ut){var Gt;return null===(Gt=this.source)||void 0===Gt?void 0:Gt.subscribe(Ut)}[W.s](){return this}pipe(...Ut){return(0,y.m)(Ut)(this)}toPromise(Ut){return new(Ut=mt(Ut))((Gt,sn)=>{let Mn;this.subscribe(_r=>Mn=_r,_r=>sn(_r),()=>Gt(Mn))})}}return _t.create=Ht=>new _t(Ht),_t})();function mt(_t){var Ht;return null!==(Ht=_t??Ye.$.Promise)&&void 0!==Ht?Ht:Promise}}},Xr=>{Xr(Xr.s=436)}]);